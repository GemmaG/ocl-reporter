<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><subtitle type="text">Real World Functional Programming</subtitle><link href="http://ocaml.io/blogs/atom.xml" rel="self"/><author><name>OCaml Labs</name></author><id>http://ocaml.io/blogs/atom.xml</id><title type="text">OCaml Labs Blogs</title><updated>2015-03-26T08:56:57+00:00</updated><entry><link href="http://kcsrk.info/multicore/opam/ocaml/2015/03/25/opam-switch-to-multicore/" rel="alternate"/><contributor><uri>http://kcsrk.info/atom.xml</uri><name>KC Sivaramakrishnan</name></contributor><content type="html">&lt;p&gt;OPAM has a great &lt;a href=&quot;https://opam.ocaml.org/doc/Usage.html#opamswitch&quot;&gt;compiler
switch&lt;/a&gt; feature that lets you
simultaneously host several OCaml installations, each with its own compiler
version and a set of installed packages. I wanted to use the power of &lt;code&gt;opam
switch&lt;/code&gt; for working with the experimental &lt;a href=&quot;https://github.com/kayceesrk/ocaml-multicore&quot;&gt;multicore
OCaml&lt;/a&gt; compiler. The key
advantage of doing this is that it lets you easily install packages from the
&lt;a href=&quot;http://opam.ocaml.org/&quot;&gt;OPAM repository&lt;/a&gt;, while sandboxing it from other OCaml
installations on your system. The post will show how to create OPAM compiler
switch for multicore OCaml.&lt;/p&gt;

&lt;h2&gt;Install opam-compiler-conf&lt;/h2&gt;

&lt;p&gt;The first step is to install Gabriel Scherer's &lt;a href=&quot;https://github.com/gasche/opam-compiler-conf&quot;&gt;opam-compiler-conf
script&lt;/a&gt; which lets you do opam
switches on local installations:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone https://github.com/gasche/opam-compiler-conf
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;opam-compiler-conf
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mkdir -p ~/.local/bin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make &lt;span class=&quot;nv&quot;&gt;BINDIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;~/.local/bin install&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This installs the &lt;code&gt;opam-compiler-conf&lt;/code&gt; script under &lt;code&gt;~/.local/bin&lt;/code&gt;. Make sure
this directory is under your search path. Now, &lt;code&gt;$opam compiler-conf&lt;/code&gt; should
give you the list of available commands.&lt;/p&gt;

&lt;h2&gt;Build multicore OCaml locally&lt;/h2&gt;

&lt;p&gt;Typing &lt;code&gt;opam switch&lt;/code&gt; should list the compilers currently installed in your
system and those that are available. For instance, here is my setup:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam switch
system  C system  System compiler &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4.02.1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
4.02.1  I 4.02.1  Official 4.02.1 release
4.02.0  I 4.02.0  Official 4.02.0 release
4.01.0  I 4.01.0  Official 4.01.0 release
--     -- 3.11.2  Official 3.11.2 release
--     -- 3.12.1  Official 3.12.1 release
--     -- 4.00.0  Official 4.00.0 release
--     -- 4.00.1  Official 4.00.1 release
&lt;span class=&quot;c&quot;&gt;# 66 more patched or experimental compilers, use '--all' to show&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You can easily switch between the installations using &lt;code&gt;opam switch
&amp;lt;system-name&amp;gt;&lt;/code&gt;. Let us now install multicore OCaml as a new switch:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone https://github.com/kayceesrk/ocaml-multicore
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;ocaml-multicore
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam compiler-conf configure
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make world
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam compiler-conf install
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;opam config env&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The multicore compiler is now installed and has been made the current compiler:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam switch
system                      I system                      System compiler &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4.02.1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
4.02.1+local-git-multicore  C 4.02.1+local-git-multicore  Local checkout of 4.02.1 at /Users/kc/ocaml-multicore
4.02.1                      I 4.02.1                      Official 4.02.1 release
4.02.0                      I 4.02.0                      Official 4.02.0 release
4.01.0                      I 4.01.0                      Official 4.01.0 release
--                         -- 3.11.2                      Official 3.11.2 release
--                         -- 3.12.1                      Official 3.12.1 release
--                         -- 4.00.0                      Official 4.00.0 release
--                         -- 4.00.1                      Official 4.00.1 release
&lt;span class=&quot;c&quot;&gt;# 66 more patched or experimental compilers, use '--all' to show&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This can be confirmed by:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ocamlc -version
4.02.1+multicore-dev0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;which shows the current OCaml bytecode compiler version.&lt;/p&gt;

&lt;h2&gt;Working with the local switch&lt;/h2&gt;

&lt;p&gt;Every time you change the compiler source, you need to rebuild the compiler and
reinstall the switch:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Changed compiler source...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make world
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam compiler-conf reinstall&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The local installation can be removed by &lt;code&gt;opam compiler-conf uninstall&lt;/code&gt;.&lt;/p&gt;
</content><id>http://kcsrk.info/multicore/opam/ocaml/2015/03/25/opam-switch-to-multicore/</id><title type="text">Opam Switch to Multicore OCaml</title><updated>2015-03-25T18:15:00+00:00</updated><author><email></email><name>KC Sivaramakrishnan</name></author></entry><entry><link href="http://www.skjegstad.com/blog/2015/03/25/mirageos-vm-per-url-experiment/" rel="alternate"/><contributor><uri>http://www.skjegstad.com/feeds/all.atom.xml</uri><name>Magnus Skjegstad</name></contributor><content type="html">&lt;p&gt;I recently wrote a DNS server that can boot unikernels on demand called &lt;a href=&quot;https://github.com/MagnusS/jitsu&quot;&gt;Jitsu&lt;/a&gt;. The following diagram shows a simplified version of how Jitsu works. The client sends a DNS query to a DNS server (Jitsu). The DNS server starts a unikernel and sends a DNS response back to the client while the unikernel is booting. When the client receives the DNS response it opens a TCP connection to the unikernel, which now has completed booting and is ready to respond to the TCP connection.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/jitsu/jitsu.jpg&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The unikernels are built using &lt;a href=&quot;http://www.openmirage.org&quot;&gt;MirageOS&lt;/a&gt;, a library operating system that allows applications to be compiled directly to small Xen VMs. These unikernels only include the operating system components the application needs - nothing else is added. This results in very small VMs with low resource requirements that boot quickly. &lt;/p&gt;
&lt;p&gt;Now, what if I wanted to use Jitsu to boot my unikernel website when someone accesses it? My website is fairly low traffic, so this could potentially save me some resource use and hosting costs. Unfortunately, there are always a few requests per hour to some of the more popular sections, which likely would make my unikernel run most of the time. But what if I could split my unikernel into even smaller unikernels? What if I went to an extreme and had one unikernel per URL? Then I could only boot unikernels for the URLs that are being used and they would only need to know how to serve a single page. This could also have a number of benefits, such as the ability to spin up multiple unikernels for an extremely popular web page and use DNS to direct clients to the unikernel that is closest to them &amp;mdash; while keeping the rest of the site inactive (let's ignore web crawlers for now). If I had dynamic sections of my website there could also be security benefits: Every dynamic page would run as a separate VM. An attack on a single page would not have to bring down the rest of the site nor reveal any data stored in other unikernels.&lt;/p&gt;


&lt;p&gt;As an experiment, I wanted to see if I could run &lt;em&gt;every&lt;/em&gt; URL hosted under my domain as a separate virtual machine. The goal was to map each URL to a domain name, which in turn was directed to a separate VM running a web server that hosts a single page. For example, the URL http://www.skjegstad.com/index.html becomes http://index.html.www.skjegstad.com/.  Each domain is then mapped to a single IPv4 address on my local network.&lt;/p&gt;
&lt;p&gt;Here is an abstract from the DNS zone file.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.11&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m4v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.12&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;33.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.13&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.14&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can see that even individual images have their own DNS entry, and will be served separately.&lt;/p&gt;
&lt;p&gt;There is an OCaml web server library, called &lt;a href=&quot;https://github.com/mirage/ocaml-cohttp&quot;&gt;CoHTTP&lt;/a&gt;, which we can use with MirageOS. Using this library, unikernels can be written that host static web pages. The web content itself can either be compiled into the unikernel (as a data structure) or be stored directly on a block storage device. For this experiment, I use the built-in data structure to store a single file per unikernel. &lt;/p&gt;
&lt;p&gt;For the unikernel code, I take the static_webserver example from &lt;a href=&quot;https://github.com/mirage/mirage-skeleton&quot;&gt;mirage-skeleton&lt;/a&gt;. The code automatically creates a web server that hosts the files located in the &lt;code&gt;./htdocs&lt;/code&gt; subdirectory when the unikernel is built.&lt;/p&gt;
&lt;p&gt;The demo code (available &lt;a href=&quot;https://github.com/MagnusS/vm-per-url-experiment&quot;&gt;here&lt;/a&gt;) accepts a directory with static web pages as input. I will use my own website in the examples below, but any site with static web pages should work.&lt;/p&gt;
&lt;p&gt;First, mirror (or copy) a static website:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then run the &lt;a href=&quot;https://github.com/MagnusS/vm-per-url-experiment/blob/master/create.py&quot;&gt;create.py&lt;/a&gt; script to generate a unikernel with a web server for each file, which will serve that single file from memory. Note that the folder name and domain name must match - otherwise the script will become confused and not rewrite the URLs properly.  My site has 49 pages and I've copied the entire output below.  This step should only take a few seconds on a reasonably modern machine.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;# Run create.py on the contents of the www.skjegstad.com folder. Folder name and domain name must match.&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;python&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Indexing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;85956378&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dc89cf3a2729&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f7fb9c68d5c3701996b3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m4v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m4v&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c286eccb0f59b299cca1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;33.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;camera_33&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bef80428ab04abb98c3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;41&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d9ee421440ceec86a4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a9fdfed9d054ee4d48de&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;28.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;camera_28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ca0d87ae96d8648c36d&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;screenshot1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;screenshot1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b1ce89d1c806c4234f2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mirage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ubuntu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;overview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ubuntu_in_vm_overview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d368ef42317b28f6243&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mirage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;overview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xen_in_vm_overview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a4e519b0d91b8967b62&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MobileNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MobileNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;390&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a92f0488aa32f17e3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f9a90e263ac465d53558&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc21dfa295c33c6e3bd3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;afc6634e807f1bddad22&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1f&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b97ef7d3a4a1ba0f4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dedbc5bfcd11fe49a83&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;8f15f&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a23ae6563d2d890&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;software&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;855&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d32b8905249554f69&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;macvim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;funnel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pl&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.05.01.2012&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cb72fc8606b734fd7322&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.12.01.2012&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;570&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b6f207695db4d2898&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mirageos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualbox&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.19.01.2015&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ada75a179f0d6c6cdff&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;experimenting&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distributed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chat&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.02.12.2011&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d0613c7f413609ab402&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stand&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bloom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.20.10.2011&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c11e5af4b1a8ee667bf5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;virtualbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;198f10ff&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b77757798200&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bloom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;da3c099920c48f77b625&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ec590d332b74f3521787&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;befa876942eb63d806d0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;experiments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d14e6010e04324f1fa9&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d09920f7a15c2f930686&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bd2e2788f6309bc762c&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mirageos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b08718e16dddf30473f&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dfc57a0ce3fc7382a001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a13890b437ef10df36e4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;papers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mistsd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;milcom2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad_mistsd_milcom2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdf&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b39a34888b769596fe0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;papers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;milcom09skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;milcom09skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdf&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;09854f&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b4a6c9bafe01&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;papers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;milcom11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distributed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;milcom11_distributed_chat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdf&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;759&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;daabffb7ac70f3c82&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;publications&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2434&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cc8c7a5f966b2bc9&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;about&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;6ff&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ef4c2d9236d7a398&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modernizr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modernizr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b8ff82e33ce3d777d9e&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;octopress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;octopress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2e5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e43546763b649cd3b&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;edf18f0bba513af40346&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;github&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;github&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a577cb04bac38034dc95&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1395516324&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e9d12885cf941b2f149c&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1395516324&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c23144b5f096a13a71bb&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code_bg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1395516324&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;19e1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de022f4a565bc1e2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1395516324&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;29ff&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b603a5d0cdebdc&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1395516324&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d4e8d94047cf9c45080&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1395516324&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;433115&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bed52cbea861a0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Preparing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;css&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bacfdf7b71099057d8c&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Zone&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generated&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Makefile&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generated&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;destroy&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VMs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Start&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;local&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DNS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dns&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;When the script completes, a unikernel has been created in &lt;code&gt;./staging&lt;/code&gt; for each file in the www.skjegstad.com directory. To compile the unikernels using the mirage-tool, run &lt;code&gt;make&lt;/code&gt;. Note that this requires a working MirageOS development environment and I have written a guide for setting this up &lt;a href=&quot;http://www.skjegstad.com/blog/2015/01/19/mirageos-xen-virtualbox/&quot;&gt;here&lt;/a&gt;. This step will take some time, depending on how many pages you have. In my case, it was around 4 minutes in Virtualbox on my laptop.&lt;/p&gt;
&lt;p&gt;When all the unikernels have been successfully built, &lt;code&gt;make run&lt;/code&gt; will start each of them using Xen's &lt;code&gt;xl&lt;/code&gt; tool. Use &lt;code&gt;sudo xl list&lt;/code&gt; to see the running unikernels. This is the &lt;code&gt;xl&lt;/code&gt; output for 49 MirageOS virtual machines hosting www.skjegstad.com on my local network:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xl&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt;                                        &lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;Mem&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VCPUsStateTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Domain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;                                     &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;292&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-----&lt;/span&gt;    &lt;span class=&quot;mf&quot;&gt;2156.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;85956378&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dc89cf3a2729&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;39&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f7fb9c68d5c3701996b3&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c286eccb0f59b299cca1&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;41&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bef80428ab04abb98c3&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;41&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d9ee421440ceec86a4&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;43&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a9fdfed9d054ee4d48de&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;44&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ca0d87ae96d8648c36d&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b1ce89d1c806c4234f2&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;46&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d368ef42317b28f6243&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;47&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a4e519b0d91b8967b62&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;390&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a92f0488aa32f17e3&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;49&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f9a90e263ac465d53558&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fc21dfa295c33c6e3bd3&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;afc6634e807f1bddad22&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;52&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;1f&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b97ef7d3a4a1ba0f4&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;53&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dedbc5bfcd11fe49a83&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;8f15f&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a23ae6563d2d890&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;55&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;855&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d32b8905249554f69&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;56&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cb72fc8606b734fd7322&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;57&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;570&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b6f207695db4d2898&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;58&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ada75a179f0d6c6cdff&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;59&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d0613c7f413609ab402&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c11e5af4b1a8ee667bf5&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;61&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;198f10ff&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b77757798200&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;62&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;da3c099920c48f77b625&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;63&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ec590d332b74f3521787&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;befa876942eb63d806d0&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d14e6010e04324f1fa9&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;66&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d09920f7a15c2f930686&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;67&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bd2e2788f6309bc762c&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;68&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b08718e16dddf30473f&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;69&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dfc57a0ce3fc7382a001&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a13890b437ef10df36e4&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;71&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b39a34888b769596fe0&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;72&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;09854f&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b4a6c9bafe01&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;73&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;759&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;daabffb7ac70f3c82&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;74&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;2434&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cc8c7a5f966b2bc9&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;75&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;6ff&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ef4c2d9236d7a398&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;76&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b8ff82e33ce3d777d9e&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;77&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;2e5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e43546763b649cd3b&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;78&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;edf18f0bba513af40346&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;79&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a577cb04bac38034dc95&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;e9d12885cf941b2f149c&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;81&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c23144b5f096a13a71bb&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;82&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;19e1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de022f4a565bc1e2&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;83&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mf&quot;&gt;29ff&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b603a5d0cdebdc&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;84&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d4e8d94047cf9c45080&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;85&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;433115&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bed52cbea861a0&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;86&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bacfdf7b71099057d8c&lt;/span&gt;                        &lt;span class=&quot;mi&quot;&gt;87&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The create.py-script also generated a DNS zone file that maps the domain names to IP addresses. This is the generated zone file for www.skjegstad.com:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zone&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;SOA&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;postmaster&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;600&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;600&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;600&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;CNAME&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.11&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m4v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.12&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;33.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.13&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.14&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ardrone1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.15&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;28.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.16&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;screenshot1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.17&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mirage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ubuntu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;overview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.18&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mirage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;overview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.19&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MobileNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.21&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.22&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.23&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.24&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.25&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uavexperiment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.26&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;software&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.27&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;macvim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;funnel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pl&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.05.01.2012&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.28&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.12.01.2012&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.29&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mirageos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualbox&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.19.01.2015&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;experimenting&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distributed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chat&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.02.12.2011&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.31&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stand&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bloom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.20.10.2011&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;virtualbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.33&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bloom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.34&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.35&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;unikernel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.36&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;experiments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.37&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.38&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;xen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.39&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mirageos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.40&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ardrone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.41&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.42&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;papers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mistsd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;milcom2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.43&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;papers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;milcom09skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.44&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;papers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;milcom11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distributed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.45&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;publications&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.46&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;about&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.47&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modernizr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.48&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;octopress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.49&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.50&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;github&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.51&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.52&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.53&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.54&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.55&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.56&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.57&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skjegstad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;IN&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;192.168.56.58&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The zone file can be loaded in your favorite DNS server (e.g. bind or unbound). It is also relatively easy to build a quick DNS server in OCaml based on ocaml-dns:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;open&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;open&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Lwt&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Lwt_main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;0.0.0.0&amp;quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;53&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Dns_server_unix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serve_with_zonefile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;www.skjegstad.com.zone&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I have written an extended version with support for forwarding unknown DNS requests to another DNS server. It is available for download &lt;a href=&quot;https://github.com/MagnusS/vm-per-url-experiment/blob/master/serve_dns.ml&quot;&gt;here&lt;/a&gt; and is included in the demo code. In fact, you could also run the DNS server as a unikernel, but I will leave that as an exercise for the reader (&lt;a href=&quot;http://hh360.user.srcf.net/blog/2015/02/part-1-running-your-own-dns-resolver-with-mirageos/&quot;&gt;this blog post&lt;/a&gt; by Heidi Howard is a good starting point with lots of &lt;a href=&quot;https://github.com/heidi-ann/ocaml-dns-examples&quot;&gt;examples&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Point your DNS server to the IP of the DNS server that hosts the zone file to start browsing the static website. Each static page should map to a separate domain name which is run by a single MirageOS unikernel!&lt;/p&gt;
&lt;h3&gt;Conclusion / discussion&lt;/h3&gt;
&lt;p&gt;Currently this is just a quick experiment and is not very practical. I would still need a unikernel or Linux VM to run the DNS server and I have not been able to find a hosting provider that has a minimum configuration which would be appropriate for large or small unikernels (e.g. 8MB vs 64MB RAM). Each VM/URL would also require a unique public IP address unless they are placed behind another service (NAT) that can route the HTTP requests to an internal network. &lt;/p&gt;
&lt;p&gt;If you followed along, then you would also notice that the compiled unikernels in &lt;code&gt;./staging&lt;/code&gt; take up around 175MB (49 unikernels). When running, they collectively consume around 1.6GB of memory. However, it was a lot easier to try this experiment using unikernels than it would have been with a traditional OS stack.&lt;/p&gt;
&lt;p&gt;A more practical architecture would perhaps be to run a website and DNS server from a single host initially. As each web page is mapped to a URL, the DNS server could then be configured to automatically boot new unikernels only if a subdomain experienced high load. It could, for example, deploy unikernels automatically to Amazon EC2 that serve a single file and start returning its IP address in DNS queries in periods with high load. Once the website has been 'disaggregated' this way, it would even be possible to start VMs in availability zones that are geographically close to the where the spike in traffic is originating!  This could all be configured to happen automatically, with DNS entries being updated as new pages are added and with unikernels being deployed to places where they are in demand.&lt;/p&gt;
&lt;p&gt;(Thanks to Amir Chaudry for commenting on a draft of this post)&lt;/p&gt;</content><id>http://www.skjegstad.com/blog/2015/03/25/mirageos-vm-per-url-experiment/</id><title type="text">A unikernel experiment: A VM for every URL</title><updated>2015-03-25T00:00:00+00:00</updated><author><email></email><name>Magnus Skjegstad</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=956" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;This article&amp;nbsp;is the third in the &amp;ldquo;Running your own DNS Resolver with MirageOS&amp;rdquo; series. In the&amp;nbsp;&lt;a href=&quot;http://hh360.user.srcf.net/blog/2015/02/part-1-running-your-own-dns-resolver-with-mirageos/&quot; title=&quot;Part 1: Running your own DNS Resolver with MirageOS&quot;&gt;first part&lt;/a&gt;, we used the&amp;nbsp;&lt;a href=&quot;https://github.com/mirage/ocaml-dns&quot;&gt;ocaml-dns&lt;/a&gt;&amp;nbsp;library to lookup the hostname corresponding with an IP address using its&amp;nbsp;&lt;a href=&quot;https://github.com/mirage/ocaml-dns/blob/master/mirage/dns_resolver_mirage.mli&quot;&gt;Dns_resolver_mirage&lt;/a&gt;&amp;nbsp;module. In the&amp;nbsp;&lt;a href=&quot;http://hh360.user.srcf.net/blog/2015/03/part-2-running-your-own-dns-resolver-with-mirageos/&quot; title=&quot;Part 2: Running your own DNS Resolver with MirageOS&quot;&gt;second part&lt;/a&gt;, we wrote a simple DNS server, which serves RRs from a zone file using the &lt;a href=&quot;https://github.com/mirage/ocaml-dns/blob/master/mirage/dns_server_mirage.mli&quot;&gt;Dns_server_mirage&lt;/a&gt; module.&lt;/p&gt;
&lt;p&gt;Today in the third part, we will combine the above to write a simple DNS resolver, which relays queries to another DNS resolver. Then we will compose this with our simple DNS server from last week, to build a resolver which first looks up queries in the host file and if unsuccessful will relay the query to another DNS resolver.&lt;/p&gt;
&lt;p&gt;As always, the complete code for these examples is in &lt;a href=&quot;https://github.com/heidi-ann/ocaml-dns-examples&quot;&gt;ocaml-dns-examples&lt;/a&gt;.&lt;/p&gt;
&lt;h5&gt;3.1 DNS FoRwarder&lt;/h5&gt;
&lt;p&gt;When writing our simple DNS server, we used a function called serve_with_zonefile in Dns_server_mirage to service incoming DNS queries. Now we are going remove a layer of abstraction and instead use&amp;nbsp;serve_with_processor:&lt;/p&gt;
&lt;pre&gt;val serve_with_processor: t -&amp;gt; port:int -&amp;gt; processor:(module PROCESSOR) -&amp;gt; unit Lwt.t
val serve_with_zonefile : t -&amp;gt; port:int -&amp;gt; zonefile:string -&amp;gt; unit Lwt.t
&lt;/pre&gt;
&lt;p&gt;Now instead of passing the function a simple string, representing the filename of zonefile, we pass a first class module, satisfying the PROCESSOR signature. We can generate such a module by writing a process and using processor_of_process:&lt;/p&gt;
&lt;pre&gt;type ip_endpoint = Ipaddr.t * int

type 'a process = src:ip_endpoint -&amp;gt; dst:ip_endpoint -&amp;gt; 'a -&amp;gt; Dns.Query.answer option Lwt.t

module type PROCESSOR = sig
  include Dns.Protocol.SERVER

  (** DNS responder function.
      @param src Server sockaddr
      @param dst Client sockaddr
      @param Query packet
      @return Answer packet
  *)
  val process : context process
end

type 'a processor = (module PROCESSOR with type context = 'a)

val processor_of_process : Dns.Packet.t process -&amp;gt; Dns.Packet.t processor&lt;/pre&gt;
&lt;p&gt;So given a&amp;nbsp;Dns.Packet.t process, which is a function of type:&lt;/p&gt;
&lt;pre&gt;src:ip_endpoint -&amp;gt; dst:ip_endpoint -&amp;gt;&amp;nbsp;Dns.Packet.t -&amp;gt; Dns.Query.answer option Lwt.t&lt;/pre&gt;
&lt;p&gt;We can now service DNS packets. If we assume that myprocess is a function of this type, we can service DNS queries with the following unikernel&lt;/p&gt;
&lt;pre&gt;open Lwt
open V1_LWT
open Dns
open Dns_server

let port = 53

module Main (C:CONSOLE) (K:KV_RO) (S:STACKV4) = struct

  module U = S.UDPV4
  module DS = Dns_server_mirage.Make(K)(S)

  let myprocess ~src ~dst packet = ...

  let start c k s =
    let server = DS.create s k in
    let processor = ((Dns_server.processor_of_process myprocess) :&amp;gt; (module Dns_server.PROCESSOR)) in 
    DS.serve_with_processor server ~port ~processor
end

&lt;/pre&gt;
&lt;p&gt;Now we will write an implementation of myprocess which will service DNS packets by forwarding them to another DNS resolver and then relaying the response.&lt;/p&gt;
&lt;p&gt;Recall from part 1, that you can use the resolve function in Dns_resolver_mirage to do this. All that remains is to wrap invocation of resolve, in a function of type&amp;nbsp;Dns.Packet.t process, which can be done as follows:&lt;/p&gt;
&lt;pre&gt; 
let process resolver ~src ~dst packet =
      let open Packet in
      match packet.questions with
      | [] -&amp;gt; (* we are not supporting QDCOUNT = 0  *)
          return None 
      | [q] -&amp;gt; 
         DR.resolve (module Dns.Protocol.Client) resolver 
         resolver_addr resolver_port q.q_class q.q_type q.q_name 
          &amp;gt;&amp;gt;= fun result -&amp;gt;
          return (Some (Dns.Query.answer_of_response result))) 
      | _ -&amp;gt; (* we are not supporting QDCOUNT &amp;gt; 1 *)
          return None&lt;/pre&gt;
&lt;h5&gt;3.2 DNS server &amp;amp; forwarder&lt;/h5&gt;
&lt;p&gt;&lt;em&gt;[this part requires PR 58 on ocaml-dns until it is merged in]&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We will extend our DNS forwarded to first check a zonefile, this is achieve with just 3 extra lines:&lt;/p&gt;
&lt;pre&gt;...
DS.eventual_process_of_zonefiles server [zonefile]
&amp;gt;&amp;gt;= fun process -&amp;gt;
let processor = (processor_of_process (compose process (forwarder resolver)) :&amp;gt; (module Dns_server.PROCESSOR)) in
...
&lt;/pre&gt;
&lt;p&gt;Here we are using compose to use two processes: one called process generated from the zonefile and one called forwarder, from the forwarding code&amp;nbsp;in the last section.&lt;/p&gt;
&lt;p&gt;Next time, we will extend our DNS resolver to include a cache.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
</content><id>http://hh360.user.srcf.net/blog/?p=956</id><title type="text">Part 3: Running your own DNS Resolver with MirageOS</title><updated>2015-03-19T12:01:22+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=832" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://hh360.user.srcf.net/blog/2015/02/part-1-running-your-own-dns-resolver-with-mirageos/&quot; title=&quot;Part 1: Running your own DNS Resolver with MirageOS&quot;&gt;Last time&lt;/a&gt;, we wrote a simple &amp;ldquo;dig like&amp;rdquo; unikernel. Given a domain and the address of a nameserver, the unikernel resolved the domain&amp;nbsp;by asking the nameserver and returned the return to the console.&lt;/p&gt;
&lt;p&gt;Today, we will look at another way to resolve a DNS query, being a DNS server. This is useful in its own right but also allows us to cool things with our local DNS resolver such as locally overwriting DNS names and resolving .local names, both of which we will add to our DNS resolver another day.&lt;/p&gt;
&lt;p&gt;Today&amp;nbsp;we use features only added to ocaml-dns library in version 0.15 (currently &lt;a href=&quot;https://github.com/mirage/ocaml-dns/pull/52&quot;&gt;PR #52&lt;/a&gt;), so if you do not have this version or later, then update OPAM or pin the master branch on github.&lt;/p&gt;
&lt;p&gt;Building a DNS server with MirageOS is simple, look at the following code:&lt;/p&gt;
&lt;pre&gt;open Lwt
open V1_LWT
open Dns
open Dns_server

let port = 53
let zonefile = &amp;quot;test.zone&amp;quot;

module Main (C:CONSOLE) (K:KV_RO) (S:STACKV4) = struct

  module U = S.UDPV4
  module DNS = Dns_server_mirage.Make(K)(S)

  let start c k s =
    let t = DNS.create s k in
    DNS.serve_with_zonefile t ~port ~zonefile
end
&lt;/pre&gt;
&lt;p&gt;The above code will serve DNS requests to port 53, responding with the resource records (RR) in test.zone. We have provided an example zone file in the &lt;a href=&quot;https://github.com/heidi-ann/ocaml-dns-examples&quot;&gt;repo&lt;/a&gt;&amp;nbsp;with the code from this guide. To use this unikernel, we also need to edit the config.ml file from yesterday.&lt;/p&gt;
&lt;pre&gt;open Mirage

let data = crunch &amp;quot;./data&amp;quot;

let handler =
  foreign &amp;quot;Unikernel.Main&amp;quot; (console @-&amp;gt; kv_ro @-&amp;gt; stackv4 @-&amp;gt; job)

let ip_config:ipv4_config = {
  address= Ipaddr.V4.make 192 168 1 2;
  netmask= Ipaddr.V4.make 255 255 255 0;
  gateways= [Ipaddr.V4.make 192 168 1 1];
}

let direct =
  let stack = direct_stackv4_with_static_ipv4 default_console tap0 ip_config  in
  handler $ default_console $ data $ stack

let () =
  add_to_ocamlfind_libraries [&amp;quot;dns.mirage&amp;quot;;&amp;quot;dns.lwt-core&amp;quot;];
  add_to_opam_packages [&amp;quot;dns&amp;quot;];
  register &amp;quot;dns&amp;quot; [direct]
&lt;/pre&gt;
&lt;p&gt;We are using crunch to access the zone file in the data directory. As explain in part 1, this config file is specific to my network setup for xen backends and can easily be generalised.&lt;/p&gt;
&lt;p&gt;You can now test your DNS server and see it work&lt;/p&gt;
&lt;pre&gt;$ dig @192.168.1.2 ns0.d1.signpo.st.&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
</content><id>http://hh360.user.srcf.net/blog/?p=832</id><title type="text">Part 2: Running your own DNS Resolver with MirageOS</title><updated>2015-03-02T21:50:27+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=792" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;The following is the first part in a step-by-step guide to setting up your own DNS resolver using MirageOS. I will be running this on a low power, low cost ARM device called the &lt;a href=&quot;http://www.amazon.co.uk/Cubieboard-A20-chip-New-IT/dp/B00FB5ILQ4&quot;&gt;Cubieboard 2&lt;/a&gt;. Up to date code for each version of the DNS&amp;nbsp;resolver is on G&lt;a href=&quot;https://github.com/heidi-ann/ocaml-dns-examples&quot;&gt;ithub&lt;/a&gt;. This guide assumes some basic experience&amp;nbsp;of &lt;a href=&quot;http://ocsigen.org/lwt/2.4.7/api/index&quot;&gt;lwt&lt;/a&gt; and MirageOS, up to the level of the&amp;nbsp;&lt;a href=&quot;http://www.openmirage.org/wiki/hello-world&quot;&gt;Hello World Tutorial&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Feedback on this article and pull requests to the &lt;a href=&quot;https://github.com/heidi-ann/ocaml-dns-examples&quot;&gt;demo code&lt;/a&gt;&amp;nbsp;are welcome.&lt;/p&gt;
&lt;h4&gt;Part&amp;nbsp;1.1 &amp;ndash; Setting up the cubieboard with MirageOS&lt;/h4&gt;
&lt;p&gt;Plenty of information on setting up a cubieboard with Xen and MirageOS is available elsewhere, most notability:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MirageOS &lt;a href=&quot;http://www.openmirage.org/wiki/hello-world&quot;&gt;Hello World Tutorial&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://github.com/mirage/mirage-skeleton&quot;&gt;Code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Cubieboard2 Xen&lt;a href=&quot;https://github.com/mirage/xen-arm-builder&quot;&gt; Binaries&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For debugging I am a big fan for wireshark. I run a full wireshark sesson on the machine which is connection sharing to my cubieboard network, to check all external traffic.&lt;/p&gt;
&lt;p&gt;For this guide, I will always be compiling for Xen ARM backend, with direct network connection via br0 and a static IP for all unikernels. My test network router is configured to give out static IP of the form 192.168.1.x to hosts&amp;nbsp;with the MAC address 00:00:00:00:00:0x. As a result, my config.ml file look like:&lt;/p&gt;
&lt;pre&gt;open Mirage

let ip_config:ipv4_config = {
  address= Ipaddr.V4.make 192 168 1 2;
  netmask= Ipaddr.V4.make 255 255 255 0;
  gateways= [Ipaddr.V4.make 192 168 1 1];
}

let client =
  foreign &amp;quot;Unikernel.Client&amp;quot; @@ console @-&amp;gt; stackv4 @-&amp;gt; job

let () =
  add_to_ocamlfind_libraries [ &amp;quot;dns.mirage&amp;quot;; ];
  register &amp;quot;dns-client&amp;quot; 
[ client $ default_console $ direct_stackv4_with_static_ipv4 default_console tap0 ip_config]
&lt;/pre&gt;
&lt;p&gt;Since the IP address of the unikernel is 192.168.1.2, before launching the unikernel, I do:&lt;/p&gt;
&lt;pre&gt;echo &amp;quot;vif = [ 'mac=00:00:00:00:00:02,bridge=br0' ]&amp;quot; &amp;gt;&amp;gt; dns-client.xl
&lt;/pre&gt;
&lt;p&gt;I build unikernel using the usual commands:&lt;/p&gt;
&lt;pre&gt;mirage configure --xen
make depend; make; make run
# edit file.xl
sudo xl create -c file.xl
&lt;/pre&gt;
&lt;h4&gt;Part&amp;nbsp;1.2 &amp;ndash; Getting Started&lt;/h4&gt;
&lt;p&gt;The following is the complete code for a unikernel which queries a DNS server for a DNS domain and prints to console the IP address returned.&lt;/p&gt;
&lt;pre&gt;open Lwt
open V1_LWT

let domain = &amp;quot;google.com&amp;quot;
let server = Ipaddr.V4.make 8 8 8 8

module Client (C:CONSOLE) (S:STACKV4) = struct

  module U = S.UDPV4
  module DNS = Dns_resolver_mirage.Make(OS.Time)(S)

  let start c s =
    let t = DNS.create s in
    OS.Time.sleep 2.0 
    &amp;gt;&amp;gt;= fun () -&amp;gt;
    C.log_s c (&amp;quot;Resolving &amp;quot; ^ domain)
    &amp;gt;&amp;gt;= fun () -&amp;gt;
    DNS.gethostbyname t ~server domain
    &amp;gt;&amp;gt;= fun rl -&amp;gt;
    Lwt_list.iter_s
      (fun r -&amp;gt;
         C.log_s c (&amp;quot;Answer &amp;quot; ^ (Ipaddr.to_string r))
      ) rl

end
&lt;/pre&gt;
&lt;p&gt;This unikernel will query a DNS server at 8.8.8.8 (google public DNS resolver) for a domain google.com. Here we are using the simple function, DNS.gethostbyname, with the following type sig:&lt;/p&gt;
&lt;pre&gt;  val gethostbyname : t -&amp;gt;
    ?server:Ipaddr.V4.t -&amp;gt; ?dns_port:int -&amp;gt;
    ?q_class:Dns.Packet.q_class -&amp;gt;
    ?q_type:Dns.Packet.q_type -&amp;gt;
    string -&amp;gt; Ipaddr.t list Lwt.t
&lt;/pre&gt;
&lt;p&gt;This returns a list of IP&amp;rsquo;s, which we then iterative over with Lwt_list.iter_s and print to the console.&lt;/p&gt;
&lt;h4&gt;Part&amp;nbsp;1.3 &amp;ndash;&amp;nbsp;Boot time parameters&lt;/h4&gt;
&lt;p&gt;Hardcoding the server and domain is far from ideal, instead we will provide them at boot time with Bootvar, the interface for bootvar is below:&lt;/p&gt;
&lt;pre&gt;type t
(* read boot parameter line and store in assoc list - expected format is &amp;quot;key1=val1 key2=val2&amp;quot; *)
val create: unit -&amp;gt; t Lwt.t

(* get boot parameter *)
val get: t -&amp;gt; string -&amp;gt; string option

(* get boot parameter, throws Not Found exception *)
val get_exn: t -&amp;gt; string -&amp;gt; string
&lt;/pre&gt;
&lt;p&gt;We can now use this to provide domain and server at boot time instead of compile time&lt;/p&gt;
&lt;pre&gt;let start c s =
    Bootvar.create () &amp;gt;&amp;gt;= fun bootvar -&amp;gt;
    let domain = Bootvar.get_exn bootvar &amp;quot;domain&amp;quot; in
    let server = Ipaddr.V4.of_string_exn (Bootvar.get_exn bootvar &amp;quot;server&amp;quot;) in
    ...
&lt;/pre&gt;
&lt;h4&gt;Part&amp;nbsp;1.4 &amp;ndash; Using Resolve&lt;/h4&gt;
&lt;p&gt;Now, a real DNS resolver will need to make many more parameters (any DNS query) and return full DNS responses not just IP address. Thus we need to move on from DNS.hostbyname to using the less abstract resolve function, resolve:&lt;/p&gt;
&lt;pre&gt;  val resolve :
    (module Dns.Protocol.CLIENT) -&amp;gt;
    t -&amp;gt; Ipaddr.V4.t -&amp;gt; int -&amp;gt;
    Dns.Packet.q_class -&amp;gt;
    Dns.Packet.q_type -&amp;gt;
    Dns.Name.domain_name -&amp;gt;
    Dns.Packet.t Lwt.t 
&lt;/pre&gt;
&lt;p&gt;We can achieve same result of hostbyname as follows:&lt;/p&gt;
&lt;pre&gt;...
    DNS.resolve (module Dns.Protocol.Client) t server 53 Q_IN Q_A (string_to_domain_name domain)
    &amp;gt;&amp;gt;= fun r -&amp;gt;
    let ips =
    List.fold_left (fun a x -&amp;gt;
      match x.rdata with
      | A ip -&amp;gt; (Ipaddr.V4 ip) :: a
      | _ -&amp;gt; a ) [] r.answers in
...
&lt;/pre&gt;
&lt;p&gt;We are now explicit about parameters such as port, class and type. Note that we have opened the &lt;a href=&quot;https://github.com/mirage/ocaml-dns/blob/master/lib/name.mli&quot;&gt;Dns.Name&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirage/ocaml-dns/blob/master/lib/packet.mli&quot;&gt;Dns.Packet.t&lt;/a&gt; modules. The return value of resolve is a &lt;a href=&quot;https://github.com/mirage/ocaml-dns/blob/master/lib/packet.mli&quot;&gt;Dns.Packet.t&lt;/a&gt;, we fold over answers in the produce an IPaddr.V4 list as with hostbyname. We can also use the to_string function in Packet to print&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve taken a break to do some refactoring work on the ocaml-dns library. In the next post, Part 2, we will expand our code to a DNS stub resolver.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
</content><id>http://hh360.user.srcf.net/blog/?p=792</id><title type="text">Part 1: Running your own DNS Resolver with MirageOS</title><updated>2015-02-18T17:08:32+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://openmirage.org/blog/announcing-bitcoin-pinata" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;a href=&quot;http://ownme.ipredator.se/&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/btc-pinata/btc-pinata.png&quot; width=&quot;300px&quot; style=&quot;float:right; padding: 10px&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Last summer we announced the beta release of a clean-slate implementation of
TLS in pure OCaml, alongside a &lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;series of blog posts&lt;/a&gt; that described
the libraries and the thinking behind them.  It took two hackers six months
&amp;mdash; starting on &lt;a href=&quot;https://goo.gl/maps/GpcQs&quot;&gt;the beach&lt;/a&gt; &amp;mdash;  to get the stack to that point and
their &lt;a href=&quot;https://tls.openmirage.org&quot;&gt;demo server&lt;/a&gt; is still going strong. Since then, the team has
continued working and recently &lt;a href=&quot;http://media.ccc.de/browse/congress/2014/31c3_-_6443_-_en_-_saal_2_-_201412271245_-_trustworthy_secure_modular_operating_system_engineering_-_hannes_-_david_kaloper.html#video&quot;&gt;presented&lt;/a&gt; at the 31st Chaos
Communication Congress.&lt;/p&gt;
&lt;p&gt;The authors are putting their stack to the test again and this time they've
built a &lt;strong&gt;&lt;a href=&quot;http://ownme.ipredator.se&quot;&gt;Bitcoin Pi&amp;ntilde;ata&lt;/a&gt;&lt;/strong&gt;! Essentially, they've hidden a
private key to a bitcoin address within a Unikernel running on Xen. If you're
able to smash your way in, then you get to keep the spoils.&lt;/p&gt;
&lt;p&gt;There's more context around this in my &lt;a href=&quot;http://amirchaudhry.com/bitcoin-pinata/&quot;&gt;Pi&amp;ntilde;ata post&lt;/a&gt; and you can see
the details on the &lt;a href=&quot;http://ownme.ipredator.se&quot;&gt;site itself&lt;/a&gt;. Remember that the codebase is
&lt;a href=&quot;https://github.com/mirleft/&quot;&gt;all open&lt;/a&gt; (as well as &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues?q=label:%22security%20concern%22%20&quot;&gt;issues&lt;/a&gt;) so there's nothing to
reverse engineer. Have fun!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/announcing-bitcoin-pinata</id><title type="text">Smash the Bitcoin Pinata for fun and profit!</title><updated>2015-02-10T16:00:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2015/02/05/back-in-the-lab" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;p&gt;We'll be meeting in the Computer Lab next Tuesday (10th February 2015) for another evening of compiler hacking.  All welcome!  Please &lt;strong&gt;&lt;a href=&quot;http://doodle.com/zxmeyn2ih92mke85&quot;&gt;add yourself to the Doodle poll&lt;/a&gt;&lt;/strong&gt; if you're planning to come along, and sign up to the &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;mailing list&lt;/a&gt; to receive updates.&lt;/p&gt;

&lt;h3&gt;Talk: Generating code with polymorphic let (Oleg Kiselyov)&lt;/h3&gt;

&lt;p&gt;This time we'll be starting with a talk from &lt;a href=&quot;http://okmij.org/ftp&quot;&gt;Oleg Kiselyov&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;h4&gt;Generating code with polymorphic let&lt;/h4&gt;

&lt;p&gt;One of the simplest ways of implementing staging is source-to-source
translation from the quotation-unquotation code to code-generating
combinators. For example, MetaOCaml could be implemented as a
pre-processor to the ordinary OCaml. However simple, the approach is
surprising productive and extensible, as Lightweight Modular Staging
(LMS) in Scala has demonstrated. However, there is a fatal flaw:
handling quotations that contain polymorphic let. The translation to
code-generating combinators represents a future-stage let-binding with
the present-staging lambda-binding, which is monomorphic. Even if
polymorphic lambda-bindings are allowed, they require type
annotations, which precludes the source-to-source translation.&lt;/p&gt;

&lt;p&gt;We show the solution to the problem, using a different translation. It
works with the current OCaml. It also almost works in theory,
requiring a small extension to the relaxed value
restriction. Surprisingly, this extension seems to be exactly the one
needed to make the value restriction sound in a staged language with
reference cells and cross-stage-persistence.&lt;/p&gt;

&lt;p&gt;The old, seems completely settled question of value restriction is
thrown deep-open in staged languages. We gain a profound problem to
work on.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3&gt;(Approximate) schedule&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;6pm&lt;/strong&gt; Start, set up&lt;br/&gt;
&lt;strong&gt;6.30pm&lt;/strong&gt; Talk&lt;br/&gt;
&lt;strong&gt;7pm&lt;/strong&gt; Pizza&lt;br/&gt;
&lt;strong&gt;7.30pm-10pm&lt;/strong&gt; Compiler hacking  &lt;/p&gt;

&lt;h3&gt;Further details&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Where&lt;/strong&gt;:
  Room &lt;a href=&quot;http://www.cl.cam.ac.uk/research/dtg/openroommap/static/?s=FW11&amp;amp;amp%3Blabels=1&quot;&gt;FW11&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/directions/&quot;&gt;Computer Laboratory, Madingley Road&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;When&lt;/strong&gt;: 6pm, Tuesday 10th February&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Who&lt;/strong&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;What&lt;/strong&gt;: fixing bugs, implementing new features, learning about OCaml internals.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Wiki&lt;/strong&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience (see also some &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;things we've done on previous evenings&lt;/a&gt;), but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll be ordering pizza, so if you want to be counted for food you should aim to arrive by 6pm.&lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2015/02/05/back-in-the-lab</id><title type="text">Ninth OCaml compiler hacking evening (back in the lab, with a talk from Oleg)</title><updated>2015-02-05T12:00:00+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://www.skjegstad.com/blog/2015/01/19/mirageos-xen-virtualbox/" rel="alternate"/><contributor><uri>http://www.skjegstad.com/feeds/all.atom.xml</uri><name>Magnus Skjegstad</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://www.openmirage.org&quot;&gt;MirageOS&lt;/a&gt; is a library operating system. An application written for MirageOS is compiled to an operating system kernel that only contains the specific functionality required by the application - a &lt;a href=&quot;http://queue.acm.org/detail.cfm?id=2566628&quot;&gt;unikernel&lt;/a&gt;. The MirageOS unikernels can be compiled for different targets, including standalone VMs that run under Xen. The Xen unikernels can be deployed directly to common cloud services such as &lt;a href=&quot;http://openmirage.org/wiki/xen-boot&quot;&gt;Amazon EC2&lt;/a&gt; and &lt;a href=&quot;http://christopherbothwell.com/ocaml/mirage/linode/2014/12/08/hello-linode.html&quot;&gt;Linode&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I have done a lot of MirageOS development for Xen lately and it can be inconvenient to have to rely on an external server or service to be able to run and debug the unikernel. As an alternative I have set up a VM in Virtualbox with a Xen server. The MirageOS unikernels then run as VMs in Xen, which itself runs in a VM in Virtualbox. With the &amp;quot;Host-only networking&amp;quot; feature in Virtualbox the unikernels are accessible from the host operating system, which can be very useful for testing client/server applications. A unikernel that hosts a web page can for example be tested in a web browser in the host OS. I am hoping that this setup may be useful to others so I am documenting it in this blog post.&lt;/p&gt;


&lt;p&gt;My current VM is based on &lt;a href=&quot;http://releases.ubuntu.com/14.04/&quot;&gt;Ubuntu Server 14.04 LTS&lt;/a&gt; with Xen hypervisor 4.4 installed. The steps described in this post should be transferrable to other distributions if they support newer versions of the Xen hypervisor (4.4+). I have also included a list of alternative development environments for Mirage &lt;a href=&quot;http://www.skjegstad.com/feeds/all.atom.xml#alternatives&quot;&gt;near the end&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Install the Ubuntu VM&lt;/h3&gt;
&lt;p&gt;First, create a new Virtualbox VM with at least 1 GB RAM and 20 GB disk and start the Ubuntu Server installation. How to install Ubuntu in Virtualbox is covered in detail &lt;a href=&quot;https://help.ubuntu.com/community/Ubuntu_as_Guest_OS&quot;&gt;elsewhere&lt;/a&gt;, so I will only briefly describe the most relevant steps. &lt;/p&gt;
&lt;p&gt;To keep the VM lightweight, install as few features as possible. We will use SSH to login to the server so select &amp;quot;OpenSSH Server&amp;quot;. You may want to install a desktop environment later, but keep in mind that the graphics support will be limited under two layers of virtualization (Virtualbox + Xen). &lt;/p&gt;
&lt;p&gt;Give the Linux VM a hostname that is unique on your network as we will use this to access it with SSH later. I use &amp;quot;virtualxen&amp;quot;. &lt;/p&gt;
&lt;p&gt;Add a user you want to use for development, for example &amp;quot;mirage&amp;quot;. &lt;/p&gt;
&lt;p&gt;You may also want to reserve some of the disk space for Mirage if you plan to run applications that use block storage. During guided partitioning in the Ubuntu installer, if you choose to use the entire disk, the next question will allow you to specify a percentage of the disk that you want to use. If you plan to use Xen VMs that need direct disk access you should leave some of it for this purpose, for example 50%.&lt;/p&gt;
&lt;p&gt;After completing the installation, run apt-get update/upgrade and install the Virtualbox guest utilities, then reboot:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;sudo apt-get update
sudo apt-get upgrade
sudo apt-get install virtualbox-guest-utils 
sudo reboot
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Install the Xen Hypervisor&lt;/h3&gt;
&lt;p&gt;After installing the Ubuntu Server VM, your configuration will be as in the following figure. Ubuntu runs in Virtualbox which runs under the main operating system (OS X in my case). &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/mirage_dev/ubuntu_in_vm_overview.jpg&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;We are now going to install the Xen hypervisor, which will become a thin layer between Virtualbox and the Ubuntu Server installation. The Xen hypervisor will be able to run VMs within the Virtualbox VM and we can use the Ubuntu installation to control Xen. This is the new configuration with Xen:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/mirage_dev/xen_in_vm_overview.jpg&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://wiki.xen.org/wiki/Dom0&quot;&gt;Dom0&lt;/a&gt; is the original Ubuntu Server installation and the &lt;a href=&quot;http://wiki.xen.org/wiki/DomU&quot;&gt;DomU&lt;/a&gt;'s will be our future Mirage applications.&lt;/p&gt;
&lt;p&gt;To install Xen, log in to Ubuntu and install the Xen hypervisor with the following command. We will also need bridge-utils (for configuring networking), build-essential (development tools) and git (version control):&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;# install hypervisor and other tools&lt;/span&gt;
sudo apt-get install xen-hypervisor-4.4-amd64 bridge-utils build-essential git
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;After the installation is complete, reboot the Virtualbox VM to start into Xen and the Ubuntu Server installation (which now has become dom0). &lt;/p&gt;
&lt;p&gt;Xen can be controlled from dom0 with the &lt;code&gt;xl&lt;/code&gt; command. To verify that Ubuntu is running under Xen, log in and run &lt;code&gt;sudo xl list&lt;/code&gt; to show a list of running domains. The output should look similar to this:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo xl list
Name                                        ID   Mem VCPUs       State      Time&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Domain-0                                     0  1896     1      r-----         31.7
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The only Xen domain running at this point should be Dom0.&lt;/p&gt;
&lt;p&gt;We are now ready to set up networking. &lt;/p&gt;
&lt;h3&gt;Networking&lt;/h3&gt;
&lt;p&gt;Internet access should work out of the box for dom0, but to enable network access from the domU's we have set up a bridge device that they can connect to. We will call this device br0. Since this is a development environment we also want the unikernels to be accessible from the host operating system (so we can test them), but not from the local network. Virtualbox has a feature that allows this called a host-only network. &lt;/p&gt;
&lt;p&gt;To set up the host-only network in Virtualbox we have to shutdown the VM (&lt;code&gt;sudo shutdown -h now&lt;/code&gt;). Then go to Preferences in Virtualbox and select the &amp;quot;Network&amp;quot; tab and &amp;quot;Host-only Networks&amp;quot;. Create a new network. Make sure that the built-in DHCP server is disabled - I have not managed to get the built-in DHCP server to work with Mirage, so we will install a DHCP server in dom0 instead. If you already have an existing host-only network and you disabled the DHCP server in this step, remember to restart Virtualbox to make sure that the DHCP server is not running. &lt;/p&gt;
&lt;p&gt;After setting up the host-only network, exit preferences and open the settings for the VM. Under the &amp;quot;Network&amp;quot; tab, go to &amp;quot;Adapter 2&amp;quot;, enable it and choose to attach to &amp;quot;Host-only Adapter&amp;quot;. Select the name of the network that you just created in Preferences. Under advanced, select &amp;quot;Allow All&amp;quot; for &amp;quot;Promiscuous mode&amp;quot;. Exit and save.&lt;/p&gt;
&lt;p&gt;You can now start the VM with the new network configuration. After booting, edit /etc/network/interfaces to setup up the host-only adapter (eth1) and add it to the bridge (br0). The configuration below is based on the default IP range (192.168.56.x) for host-only networking in Virtualbox - if you have made changes to the default network configuration you may have to update the configuration here as well. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;# /etc/network/interfaces&lt;/span&gt;
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp

auto eth1
iface eth1 inet manual
    pre-up ifconfig &lt;span class=&quot;nv&quot;&gt;$IFACE&lt;/span&gt; up
    post-down ifconfig &lt;span class=&quot;nv&quot;&gt;$IFACE&lt;/span&gt; down

auto br0
iface br0 inet static
    bridge_ports eth1
    address 192.168.56.5
    broadcast 192.168.56.255
    netmask 255.255.255.0
    &lt;span class=&quot;c&quot;&gt;# disable ageing (turn bridge into switch)&lt;/span&gt;
    up /sbin/brctl setageing br0 0
    &lt;span class=&quot;c&quot;&gt;# disable stp&lt;/span&gt;
    up /sbin/brctl stp br0 off
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Next, we install dnsmasq to setup a DHCP server in dom0. This DHCP server will be responsible for assigning IP addresses to the unikernels that attach to br0.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo apt-get install dnsmasq
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To enable the DHCP server on br0, edit /etc/dnsmasq.conf and add the following lines:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;interface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;br0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dhcp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168.56.150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168.56.200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This configures the DHCP server to run on br0 and to dynamically assign IP addresses in the range 192.168.56.150 to 192.168.56.200 with a lease time of 1 hour. &lt;/p&gt;
&lt;p&gt;To be able to access dom0 via SSH from the host operating system (outside Virtualbox) we install avahi-daemon. Avahi-daemon enables mDNS, which will allow you to connect to &amp;quot;virtualxen.local&amp;quot; from the host operating system:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo apt-get install avahi-daemon
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Reboot dom0 to activate the changes (&lt;code&gt;sudo reboot&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;You should now be able to connect to dom0 with SSH from the host OS:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh mirage@virtualxen.local
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Dom0 can also be accessed from the host by using the IP address for br0 that we set above: 192.168.56.5.&lt;/p&gt;
&lt;h3&gt;Installing MirageOS in dom0&lt;/h3&gt;
&lt;p&gt;Before we can compile MirageOS unikernels we have to install OCaml.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;# install ocaml and friends&lt;/span&gt;
sudo apt-get install ocaml-compiler-libs ocaml-interp ocaml-base-nox ocaml-base ocaml ocaml-nox ocaml-native-compilers camlp4 camlp4-extra m4
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We also need the OCaml package manager, &lt;a href=&quot;https://opam.ocaml.org&quot;&gt;opam&lt;/a&gt;. A new version of opam was recently release and the version that comes with many Linux distros is outdated. To get the latest version (currently 1.2.x) I use &lt;a href=&quot;http://0install.net&quot;&gt;0install&lt;/a&gt; to install opam directly from the installation script provided on the ocaml.org web page. If you don't want to use 0install, a list of other options is available &lt;a href=&quot;http://opam.ocaml.org/doc/Install.html&quot;&gt;here&lt;/a&gt; (including PPA's). &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;# install 0install&lt;/span&gt;
sudo apt-get install zeroinstall-injector
&lt;span class=&quot;c&quot;&gt;# install opam&lt;/span&gt;
0install add opam http://tools.ocaml.org/opam.xml
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;0install installs applications in ~/bin. To add this directory to your path logout and back in. &lt;/p&gt;
&lt;p&gt;After installing opam, run &lt;code&gt;opam init&lt;/code&gt; and follow the instructions to complete the installation. Note that the opam commands should not be run with sudo, as it installs everything in ~/.opam in your home directory.&lt;/p&gt;
&lt;p&gt;If you want to run the development version of Mirage, you can add mirage-dev as an opam repository. Keep in mind that this repository contains the latest changes to Mirage, which may not always work. &lt;em&gt;The safest option is to skip this step&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;# optional - add mirage-dev to opam &lt;/span&gt;
opam remote add mirage-dev git://github.com/mirage/mirage-dev
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can now install Mirage:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;# install libs required to build many mirage apps&lt;/span&gt;
sudo apt-get install libssl-dev pkg-config
&lt;span class=&quot;c&quot;&gt;# install mirage&lt;/span&gt;
opam install mirage -v
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;After Mirage has been installed you should be able to run the Mirage configuration tool &lt;code&gt;mirage&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mirage --version
2.0.0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If you use emacs or vim I also recommend installing &lt;a href=&quot;https://github.com/the-lambda-church/merlin/wiki&quot;&gt;Merlin&lt;/a&gt;, which provides tab completion, type lookup and many other useful IDE features for OCaml. &lt;/p&gt;
&lt;h3&gt;Creating a Mirage VM&lt;/h3&gt;
&lt;p&gt;To verify that everything works, we will now download the &lt;a href=&quot;https://github.com/mirage/mirage-skeleton&quot;&gt;Mirage examples&lt;/a&gt; and compile the static website example. This example will start a web server hosting a &amp;quot;Hello world&amp;quot; page that we should be able to access from the host OS. The IP-address will be assigned with DHCP. &lt;/p&gt;
&lt;p&gt;First, clone the Mirage examples:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;# clone mirage-skeleton&lt;/span&gt;
git clone http://github.com/mirage/mirage-skeleton.git
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then go to the &lt;code&gt;mirage-skeleton/static-webpage&lt;/code&gt; folder and run &lt;code&gt;env DHCP=true mirage configure --xen&lt;/code&gt;. This command will download and install all the required dependencies and then create a Makefile. When the command completes, run &lt;code&gt;make&lt;/code&gt; to compile.&lt;/p&gt;
&lt;p&gt;If make completes successfully, there will be a file called &lt;code&gt;www.xl&lt;/code&gt; that contains the Xen DomU configuration file for the unikernel. By default the line that contains the network interface configuration is commented out. Remove the # in front of the line that begins with 'vif = ...' to enable network support. The &lt;code&gt;www.xl&lt;/code&gt; file should look similar to this:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kernel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skeleton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;static_website&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xen&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linux&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;memory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;on_crash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preserve&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;# You must define the network and block interfaces manually.&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;# The disk configuration is defined here:&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;# http:&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//xenbits.xen.org/docs/4.3-testing/misc/xl-disk-configuration.txt&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;# An example would look like:&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;# disk = [ '/dev/loop0,,xvda' ]&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;# The network configuration is defined here:&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;# http:&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//xenbits.xen.org/docs/4.3-testing/misc/xl-network-configuration.html&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;# An example would look like:&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vif&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mac&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ee&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bridge&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;br0&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The memory is set to 256 MB by default, but most of the example unikernels require much less than this. The static webserver example runs fine with 16 MB.&lt;/p&gt;
&lt;p&gt;You should now be able to start the unikernel using the command &lt;code&gt;sudo xl create www.xl -c&lt;/code&gt;: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;xl&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;xl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Parsing&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;config&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;xl&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Xen&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Minimal&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;start_info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0000000000332000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;nr_pages&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;shared_inf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x5457d000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;MA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
     &lt;span class=&quot;nx&quot;&gt;pt_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0000000000335000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;nr_pt_frames&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x5&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;mfn_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;00000000002&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;nx&quot;&gt;mod_start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
     &lt;span class=&quot;nx&quot;&gt;mod_len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
       &lt;span class=&quot;nx&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;cmd_line&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
       &lt;span class=&quot;nx&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0000000000291&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b40&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00000000002&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b1b40&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Mirage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;start_kernel&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;MM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Init&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;_text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0000000000000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
     &lt;span class=&quot;nx&quot;&gt;_etext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;000000000015&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cc0f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;nx&quot;&gt;_erodata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0000000000197000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
     &lt;span class=&quot;nx&quot;&gt;_edata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0000000000258220&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;stack&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0000000000291&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;nx&quot;&gt;_end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;00000000002&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b1b40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;start_pfn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;max_pfn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Mapping&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;memory&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;range&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x400000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10000000&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;setting&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0000000000000000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0000000000197000&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;readonly&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;skipped&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;MM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Initialise&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allocator&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bb000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bb000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;MM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Demand&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pfns&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10001000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0000002010001000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Initialising&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;timer&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;interface&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Initialising&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gnttab_table&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mapped&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0000000010001000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;xencaml&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;app_main_thread&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;OCAMLRUNPARAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CAMLRUNPARAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Unsupported&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lseek&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;called&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Mini&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;OS&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kernel&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Unsupported&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lseek&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;called&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Mini&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;OS&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kernel&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Unsupported&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lseek&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;called&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Mini&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;OS&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kernel&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;OCAMLRUNPARAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CAMLRUNPARAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;TMPDIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;TEMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Netif&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resume&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hook&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Netif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Netfront&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;domid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;MAC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ee&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ee&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Manager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Attempt&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/dev/urandom)!&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Manager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;configuring&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;DHCP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;discovery&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;Sending&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;DHCP&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;broadcast&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;552&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;DHCP&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ciaddr&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;yiaddr&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.178&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;siaddr&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.5&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;giaddr&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;chaddr&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c0ffeec0ffee00000000000000000000&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sname&lt;/span&gt;  &lt;span class=&quot;nx&quot;&gt;file&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;DHCP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;offer&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;received&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.178&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;DHCP&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Offer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;DNS&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;servers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Routers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Broadcast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Subnet&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Unknown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;59&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Unknown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;58&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Lease&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;43200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Server&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;identifer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Sending&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;DHCP&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;broadcast&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;552&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;DHCP&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ciaddr&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;yiaddr&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.178&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;siaddr&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.5&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;giaddr&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;chaddr&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c0ffeec0ffee00000000000000000000&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sname&lt;/span&gt;  &lt;span class=&quot;nx&quot;&gt;file&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;DHCP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;offer&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;received&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;IPv4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.178&lt;/span&gt;
                                        &lt;span class=&quot;nx&quot;&gt;Netmask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.0&lt;/span&gt;
                                                              &lt;span class=&quot;nx&quot;&gt;Gateways&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168.56.5&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;]&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;sg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gso_tcpv4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rx_copy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rx_flip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;smart_poll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;ARP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sending&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gratuitous&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.178&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;DHCP&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;offer&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;received&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;bound&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;56.178&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;nm&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gw&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168.56.5&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Manager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;configuration&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The console output shows the IP address that was assigned to the unikernel (&amp;quot;DHCP offer received and bound...&amp;quot;). In the example above the IP is 192.168.56.178. From the host operating system you should now be able to open this IP in a web browser to see the &amp;quot;Hello Mirage World!&amp;quot; message.&lt;/p&gt;
&lt;p&gt;If you login to dom0 in a new terminal &lt;code&gt;xl list&lt;/code&gt; will show the running domains, which now includes &amp;quot;www&amp;quot;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xl&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt;                                        &lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;Mem&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VCPUsStateTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Domain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;                                     &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;1355&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-----&lt;/span&gt;    &lt;span class=&quot;mf&quot;&gt;6691.4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;                                         &lt;span class=&quot;mi&quot;&gt;33&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To stop the unikernel, run &lt;code&gt;sudo xl destroy www&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;alternatives&quot;&gt;Some alternatives&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The environment described in this post is my current development environment and is based on a Xen server running in a Virtualbox VM with the latest versions of opam and Mirage. I use a host-only second network adapter to allow access to the Mirage applications from the host running Virtualbox. &lt;/p&gt;
&lt;p&gt;Mirage applications can also be compiled in &lt;a href=&quot;http://openmirage.org/wiki/hello-world&quot;&gt;Unix mode&lt;/a&gt;, which produces an executable that can be executed directly in a Unix-like operating system. Currently OS X seems to be particularly well supported. This mode may often be the easiest way to debug and develop a Mirage application, but not all of Mirage's features are available in this mode and some applications may require low level access to the system - for example to block storage or network interfaces - which may not be available in this mode. &lt;/p&gt;
&lt;p&gt;Another approach is to use a &lt;a href=&quot;http://cubieboard.org&quot;&gt;Cubieboard2&lt;/a&gt; with a prebuilt &lt;a href=&quot;http://github.com/mirage/xen-arm-builder&quot;&gt;Mirage/Xen image&lt;/a&gt; to set up a low cost, portable Xen server for development. If you want to have long running Mirage services in your local network or host your own web page this may be a good alternative. Note that compilation times can be slow on this platform compared to an x86 based VM.&lt;/p&gt;
&lt;p&gt;An automated VM setup is being developed based on Debian, Vagrant and Packer &lt;a href=&quot;http://github.com/mirage/mirage-vagrant-vms&quot;&gt;here&lt;/a&gt;. This can be useful if you don't want to manually perform the setup steps outlined in this post. Currently this setup uses an older version of Debian which comes with Xen 4.1, but it should be possible to upgrade to Debian Jessie or later.&lt;/p&gt;</content><id>http://www.skjegstad.com/blog/2015/01/19/mirageos-xen-virtualbox/</id><title type="text">Local MirageOS development with Xen and Virtualbox</title><updated>2015-01-19T00:00:00+00:00</updated><author><email></email><name>Magnus Skjegstad</name></author></entry><entry><link href="http://amirchaudhry.com/towards-governance-framework-for-ocamlorg" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;p&gt;The projects around the OCaml.org domain name are becoming more established
and it&amp;rsquo;s time to think about how they&amp;rsquo;re organised. 2014 saw a &lt;em&gt;lot&lt;/em&gt; of
activity, which built on the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#OnlineatOCamlorg&quot;&gt;successes from 2013&lt;/a&gt;.
Some of the main things that stand out to me are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;More &lt;a href=&quot;http://ocaml.org/contributors.html&quot;&gt;volunteers&lt;/a&gt; contributing to the public website with
translations, bug fixes and content updates, as well as many new visitors &amp;mdash;
for example, the new page on &lt;a href=&quot;http://ocaml.org/learn/teaching-ocaml.html&quot;&gt;teaching OCaml&lt;/a&gt; received over 5k
visits alone. The increasing contributions are a result of the earlier work on
&lt;a href=&quot;http://amirchaudhry.com/announcing-new-ocamlorg/&quot;&gt;re-engineering the site&lt;/a&gt; and there are many ways to get involved
so please do &lt;a href=&quot;https://github.com/ocaml/ocaml.org/labels/contribute!&quot;&gt;contribute&lt;/a&gt;!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://opam.ocaml.org/&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/web/opampkg-2015-01-08.png&quot; style=&quot;float: right; margin-left: 10px&quot;/&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The relentless improvements and growth of OPAM, both in terms of the
repository &amp;mdash; with over 1000 additional packages and several
&lt;a href=&quot;http://lists.ocaml.org/pipermail/opam-devel/2014-October/000781.html&quot;&gt;new repo maintainers&lt;/a&gt; &amp;mdash; and also improved workflows (e.g the new
&lt;a href=&quot;http://opam.ocaml.org/blog/opam-1-2-pin/&quot;&gt;pin functionality&lt;/a&gt;). 
The OPAM site and package list also moved to the ocaml.org domain, becoming
the substrate for the OCaml Platform efforts. This began with the work towards
&lt;a href=&quot;http://opam.ocaml.org/blog/opam-1-2-0-beta4/&quot;&gt;OPAM 1.2&lt;/a&gt; and there is much more to come (including closer
integration in terms of styling). Join the &lt;a href=&quot;http://lists.ocaml.org/listinfo/platform&quot;&gt;Platform list&lt;/a&gt; to
keep up to date.&lt;/li&gt;
&lt;/ul&gt;

&lt;ul&gt;
  &lt;li&gt;Much more activity on the &lt;a href=&quot;http://lists.ocaml.org&quot;&gt;mailing lists&lt;/a&gt; in general and user groups
requesting to have lists made (e.g the &lt;a href=&quot;http://lists.ocaml.org/listinfo/teaching&quot;&gt;teaching list&lt;/a&gt;). If anyone
has a need for a new list, just ask on the
&lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure list&lt;/a&gt;!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;There is other work besides those I&amp;rsquo;ve mentioned and I think by any measure,
all the projects have been quite successful. As the community continues to
develop, it&amp;rsquo;s important to clarify how things currently work to improve the
level of transparency and make it easier for newcomers to get involved.&lt;/p&gt;

&lt;h3&gt;Factors for a governance framework&lt;/h3&gt;

&lt;p&gt;For the last couple of months, I&amp;rsquo;ve been looking over how larger projects
manage themselves and the governance documents that are available. My aim has
been to put such a document together for the OCaml.org domain without
introducing burdensome processes.  There are number of things that stood out
to me during this process, which have guided the approach I&amp;rsquo;m taking.&lt;/p&gt;

&lt;p&gt;My considerations for an OCaml.org governance document:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;A governance document is not &lt;em&gt;necessary&lt;/em&gt; for success but it&amp;rsquo;s valuable to
demonstrate a commitment to a &lt;strong&gt;stable decision-making process&lt;/strong&gt;.  There are
many projects that progress perfectly well without any documented processes
and indeed the work around OCaml.org so far is a good example of this (as well
as OCaml itself).  However, for projects to achieve a scale greater than the
initial teams, it&amp;rsquo;s a significant benefit to encode in writing how things work
(NB: please note that I didn&amp;rsquo;t define the &lt;em&gt;type&lt;/em&gt; of decision-making process -
merely that it&amp;rsquo;s a stable one).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;It must &lt;strong&gt;clarify its scope&lt;/strong&gt; so that there is no confusion about what the
document covers. In the case of OCaml.org, it needs to be clear that the
governance covers the domain itself, rather than referring to the website. &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;It should &lt;strong&gt;document the reality&lt;/strong&gt;, rather than represent an aspirational
goal or what people &lt;em&gt;believe&lt;/em&gt; a governance structure should look like.  It&amp;rsquo;s
very tempting to think of an idealised structure without recognising that
behaviours and norms have &lt;em&gt;already&lt;/em&gt; been established. Sometimes this will be
vague and poorly defined but that might simply indicate areas that the
community hasn&amp;rsquo;t encountered yet (e.g it&amp;rsquo;s uncommon for any new project to
seriously think about dispute resolution processes until they have to).  In
this sense, the initial version of a governance document should simply be a
written description of how things currently stand, rather than a means to
adjust that behaviour.  &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;It should be &lt;strong&gt;simple and self-contained&lt;/strong&gt;, so that anyone can understand
the intent quickly without recourse to other documents.  It may be tempting to
consider every edge-case or try to resolve every likely ambiguity but this
just leads to large, legal documents.  This approach may well be necessary
once projects have reached a certain scale but to implement it sooner would be
a case of premature optimisation &amp;mdash; not to mention that very few people would 
read and remember such a document.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;It&amp;rsquo;s a &lt;strong&gt;living document&lt;/strong&gt;. If the community decides that it would prefer a
new arrangement, then the document conveniently provides a stable starting
point from which to iterate. Indeed, it &lt;em&gt;should&lt;/em&gt; adapt along with the project
that it governs. &lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;With the above points in mind, I&amp;rsquo;ve been putting together a draft governance
framework to cover how the OCaml.org domain name is managed.  It&amp;rsquo;s been a
quiet work-in-progress for some time and I&amp;rsquo;ll be getting in touch with
maintainers of specific projects soon.  Once I&amp;rsquo;ve had a round of reviews, I&amp;rsquo;ll
be sharing it more widely and posting it here!&lt;/p&gt;


</content><id>http://amirchaudhry.com/towards-governance-framework-for-ocamlorg</id><title type="text">Towards a governance framework for OCaml.org</title><updated>2015-01-08T18:15:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://openmirage.org/blog/2014-in-review" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;small&gt;
 This work funded in part by the EU FP7 User-Centric Networking project, Grant
 No. 611001.
&lt;/small&gt;&lt;/p&gt;
&lt;p&gt;An action-packed year has flown by for Mirage, and it's time for a little recap of what's been happening and the plans for the new year.
We announced &lt;a href=&quot;http://openmirage.org/blog/announcing-mirage10&quot;&gt;Mirage 1.0&lt;/a&gt; just over a year ago, and 2014 also saw a major &lt;a href=&quot;http://openmirage.org/blog/announcing-mirage-20-release&quot;&gt;2.0 summer release&lt;/a&gt; and the growth of a developer community that have been building support for IPv6, Transport Layer Security, on-demand spawning, profiling and much more.  There have been 205 individual library &lt;a href=&quot;http://openmirage.org/releases&quot;&gt;releases&lt;/a&gt;, 25 &lt;a href=&quot;http://decks.openmirage.org&quot;&gt;presentations&lt;/a&gt;, and lots of &lt;a href=&quot;http://openmirage.org/links&quot;&gt;online chatter&lt;/a&gt; through the year, so here follows a summary of our major activities recently.&lt;/p&gt;
&lt;h3&gt;Clean-Slate Transport Layer Security&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://media.ccc.de/browse/congress/2014/31c3_-_6443_-_en_-_saal_2_-_201412271245_-_trustworthy_secure_modular_operating_system_engineering_-_hannes_-_david_kaloper.html#video&quot;&gt;&lt;img src=&quot;http://openmirage.org/graphics/tls-31c3.png&quot; width=&quot;300px&quot; style=&quot;float:right; padding: 5px&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;David Kaloper and Hannes Mehnert started 2014 with getting interested in writing a &lt;a href=&quot;https://ocaml.org/meetings/ocaml/2014/ocaml2014_4.pdf&quot;&gt;safer and cleaner TLS stack&lt;/a&gt; in OCaml, and ended the year with a complete demonstration and talk last week in &lt;a href=&quot;http://media.ccc.de/browse/congress/2014/31c3_-_6443_-_en_-_saal_2_-_201412271245_-_trustworthy_secure_modular_operating_system_engineering_-_hannes_-_david_kaloper.html#video&quot;&gt;31C3&lt;/a&gt;, the premier hacker conference!  Their blog posts over the summer remain an excellent introduction to the new stack:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;OCaml-TLS: Introducing transport layer security (TLS) in pure OCaml&lt;/a&gt;&amp;quot;&lt;/em&gt; presents the motivation and architecture behind our clean-slate implementation of the protocol.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;OCaml-TLS: building the nocrypto library core&lt;/a&gt;&amp;quot;&lt;/em&gt; talks about the cryptographic primitives that form the heart of TLS confidentiality guarantees, and how they expose safe interfaces to the rest of the stack.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;OCaml-TLS: adventures in X.509 certificate parsing and validation&lt;/a&gt;&amp;quot;&lt;/em&gt; explains how authentication and chain-of-trust verification is implemented in our stack.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-asn1&quot;&gt;OCaml-TLS: ASN.1 and notation embedding&lt;/a&gt;&amp;quot;&lt;/em&gt; introduces the libraries needed for handling ASN.1 grammars, the wire representation of messages in TLS.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation&quot;&gt;OCaml-TLS: the protocol implementation and mitigations to known attacks&lt;/a&gt;&amp;quot;&lt;/em&gt; concludes with the implementation of the core TLS protocol logic itself.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;By summer, the stack was complete enough to connect to the majority of TLS 1.0+ sites on the Internet, and work progressed to integration with the remainder of the Mirage libraries.  By November, the &lt;a href=&quot;https://github.com/mirage/ocaml-conduit&quot;&gt;Conduit&lt;/a&gt; network library had Unix support for both the &lt;a href=&quot;https://github.com/savonet/ocaml-ssl&quot;&gt;OpenSSL/Lwt&lt;/a&gt; bindings and the pure OCaml stack, with the ability to dynamically select them.  You can now deploy and test the pure OCaml TLS stack on a webserver simply by:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;opam install lwt tls cohttp
export CONDUIT_TLS=native
cohttp-server-lwt -c &amp;lt;certfile&amp;gt; -p &amp;lt;port&amp;gt; &amp;lt;directory&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This will spin up an HTTPS server that serves the contents of &lt;code&gt;&amp;lt;directory&amp;gt;&lt;/code&gt; to you over TLS.
At the same time, we were also working on integrating the TLS stack into the Xen unikernel backend, so we could run completely standalone.  This required some surgery:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;The &lt;a href=&quot;https://github.com/mirleft/ocaml-nocrypto&quot;&gt;nocrypto&lt;/a&gt; crypto core is written in C, so we had to improve support for linking in external C libraries.  Since the Xen unikernel is a single address-space custom kernel, we also need to be careful to compile it with the correct compilation flags or else risk &lt;a href=&quot;https://github.com/mirage/mirage-tcpip/issues/80&quot;&gt;subtle bugs&lt;/a&gt;. Thomas Leonard completely rearranged the Mirage compilation pipeline to support &lt;a href=&quot;https://github.com/mirage/mirage/pull/332&quot;&gt;separation compilation of C stubs&lt;/a&gt;, and we had the opportunity to remove lots of duplicated code within &lt;a href=&quot;https://github.com/mirage/mirage-platform&quot;&gt;mirage-platform&lt;/a&gt; as a result of this work.&lt;/li&gt;&lt;li&gt;Meanwhile, the problem of gathering entropy in a virtual machine reared its head.  We created a &lt;a href=&quot;https://github.com/mirage/mirage-entropy&quot;&gt;mirage-entropy&lt;/a&gt; device driver, and an &lt;a href=&quot;http://lists.xenproject.org/archives/html/mirageos-devel/2014-11/msg00146.html&quot;&gt;active discussion&lt;/a&gt; ensued about how best to gather reliable randomness from Xen.  &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; built the best solution -- the &lt;a href=&quot;https://github.com/mirage/xentropyd&quot;&gt;xenentropyd&lt;/a&gt; that proxies entropy from dom0 to a unikernel VM.&lt;/li&gt;&lt;li&gt;David Kaloper also ported the &lt;code&gt;nocrypto&lt;/code&gt; library to use the &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes&quot;&gt;OCaml-Ctypes&lt;/a&gt; library, which increases the safety of the C bindings significantly.  This is described in more detail in the &amp;quot;&lt;a href=&quot;http://openmirage.org/blog/modular-foreign-function-bindings&quot;&gt;Modular foreign function bindings&lt;/a&gt;&amp;quot; blog post from the summer.  This forms the basis for allowing Xen unikernels to communicate with C code, and integration with the Mirage toolchain will continue to improve next year.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;You can see &lt;a href=&quot;http://media.ccc.de/browse/congress/2014/31c3_-_6443_-_en_-_saal_2_-_201412271245_-_trustworthy_secure_modular_operating_system_engineering_-_hannes_-_david_kaloper.html#video&quot;&gt;Hannes and David present OCaml-TLS&lt;/a&gt; at CCC online.  It's been a real pleasure watching their work develop in the last 12 months with such precision and attention to detail!&lt;/p&gt;
&lt;h3&gt;HTTP and JavaScript&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://rgrinberg.com/&quot;&gt;Rudi Grinberg&lt;/a&gt; got sufficiently irked with the poor state of documentation for the &lt;a href=&quot;https://github.com/mirage/ocaml-cohttp&quot;&gt;CoHTTP&lt;/a&gt; library that he began gently contributing fixes towards the end of 2013, and rapidly became one of the maintainers.  He also began improving the ecosystem around the web stack by building a HTTP routing layer, described in his blog posts:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;em&gt;&lt;a href=&quot;http://rgrinberg.com/blog/2014/12/13/primitive-type-safe-routing/&quot;&gt;Type Safe Routing - Baby Steps&lt;/a&gt;&lt;/em&gt;: type-safe routing of URLs to avoid dangling links&lt;/li&gt;&lt;li&gt;&lt;em&gt;&lt;a href=&quot;http://rgrinberg.com/blog/2014/04/04/introducing-opium/&quot;&gt;Introducing Opium&lt;/a&gt;&lt;/em&gt;: middleware for REST services&lt;/li&gt;&lt;li&gt;&lt;em&gt;&lt;a href=&quot;http://rgrinberg.com/blog/2014/04/11/middleware-intro/&quot;&gt;Middleware in Opium&lt;/a&gt;&lt;/em&gt;: a walkthrough the Opium HTTP middleware model&lt;/li&gt;&lt;li&gt;&lt;em&gt;&lt;a href=&quot;http://rgrinberg.com/blog/2014/05/23/humane-re-intro/&quot;&gt;Introducing Humane-Re&lt;/a&gt;&lt;/em&gt;: more friendly regular expression interfaces&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;Meanwhile, &lt;a href=&quot;http://www.ujamjar.com/&quot;&gt;Andy Ray&lt;/a&gt; started developing &lt;a href=&quot;http://www.ujamjar.com/hardcaml/&quot;&gt;HardCaml&lt;/a&gt; (a register transfer level hardware design system) in OCaml, and built the &lt;a href=&quot;https://andrewray.github.io/iocamljs/&quot;&gt;iocamljs&lt;/a&gt; interactive browser notebook.  This uses &lt;a href=&quot;http://ocsigen.org/js_of_ocaml&quot;&gt;js_of_ocaml&lt;/a&gt; to port the &lt;em&gt;entire&lt;/em&gt; OCaml compilation toolstack to JavaScript, including &lt;code&gt;ocamlfind&lt;/code&gt;, Lwt threading and dynamic loading support.  The results are browsable &lt;a href=&quot;https://andrewray.github.io/iocamljs/&quot;&gt;online&lt;/a&gt;, and it is now easy to generate a JavaScript-driven interactive page for many Mirage libraries.&lt;/p&gt;
&lt;p&gt;An interesting side effect of Andy's patches were the addition of a &lt;a href=&quot;https://github.com/mirage/ocaml-cohttp/pull/172&quot;&gt;JavaScript port&lt;/a&gt; to the CoHTTP library.  For those not familiar with the innards, CoHTTP uses the &lt;a href=&quot;https://realworldocaml.org/v1/en/html/functors.html&quot;&gt;OCaml module system&lt;/a&gt; to build a very portable HTTP implementation that can make mapped to different I/O models (Lwt or Async cooperative threading or POSIX blocking I/O), and to different operating systems (e.g. Unix or Mirage).  The JavaScript support mapped the high-level modules in CoHTTP to the XMLHTTPRequest native to JavaScript, allowing the same OCaml HTTP client code to run efficiently on Unix, Windows and now an IOCamlJS browser instance.&lt;/p&gt;
&lt;p&gt;Mirage uses a number of libraries developed by the &lt;a href=&quot;http://ocsigen.org&quot;&gt;Ocsigen&lt;/a&gt; team at &lt;a href=&quot;http://irill.org&quot;&gt;IRILL&lt;/a&gt; in Paris, and so I was thrilled to &lt;a href=&quot;https://www.irill.org/videos/oups-december-2014/MirageOS&quot;&gt;deliver a talk&lt;/a&gt; there in December.  Romain Calascibetta started integrating Ocsigen and Mirage over the summer, and the inevitable plotting over beer in Paris lead &lt;a href=&quot;https://github.com/Drup&quot;&gt;Gabriel Radanne&lt;/a&gt; to kick off an effort to integrate the complete Ocsigen web stack into Mirage. Head to &lt;a href=&quot;https://github.com/ocsigen/ocsigenserver/issues/54&quot;&gt;ocsigen/ocsigenserver#54&lt;/a&gt; if you're interested in seeing this happen in 2015!
I also expect the JavaScript and Mirage integration to continue to improve in 2015, thanks to large industrial users such as &lt;a href=&quot;https://github.com/facebook&quot;&gt;Facebook&lt;/a&gt; adopting &lt;code&gt;js_of_ocaml&lt;/code&gt; in their open-source tools such as &lt;a href=&quot;https://github.com/facebook/hack&quot;&gt;Hack&lt;/a&gt; and &lt;a href=&quot;https://github.com/facebook/flow&quot;&gt;Flow&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;IPv6&lt;/h3&gt;

&lt;p&gt;We've wanted IPv6 support in Mirage since its inception, and several people contributed to making this possible.  At the start of the year, &lt;a href=&quot;https://github.com/hhugo&quot;&gt;Hugo Heuzard&lt;/a&gt; and &lt;a href=&quot;https://github.com/dsheets&quot;&gt;David Sheets&lt;/a&gt; got &lt;a href=&quot;https://github.com/mirage/ocaml-ipaddr/pull/9&quot;&gt;IPv6 parsing support&lt;/a&gt; into the &lt;code&gt;ipaddr&lt;/code&gt; library (with me watching bemusedly at how insanely complex parsing is versus IPv4).&lt;/p&gt;
&lt;p&gt;Meanwhile, &lt;a href=&quot;https://www.dpmms.cam.ac.uk/~no263/&quot;&gt;Nicolas Ojeda Bar&lt;/a&gt; had been building OCaml networking libraries independently for some time, such as a &lt;a href=&quot;https://github.com/nojb/ocaml-imap&quot;&gt;IMAP client&lt;/a&gt;, &lt;a href=&quot;https://github.com/nojb/ocaml-maildir&quot;&gt;Maildir&lt;/a&gt; handler, and a &lt;a href=&quot;https://github.com/nojb/ocaml-bt&quot;&gt;Bittorrent&lt;/a&gt; client.  He became interested in the networking layer of Mirage, and performed a &lt;a href=&quot;https://github.com/mirage/mirage-tcpip/pull/70&quot;&gt;comprehensive cleanup&lt;/a&gt;  that resulted in a more modular stack that now supports both IPv4 and IPv6!&lt;/p&gt;
&lt;p&gt;The addition of IPv6 support also forced us to consider how to simplify the configuration frontend to Mirage unikernels that was &lt;a href=&quot;http://openmirage.org/blog/mirage-1.1-released&quot;&gt;originally written&lt;/a&gt; by Thomas Gazagnaire and &lt;a href=&quot;http://openmirage.org/blog/intro-tcpip&quot;&gt;described here&lt;/a&gt; by Mindy Preston.
Nicolas has &lt;a href=&quot;http://lists.xenproject.org/archives/html/mirageos-devel/2014-12/msg00001.html&quot;&gt;proposed&lt;/a&gt; a declarative extension to the configuration that allows applications to extend the &lt;code&gt;mirage&lt;/code&gt; command-line more easily, thus unifying the &amp;quot;built-in&amp;quot; Mirage compilation modes (such as choosing between Xen or Unix) and protocol-specific choices (such as configuring IPv4 and IPv6).&lt;/p&gt;
&lt;p&gt;The new approach opens up the possibility of writing more user-friendly configuration frontends that can render them as a text- or web-based selectors, which is really important as more real-world uses of Mirage are being created.  It should be possible in 2015 to solve common problems such as web or DNS serving without having to write a single line of OCaml code.&lt;/p&gt;
&lt;h3&gt;Profiling&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://roscidus.com/blog/blog/2014/10/27/visualising-an-asynchronous-monad&quot;&gt;&lt;img src=&quot;http://roscidus.com/blog/images/mirage-profiling/block-reads-3-32.png&quot; width=&quot;300px&quot; style=&quot;float:right; padding: 5px&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;One of the benefits touted by our CACM article on &lt;a href=&quot;http://queue.acm.org/detail.cfm?id=2566628&quot;&gt;unikernels&lt;/a&gt; at the start of the year was the improved tooling from the static linking of an entire application stack with an operating system layer.
&lt;a href=&quot;http://roscidus.com&quot;&gt;Thomas Leonard&lt;/a&gt; joined the project this year after publishing a widely read &lt;a href=&quot;http://roscidus.com/blog/blog/2014/06/06/python-to-ocaml-retrospective/&quot;&gt;blog series&lt;/a&gt; on his experiences from switching from Python to OCaml.
Aside from leading (and upstreaming to Xen) the port of &lt;a href=&quot;http://openmirage.org/blog/introducing-xen-minios-arm&quot;&gt;Mirage to ARM&lt;/a&gt;, he also explored how to add profiling throughout the unikernel stack.&lt;/p&gt;
&lt;p&gt;The support is now comprehensive and integrated into the Mirage trees: the &lt;a href=&quot;http://ocsigen.org/lwt&quot;&gt;Lwt&lt;/a&gt; cooperative threading engine has hooks for thread switching, most of the core libraries register named events, traces are dumped into shared memory buffers in the &lt;a href=&quot;http://wiki.eclipse.org/Linux_Tools_Project/TMF/CTF_guide&quot;&gt;CTF&lt;/a&gt; file format used by the Linux trace toolkit, and there are JavaScript and GTK+ &lt;a href=&quot;https://github.com/talex5/mirage-trace-viewer&quot;&gt;GUI frontends&lt;/a&gt; that can parse them.&lt;/p&gt;
&lt;p&gt;You can find the latest instructions on &lt;a href=&quot;http://openmirage.org/wiki/profiling&quot;&gt;Tracing and Profiling&lt;/a&gt; on this website, and here are Thomas' original blog posts on the subject:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://roscidus.com/blog/blog/2014/08/15/optimising-the-unikernel/&quot;&gt;Optimising the Unikernel&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://roscidus.com/blog/blog/2014/10/27/visualising-an-asynchronous-monad/&quot;&gt;Visualising an Asynchronous Monad&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;

&lt;h3&gt;Irmin&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; spent most of the year furiously hacking away at the storage layer in Irmin, which is a clean-slate storage stack that uses a Git-like branching model as the basis for distributed unikernel storage.  &lt;a href=&quot;https://github.com/mirage/irmin/releases/tag/0.9.0&quot;&gt;Irmin 0.9.0&lt;/a&gt; was released in December with efficiency improvements and a sufficiently portable set of dependencies to make JavaScript compilation practical.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-irmin&quot;&gt;Introducing Irmin: Git-like distributed, branchable storage&lt;/a&gt;&amp;quot;&lt;/em&gt;  describes the concepts and high-level architecture of the system.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-irmin-in-xenstore&quot;&gt;Using Irmin to add fault-tolerance to the Xenstore database&lt;/a&gt;&amp;quot;&lt;/em&gt; shows how Irmin is used in a real-world application: the security-critical Xen toolstack that manages hosts full of virtual machines (&lt;a href=&quot;https://www.youtube.com/watch?v=DSzvFwIVm5s&quot;&gt;video&lt;/a&gt;).&lt;/li&gt;&lt;li&gt;There have been several other early adopters of Irmin for their own projects (independent of Mirage).  One of the most exciting is by &lt;a href=&quot;https://github.com/gregatcam&quot;&gt;Gregory Tsipenyuk&lt;/a&gt;, who has been developing a version-controlled &lt;a href=&quot;https://github.com/gregtatcam/imaplet-lwt&quot;&gt;Irmin-based IMAP server&lt;/a&gt; that offers a very different model for e-mail management.  Expect to see more of this in the new year!&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;We also had the pleasure of Benjamin Farinier and Matthieu Journault join us as summer interns.  Both of them did a great job improving the internals of Irmin, and Benjamin's work on &lt;em&gt;&lt;a href=&quot;http://gazagnaire.org/pub/FGM15.pdf&quot;&gt;Mergeable Persistent Datastructures&lt;/a&gt;&lt;/em&gt; will be presented at JFLA 2015.&lt;/p&gt;
&lt;h3&gt;Jitsu&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://decks.openmirage.org/irill14-seminar#/&quot;&gt;&lt;img src=&quot;http://openmirage.org/graphics/decks-on-arm.png&quot; width=&quot;250px&quot; style=&quot;float:right; padding: 5px&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.skjegstad.com/&quot;&gt;Magnus Skjegstad&lt;/a&gt; returned to Cambridge and got interested in the rapid dynamic provisioning of unikernels.  He built &lt;a href=&quot;https://github.com/MagnusS/jitsu&quot;&gt;Jitsu&lt;/a&gt;, a DNS server that spawns unikernels in response to DNS requests and boots them in real-time with no perceptible lag to the end user.  The longer term goal behind this is to enable a community cloud of ARM-based &lt;a href=&quot;http://cubieboard.org/&quot;&gt;Cubieboard2&lt;/a&gt; boards that serve user content without requiring centralised data centers, but with the ease-of-use of existing systems.&lt;/p&gt;
&lt;p&gt;Building Jitsu and hitting our goal of extremely low latency management of unikernels required a huge amount of effort from across the Mirage team.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; and &lt;a href=&quot;http://jon.recoil.org&quot;&gt;Jon Ludlam&lt;/a&gt; (two of the Xen maintainers at Citrix) improved the Xen &lt;code&gt;xl&lt;/code&gt; toolstack to deserialise the VM startup chain to shave 100s of milliseconds off every operation.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://roscidus.com/blog/&quot;&gt;Thomas Leonard&lt;/a&gt; drove the removal of our forked &lt;a href=&quot;http://wiki.xen.org/wiki/Mini-OS&quot;&gt;Xen MiniOS&lt;/a&gt; with a library version that is being fed upstream (including ARM support).  This made the delta between Xen and Mirage much smaller and therefore made reducing end-to-end latency tractable.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/dsheets&quot;&gt;David Sheets&lt;/a&gt; built a test harness to boot unikernel services and measure their latency under very different conditions, including contrasting boot timer versus &lt;a href=&quot;http://docker.com&quot;&gt;Docker&lt;/a&gt; containers.  In many instances, we ended up booting faster than containers due to not touching disk at all with a standalone unikernel.  &lt;a href=&quot;http://www.cl.cam.ac.uk/~iml1/&quot;&gt;Ian Leslie&lt;/a&gt; built us some custom power measurement hardware that came in handy to figure out how to drive down the energy cost of unikernels running on ARM boards.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt;, Balraj Singh, Magnus Skjegstad built the &lt;code&gt;synjitsu&lt;/code&gt; proxy server that intercepts and proxies TCP connections to mask the couple of 100 milliseconds during unikernel boot time, ensuring that no TCP connections ever require retransmission from the client.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; and I built out the &lt;a href=&quot;https://github.com/mirage/&quot;&gt;vchan&lt;/a&gt; shared memory transport that supports low-latency communiction between unikernels and/or Unix processes.  This is rapidly heading into a Plan9-like model, with the additional twist of using Git instead of a flat filesystem hierarchy as its coordination basis.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://amirchaudhry.com/&quot;&gt;Amir Chaudhry&lt;/a&gt; and &lt;a href=&quot;http://mort.io&quot;&gt;Richard Mortier&lt;/a&gt; documented the Git-based (and eventually Irmin-based) workflow behind managing the unikernels themselves, so that they can easily be deployed to distance ARM devices simply by running &lt;code&gt;git pull&lt;/code&gt;.  You can read more about this in his &lt;a href=&quot;http://amirchaudhry.com/from-jekyll-to-unikernel-in-fifty-lines/&quot;&gt;From Jekyll to Unikernels&lt;/a&gt; post.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;All of this work was hastily crammed into a &lt;a href=&quot;https://www.usenix.org/conference/nsdi15/call-for-papers&quot;&gt;USENIX NSDI 2015&lt;/a&gt; paper that got submitted at 4am on a bright autumn morning.  We'll put the preprint available when it's ready in January, along with a blog post describing how you can deploy this infrastructure for yourself.&lt;/p&gt;
&lt;h3&gt;Community&lt;/h3&gt;

&lt;p&gt;All of the above work was only possible due to the vastly improved tooling and infrastructure around the project.  Our community manager Amir Chaudhry led the &lt;a href=&quot;http://openmirage.org/docs/&quot;&gt;minuted&lt;/a&gt; calls every two weeks that tied the efforts together, and we established some &lt;a href=&quot;https://github.com/mirage/mirage-www/wiki/Pioneer-Projects&quot;&gt;pioneer projects&lt;/a&gt; for newcomers to tackle.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openmirage.org/graphics/opam-packages-20141231.png&quot; width=&quot;250px&quot; style=&quot;float:right; padding: 5px&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt; package manager continued to be the frontend for all Mirage tools, with releases of libraries happening &lt;a href=&quot;http://openmirage.org/releases&quot;&gt;regularly&lt;/a&gt;.  Because of the modular nature of Mirage code, most of the libraries can also be used as normal Unix-based libraries, meaning that we aren't just limited to Mirage users but can benefit from the entire OCaml community.  The graph to the right shows the growth of the total package database since the project started to give you a sense of how much activity there is.&lt;/p&gt;
&lt;p&gt;The major &lt;a href=&quot;http://opam.ocaml.org/blog/opam-1-2-0-release/&quot;&gt;OPAM 1.2&lt;/a&gt; also added a number of new features that made Mirage code easier to develop, including a &lt;a href=&quot;http://opam.ocaml.org/blog/opam-1-2-pin/&quot;&gt;Git-based library pinning workflow&lt;/a&gt; that works superbly with GitHub, and &lt;a href=&quot;http://opam.ocaml.org/blog/opam-1-2-travisci/&quot;&gt;easier Travis integration&lt;/a&gt; for continuous integration.  &lt;a href=&quot;https://github.com/niksu&quot;&gt;Nik Sultana&lt;/a&gt; also improved the &lt;a href=&quot;https://github.com/mirage/is-mirage-broken/tree/master/logs&quot;&gt;is-mirage-broken&lt;/a&gt; to give us a cron-driven prod if a library update caused an end-to-end failure in building the Mirage website or other self-hosted infrastructure.&lt;/p&gt;
&lt;p&gt;Our favourite &lt;a href=&quot;http://www.somerandomidiot.com&quot;&gt;random idiot&lt;/a&gt;, Mindy Preston, wrote up a superb blog series about her experiences in the spring of 2014 with moving her homepage to be hosted on Mirage.  This was followed up by &lt;a href=&quot;http://roscidus.com/blog/blog/2014/07/28/my-first-unikernel/&quot;&gt;Thomas Leonard&lt;/a&gt;, &lt;a href=&quot;http://philtomson.github.io/blog/2014/09/10/some-notes-on-building-and-running-mirage-unikernels-on-cubieboard2/&quot;&gt;Phil Tomson&lt;/a&gt;, &lt;a href=&quot;https://github.com/iw/mirage-jekyll&quot;&gt;Ian Wilkinson&lt;/a&gt;, &lt;a href=&quot;http://ocaml.is-awesome.net/2014/11/building-a-blog-with-mirage-os&quot;&gt;Toby Moore&lt;/a&gt;, and many others that we've tried to record in our &lt;a href=&quot;http://openmirage.org/links/&quot;&gt;link log&lt;/a&gt;.  We really appreciate the hundreds of bug reports filed by users and folk trying out Mirage; by taking the trouble to do this, you've  helped us refine and polish the frontend.  One challenge for 2015 that we could use help on is to pull together many of these distributed blogged instructions and merge them back into the main documentation (get in touch if interested!).&lt;/p&gt;
&lt;p&gt;OCaml has come a long way in the last year in terms of tooling, and another task my research group &lt;a href=&quot;http://ocaml.io&quot;&gt;OCaml Labs&lt;/a&gt; works on at Cambridge is the development of the &lt;a href=&quot;https://ocaml.org/meetings/ocaml/2014/ocaml2014_7.pdf&quot;&gt;OCaml Platform&lt;/a&gt;.  I'll be blogging separately about our OCaml-specific activities in a few days, but all of this work has a direct impact on Mirage itself since it lets us establish a local feedback loop between Mirage and OCaml developers to rapidly iterate on large-scale development.  The regular &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/&quot;&gt;OCaml compiler hacking sessions&lt;/a&gt; organised by Jeremy Yallop and Leo White have been a great success this year, with a wide variety of people from academic (Cambridge, London universities and Microsoft Research) and industrial (Jane Street, Citrix and Facebook among others) and locally interested folk.
One very important project that has had a lot of work put into it in 2014 (but isn't quite ready for a public release yet) is &lt;a href=&quot;https://github.com/samoht/assemblage&quot;&gt;Assemblage&lt;/a&gt;, which will remove much of the boilerplate currently needed to build and release an OCaml library to OPAM.&lt;/p&gt;
&lt;p&gt;We also had a great time working with open-source summer programs. Thanks to the Xen Foundation and GNOME for their support here, and we hope to do this again next summer!  The roundup posts were:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;em&gt;&lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/08/22/opw-fin/&quot;&gt;OPW FIN&lt;/a&gt;&lt;/em&gt; by Mindy Preston: on of her &lt;a href=&quot;http://gnome.org/opw/&quot;&gt;FOSS Outreach Program&lt;/a&gt; work.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&lt;a href=&quot;http://1000hippos.wordpress.com/&quot;&gt;Amazon Adventures&lt;/a&gt;&lt;/em&gt; by Jyotsna Prakash: on her &lt;a href=&quot;https://developers.google.com/open-source/soc/?csw=1&quot;&gt;Google Summer of Code&lt;/a&gt; 2014 efforts on EC2 bindings.&lt;/li&gt;&lt;/ul&gt;

&lt;h3&gt;Upcoming features&lt;/h3&gt;

&lt;p&gt;So what's coming up for our unikernels in 2015?  Our focus heading into the new year is very much on improving the ease-of-use and deployability of Mirage and fleshing out the feature set for the early adopters such as the &lt;a href=&quot;https://github.com/xapi-project&quot;&gt;XAPI&lt;/a&gt; project, &lt;a href=&quot;http://events.linuxfoundation.org/sites/events/files/slides/XenStore_MAC_XenSummit_2014.pdf&quot;&gt;Galois&lt;/a&gt;, and the &lt;a href=&quot;http://nymote.org&quot;&gt;Nymote&lt;/a&gt; personal data project.  Here are some of the highlights:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Dust Clouds&lt;/strong&gt;: The work on Jitsu is leading to the construction of what we term &amp;quot;&lt;a href=&quot;http://anil.recoil.org/papers/2010-iswp-dustclouds.pdf&quot;&gt;dust clouds&lt;/a&gt;&amp;quot;: on-demand scaling of unikernel services within milliseconds of requests coming in, terminated right beside the user on local ARM devices.  The model supports existing clouds as well, and so we are improving support for cloud APIs such via Jyotsna Prakash's &lt;a href=&quot;https://github.com/moonlightdrive/ocaml-ec2&quot;&gt;EC2&lt;/a&gt; bindings, &lt;a href=&quot;https://github.com/djs55/xe-unikernel-upload&quot;&gt;XenAPI&lt;/a&gt;, and (volunteers needed) OpenStack support.  If you're interested in tracking this work, head over to the &lt;a href=&quot;http://nymote.org&quot;&gt;Nymote&lt;/a&gt; site for updates.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Portability&lt;/strong&gt;: Beyond Xen, there are several efforts afoot to port Mirage to bare metal targets.  One promising effort is to use &lt;a href=&quot;http://rumpkernel.org&quot;&gt;Rump Kernels&lt;/a&gt; as the boot infrastructure and Mirage as the application stack.  We hope to have a Raspberry Pi and other ARM targets fairly soon.  Meanwhile at the end of the spectrum is mobile computing, which was part of the original &lt;a href=&quot;http://anil.recoil.org/papers/2010-bcs-visions.pdf&quot;&gt;multiscale&lt;/a&gt; vision for starting the project.  The JavaScript, iOS and Android ports are all progressing (mainly thanks to community contributions around OCaml support for this space, such as Jeff Psellos' hard work on &lt;a href=&quot;http://psellos.com/ocaml/&quot;&gt;OCaml-IOS&lt;/a&gt;).&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Protocol Development&lt;/strong&gt;: There are a huge number of protocols being developed independently, and more are always welcome.  &lt;a href=&quot;https://github.com/infidel&quot;&gt;Luke Dunstan&lt;/a&gt; is hacking on &lt;a href=&quot;https://github.com/mirage/ocaml-dns/pull/35#discussion_r22388447&quot;&gt;multicast DNS&lt;/a&gt; support, we have an IMAP &lt;a href=&quot;https://github.com/nojb/ocaml-imap&quot;&gt;client&lt;/a&gt; and &lt;a href=&quot;https://github.com/gregtatcam/imaplet-lwt/&quot;&gt;server&lt;/a&gt;, &lt;a href=&quot;https://github.com/dominicjprice&quot;&gt;Dominic Price&lt;/a&gt; has built a series of social network APIs for &lt;a href=&quot;https://github.com/dominicjprice/sociaml-facebook-api&quot;&gt;Facebook&lt;/a&gt; or &lt;a href=&quot;https://github.com/dominicjprice/sociaml-tumblr-api&quot;&gt;Tumblr&lt;/a&gt;, and &lt;a href=&quot;http://nottingham.ac.uk/horizon/people/masoud.koleini&quot;&gt;Masoud Koleini&lt;/a&gt; has been extending Haris Rotsos' work to achieve a line-rate and type-safe &lt;a href=&quot;https://github.com/mirage/ocaml-openflow&quot;&gt;OpenFlow&lt;/a&gt; switch and controller based on the &lt;a href=&quot;https://github.com/frenetic-lang&quot;&gt;Frenetic&lt;/a&gt; project.  Hannes is also developing &lt;a href=&quot;https://github.com/hannesm/jackline&quot;&gt;Jackline&lt;/a&gt;, which uses his Mirage to assemble a trustworthy communication client.  &lt;a href=&quot;http://erratique.ch/software&quot;&gt;Daniel Buenzli&lt;/a&gt; also continues to release a growing set of high-quality, modular libraries that we depend on throughout Mirage.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Storage&lt;/strong&gt;: All storage services from the unikernels will be Git-based (e.g. logging, command-and-control, key-value retrieval).  Expect to see Xen toolstack extensions that make this support seamless, so a single Linux VM will be able to control a large army of unikernels via persistent data structures.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;h3&gt;Want to get involved?&lt;/h3&gt;

&lt;p&gt;This is a really fun time to get involved with unikernels and the Mirage project. The year of 2014 has seen &lt;a href=&quot;http://openmirage.org/links/&quot;&gt;lots of discussion&lt;/a&gt; about the potential of unikernels and we'll see some of the first big deployments involving them in 2015.  For the ones among you who wish to learn more, then check out the &lt;a href=&quot;https://github.com/mirage/mirage-www/wiki/Pioneer-Projects&quot;&gt;pioneer projects&lt;/a&gt;, watch out for &lt;a href=&quot;http://openmirage.org/wiki&quot;&gt;Amir's meeting notes&lt;/a&gt; and join the voice calls if you want a more interactive discussion, and engage on the &lt;a href=&quot;http://openmirage.org/community/&quot;&gt;mailing lists&lt;/a&gt; with any questions you might have.&lt;/p&gt;
&lt;p&gt;For me personally, it's been a real privilege to spend the year working with and learning from the friendly, intelligent and diverse community that is springing up around the project.  The progression from experiment to reality has been a lot of work, but the unikernel dream is finally coming together rath[er nicely thanks to everyone's hard work and enthusiasm.  I'd also like to thank all of our &lt;a href=&quot;http://openmirage.org/community/&quot;&gt;funding bodies&lt;/a&gt; and the &lt;a href=&quot;http://linuxfoundation.org&quot;&gt;Linux Foundation&lt;/a&gt; and the &lt;a href=&quot;http://xenproject.org&quot;&gt;Xen Project&lt;/a&gt; (especially Lars Kurth and Russell Pavlicek) for their support throughout the year that made all this work possible.  Happy new year, everyone!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/2014-in-review</id><title type="text">Mirage 2014 review: IPv6, TLS, Irmin, Jitsu and community growth</title><updated>2014-12-31T16:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2014/09/23/compiler-hacking-by-the-river" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;p&gt;&lt;strong&gt;Update: This session will be a joint F#/OCaml hacking event, beginning with a talk from Don Syme about F# compiler and language development!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;For the eighth Cambridge OCaml compiler hacking evening we'll be meeting in the &lt;a href=&quot;http://www.cam.ac.uk/news/first-ever-postdoc-centre-is-new-home-for-research-staff&quot;&gt;University Postdoc centre&lt;/a&gt; at &lt;a href=&quot;https://goo.gl/maps/cZXev&quot;&gt;16 Mill Lane&lt;/a&gt; (near the river, next door to &lt;a href=&quot;http://makespace.org/space/&quot;&gt;Makespace&lt;/a&gt;) on 6.30pm Tuesday 30th September.&lt;/p&gt;

&lt;p&gt;If you're planning to come along, it'd be helpful if you could &lt;a href=&quot;http://doodle.com/svwkevcs5p2xs8n8&quot;&gt;&lt;strong&gt;indicate interest via Doodle&lt;/strong&gt;&lt;/a&gt; and &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;sign up to the mailing list&lt;/a&gt; to receive updates:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Where&lt;/strong&gt;:
  Postdoc Centre&lt;br/&gt;
  Basement, &lt;a href=&quot;https://goo.gl/maps/cZXev&quot;&gt;16 Mill Lane&lt;/a&gt;&lt;br/&gt;
  Cambridge, CB2 1SB&lt;br/&gt;
  United Kingdom  &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;When&lt;/strong&gt;: 6.30pm, Tuesday 30th September&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Who&lt;/strong&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;What&lt;/strong&gt;: fixing bugs, implementing new features, learning about OCaml internals.  This time we'll be focusing on code quality: refactoring, adding test cases, reviewng existing proposals and updating packages after the recent &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2014-08/msg00127.html&quot;&gt;release of OCaml 4.02&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Wiki&lt;/strong&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience (see also some &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;things we've done on previous evenings&lt;/a&gt;), but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll also be ordering pizza, so if you want to be counted for food you should aim to arrive by 6.45pm.&lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2014/09/23/compiler-hacking-by-the-river</id><title type="text">Eighth OCaml compiler hacking evening (at Mill Lane, by the river)</title><updated>2014-09-23T19:00:00+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://www.somerandomidiot.com/blog/2014/08/19/i-am-unikernel/" rel="alternate"/><contributor><uri>http://www.somerandomidiot.com/blog/categories/ocaml/atom.xml</uri><name>Mindy Preston</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://jvns.ca&quot;&gt;Julia Evans,&lt;/a&gt; prolific blogger and rad person, gave me several kind comments on the &amp;ldquo;Why I Unikernel&amp;rdquo; posts (&lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/08/11/attack-surface-area/&quot;&gt;security&lt;/a&gt;, &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/08/14/my-content-is-mine/&quot;&gt;self-hosting&lt;/a&gt;). She also asked, quite reasonably, whether I&amp;rsquo;d written a high-level summary of how I host my blog from a unikernel. &amp;ldquo;No, but I should,&amp;rdquo; I said, and unlike most times I say I should do something, I actually did it.&lt;/p&gt;&lt;p&gt;Here&amp;rsquo;s the very-high-level overview:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;use brain to generate content that some human, somewhere, might want to read (hardest step)&lt;/li&gt;&lt;li&gt;write all that stuff in Markdown&lt;/li&gt;&lt;li&gt;use &lt;a href=&quot;http://www.octopress.org&quot;&gt;Octopress&lt;/a&gt; to generate a static site from that Markdown&lt;/li&gt;&lt;li&gt;use &lt;a href=&quot;http://www.openmirage.org&quot;&gt;Mirage&lt;/a&gt; to build a unikernel with the blog content&lt;/li&gt;&lt;li&gt;upload the unikernel to an EC2 instance running Linux&lt;/li&gt;&lt;li&gt;build a new EC2 instance from the uploaded unikernel&lt;/li&gt;&lt;li&gt;make sure that newly generated instance looks like my website with new content&lt;/li&gt;&lt;li&gt;shut down the Linux host that made the new EC2 instance&lt;/li&gt;&lt;li&gt;make &lt;code&gt;somerandomidiot.com&lt;/code&gt; point to the new EC2 instance&lt;/li&gt;&lt;li&gt;kill the EC2 instance which previously served &lt;code&gt;somerandomidiot.com&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;And below, one can find the gory details.&lt;/p&gt;&lt;h3&gt;Use Brain To Generate Content&lt;/h3&gt;&lt;p&gt;I can&amp;rsquo;t really give you great advice on this, but &lt;a href=&quot;http://emptysqua.re/blog/write-an-excellent-programming-blog/&quot;&gt;A. Jesse Jiryu Davis can&lt;/a&gt;.&lt;/p&gt;&lt;h3&gt;Write All That Stuff In Markdown&lt;/h3&gt;&lt;p&gt;I say Markdown, but really, write it in whatever thing makes sense for how you&amp;rsquo;re going to deploy it. If you&amp;rsquo;re going to use Octopress, you want Markdown. There are a lot of Markdown summaries floating around the &amp;lsquo;net, but my favorite one is &lt;a href=&quot;https://github.com/trucy/potatodown&quot;&gt;potatodown&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;For the purposes of this walkthrough, let&amp;rsquo;s say I&amp;rsquo;ve written my masterpiece into &lt;code&gt;octopress/source/_posts/2014-08-18-i-am-unikernel.markdown&lt;/code&gt;.&lt;/p&gt;&lt;h3&gt;Use Octopress To Generate A Static Site&lt;/h3&gt;&lt;p&gt;I happen to use Octopress, but I see no reason why you couldn&amp;rsquo;t use &lt;em&gt;any&lt;/em&gt; static site generator. Amir Chaudry, who was making unikernel blog entries before I&amp;rsquo;d even cracked a book on OCaml, &lt;a href=&quot;http://amirchaudhry.com/from-jekyll-to-unikernel-in-fifty-lines/&quot;&gt;uses Jekyll and much smarter automation than I use&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;If you want to start an Octopress blog, the &lt;a href=&quot;http://octopress.org/docs/setup/&quot;&gt;instructions on getting started&lt;/a&gt; are fairly straightforward. There&amp;rsquo;s a potentially tricky substep here, which is &amp;ldquo;get a working Ruby environment that can build Octopress&amp;rdquo;. If you already use Ruby, you&amp;rsquo;re probably fine; if you don&amp;rsquo;t, you may appreciate this &lt;a href=&quot;http://bundler.io/issues.html&quot;&gt;documentation for Bundler&lt;/a&gt;, the module which gave me a couple of hours of trouble.&lt;/p&gt;&lt;p&gt;Once Octopress is initialized, configured, and ready to go, I can regenerate my blog with new content:&lt;/p&gt;&lt;p&gt;``` user@computer:~/octopress$ rake generate&lt;/p&gt;&lt;h2&gt;Generating Site with Jekyll&lt;/h2&gt;&lt;p&gt;identical source/stylesheets/screen.css Configuration from /home/user/octopress/_config.yml Building site: source &amp;ndash;&amp;gt; public Successfully generated site: source &amp;ndash;&amp;gt; public ```&lt;/p&gt;&lt;p&gt;Now I have a bunch of files in &lt;code&gt;octopress/public&lt;/code&gt; that comprise the entirety of my blog, including &lt;code&gt;public/blog/2014/08/18/i-am-unikernel/index.html&lt;/code&gt;, my new post.&lt;/p&gt;&lt;h3&gt;Use Mirage to Build a Unikernel&lt;/h3&gt;&lt;p&gt;To serve my website, I need something that can do a series of things:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;read HTTP requests from interested clients (e.g., &amp;ldquo;show me the index of &lt;code&gt;somerandomidiot.com&lt;/code&gt;&amp;rdquo;)&lt;/li&gt;&lt;li&gt;provide the content for a given request&lt;/li&gt;&lt;li&gt;construct a valid HTTP response wrapping the content&lt;/li&gt;&lt;li&gt;respond to requests that can&amp;rsquo;t be fulfilled with an error page (i.e., serve a &amp;ldquo;page not found&amp;rdquo; page)&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Handily, there&amp;rsquo;s an example of such a thing in &lt;a href=&quot;https://github.com/mirage/mirage-skeleton/tree/master/static_website&quot;&gt;mirage-skeleton&lt;/a&gt;. I made a &lt;code&gt;_mirage&lt;/code&gt; subdirectory in my &lt;code&gt;octopress&lt;/code&gt; directory and copied the &lt;code&gt;config.ml&lt;/code&gt; and &lt;code&gt;dispatch.ml&lt;/code&gt; over into it. I had to edit &lt;code&gt;config.ml&lt;/code&gt; to look for my content in a different location, and edit &lt;code&gt;dispatch.ml&lt;/code&gt; to assume that any request with a trailing &lt;code&gt;/&lt;/code&gt; should have an &lt;code&gt;index.html&lt;/code&gt; appended for lookup; other than that, the code is stock. Here&amp;rsquo;s &lt;a href=&quot;https://gist.github.com/yomimono/a853d3699ca5edad1829&quot;&gt;the edited dispatch.ml&lt;/a&gt; and &lt;a href=&quot;https://gist.github.com/yomimono/5533a8de0299dd599d97&quot;&gt;the edited config.ml&lt;/a&gt;; if you like, use them yourself.&lt;/p&gt;&lt;p&gt;Once this is in place, &lt;code&gt;DHCP=yes mirage configure --xen&lt;/code&gt; and &lt;code&gt;mirage build&lt;/code&gt; gets me a unikernel called &lt;code&gt;mir-www.xen&lt;/code&gt;. I generally boot it locally and look it over, find something wrong, fix it, and rebuild a few times.&lt;/p&gt;&lt;h3&gt;Upload the Unikernel to an EC2 Host Running Linux&lt;/h3&gt;&lt;p&gt;I run my unikernel on EC2, pretty much entirely because it works and it&amp;rsquo;s free. In order to deploy a unikernel to EC2 as cheaply as possible, one currently needs to do some auxiliary operations on something running on EC2. I got a Linux host set up with the shell EC2 tools to do this. I keep the host stopped when I&amp;rsquo;m not using it to build a unikernel, to avoid having to (1) pay for compute time and (2) worry about its credentials being brute-forced. The Linux host is &lt;a href=&quot;http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html&quot;&gt;tagged&lt;/a&gt; with &lt;code&gt;role=host&lt;/code&gt;, so I can distinguish it from my little mayfly unikernels when manipulating my EC2 instances programmatically.&lt;/p&gt;&lt;p&gt;I start up the build host, then once it&amp;rsquo;s responding, I &lt;code&gt;scp&lt;/code&gt; my unikernel, &lt;code&gt;mir-www.xen&lt;/code&gt;, over to its filesystem. The blog is currently about 17 megabytes (mostly high-resolution embroidery photos), so this is starting to take a while; soon I&amp;rsquo;ll have to do something smarter.&lt;/p&gt;&lt;h3&gt;Build the New Unikernel EC2 Instance&lt;/h3&gt;&lt;p&gt;Building a bootable &lt;code&gt;t1.micro&lt;/code&gt; instance from a unikernel is surprisingly involved. I have a janky shell script that lives on the Linux EC2 host and does this automatically. If you&amp;rsquo;re interested in the details, &lt;a href=&quot;https://gist.github.com/yomimono/9559263&quot;&gt;it&amp;rsquo;s up on gist&lt;/a&gt;. The summary, &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/03/14/its-a-mirage/&quot;&gt;shamelessly copied from the first time I did this a few months ago&lt;/a&gt;, is this:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;create an EBS block to attach to the Linux image&lt;/li&gt;&lt;li&gt;attach the EBS block to the Linux image&lt;/li&gt;&lt;li&gt;make a bootable filesystem on the EBS block&lt;/li&gt;&lt;li&gt;copy the Mirage kernel to the EBS block over the network&lt;/li&gt;&lt;li&gt;make a workable Grub configuration on the EBS block&lt;/li&gt;&lt;li&gt;snapshot the EBS block&lt;/li&gt;&lt;li&gt;associate the EBS block snapshot with an Amazon Kernel Image that &lt;a href=&quot;http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/UserProvidedKernels.html&quot;&gt;boots PV-GRUB&lt;/a&gt;, which gives you an Amazon Machine Instance backed by an Elastic Block Store&lt;/li&gt;&lt;li&gt;finally, fire up your instance from the previous step.&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;Check the New Instance&lt;/h3&gt;&lt;p&gt;At the end of all this, a successful build generates a new instance at some nonpredictable public IP, which is discoverable from the Amazon console or with &lt;code&gt;ec2-describe-instances&lt;/code&gt;. I usually browse to it and make sure it&amp;rsquo;s up and responding before making this version of the blog the authoritative one, but this is somewhat unnecessarily paranoid.&lt;/p&gt;&lt;h3&gt;Stop the Build Host&lt;/h3&gt;&lt;p&gt;I don&amp;rsquo;t need the Linux EC2 host running anymore, so I stop it with &lt;code&gt;ec2-stop-instances&lt;/code&gt;.&lt;/p&gt;&lt;h3&gt;Point Traffic at the New Instance&lt;/h3&gt;&lt;p&gt;&lt;code&gt;somerandomidiot.com&lt;/code&gt; points to an Amazon &lt;a href=&quot;https://aws.amazon.com/articles/1346&quot;&gt;Elastic IP&lt;/a&gt;, which can be reassigned to a different instance very quickly &amp;mdash; much faster than DNS propagation. Once I&amp;rsquo;m satisfied with the new instance, I move the elastic IP over to it with &lt;code&gt;ec2-associate-address&lt;/code&gt;, so that the IP that &lt;code&gt;somerandomidiot.com&lt;/code&gt; resolves to now points to the newest instance.&lt;/p&gt;&lt;h3&gt;Kill the Previous Instance&lt;/h3&gt;&lt;p&gt;The EC2 instance that was serving the blog until the previous step is still up and running. &lt;code&gt;ec2-terminate-instances&lt;/code&gt; (a command that not many people get to use as often as I do!) destroys it completely. If I needed to, I could regenerate it from the EBS block snapshot.&lt;/p&gt;&lt;h3&gt;Bonus Extras!&lt;/h3&gt;&lt;p&gt;I haven&amp;rsquo;t had to worry about this yet, but there&amp;rsquo;s a charge for storing large numbers of snapshots on EC2 &amp;ndash; a few pennies per gigabyte-month once you pass 30 gigabytes. Each deployment makes a 1GB snapshot, so soon I&amp;rsquo;ll have enough snapshots on EC2 that I&amp;rsquo;ll have to go in and delete a few.&lt;/p&gt;&lt;h3&gt;The Future!&lt;/h3&gt;&lt;p&gt;My fellow OPW intern, &lt;a href=&quot;http://1000hippos.wordpress.com/&quot;&gt;Jyotsna Prakash&lt;/a&gt;, has been working on &lt;a href=&quot;https://github.com/moonlightdrive/ocaml-ec2&quot;&gt;EC2 API bindings for OCaml&lt;/a&gt;. Soon, I hope it will be possible to have a unikernel do the work of packaging up unikernels into Amazon Machine Instances, as well as the management work of spinning them up, shutting them down, and reassigning IPs. It&amp;rsquo;s a bit embarrassing that I have a Linux host just for running a shell script that repeatedly calls other shell scripts that invoke the JVM in order to do REST API calls, and it&amp;rsquo;ll be a great day when I can replace that with a few lines of OCaml.&lt;/p&gt; </content><id>http://www.somerandomidiot.com/blog/2014/08/19/i-am-unikernel/</id><title type="text">I Am Unikernel (and So Can You!)</title><updated>2014-08-19T06:47:13+00:00</updated><author><email></email><name>Mindy Preston</name></author></entry><entry><link href="http://www.somerandomidiot.com/blog/2014/08/14/my-content-is-mine/" rel="alternate"/><contributor><uri>http://www.somerandomidiot.com/blog/categories/ocaml/atom.xml</uri><name>Mindy Preston</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/08/11/attack-surface-area/&quot;&gt;Having a machine capable of executing arbitrary instructions on the public Internet is a responsibility&lt;/a&gt;, and it&amp;rsquo;s a fairly heavy one to assume just to run a blog. Some people solve this by letting someone else take care of it &amp;mdash; GitHub, Tumblr, or Medium, for example. I&amp;rsquo;m not so keen on that solution for a number of reasons, almost none of which are Internet-old-person crankery.&lt;/p&gt;&lt;p&gt;First, and most emotionally: as dumb as my thoughts are, they&amp;rsquo;re &lt;em&gt;mine&lt;/em&gt;. Not GitHub&amp;rsquo;s or Medium&amp;rsquo;s or any other group&amp;rsquo;s. Most entities on the web don&amp;rsquo;t host user content out of the goodness of their heart; they&amp;rsquo;re getting something out of it, and it&amp;rsquo;s likely that they&amp;rsquo;re getting more out of it than the user is. I&amp;rsquo;m reminded of the old MetaFilter maxim: &amp;ldquo;If you&amp;rsquo;re not paying for it, you&amp;rsquo;re not the consumer, you&amp;rsquo;re the product.&amp;rdquo; Either someone&amp;rsquo;s making money off of you now or &lt;a href=&quot;http://idlewords.com/bt14.htm#ads&quot;&gt;they plan to do it later&lt;/a&gt;. I don&amp;rsquo;t want to encourage that kind of behavior. I just want to write things that people can read about how to make stuff work.&lt;/p&gt;&lt;p&gt;Moreover, if I let someone else host my content, I&amp;rsquo;m not in ultimate control of whether it stays there. Content disappears all the time &amp;mdash; &lt;a href=&quot;http://indiewebcamp.com/site-deaths&quot;&gt;companies fold and take your data with them&lt;/a&gt;, they decide they&amp;rsquo;d rather not provide you a mouthpiece because they don&amp;rsquo;t like what you&amp;rsquo;re saying, or they may decide to start charging you for the privilege of putting your stuff on their site (sometimes without letting you get your data out first, if you don&amp;rsquo;t like the fee structure). Companies that initially offered open access to content turn into &lt;a href=&quot;http://blog.codinghorror.com/avoiding-walled-gardens-on-the-internet/&quot;&gt;walled gardens&lt;/a&gt;, possibly with terms for signup that are onerous to folks who want to read your content. When you put your content in someone else&amp;rsquo;s hands, you have no control over any of this.&lt;/p&gt;&lt;p&gt;There are even worse possibilities for user content. Signing your name to an article, then posting it on a content platform, signals a high level of trust in the platform not to edit your content after you&amp;rsquo;ve signed it. In most cases, there&amp;rsquo;s nothing technical stopping the content platform from doing so. In many cases, there&amp;rsquo;s nothing in the terms of service or any official policy preventing the content platform from editing your content, either. I&amp;rsquo;d be rather piqued, personally, to discover the sentence &amp;ldquo;State surveillance is not a public good&amp;rdquo; edited to &amp;ldquo;State surveillance is a public good&amp;rdquo; after I&amp;rsquo;d written and posted it.&lt;/p&gt;&lt;p&gt;Keeping even innocuous content safe from modification (and as a consequence, &lt;a href=&quot;http://blog.spoofed.org/2008/04/why-ssl.html&quot;&gt;authenticated and encrypted&lt;/a&gt;, something &lt;a href=&quot;http://www.github.com/mirleft/ocaml-tls&quot;&gt;in the works&lt;/a&gt; for Mirage unikernels) is vital for keeping all content safe from modification. If all content that Medium will accept is hosted on Medium, content hosted elsewhere automatically becomes suspect. Worse, access to content elsewhere may be restricted by network gatekeepers, be they well-meaning or otherwise; it&amp;rsquo;s already possible to get a &lt;a href=&quot;http://blogs.wsj.com/digits/2014/07/30/sprint-tries-a-facebook-only-wireless-plan/&quot;&gt;Facebook, Twitter, Instragram, or Pinterest-only data plan&lt;/a&gt;. What does that imply about content hosted in places other than Facebook and Twitter?&lt;/p&gt;&lt;p&gt;The ability of content creators to self-host is a fundamental requirement of a free and open Internet, and I think that my own participation in such an Internet requires that I host my own content. I didn&amp;rsquo;t think it was possible to do so responsibly, and with a minimum of cognitive overhead, until I started running my blog as a unikernel.&lt;/p&gt;&lt;p&gt;This part of my online presence isn&amp;rsquo;t the only thing about my Internet use that could be made safer, and more ethical, by controlling it myself &amp;ndash; there are many services that I, and others, could certainly use a safe, secure, unmonitored, and tamper-resistant interface to. I would love to have a highly-available virtual machine that answered and anonymized my DNS queries. I&amp;rsquo;d like to run my own mail server again &amp;mdash; a prospect currently much scarier than running a web server. I&amp;rsquo;d love to have an IPSEC tunnel, for which I controlled both endpoints, to route &lt;em&gt;all&lt;/em&gt; of my traffic over. I&amp;rsquo;d love to have a ubiquitous, reliable mesh network available in my home, so all this self-hosting I&amp;rsquo;m doing didn&amp;rsquo;t rely on a data center to Do The Right Thing. I&amp;rsquo;d love for my artist and activist friends to be able to have these things too.&lt;/p&gt;&lt;p&gt;I&amp;rsquo;m looking forward to helping make more of these things possible.&lt;/p&gt; </content><id>http://www.somerandomidiot.com/blog/2014/08/14/my-content-is-mine/</id><title type="text">My Content Is Mine: Why I Unikernel, Part 2</title><updated>2014-08-14T22:33:52+00:00</updated><author><email></email><name>Mindy Preston</name></author></entry><entry><link href="http://www.somerandomidiot.com/blog/2014/08/11/attack-surface-area/" rel="alternate"/><contributor><uri>http://www.somerandomidiot.com/blog/categories/ocaml/atom.xml</uri><name>Mindy Preston</name></contributor><content type="html">&lt;p&gt;Before I started this blog, I had started a few others at &lt;a href=&quot;http://www.yomimono.org&quot;&gt;my other domain&lt;/a&gt; (now moribund). Despite repeated attempts, I never could resign myself to doing systems administration for a web server that executed dynamic code, like that which powers WordPress or Drupal; I&amp;rsquo;d install such a framework, begin &lt;a href=&quot;http://blog.softlayer.com/2012/tips-and-tricks-how-to-secure-wordpress/&quot;&gt;locking the site down&lt;/a&gt;, realize that I&amp;rsquo;d spent a lot of time reassuring myself that the site was secure without believing it for a second, then delete the framework and revert the frontpage to an &lt;code&gt;index.html&lt;/code&gt; rather like what&amp;rsquo;s present there now. Particularly ambitious iterations would get a post or two published before this cycle completed, now long-vanished.&lt;/p&gt;&lt;p&gt;I wanted my site to be either accessible for the sole purpose of reading my content or not responding to any incoming requests; I wanted it to have no possibility of serving my content but also mining BitCoin for someone else, for example, or serving my content and also a whole bunch of malware. Best of all would be to get all of that without a maintenance-hungry layer of helper applications and kernel code, most of which is irrelevant to my server&amp;rsquo;s only goal &amp;ndash; delivering my dumb thoughts via HTML and CSS to hapless browsers.&lt;/p&gt;&lt;p&gt;This may sound paranoid (not to mention self-important) to readers who haven&amp;rsquo;t ever read the access or error logs for a publicly accessible webserver, and are under the impression that all attacks are launched by humans and specifically targeted at a specific site. In fact, the vast majority of attacks are automated from stem to stern &amp;ndash; a crawler automatically discovers your site, scans it for vulnerabilities, finds an automatically exploitable problem, exploits it, deposits a payload, and moves to the next target. Blog frameworks get a lot of attention from people looking to find new targets. Here&amp;rsquo;s an excerpt from my access logs at the old domain from this month, reflecting a few automated attempts to discover exploitable software running there.&lt;/p&gt;&lt;p&gt;&lt;code&gt; 139.0.10.183 - - [04/Aug/2014:17:02:48 -0400] &amp;quot;GET /myadmin/scripts/setup.php HTTP/1.1&amp;quot; 404 - &amp;quot;-&amp;quot; &amp;quot;-&amp;quot; 95.173.166.154 - - [06/Aug/2014:04:20:02 -0400] &amp;quot;GET /myadmin/scripts/setup.php HTTP/1.1&amp;quot; 404 - &amp;quot;-&amp;quot; &amp;quot;-&amp;quot; 119.77.140.105 - - [07/Aug/2014:01:08:42 -0400] &amp;quot;GET /myadmin/scripts/setup.php HTTP/1.1&amp;quot; 404 - &amp;quot;-&amp;quot; &amp;quot;-&amp;quot; 91.234.104.79 - - [07/Aug/2014:06:44:50 -0400] &amp;quot;GET /CFIDE/administrator/ HTTP/1.1&amp;quot; 404 - &amp;quot;-&amp;quot; &amp;quot;-&amp;quot; 124.207.151.33 - - [07/Aug/2014:11:23:52 -0400] &amp;quot;GET /myadmin/scripts/setup.php HTTP/1.1&amp;quot; 404 - &amp;quot;-&amp;quot; &amp;quot;-&amp;quot; 37.187.35.182 - - [07/Aug/2014:20:02:51 -0400] &amp;quot;GET /CFIDE/administrator/ HTTP/1.1&amp;quot; 404 - &amp;quot;-&amp;quot; &amp;quot;-&amp;quot; &lt;/code&gt;&lt;/p&gt;&lt;p&gt;In short, it doesn&amp;rsquo;t matter who you are; whether or not anyone&amp;rsquo;s reading your blog, your blog is a target.&lt;/p&gt;&lt;p&gt;In late 2013, I decided to do something with the impulse-purchased &lt;code&gt;somerandomidiot.com&lt;/code&gt;, and rather than going on the dynamic blog framework roller-coaster ride again, I used a &lt;a href=&quot;http://staticsitegenerators.net/&quot;&gt;static site generator&lt;/a&gt;. This site is represented completely by content that doesn&amp;rsquo;t need to be executed by the webserver when a page is loaded. Moreover, there is no element of the site that needs to read, parse, or act according to the semantics of user-generated input. Only the webserver itself, which has a much more clearly-defined and constrained set of potential inputs, is exposed to outside requests.&lt;/p&gt;&lt;p&gt;This site&amp;rsquo;s use of a static site generator, rather than a dynamic framework like WordPress, is entirely responsible for this site&amp;rsquo;s existence through March of this year. I was still responsible for something that opened a potential attack vector to the entire Internet, but at least it wasn&amp;rsquo;t the most glaringly obvious target around; reducing the attack surface to that of a static site let me sleep at night, albeit fitfully.&lt;/p&gt;&lt;p&gt;Before April of 2014, this blog was served from a fairly conventional Ubuntu Linux remotely-hosted &lt;a href=&quot;https://en.wikipedia.org/wiki/Virtual_private_server&quot;&gt;virtual private server&lt;/a&gt; running &lt;a href=&quot;http://nginx.org/&quot;&gt;&lt;code&gt;nginx&lt;/code&gt;&lt;/a&gt;, a common webserver more minimal than the venerable &lt;a href=&quot;http://apache.org&quot;&gt;&lt;code&gt;apache&lt;/code&gt;&lt;/a&gt;. In order to submit new content to the blog and apply security updates to its software components, I had to be able to access it over some control interface; &lt;code&gt;ssh&lt;/code&gt; fulfills both requirements, but not without a price.&lt;/p&gt;&lt;p&gt;&lt;code&gt;ssh&lt;/code&gt; is one of the most frequently-attacked services on the Internet. Having a server with a publicly-accessible &lt;code&gt;ssh&lt;/code&gt; port guarantees that bots will be attempting to guess a valid username and password at least once a day. The risk of such an attack succeeding is fairly easy to mitigate with &lt;a href=&quot;https://www.schneier.com/blog/archives/2009/08/password_advice.html&quot;&gt;the most common security advice on the planet&lt;/a&gt; or &lt;a href=&quot;http://www.paulkeck.com/ssh/&quot;&gt;by having your computer do something smarter&lt;/a&gt;, but the &lt;code&gt;ssh&lt;/code&gt; server I was using is &lt;a href=&quot;http://www.openssh.com/security.html&quot;&gt;not itself invulnerable&lt;/a&gt;. I thought about this risk a lot when logging into my server and took a few ameliorative measures, but largely I accepted the risk because no alternatives seemed sufficiently superior.&lt;/p&gt;&lt;p&gt;In summary, in order to serve content from my blog, here&amp;rsquo;s what I needed to configure and manage, and why.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;compilation: an environment that can build static pages representing this blog&lt;/li&gt;&lt;li&gt;&lt;code&gt;ssh&lt;/code&gt;: updates and configuration&lt;/li&gt;&lt;li&gt;&lt;code&gt;nginx&lt;/code&gt;: serving web pages&lt;/li&gt;&lt;li&gt;Ubuntu LTS: Linux kernel and system dependencies&lt;/li&gt;&lt;li&gt;VPS provider: physical hardware and network connections&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Compilation can be done locally (i.e. not on the server that hosts the blog). &lt;code&gt;ssh&lt;/code&gt;&amp;rsquo;s security risk can be mitigated, but not removed. &lt;code&gt;nginx&lt;/code&gt;, Ubuntu, and the VPS are required and must run on the blog&amp;rsquo;s server.&lt;/p&gt;&lt;p&gt;When I &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/03/14/its-a-mirage/&quot;&gt;discovered Mirage&lt;/a&gt; in April of 2014, I was immediately excited about the idea of running a web server without having to maintain or configure an underlying OS. Moreover, I wouldn&amp;rsquo;t have to leave any kind of control facility open to the Internet &amp;ndash; my workflow for deploying a new unikernel was the control facility. Even if my site was hacked and got defaced &amp;mdash; and in the worst case, was hacked and defaced in some way that &lt;em&gt;I&lt;/em&gt; didn&amp;rsquo;t notice, but harmed my readers &amp;mdash; it wouldn&amp;rsquo;t &lt;em&gt;stay&lt;/em&gt; hacked; each time I updated the blog, I would be deploying an entirely freshly-generated unikernel, so post-install changes would be overwritten.&lt;/p&gt;&lt;p&gt;In essence, running my site from a unikernel replaces the &lt;code&gt;ssh&lt;/code&gt; control service with something much more difficult to exploit, which is invisible to automated scanners &amp;ndash; one might surmise that the machine that &lt;code&gt;somerandomidiot.com&lt;/code&gt; points to is an Amazon EC2 instance from its public IP address, but that doesn&amp;rsquo;t give an attacker any useful information on how to go about attacking it. In order to subvert the control I have over the web server at &lt;code&gt;somerandomidiot.com&lt;/code&gt;, an attacker would have to first gain my Amazon credentials, and at that point I can&amp;rsquo;t imagine any sane attacker doing anything besides &lt;a href=&quot;http://readwrite.com/2014/04/15/amazon-web-services-hack-bitcoin-miners-github&quot;&gt;creating a whole bunch of mining instances&lt;/a&gt; on my dime and not worrying about my silly website.&lt;/p&gt;&lt;p&gt;I&amp;rsquo;m also able not to worry about attackers who&amp;rsquo;ve managed to compromise my blog using it to launch attacks to other sites. Since there&amp;rsquo;s no need for software updates from the unikernel &amp;mdash; a new unikernel completely supplants the old one &amp;mdash; there&amp;rsquo;s no need to initiate outgoing connections. Ever. I can define network firewall rules that prevent my unikernel from initiating network connections to the outside world, so that even in the case where the box is completely owned and &lt;em&gt;tries&lt;/em&gt; to start an outgoing connection, the network firewall will disallow it. (This would&amp;rsquo;ve been possible with a Linux box, but not without needing to manually allow outbound access for system updates.)&lt;/p&gt;&lt;p&gt;For my Mirage blog, here&amp;rsquo;s what I need to configure and manage:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;compilation: a local environment that can build &lt;code&gt;octopress&lt;/code&gt; blog and Mirage unikernels&lt;/li&gt;&lt;li&gt;deployment: a process to deploy a unikernel to the a public cloud and keep &lt;code&gt;somerandomidiot.com&lt;/code&gt; pointing to the right place&lt;/li&gt;&lt;li&gt;VPS provider: physical hardware and network connections&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Crucially, compilation and deployment are separable from the server that runs my blog. I can (and do) assemble a unikernel on my own laptop and send it to a non-publicly-accessible host for deployment. The only thing the unikernel version of &lt;code&gt;somerandomidiot.com&lt;/code&gt; knows how to do is serve static blog content.&lt;/p&gt;&lt;p&gt;I won&amp;rsquo;t go so far as to say that this site is unhackable now. I found &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/07/09/how-to-set-the-evil-bit/&quot;&gt;a denial of service&lt;/a&gt; that would crash this blog with just one packet a month ago. Mirage is still under active development &amp;ndash; there are surely errors we have yet to find (and for that matter, errors we have yet to make). But once an error is found and patched, users need only do what they are already used to doing &amp;ndash; build a new unikernel, test it, and use it to replace the old unikernel. There are no harrowing, high-stakes in-place upgrades of the webserver that can render a site both inoperable and unrecoverable. If a vulnerability is discovered tomorrow and a patch is available on Sunday, my steps to ameliorate the problem are just &lt;code&gt;opam upgrade&lt;/code&gt;, then the same steps I take whenever I publish a new post.&lt;/p&gt;&lt;p&gt;This blog is brought to you, in more ways than one, by &lt;a href=&quot;http://www.openmirage.org&quot;&gt;Mirage&lt;/a&gt;.&lt;/p&gt; </content><id>http://www.somerandomidiot.com/blog/2014/08/11/attack-surface-area/</id><title type="text">Attack Surface: Why I Unikernel, Part 1</title><updated>2014-08-11T21:17:43+00:00</updated><author><email></email><name>Mindy Preston</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=493" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;&lt;span style=&quot;color: #555555;&quot;&gt;&amp;nbsp;&amp;ldquo;ARC: Analysis of Raft Consensus&amp;rdquo;&amp;nbsp;is now available online as a UCAM technical report.&amp;nbsp;&lt;/span&gt;&lt;br/&gt;
&lt;a href=&quot;http://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-857.pdf&quot;&gt;http://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-857.pdf&lt;/a&gt;&lt;/p&gt;
&lt;h2 style=&quot;color: #333333;&quot;&gt;Abstract&lt;/h2&gt;
&lt;p style=&quot;color: #333333;&quot;&gt;The Paxos algorithm, despite being synonymous with distributed consensus for a decade, is famously difficult to reason about and implement due to its non-intuitive approach and underspecification. In response, this project implemented and evaluated a framework for constructing fault-tolerant applications, utilising the recently proposed Raft algorithm for distributed consensus. Constructing a simulation framework for our implementation enabled us to evaluate the protocol on everything from understandability and efficiency to correctness and performance in diverse network environments. We propose a range of optimisations to the protocol and released to the community a testbed for developing further optimisations and investigating optimal protocol parameters for real-world deployments.&lt;/p&gt;
&lt;p&gt;Thank you everyone for your feedback.&lt;/p&gt;
</content><id>http://hh360.user.srcf.net/blog/?p=493</id><title type="text">Release of  “ARC: Analysis of Raft Consensus”</title><updated>2014-07-25T22:05:09+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://www.somerandomidiot.com/blog/2014/07/25/doing-nothing-in-mirage/" rel="alternate"/><contributor><uri>http://www.somerandomidiot.com/blog/categories/ocaml/atom.xml</uri><name>Mindy Preston</name></contributor><content type="html">&lt;p&gt;It&amp;rsquo;s Northern Hemisphere summer right now, and in Wisconsin we&amp;rsquo;re having one of the loveliest ones I can remember. Today the temperature is hovering right at pleasant, there are high clouds blowing across the sky, the breeze is soothing, and birds are singing all over the place. It is not, in short, programming weather. It is sit-outside, read-a-novel, do-nothing weather.&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://flic.kr/p/jWqcS&quot;&gt;&lt;img src=&quot;http://www.somerandomidiot.com/images/bicycle_tree.jpg&quot; class=&quot;center&quot; title=&quot;&amp;lsquo;Yes, this sort of thing.&amp;rsquo; &amp;lsquo;Sunbeams stream through the leaves of a large tree, beneath which is a bicycle.&amp;rsquo;&quot;/&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;We don&amp;rsquo;t often let our programs slack off, even when we let ourselves take a peaceful day. I got to wondering (staring off into space, watching the shadows cast by sun-dappled leaves) what the most trivial, do-nothing Mirage project would look like, and how it could be constructed with a minimum of activity and a maximum of understanding.&lt;/p&gt;&lt;p&gt;&lt;code&gt; [] dothraki@iBook:~$ mkdir trivial [] dothraki@iBook:~$ cd trivial/ [] dothraki@iBook:~/trivial$ ls -alh total 16K drwxrwxr-x 2 dothraki dothraki 4.0K Jul 23 13:17 . drwxr-xr-x 161 dothraki dothraki 12K Jul 23 13:17 .. [] dothraki@iBook:~/trivial$ mirage configure --xen [ERROR] No configuration file config.ml found. You'll need to create one to let Mirage know what to do. &lt;/code&gt;&lt;/p&gt;&lt;p&gt;Okay, we&amp;rsquo;ll have to do at least one thing to make this work. Mirage uses &lt;code&gt;config.ml&lt;/code&gt; to programmatically generate a &lt;code&gt;Makefile&lt;/code&gt; and &lt;code&gt;main.ml&lt;/code&gt; when you invoke &lt;code&gt;mirage --configure&lt;/code&gt;. &lt;code&gt;main.ml&lt;/code&gt; uses instructions from &lt;code&gt;config.ml&lt;/code&gt; to satisfy module types representing driver requirements for your application, then begins running the threads you requested that it run. That all sounds an awful lot like work; maybe we can get away with not asking for anything.&lt;/p&gt;&lt;p&gt;&lt;code&gt; [] dothraki@iBook:~/trivial$ touch config.ml [] dothraki@iBook:~/trivial$ mirage configure --xen Mirage Using scanned config file: config.ml Mirage Processing: /home/dothraki/trivial/config.ml Mirage =&amp;gt; rm -rf /home/dothraki/trivial/_build/config.* Mirage =&amp;gt; cd /home/dothraki/trivial &amp;amp;&amp;amp; ocamlbuild -use-ocamlfind -tags annot,bin_annot -pkg mirage config.cmxs empty Using configuration: /home/dothraki/trivial/config.ml empty 0 jobs [] empty =&amp;gt; ocamlfind printconf path empty Generating: main.ml empty Now run 'make depend' to install the package dependencies for this unikernel. [] dothraki@iBook:~/trivial$ ls _build config.ml empty.xl log main.ml Makefile &lt;/code&gt;&lt;/p&gt;&lt;p&gt;That seems like a great start! Maybe we can trivially achieve our dream of doing nothing.&lt;/p&gt;&lt;p&gt;&lt;code&gt; [] dothraki@iBook:~/trivial$ make depend opam install mirage-xen --verbose [NOTE] Package mirage-xen is already installed (current version is 1.1.1). &lt;/code&gt;&lt;/p&gt;&lt;p&gt;Resting on our laurels. Excellent. (In keeping with the lazy theme of this post, I&amp;rsquo;ll elide the &lt;code&gt;make depend&lt;/code&gt; step from future examples, but if you&amp;rsquo;re playing along at home you may discover that you need to run it when you introduce new complexity in pursuit of perfect non-action.)&lt;/p&gt;&lt;p&gt;&lt;code&gt; [] dothraki@iBook:~/trivial$ make ocamlbuild -classic-display -use-ocamlfind -pkgs lwt.syntax,mirage-types.lwt -tags &amp;quot;syntax(camlp4o),annot,bin_annot,strict_sequence,principal&amp;quot; -cflag -g -lflags -g,-linkpkg,-dontlink,unix main.native.o ocamlfind ocamldep -package mirage-types.lwt -package lwt.syntax -syntax camlp4o -modules main.ml &amp;gt; main.ml.depends ocamlfind ocamlc -c -g -annot -bin-annot -principal -strict-sequence -package mirage-types.lwt -package lwt.syntax -syntax camlp4o -o main.cmo main.ml + ocamlfind ocamlc -c -g -annot -bin-annot -principal -strict-sequence -package mirage-types.lwt -package lwt.syntax -syntax camlp4o -o main.cmo main.ml File &amp;quot;main.ml&amp;quot;, line 8, characters 2-13: Error: Unbound module OS Command exited with code 2. make: *** [main.native.o] Error 10 [] dothraki@iBook:~/trivial$ &lt;/code&gt;&lt;/p&gt;&lt;p&gt;Oh, bother.&lt;/p&gt;&lt;p&gt;Let&amp;rsquo;s have a look at the &lt;code&gt;main.ml&lt;/code&gt; generated by &lt;code&gt;mirage configure --xen&lt;/code&gt; with our empty &lt;code&gt;config.ml&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;``` (&lt;em&gt; Generated by Mirage (Wed, 23 Jul 2014 18:21:24 GMT). &lt;/em&gt;)&lt;/p&gt;&lt;p&gt;open Lwt&lt;/p&gt;&lt;p&gt;let _ = Printexc.record_backtrace true&lt;/p&gt;&lt;p&gt;let () = OS.Main.run (join []) ```&lt;/p&gt;&lt;p&gt;This looks like the right general idea &amp;ndash; &lt;code&gt;OS.Main.run&lt;/code&gt; to invoke a thread, &lt;code&gt;join []&lt;/code&gt; (from &lt;code&gt;Lwt&lt;/code&gt;) to operate on an empty list of work to do. We have no work to do. It&amp;rsquo;s a nice day.&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://flic.kr/p/6qmZFm&quot;&gt;&lt;img src=&quot;http://www.somerandomidiot.com/images/nice_day_boat.jpg&quot; class=&quot;center&quot; title=&quot;&amp;lsquo;:)&amp;rsquo; &amp;lsquo;An unrigged sailboat in a lake on a sunny day.&amp;rsquo;&quot;/&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Unfortunately, we can&amp;rsquo;t accomplish our goal of doing nothing if we can&amp;rsquo;t do anything (in other words, we can&amp;rsquo;t run our zero threads if we have no idea how to run anything), so we&amp;rsquo;ll have to do a little more work first.&lt;/p&gt;&lt;p&gt;If we can figure out how to get &lt;code&gt;OS.Main.run&lt;/code&gt; included, we&amp;rsquo;ll be off to the races. Let&amp;rsquo;s have a look at the &lt;code&gt;Makefile&lt;/code&gt;, which is also programmatically generated by &lt;code&gt;mirage configure&lt;/code&gt; and shows which libraries the invocation of &lt;code&gt;make&lt;/code&gt; will link against.&lt;/p&gt;&lt;p&gt;&lt;code&gt; [] dothraki@iBook:~/trivial$ grep ^LIBS Makefile LIBS = -pkgs lwt.syntax,mirage-types.lwt &lt;/code&gt;&lt;/p&gt;&lt;p&gt;Mirage applications will always get &lt;a href=&quot;https://github.com/mirage/mirage/blob/85a2dc28567d69f4f70114fa8b037fe63d522a3b/lib/mirage.ml#L1586&quot;&gt;&lt;code&gt;mirage-types.lwt&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirage/mirage/blob/85a2dc28567d69f4f70114fa8b037fe63d522a3b/lib/mirage.ml#L1705&quot;&gt;&lt;code&gt;lwt.syntax&lt;/code&gt;&lt;/a&gt;, and might get more libraries included &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/04/23/verb-your-own-noun/&quot;&gt;if they&amp;rsquo;re requested in &lt;code&gt;config.ml&lt;/code&gt; or required by a driver requested there&lt;/a&gt;. Unfortunately, neither of these gets us &lt;code&gt;OS&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Some snooping on &lt;code&gt;utop&lt;/code&gt; with &lt;code&gt;strace&lt;/code&gt; reveals that an implementation for &lt;code&gt;OS&lt;/code&gt; lives in the &lt;code&gt;mirage-xen&lt;/code&gt; and &lt;code&gt;mirage-unix&lt;/code&gt; libraries. If we add &lt;code&gt;mirage-xen&lt;/code&gt; to &lt;code&gt;LIBS&lt;/code&gt; manually in the &lt;code&gt;Makefile&lt;/code&gt; (or &lt;code&gt;mirage-unix&lt;/code&gt;, if we generated the &lt;code&gt;Makefile&lt;/code&gt; with &lt;code&gt;mirage configure --unix&lt;/code&gt;) and then &lt;code&gt;make&lt;/code&gt;, we do get something runnable. But that&amp;rsquo;s not good enough! We don&amp;rsquo;t want to manually edit files that a computer could generate for us! That sounds like work, and that&amp;rsquo;s not what today is all about.&lt;/p&gt;&lt;p&gt;One possible solution is to do is write a few lines into our &lt;code&gt;config.ml&lt;/code&gt; to request that an appropriate library be included in &lt;code&gt;LIBS&lt;/code&gt;. We could ask for &lt;code&gt;mirage-unix&lt;/code&gt; directly, but that wouldn&amp;rsquo;t work when we want to do nothing in Xen, and &lt;code&gt;mirage-xen&lt;/code&gt; has the same problem when we want to do nothing in Unix. Every time we wanted to do nothing on a different platform, we&amp;rsquo;d have to change our &lt;code&gt;config.ml&lt;/code&gt;! No way.&lt;/p&gt;&lt;p&gt;Instead, let&amp;rsquo;s request a driver that imports the &lt;code&gt;OS&lt;/code&gt; interface. &lt;a href=&quot;https://github.com/mirage/mirage/blob/master/types/V2.mli&quot;&gt;Numerous drivers are available&lt;/a&gt;, but the simplest one is &lt;code&gt;CONSOLE&lt;/code&gt;, which provides basic text output on a screen. Let&amp;rsquo;s pick that one.&lt;/p&gt;&lt;p&gt;In order to use &lt;code&gt;CONSOLE&lt;/code&gt;, we&amp;rsquo;ll have to add some code to our &lt;code&gt;config.ml&lt;/code&gt;, disturbing its state of complete relaxation. Minimally, we need a call to &lt;code&gt;register&lt;/code&gt;, which is defined &lt;a href=&quot;https://github.com/mirage/mirage/blob/master/lib/mirage.mli#L335&quot;&gt;in &lt;code&gt;mirage.ml&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;&lt;p&gt;&lt;code&gt;ocaml val register: string -&amp;gt; job impl list -&amp;gt; unit (** [register name jobs] registers the application named by [name] which will executes the given [jobs]. *) &lt;/code&gt;&lt;/p&gt;&lt;p&gt;It appears we&amp;rsquo;ll have to define at least one &lt;code&gt;job impl&lt;/code&gt;, where we&amp;rsquo;ll do the hard work of defining doing nothing, then &lt;code&gt;register&lt;/code&gt; it with some name. Say, &lt;code&gt;out_to_lunch&lt;/code&gt;. Mirage expects us to define the job in another file, then tell &lt;code&gt;config.ml&lt;/code&gt; where to find it with &lt;code&gt;foreign&lt;/code&gt; &lt;a href=&quot;https://github.com/mirage/mirage/blob/master/lib/mirage.mli#L48&quot;&gt;(source)&lt;/a&gt;:&lt;/p&gt;&lt;p&gt;&lt;code&gt;ocaml val foreign: string -&amp;gt; ?libraries:string list -&amp;gt; ?packages:string list -&amp;gt; 'a typ -&amp;gt; 'a impl (** [foreign name libs packs constr typ] states that the module named by [name] has the module type [typ]. If [libs] is set, add the given set of ocamlfind libraries to the ones loaded by default. If [packages] is set, add the given set of OPAM packages to the ones loaded by default. *) &lt;/code&gt;&lt;/p&gt;&lt;p&gt;So we&amp;rsquo;ll have to make another file, say maybe &lt;code&gt;loaf.ml&lt;/code&gt;, with our top-secret and highly-valuable instructions for slacking off. (Before we get too high and mighty about all the instructions our project needs just to not do anything, remember that &lt;a href=&quot;http://www.worldcat.org/oclc/148665266&quot;&gt;sometimes humans need help with this too&lt;/a&gt;.) &lt;code&gt;loaf.ml&lt;/code&gt; needs to have at least one module specified that can take a &lt;code&gt;CONSOLE&lt;/code&gt; module argument; traditionally unikernels call this module &lt;code&gt;Main&lt;/code&gt;, but we can call it anything. Say, for example, &lt;code&gt;Relax&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Modules in OCaml can&amp;rsquo;t be completely empty, and we&amp;rsquo;ll need a &lt;code&gt;start&lt;/code&gt; function for the program to link, so we&amp;rsquo;ll just get all that hard work out of the way and define it right now. Since Mirage will want to pass information on how to use the specific instance of a console to the program, &lt;code&gt;start&lt;/code&gt; will have to accept an argument of type &lt;code&gt;console_impl&lt;/code&gt;. Luckily, there&amp;rsquo;s no requirement that we actually do anything of consequence in there, so we can finally define what it means to do nothing &amp;ndash; &lt;code&gt;Lwt.return ()&lt;/code&gt;. A full explanation of Lwt is outside the scope of our laziness today, but there is great documentation both through &lt;a href=&quot;http://www.openmirage.org/wiki/tutorial-lwt&quot;&gt;the Mirage website&lt;/a&gt; and at &lt;a href=&quot;http://ocsigen.org/lwt/2.4.3/manual/&quot;&gt;the Ocsigen site for Lwt&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;```ocaml module Relax (C: V1_LWT.CONSOLE) = struct let start console =&lt;/p&gt;&lt;pre&gt;&lt;code&gt;  Lwt.return ()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; end ```&lt;/p&gt;&lt;p&gt;We define &lt;code&gt;Relax&lt;/code&gt; as a module parameterized by a &lt;code&gt;V1_LWT.CONSOLE&lt;/code&gt; module (which we have no plan to use, but &lt;code&gt;config.ml&lt;/code&gt; won&amp;rsquo;t be able to make a sensible program for us unless we&amp;rsquo;re ready to accept it). &lt;code&gt;start&lt;/code&gt; takes a &lt;code&gt;console&lt;/code&gt; argument representing a particular implementation of a console. If we had any plans to output anything, we&amp;rsquo;d do it by calling a function with &lt;code&gt;console&lt;/code&gt; as an argument, but we&amp;rsquo;re not going to do that. We&amp;rsquo;re just going to relax today.&lt;/p&gt;&lt;p&gt;Now that we know how to relax, we can point &lt;code&gt;config.ml&lt;/code&gt; at this code with &lt;code&gt;foreign&lt;/code&gt;, so that we&amp;rsquo;ll eventually be able to &lt;code&gt;register&lt;/code&gt; it. The code we want to run is in the file &lt;code&gt;loaf.ml&lt;/code&gt;, in a module called &lt;code&gt;Relax&lt;/code&gt;, so our first argument to &lt;code&gt;foreign&lt;/code&gt; will be &lt;code&gt;&amp;quot;Loaf.Relax&amp;quot;&lt;/code&gt;. (This works so simply because &lt;code&gt;config.ml&lt;/code&gt; and &lt;code&gt;loaf.ml&lt;/code&gt; are in the same directory &amp;ndash; if you structure things differently, you&amp;rsquo;ll have to work harder, so I recommend against it.)&lt;/p&gt;&lt;p&gt;Our second argument to &lt;code&gt;foreign&lt;/code&gt;, according to the type signature, should be a &lt;code&gt;'a typ&lt;/code&gt;, and if we do so, the function will return a &lt;code&gt;'a impl&lt;/code&gt;. In order to call &lt;code&gt;register&lt;/code&gt;, we need at least one &lt;code&gt;job impl&lt;/code&gt; to put in the list, so we need to somehow make &lt;code&gt;'a&lt;/code&gt; be &lt;code&gt;job&lt;/code&gt; in our call to &lt;code&gt;foreign&lt;/code&gt;. Mirage provides a &lt;code&gt;job impl&lt;/code&gt; called, simply, &lt;code&gt;job&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;We can&amp;rsquo;t just pass the results of &lt;code&gt;foreign &amp;quot;Loaf.Relax&amp;quot; job&lt;/code&gt; off to &lt;code&gt;register&lt;/code&gt;, though, because if we do that, &lt;code&gt;mirage configure&lt;/code&gt; won&amp;rsquo;t know that we wanted a console, and we&amp;rsquo;ll still have no libraries that know about &lt;code&gt;OS.Main.run&lt;/code&gt; in our &lt;code&gt;Makefile&lt;/code&gt;. What we really need is a &lt;code&gt;(console -&amp;gt; job) typ&lt;/code&gt;, so we can get a &lt;code&gt;(console -&amp;gt; job) impl&lt;/code&gt;, and then pass it a &lt;code&gt;console impl&lt;/code&gt; to get a &lt;code&gt;job impl&lt;/code&gt; out.&lt;/p&gt;&lt;p&gt;Mirage provides two combinators for making this work &amp;ndash; &lt;code&gt;@-&amp;gt;&lt;/code&gt; for composing a &lt;code&gt;'a typ&lt;/code&gt; and &lt;code&gt;'b typ&lt;/code&gt; into a &lt;code&gt;('a -&amp;gt; 'b) typ&lt;/code&gt;, and a combinator &lt;code&gt;$&lt;/code&gt; for applying a &lt;code&gt;('a -&amp;gt; 'b) impl&lt;/code&gt; to a &lt;code&gt;'a impl&lt;/code&gt; and getting a &lt;code&gt;'b impl&lt;/code&gt; back. We can use &lt;code&gt;foreign &amp;quot;Loaf.Relax&amp;quot; (console @-&amp;gt; job)&lt;/code&gt; to get a &lt;code&gt;(console -&amp;gt; job) typ&lt;/code&gt;, let-bind this value to a variable (say, &lt;code&gt;relax&lt;/code&gt;), and use this along with a Mirage-provided &lt;code&gt;console impl&lt;/code&gt; as an argument to &lt;code&gt;register&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;```ocaml open Mirage&lt;/p&gt;&lt;p&gt;let () = &lt;br/&gt; let relax = foreign &amp;ldquo;Loaf.Relax&amp;rdquo; (console @&amp;ndash;&amp;gt; job) in &lt;br/&gt; register &amp;ldquo;out_to_lunch&amp;rdquo; [ relax $ default_console ] ```&lt;/p&gt;&lt;p&gt;A &lt;code&gt;mirage configure --xen&lt;/code&gt; and &lt;code&gt;make&lt;/code&gt; get us a small, very lazy unikernel named &lt;code&gt;mir-out_to_lunch.xen&lt;/code&gt; and an automatically generated configuration file for Xen named &lt;code&gt;out_to_lunch.xl&lt;/code&gt;. (Both names are taken from the string we pass as the first argument to &lt;code&gt;register&lt;/code&gt;.) If we start it up this unikernel with &lt;code&gt;sudo xm create -c out_to_lunch.xl&lt;/code&gt;, we get the following (somewhat disappointing) output:&lt;/p&gt;&lt;p&gt;&lt;code&gt; [] dothraki@iBook:~/trivial$ sudo xm create -c out_to_lunch.xl [sudo] password for dothraki: Using config file &amp;quot;./out_to_lunch.xl&amp;quot;. Started domain out_to_lunch (id=2) Domain has already finished Could not start console &lt;/code&gt;&lt;/p&gt;&lt;p&gt;Our unikernel finishes so quickly that Xen can&amp;rsquo;t attach a console to it. If we start it paused and then unpause it after our console attaches, we can watch it boot:&lt;/p&gt;&lt;p&gt;&lt;code&gt; [] dothraki@iBook:~/trivial$ sudo xm create -c out_to_lunch.xl -p Using config file &amp;quot;./out_to_lunch.xl&amp;quot;. Started domain out_to_lunch (id=3) &lt;/code&gt;&lt;/p&gt;&lt;p&gt;and, in another window, &lt;code&gt;sudo xm unpause out_to_lunch&lt;/code&gt;, to let &lt;code&gt;out_to_lunch&lt;/code&gt; start booting. We then see the output sent to the console by Mirage as it&amp;rsquo;s booting, before control is handed over to our user program &amp;ndash; in this case, &lt;code&gt;return ()&lt;/code&gt;, which executes immediately, returns from the main program, and informs Xen that the virtual machine is shutting down.&lt;/p&gt;&lt;p&gt;&lt;code&gt; Started domain out_to_lunch (id=3) kernel.c: Mirage OS! kernel.c: start_info: 0x11c1000(VA) kernel.c: nr_pages: 0x10000 ... x86_mm.c: Demand map pfns at 10001000-2010001000. Initialising timer interface main returned 0 [] dothraki@iBook:~/trivial$ &lt;/code&gt;&lt;/p&gt;&lt;h3&gt;Doing Nothing with Different Drivers&lt;/h3&gt;&lt;p&gt;We&amp;rsquo;ve succesfully done nothing with this simple &lt;code&gt;config.ml&lt;/code&gt;:&lt;/p&gt;&lt;p&gt;```ocaml open Mirage&lt;/p&gt;&lt;p&gt;let () = let relax = foreign &amp;ldquo;Loaf.Relax&amp;rdquo; (console @&amp;ndash;&amp;gt; job) in register &amp;ldquo;out_to_lunch&amp;rdquo; [ relax $ default_console ] ```&lt;/p&gt;&lt;p&gt;What if we want to do nothing over the network? Or do nothing with a filesystem? Or do nothing with all of these things?&lt;/p&gt;&lt;p&gt;Including support for a driver requires us to have two things: a &lt;code&gt;typ&lt;/code&gt; representation to include in the arguments to &lt;code&gt;foreign&lt;/code&gt;, and an &lt;code&gt;impl&lt;/code&gt; to include in the list of arguments to &lt;code&gt;register&lt;/code&gt;. The available &lt;code&gt;typ&lt;/code&gt;s and &lt;code&gt;impl&lt;/code&gt;s are defined in &lt;code&gt;mirage.mli&lt;/code&gt;; some &lt;code&gt;typ&lt;/code&gt;s have more than one corresponding &lt;code&gt;impl&lt;/code&gt;, or have parameterized constructors for &lt;code&gt;impl&lt;/code&gt;s.&lt;/p&gt;&lt;p&gt;For example, there are two ways to get a &lt;code&gt;network impl&lt;/code&gt;, the &lt;code&gt;impl&lt;/code&gt; representing raw device-level access to a network card:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;val tap0: network impl&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;val netif: string -&amp;gt; network impl&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;tap0&lt;/code&gt; just returns the first available network interface; &lt;code&gt;netif&lt;/code&gt; takes a string argument and attempts to find a matching network interface, then makes that interface available in the returned value. The same &lt;code&gt;network typ&lt;/code&gt; applies for both:&lt;/p&gt;&lt;p&gt;``` open Mirage&lt;/p&gt;&lt;p&gt;let () = let relax = foreign &amp;ldquo;Loaf.Relax&amp;rdquo; (network @&amp;ndash;&amp;gt; network @&amp;ndash;&amp;gt; job) in register &amp;ldquo;out_to_lunch&amp;rdquo; [ relax $ tap0 $ netif &amp;ldquo;1&amp;rdquo; ] ```&lt;/p&gt;&lt;p&gt;This &lt;code&gt;config.ml&lt;/code&gt; will build against a &lt;code&gt;loaf.ml&lt;/code&gt; that has a &lt;code&gt;Relax&lt;/code&gt; module parameterized by two &lt;code&gt;V1_LWT.NETWORK&lt;/code&gt; modules, and a &lt;code&gt;start&lt;/code&gt; function that expects two &lt;code&gt;network impl&lt;/code&gt; arguments:&lt;/p&gt;&lt;p&gt;``` module Relax (IGNORED: V1_LWT.NETWORK) (ALSO_IGNORED: V1_LWT.NETWORK) = struct let start default string_parameterized =&lt;/p&gt;&lt;pre&gt;&lt;code&gt;Lwt.return ()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;end ```&lt;/p&gt;&lt;p&gt;(To actually run this in Xen, we need to make &lt;a href=&quot;http://wiki.xen.org/wiki/Xen_Networking#Attaching_virtual_devices_to_the_appropriate_bridge&quot;&gt;a couple alterations&lt;/a&gt; to the autogenerated &lt;code&gt;out_to_lunch.xl&lt;/code&gt; so that two network interfaces are actually provided, but this can be done once and saved off somewhere so as not to be overwritten by subsequent rebuilds.)&lt;/p&gt;&lt;p&gt;We can do nothing with multiple kinds of drivers, too:&lt;/p&gt;&lt;p&gt;``` open Mirage&lt;/p&gt;&lt;p&gt;let () = &lt;br/&gt; let relax = foreign &amp;ldquo;Loaf.Relax&amp;rdquo; (network @&amp;ndash;&amp;gt; console @&amp;ndash;&amp;gt; job) in &lt;br/&gt; register &amp;ldquo;out_to_lunch&amp;rdquo; [ relax $ tap0 $ default_console ] &lt;br/&gt; ```&lt;/p&gt;&lt;p&gt;If we modify &lt;code&gt;loaf.ml&lt;/code&gt; have a &lt;code&gt;Relax&lt;/code&gt; module parameterized by a &lt;code&gt;V1_LWT.NETWORK&lt;/code&gt; and &lt;code&gt;V1_LWT.CONSOLE&lt;/code&gt;, and provide a &lt;code&gt;start&lt;/code&gt; with &lt;code&gt;network impl&lt;/code&gt; and &lt;code&gt;console impl&lt;/code&gt; parameters, we&amp;rsquo;re off to the races.&lt;/p&gt;&lt;h3&gt;For The Ambitious&lt;/h3&gt;&lt;p&gt;The &lt;code&gt;start&lt;/code&gt; function in &lt;code&gt;Loaf.Relax&lt;/code&gt; can do more than just immediately return, of course. Programmers with ambition, gumption, and Tasks To Accomplish can define programs that Get Things Done, and launch them from &lt;code&gt;start&lt;/code&gt;. Programs that plan to use, say, a network interface, can call functions provided by &lt;code&gt;V1_LWT.NETWORK&lt;/code&gt; on the &lt;code&gt;network impl&lt;/code&gt; provided to &lt;code&gt;start&lt;/code&gt; to generate and receive network traffic; console programs can write to their provided &lt;code&gt;console impl&lt;/code&gt;. &lt;a href=&quot;http://www.openmirage.org/wiki/hello-world&quot;&gt;The &amp;ldquo;Hello Mirage World&amp;rdquo; tutorial&lt;/a&gt; gives great examples and instructions for making things happen &amp;ndash; perfect for a rainy day.&lt;/p&gt;&lt;p&gt;Today&amp;rsquo;s more of a &lt;code&gt;return ()&lt;/code&gt; type of day, though.&lt;/p&gt; </content><id>http://www.somerandomidiot.com/blog/2014/07/25/doing-nothing-in-mirage/</id><title type="text">Doing Nothing in Mirage</title><updated>2014-07-25T20:30:49+00:00</updated><author><email></email><name>Mindy Preston</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2014/07/24/compiler-hacking-at-citrix" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;p&gt;For the seventh Cambridge OCaml compiler-hacking session we'll be meeting at &lt;a href=&quot;https://maps.google.co.uk/maps?q=101%20Cambridge%20Science%20Park%20Milton%20Road,%20Cambridge&amp;amp;hl=en&amp;amp;ll=52.232955,0.150338&amp;amp;spn=0.003082,0.006947&amp;amp;sll=52.231717,0.144648&amp;amp;sspn=0.012327,0.027788&amp;amp;oq=101Cambrideg%20Science&amp;amp;t=h&amp;amp;hq=101%20Cambridge%20Science%20Park%20Milton%20Road,&amp;amp;hnear=Cambridge,%20United%20Kingdom&amp;amp;z=18&quot;&gt;the Citrix office in the Cambridge Science Park&lt;/a&gt; on 6.30pm Friday 1st August.  Thanks to Citrix for supporting and hosting the session!&lt;/p&gt;

&lt;p&gt;We'll kick off with a demo from &lt;a href=&quot;https://github.com/def-lkb&quot;&gt;Fr&amp;eacute;d&amp;eacute;ric Bour&lt;/a&gt; of modular implicits, an OCaml extension that adds support for overloading.&lt;/p&gt;

&lt;p&gt;If you're planning to come along, it'd be helpful if you could &lt;a href=&quot;http://doodle.com/46f2bnk4xny724in&quot;&gt;&lt;strong&gt;indicate interest via Doodle&lt;/strong&gt;&lt;/a&gt; and &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;sign up to the mailing list&lt;/a&gt; to receive updates:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Where&lt;/strong&gt;:
  Citrix Systems Research &amp;amp; Development Ltd.&lt;br/&gt;
  &lt;a href=&quot;https://maps.google.co.uk/maps?q=101%20Cambridge%20Science%20Park%20Milton%20Road,%20Cambridge&amp;amp;hl=en&amp;amp;ll=52.232955,0.150338&amp;amp;spn=0.003082,0.006947&amp;amp;sll=52.231717,0.144648&amp;amp;sspn=0.012327,0.027788&amp;amp;oq=101Cambrideg%20Science&amp;amp;t=h&amp;amp;hq=101%20Cambridge%20Science%20Park%20Milton%20Road,&amp;amp;hnear=Cambridge,%20United%20Kingdom&amp;amp;z=18&quot;&gt;Building 101&lt;/a&gt;&lt;br/&gt;
  Cambridge Science Park&lt;br/&gt;
  Milton Road&lt;br/&gt;
  Cambridge, CB4 0FY&lt;br/&gt;
  United Kingdom  &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;When&lt;/strong&gt;: 6.30pm, Friday 1st August&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Who&lt;/strong&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;What&lt;/strong&gt;: fixing bugs, implementing new features, learning about OCaml internals&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Wiki&lt;/strong&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience (see also some &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;things we've worked on in previous sessions&lt;/a&gt;), but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll also be ordering pizza, so if you want to be counted for food you should aim to arrive by 6.45pm.&lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2014/07/24/compiler-hacking-at-citrix</id><title type="text">Seventh OCaml compiler hacking session (at Citrix)</title><updated>2014-07-24T11:00:00+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://openmirage.org/blog/announcing-mirage-20-release" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;small&gt;
 This work funded in part by the EU FP7 User-Centric Networking project, Grant
 No. 611001.
&lt;/small&gt;&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;http://openmirage.org/blog/announcing-mirage10&quot;&gt;first release&lt;/a&gt; of Mirage back in December 2013 introduced the prototype
of the &lt;a href=&quot;http://queue.acm.org/detail.cfm?id=2566628&quot;&gt;unikernel concept&lt;/a&gt;, which realised the promise of a safe,
flexible mechanism to build highly optimized software stacks purpose-built for deployment in the public cloud (more &lt;a href=&quot;http://openmirage.org/wiki/overview-of-mirage&quot;&gt;background&lt;/a&gt; on this).
Since then, we've been hard at work using and extending Mirage for real projects and the community has been
&lt;a href=&quot;http://openmirage.org/blog/welcome-to-our-summer-hackers&quot;&gt;steadily growing&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We're thrilled to announce the release of Mirage OS v2.0 today!  Over the past
few weeks the &lt;a href=&quot;http://openmirage.org/community&quot;&gt;team&lt;/a&gt; has been &lt;a href=&quot;https://github.com/mirage/mirage/issues/257&quot;&gt;hard at work&lt;/a&gt; blogging about all
the new features in this latest release, coordinated by the tireless &lt;a href=&quot;http://amirchaudhry.com&quot;&gt;Amir Chaudhry&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openmirage.org/graphics/cubieboard2.jpg&quot; width=&quot;250px&quot; style=&quot;float:right; padding: 5px&quot;/&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;ARM device support&lt;/strong&gt;: While the first version of Mirage was specialised towards conventional x86 clouds, the code generation and boot libraries have now been made portable enough to operate on low-power embedded ARM devices such as the &lt;a href=&quot;http://cubieboard.org/&quot;&gt;Cubieboard 2&lt;/a&gt;.  This is a key part of our efforts to build a safe, unified &lt;a href=&quot;http://anil.recoil.org/papers/2010-bcs-visions.pdf&quot;&gt;mutiscale programming model&lt;/a&gt; for both cloud and mobile workloads as part of the &lt;a href=&quot;http://nymote.org&quot;&gt;Nymote&lt;/a&gt; project.  We also upstreamed the changes required to the Xen Project so that other unikernel efforts such as &lt;a href=&quot;https://github.com/GaloisInc/HaLVM&quot;&gt;HalVM&lt;/a&gt; or &lt;a href=&quot;https://www.usenix.org/system/files/conference/nsdi14/nsdi14-paper-martins.pdf&quot;&gt;ClickOS&lt;/a&gt; can benefit.&lt;ul&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-xen-minios-arm&quot;&gt;Introducing an ARMy of unikernels&lt;/a&gt;&amp;quot;&lt;/em&gt; by &lt;a href=&quot;http://roscidus.com/blog/&quot;&gt;Thomas Leonard&lt;/a&gt; talks about the changes required and &lt;a href=&quot;http://openmirage.org/wiki/xen-on-cubieboard2&quot;&gt;instructions&lt;/a&gt; for trying this out for yourself on your own cheap Cubieboard.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Irmin distributed, branchable storage&lt;/strong&gt;: Unikernels usually execute in a distributed, disconnection-prone environment (particularly with the new mobile ARM support).  We therefore built the &lt;a href=&quot;https://github.com/mirage/irmin&quot;&gt;Irmin&lt;/a&gt; library to explicitly make synchronization easier via a Git-like persistence model that can be used to build and easily trace the operation of distributed applications across all of these diverse environments.&lt;ul&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-irmin&quot;&gt;Introducing Irmin: Git-like distributed, branchable storage&lt;/a&gt;&amp;quot;&lt;/em&gt; by &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; describes the concepts and high-level architecture of the system.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-irmin-in-xenstore&quot;&gt;Using Irmin to add fault-tolerance to the Xenstore database&lt;/a&gt;&amp;quot;&lt;/em&gt; by &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; shows how Irmin is used in a real-world application: the security-critical Xen toolstack that manages hosts full of virtual machines (&lt;a href=&quot;https://www.youtube.com/watch?v=DSzvFwIVm5s&quot;&gt;video&lt;/a&gt;).&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;OCaml TLS&lt;/strong&gt;: The philosophy of Mirage is to construct the entire operating system in a safe programming style, from the device drivers up.  This continues in this release with a comprehensive OCaml implementation of &lt;a href=&quot;https://en.wikipedia.org/wiki/Transport_Layer_Security&quot;&gt;Transport Level Security&lt;/a&gt;, the most widely deployed end-to-end encryption protocol on the Internet (and one that is very prone to &lt;a href=&quot;https://en.wikipedia.org/wiki/Heartbleed&quot;&gt;bad security holes&lt;/a&gt;).  The blog series is written by &lt;a href=&quot;https://github.com/hannesm&quot;&gt;Hannes Mehnert&lt;/a&gt; and &lt;a href=&quot;https://github.com/pqwy&quot;&gt;David Kaloper&lt;/a&gt;.&lt;ul&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;OCaml-TLS: Introducing transport layer security (TLS) in pure OCaml&lt;/a&gt;&amp;quot;&lt;/em&gt; presents the motivation and architecture behind our clean-slate implementation of the protocol.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;OCaml-TLS: building the nocrypto library core&lt;/a&gt;&amp;quot;&lt;/em&gt; talks about the cryptographic primitives that form the heart of TLS confidentiality guarantees, and how they expose safe interfaces to the rest of the stack.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;OCaml-TLS: adventures in X.509 certificate parsing and validation&lt;/a&gt;&amp;quot;&lt;/em&gt; explains how authentication and chain-of-trust verification is implemented in our stack.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/introducing-asn1&quot;&gt;OCaml-TLS: ASN.1 and notation embedding&lt;/a&gt;&amp;quot;&lt;/em&gt; introduces the libraries needed for handling ASN.1 grammars, the wire representation of messages in TLS.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation&quot;&gt;OCaml-TLS: the protocol implementation and mitigations to known attacks&lt;/a&gt;&amp;quot;&lt;/em&gt; concludes with the implementation of the core TLS protocol logic itself.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Modularity and communication&lt;/strong&gt;: Mirage is built on the concept of a &lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;library operating system&lt;/a&gt;, and this release provides many new libraries to flexibly extend applications with new functionality.&lt;ul&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/intro-tcpip&quot;&gt;Fitting the modular Mirage TCP/IP stack together&lt;/a&gt;&amp;quot;&lt;/em&gt; by &lt;a href=&quot;http://somerandomidiot.com&quot;&gt;Mindy Preston&lt;/a&gt; explains the rather unique modular architecture of our TCP/IP stack that lets you swap between the conventional Unix sockets API, or a complete implementation of TCP/IP in pure OCaml.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/update-on-vchan&quot;&gt;Vchan: low-latency inter-VM communication channels&lt;/a&gt;&amp;quot;&lt;/em&gt; by &lt;a href=&quot;http://jon.recoil.org&quot;&gt;Jon Ludlam&lt;/a&gt; shows how unikernels can communicate efficiently with each other to form distributed clusters on a multicore Xen host, by establishing shared memory rings with each other.&lt;/li&gt;&lt;li&gt;&lt;em&gt;&amp;quot;&lt;a href=&quot;http://openmirage.org/blog/modular-foreign-function-bindings&quot;&gt;Modular foreign function bindings&lt;/a&gt;&amp;quot;&lt;/em&gt; by &lt;a href=&quot;https://github.com/yallop&quot;&gt;Jeremy Yallop&lt;/a&gt; continues the march towards abstraction by expaining how to interface safely with code written in C, without having to write any unsafe C bindings!  This forms the basis for allowing Xen unikernels to communicate with existing libraries that they may want to keep at arm's length for security reasons.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;All the libraries required for these new features are &lt;a href=&quot;http://openmirage.org/releases&quot;&gt;regularly
released&lt;/a&gt; into the &lt;a href=&quot;http://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt; package manager, so
just follow the &lt;a href=&quot;http://openmirage.org/wiki/install&quot;&gt;installation instructions&lt;/a&gt; to give them a spin.
A release this size probably introduces minor hiccups that may cause build
failures, so we very much encourage &lt;a href=&quot;https://github.com/mirage/mirage/issues&quot;&gt;bug
reports&lt;/a&gt; on our issue tracker or
&lt;a href=&quot;http://openmirage.org/community&quot;&gt;questions&lt;/a&gt; to our mailing lists.  Don't be shy: no question is too
basic, and we'd love to hear of any weird and wacky uses you put this new
release to!  And finally, the lifeblood of Mirage is about sharing and
&lt;a href=&quot;http://opam.ocaml.org/doc/Packaging.html&quot;&gt;publishing libraries&lt;/a&gt; that add new functionality to the framework, so do get
involved and open-source your own efforts.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Breaking news&lt;/em&gt;: &lt;a href=&quot;http://mort.io&quot;&gt;Richard Mortier&lt;/a&gt; and I will be speaking at &lt;a href=&quot;http://www.oscon.com&quot;&gt;OSCON&lt;/a&gt; this week on Thursday morning about the new features &lt;a href=&quot;http://www.oscon.com/oscon2014/public/schedule/detail/35024&quot;&gt;in F150 in the Cloud Track&lt;/a&gt;. Come along if you are in rainy Portland at the moment!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/announcing-mirage-20-release</id><title type="text">Mirage v2.0: a recap of the new features</title><updated>2014-07-22T11:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://openmirage.org/blog/introducing-xen-minios-arm" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;Mirage has just gained the ability to compile unikernels for the Xen/arm32
platform, allowing Mirage guests to run under the Xen hypervisor on ARM
devices such as the &lt;a href=&quot;http://cubietruck.com/collections/frontpage/products/cubieboard2-allwinner-a20-arm-cortex-a7-dual-core-development-board&quot;&gt;Cubieboard 2&lt;/a&gt; and &lt;a href=&quot;http://cubietruck.com/collections/frontpage/products/cubietruck-cubieboard3-cortex-a7-dual-core-2gb-ram-8gb-flash-with-wifi-bt&quot;&gt;CubieTruck&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Introduction&lt;/h3&gt;

&lt;p&gt;The ARMv7 architecture introduced the (optional) Virtualization Extensions,
providing hardware support for running virtual machines on ARM devices, and
Xen's &lt;a href=&quot;http://www.xenproject.org/developers/teams/arm-hypervisor.html&quot;&gt;ARM Hypervisor&lt;/a&gt; uses this to support hardware accelerated
ARM guests.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://wiki.xen.org/wiki/Mini-OS&quot;&gt;Mini-OS&lt;/a&gt; is a tiny OS kernel designed specifically for running under Xen.
It provides code to initialise the CPU, display messages on the console,
allocate memory (malloc), and not much else. It is used as the low-level
core of Mirage's Xen implementation.&lt;/p&gt;
&lt;p&gt;Mirage v1 was built on an old version of Mini-OS which didn't support ARM.
For Mirage v2, we have added ARM support to the current Mini-OS (completing
Karim Allah Ahmed's &lt;a href=&quot;http://lists.xen.org/archives/html/xen-devel/2014-01/msg00249.html&quot;&gt;initial ARM port&lt;/a&gt;) and made Mirage depend
on it as an external library.
This means that Mirage will automatically gain support for other
architectures that get added later.
We are currently working with the Xen developers to get
&lt;a href=&quot;https://github.com/talex5/xen&quot;&gt;our Mini-OS fork&lt;/a&gt; upstreamed.&lt;/p&gt;
&lt;p&gt;In a similar way, we have replaced Mirage v1's bundled maths library with a
dependency on the external
&lt;a href=&quot;https://github.com/JuliaLang/openlibm&quot;&gt;OpenLibm&lt;/a&gt;, which we also extended
with ARM support (this was just a case of fixing the build system; the code
is from FreeBSD's libm, which already supported ARM).&lt;/p&gt;
&lt;p&gt;Mirage v1 also bundled &lt;a href=&quot;http://www.fefe.de/dietlibc/&quot;&gt;dietlibc&lt;/a&gt; to provide its standard C library.
A nice side-effect of this work came when we were trying to separate out the
dietlibc headers from the old Mini-OS headers in Mirage.
These had rather grown together over time and the work was proving
difficult, until we discovered that we no longer needed a libc at all, as
almost everything that used it had been replaced with pure OCaml versions!
The only exception was the &lt;code&gt;printf&lt;/code&gt; code for formatting floating point
numbers, which OCaml uses in its &lt;code&gt;printf&lt;/code&gt; implementation.
We replaced that by taking the small &lt;code&gt;fmt_fp&lt;/code&gt; function from
&lt;a href=&quot;http://www.musl-libc.org/&quot;&gt;musl libc&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here's the final diffstat of the changes to &lt;a href=&quot;https://github.com/mirage/mirage-platform&quot;&gt;mirage-platform&lt;/a&gt;
adding ARM support:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;778 files changed, 1949 insertions(+), 59689 deletions(-)&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Trying it out&lt;/h3&gt;

&lt;p&gt;You'll need an ARM device with the Virtualization Extensions.
I've been testing using the Cubieboard 2 (and CubieTruck):&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openmirage.org/graphics/cubieboard2.jpg&quot; alt=&quot;Cubieboard2&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The first step is to install Xen.
&lt;a href=&quot;http://openmirage.org/wiki/xen-on-cubieboard2&quot;&gt;Running Xen on the Cubieboard2&lt;/a&gt;
documents the manual installation process, but you can now also use
&lt;a href=&quot;https://github.com/mirage/xen-arm-builder&quot;&gt;mirage/xen-arm-builder&lt;/a&gt; to build
an SDcard image automatically.
Copy the image to the SDcard, connect the network cable and power, and the
board will boot Xen.&lt;/p&gt;
&lt;p&gt;Once booted you can ssh to Dom0, the privileged Linux domain used to manage
the system, &lt;a href=&quot;http://openmirage.org/wiki/install&quot;&gt;install Mirage&lt;/a&gt;, and build your unikernel just
as on x86.
Currently, you need to select the Git versions of some components.
The following commands will install the necessary versions if you're using
the xen-arm-builder image:&lt;/p&gt;
&lt;pre class=&quot;bash&quot;&gt;&lt;code class=&quot;bash&quot;&gt;$ opam init
$ opam install mirage-xen-minios
$ opam remote add mirage-dev git://github.com/mirage/mirage-dev
$ opam install mirage&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Technical details&lt;/h3&gt;

&lt;p&gt;One of the pleasures of unikernels is that you can comprehend the whole
system with relatively little effort, and
those wishing to understand, debug or contribute to the ARM support may find
the following technical sections interesting.
However, you don't need to know the details of the ARM port to use it,
as Mirage abstracts away the details of the underlying platform.&lt;/p&gt;
&lt;h4&gt;The boot process&lt;/h4&gt;

&lt;p&gt;An ARM Mirage unikernel uses the &lt;a href=&quot;http://www.simtec.co.uk/products/SWLINUX/files/booting_article.html&quot;&gt;Linux zImage format&lt;/a&gt;, though it is
not actually compressed. Xen will allocate some RAM for the image and load
the kernel at the offset 0x8000 (32 KB).&lt;/p&gt;
&lt;p&gt;Execution begins in &lt;a href=&quot;https://github.com/talex5/xen/blob/cde4b7e14b0aeedcdc006b0622905b7af2665c77/extras/mini-os/arch/arm/arm32.S#L8&quot;&gt;arm32.S&lt;/a&gt;, with the &lt;code&gt;r2&lt;/code&gt; register pointing to a
&lt;a href=&quot;http://www.devicetree.org&quot;&gt;Flattened Device Tree (FDT)&lt;/a&gt; describing details of the virtual system.
This assembler code performs a few basic boot tasks:&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;Configuring the MMU, which maps virtual addresses to physical addresses (see next section).&lt;/li&gt;&lt;li&gt;Turning on caching and branch prediction.&lt;/li&gt;&lt;li&gt;Setting up the exception vector table (this says how to handle interrupts and deal with various faults, such as reading from an invalid address).&lt;/li&gt;&lt;li&gt;Setting up the stack pointer and calling the C function &lt;code&gt;arch_init&lt;/code&gt;.&lt;/li&gt;&lt;/ol&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/talex5/xen/blob/cde4b7e14b0aeedcdc006b0622905b7af2665c77/extras/mini-os/arch/arm/setup.c#L74&quot;&gt;arch_init&lt;/a&gt; makes some calls to the hypervisor to set up support for the console and interrupt controller, and then calls &lt;code&gt;start_kernel&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/mirage/mirage-platform/blob/b0a027d4486230ce6e1e8fd0e7354b17e9c388f5/xen/runtime/xencaml/main.c#L57&quot;&gt;start_kernel&lt;/a&gt; (in libxencaml) sets up a few more features (events, malloc, time-keeping and &lt;a href=&quot;http://wiki.xen.org/wiki/Grant_Table&quot;&gt;grant tables&lt;/a&gt;), then calls &lt;code&gt;caml_startup&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/mirage/mirage-platform/blob/b0a027d4486230ce6e1e8fd0e7354b17e9c388f5/xen/runtime/ocaml/startup.c#L202&quot;&gt;caml_startup&lt;/a&gt; (in libocaml) initialises the garbage collector and calls &lt;code&gt;caml_program&lt;/code&gt;, which is your application's &lt;code&gt;main.ml&lt;/code&gt;.&lt;/p&gt;
&lt;h4&gt;The address space&lt;/h4&gt;

&lt;p&gt;With the Virtualization Extensions, there are two stages to converting a
virtual memory address (used by application code) to a physical address in
RAM.
The first stage is under the control of the guest VM, mapping the virtual
address to what the guest believes is the physical address (this address is
referred to as the &lt;em&gt;Intermediate Physical Address&lt;/em&gt; or &lt;em&gt;IPA&lt;/em&gt;).
The second stage, under the control of Xen, maps the IPA to the real
physical address.
The tables holding these mappings are called &lt;em&gt;translation tables&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Mirage's memory needs are simple: most of the RAM should be used for the
garbage-collected OCaml heap, with a few pages used for interacting with Xen
(these don't go on the OCaml heap because they must be page aligned and must
not move around).&lt;/p&gt;
&lt;p&gt;Xen does not commit to using a fixed address as the IPA of the RAM, but the
C code needs to run from a known location. To solve this problem the
assembler code in &lt;code&gt;arm32.S&lt;/code&gt; detects where it is running from and sets up a
virtual-to-physical mapping that will make it appear at the expected
location, by adding a fixed offset to each virtual address.
For example, on Xen/unstable, we configure the beginning of the virtual
address space to look like this (on Xen 4.4, the physical addresses would
start at 80000000 instead):&lt;/p&gt;
&lt;table&gt;
  &lt;tr&gt;&lt;th&gt;Virtual address&lt;/th&gt;&lt;th&gt;Physical address (IPA)&lt;/th&gt;&lt;th&gt;Purpose&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;400000&lt;/td&gt;&lt;td&gt;40000000&lt;/td&gt;&lt;td&gt;Stack (16 KB)&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;404000&lt;/td&gt;&lt;td&gt;40004000&lt;/td&gt;&lt;td&gt;Translation tables (16 KB)&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;408000&lt;/td&gt;&lt;td&gt;40008000&lt;/td&gt;&lt;td&gt;Kernel image&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;The physical address is always at a fixed offset from the virtual address and
the addresses wrap around, so virtual address c0400000 maps back to physical
address 0 (in this example).&lt;/p&gt;
&lt;p&gt;The stack, which grows downwards, is placed at the start of RAM so that a
stack overflow will trigger a fault rather than overwriting other data.&lt;/p&gt;
&lt;p&gt;The 16 KB translation table is an array of 4-byte entries each mapping 1 MB
of the virtual address space, so the 16 KB table is able to map the entire
32-bit address space (4 GB). Each entry can either give the physical section
address directly (which is what we do) or point to a second-level table
mapping individual 4 KB pages. By using only the top-level table we reduce
possible delays due to &lt;a href=&quot;http://en.wikipedia.org/wiki/Translation_lookaside_buffer&quot;&gt;TLB misses&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;After the kernel code comes the data (constants and global variables), then
the &lt;a href=&quot;http://en.wikipedia.org/wiki/.bss&quot;&gt;bss&lt;/a&gt; section (data that is initially
zero, and therefore doesn't need to be stored in the kernel image),
and finally the rest of the RAM, which is handed over to the malloc system.&lt;/p&gt;
&lt;h3&gt;Contact&lt;/h3&gt;

&lt;p&gt;The current version seems to be working well on Xen 4.4 (stable) and the 4.5
development version, but has only been lightly tested.
If you have any problems or questions, or get it working on other devices,
please &lt;a href=&quot;http://openmirage.org/community/&quot;&gt;let us know&lt;/a&gt;!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/introducing-xen-minios-arm</id><title type="text">Building an ARMy of Xen unikernels</title><updated>2014-07-22T10:00:00+00:00</updated><author><email></email><name>Thomas Leonard</name></author></entry><entry><link href="http://openmirage.org/blog/introducing-irmin-in-xenstore" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;em&gt;This is the second in a series of posts that introduces the &lt;a href=&quot;https://github.com/mirage/irmin&quot;&gt;Irmin&lt;/a&gt; distributed storage engine.
You might like to begin with the &lt;a href=&quot;http://openmirage.org/blog/introducing-irmin&quot;&gt;introductory post&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://wiki.xen.org/wiki/XenStore&quot;&gt;Xenstore&lt;/a&gt; is a critical service found on all hosts
running &lt;a href=&quot;http://www.xen.org/&quot;&gt;Xen&lt;/a&gt;. Xenstore is necessary to&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;configure all VM I/O devices such as disk controllers and network interface cards;&lt;/li&gt;&lt;li&gt;share performance statistics and OS version information; and&lt;/li&gt;&lt;li&gt;signal VMs during shutdown, suspend, resume, migrate etc.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;Xenstore must be &lt;strong&gt;reliable&lt;/strong&gt;: if it fails then the host is unmanageable and must be rebooted.&lt;/p&gt;
&lt;p&gt;Xenstore must be &lt;strong&gt;secure&lt;/strong&gt;: if it is compromised by a VM then that VM can access data belonging
to other VMs.&lt;/p&gt;
&lt;p&gt;The current version of Xenstore is &lt;a href=&quot;http://xenbits.xen.org/gitweb/?p=xen.git%3Ba=tree%3Bf=tools/ocaml/xenstored%3Bh=0d762f2a61de098c0100814e0c140575b51688a3%3Bhb=stable-4.4&quot;&gt;already written in OCaml&lt;/a&gt;
and documented in the paper
&lt;a href=&quot;http://gazagnaire.org/pub/GH09.pdf&quot;&gt;OXenstored: an efficient hierarchical and transactional database using functional programming with reference cell comparisons&lt;/a&gt; presented at ICFP 2009.
The existing code works very reliably, but there is always room for improvement
for debuggability of such a complex system component. This is where Irmin, the
storage layer of Mirage 2.0, can help.&lt;/p&gt;
&lt;p&gt;But first, a quick Xenstore primer:&lt;/p&gt;
&lt;h3&gt;Xen and Xenstore in 30 seconds&lt;/h3&gt;

&lt;p&gt;The Xen hypervisor focuses on isolating VMs from each-other; the hypervisor provides a virtual CPU scheduler
and a memory allocator but does not perform I/O on behalf of guest VMs.
On a Xen host, privileged server VMs perform I/O on behalf of client VMs.
The configuration for calculating which server VM services requests for which client VMs is stored in Xenstore, as
key/value pairs.&lt;/p&gt;
&lt;p&gt;The following diagram shows a Xen host with a single client and server VM, with
a single virtual device in operation.  Disk blocks and network packets flow via
shared memory between Xen-aware drivers in the VMs, shown in the lower-half.
The control-plane, shown in the upper-half, contains the metadata about the
datapath: how the device should appear in the client VM; where the I/O should
go in the server VM; where the shared memory control structures are etc.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openmirage.org/graphics/xenstore-diagram.png&quot; alt=&quot;Device configuration is stored in Xenstore as key=value pairs.&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The Xenstore device attach protocol insists that all device keys are added
through atomic transactions, i.e. partial updates are never visible to clients and transactions
cannot interfere with each other.
A Xenstore server must abort transactions whose operations were not successfully
isolated from other transactions. After an abort, the client is expected to retry.
Each key=value write is communicated to the server as a single request/response, so transactions
comprising multiple writes are open for multiple round-trip times.
This protocol is baked into guest VM kernels (including Linux, FreeBSD, Mirage, ...)
and won't change anytime soon.&lt;/p&gt;
&lt;p&gt;Xenstore is used heavily when lots of VMs are starting in parallel. Each VM typically
has several devices, each of these devices is added in a parallel transaction and therefore
many transactions are open at once. If the server aborts too many of these transactions,
causing the clients to retry, the system will make little progress and may appear to live-lock.
The challenge for a Xenstore implementation is to minimise the number of aborted
transactions and retries, without compromising on the isolation guarantee.&lt;/p&gt;
&lt;h3&gt;Irmin Xenstore design goals&lt;/h3&gt;

&lt;p&gt;The design goals of the Irmin-based Mirage Xenstore server are:&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;safely restart after a crash;&lt;/li&gt;&lt;li&gt;make system debugging easy; and&lt;/li&gt;&lt;li&gt;go really fast!&lt;/li&gt;&lt;/ol&gt;

&lt;p&gt;How does Irmin help achieve these goals?&lt;/p&gt;
&lt;h3&gt;Restarting after crashes&lt;/h3&gt;

&lt;p&gt;The Xenstore service is a reliable component and very rarely crashes. However,
if a crash does occur, the impact is severe on currently running virtual
machines. There is no protocol for a running VM to close its connection to a
Xenstore and open a new one, so if Xenstore crashes then running VMs are simply
left orphaned. VMs in this state are impossible to manage properly: there is no
way to shut them down cleanly, to suspend/resume or migrate, or to configure
any disk or network interfaces. If Xenstore crashes, the host must be rebooted
shortly after.&lt;/p&gt;
&lt;p&gt;Irmin helps make Xenstore recoverable after a crash, by providing a library
that applications can use to persist and synchronise distributed data
structures on disk and in memory. By using Irmin to persist all our state
somewhere sensible and taking care to manage our I/O carefully, then the server
process becomes stateless and can be restarted at will.&lt;/p&gt;
&lt;p&gt;To make Xenstore use Irmin,
the first task is to enumerate all the different kinds of state in the running process.
This includes the obvious key-value pairs used for VM configuration
as well as data currently hidden away in the OCaml heap:
the addresses in memory of established communication rings,
per-domain quotas, pending watch events and watch registrations etc etc. 
Once the state has been enumerated it must be mapped onto key-value pairs which can
be stored in Irmin. Rather than using ad-hoc mappings everywhere, the Mirage Irmin
server has
&lt;a href=&quot;https://github.com/mirage/ocaml-xenstore-server/blob/blog/introducing-irmin-in-xenstore/server/pMap.mli&quot;&gt;persistent Maps&lt;/a&gt;,
&lt;a href=&quot;https://github.com/mirage/ocaml-xenstore-server/blob/blog/introducing-irmin-in-xenstore/server/pSet.ml&quot;&gt;persistent Sets&lt;/a&gt;,
&lt;a href=&quot;https://github.com/mirage/ocaml-xenstore-server/blob/blog/introducing-irmin-in-xenstore/server/pQueue.ml&quot;&gt;persistent Queues&lt;/a&gt;
and
&lt;a href=&quot;https://github.com/mirage/ocaml-xenstore-server/blob/blog/introducing-irmin-in-xenstore/server/pRef.ml&quot;&gt;persistent reference cells&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Irmin applications are naturally written as functors, with the details of the persistence kept
abstract.
The following &lt;a href=&quot;https://github.com/mirage/irmin/blob/0.8.3/lib/core/irminView.mli&quot;&gt;Irmin-inspired&lt;/a&gt; signature represents what Xenstore needs
from Irmin:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;module type VIEW = sig
  type t

  val create: unit -&amp;gt; t Lwt.t
  (** Create a fresh VIEW from the current state of the store.
      A VIEW tracks state queries and updates and acts like a branch
      which has an explicit [merge]. *)

  val read: t -&amp;gt; Protocol.Path.t -&amp;gt; 
    [ `Ok of Node.contents | `Enoent of Protocol.Path.t ] Lwt.t
  (** Read a single key *)

  val list: t -&amp;gt; Protocol.Path.t -&amp;gt; 
    [ `Ok of string list | `Enoent of Protocol.Path.t ] Lwt.t
  (** List all the children of a key *)

  val write: t -&amp;gt; Protocol.Path.t -&amp;gt; Node.contents -&amp;gt; 
    [ `Ok of unit ] Lwt.t
  (** Update a single key *)

  val mem: t -&amp;gt; Protocol.Path.t -&amp;gt; bool Lwt.t
  (** Check whether a key exists *)

  val rm: t -&amp;gt; Protocol.Path.t -&amp;gt; [ `Ok of unit ] Lwt.t
  (** Remove a key *)

  val merge: t -&amp;gt; string -&amp;gt; bool Lwt.t
  (** Merge this VIEW into the current state of the store *)
end&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The main 'business logic' of Xenstore can then be functorised over this signature relatively easily.
All we need is to instantiate the functor using Irmin to persist the data somewhere sensible.
Eventually we will need two instantiations: one which runs as a userspace application and which
writes to the filesystem; and a second which will run as a
native Xen kernel (known as a &lt;a href=&quot;http://openmirage.org/blog/xenstore-stub.md&quot;&gt;xenstore stub domain&lt;/a&gt;)
and which will write to a fixed memory region (like a ramdisk).
The choice of which to use is left to the system administrator. Currently most (if not all)
distribution packagers choose to run Xenstore in userspace. Administrators who wish to
further secure their hosts are encouraged to run the kernelspace version to isolate Xenstore
from other processes (where a VM offers more isolation than a container, which offers more
isolation than a chroot). Note this choice is invisible to the guest VMs.&lt;/p&gt;
&lt;p&gt;So far in the Irmin Xenstore integration only the userspace instantiation has been implemented.
One of the most significant user-visible features is that all of the operations done through
Irmin can be inspected using the standard &lt;code&gt;git&lt;/code&gt; command line tool.
The runes to configure Irmin to write
&lt;a href=&quot;http://git-scm.com&quot;&gt;git&lt;/a&gt; format data to the filesystem are as follows:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    let open Irmin_unix in
    let module Git = IrminGit.FS(struct
      let root = Some filename
      let bare = true
    end) in
    let module DB = Git.Make(IrminKey.SHA1)(IrminContents.String)(IrminTag.String) in
    DB.create () &amp;gt;&amp;gt;= fun db -&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;where keys and values will be mapped into OCaml &lt;code&gt;strings&lt;/code&gt;, and our
&lt;code&gt;VIEW.t&lt;/code&gt; is simply an Irmin &lt;code&gt;DB.View.t&lt;/code&gt;. All that remains is to implement
&lt;code&gt;read&lt;/code&gt;, &lt;code&gt;list&lt;/code&gt;, &lt;code&gt;write&lt;/code&gt;, &lt;code&gt;rm&lt;/code&gt; by&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;mapping Xenstore &lt;code&gt;Protocol.Path.t&lt;/code&gt; values onto Irmin keys; and&lt;/li&gt;&lt;li&gt;mapping Xenstore &lt;code&gt;Node.contents&lt;/code&gt; records onto Irmin values.&lt;/li&gt;&lt;/ol&gt;

&lt;p&gt;As it happens Xenstore and Irmin have similar notions of &amp;quot;paths&amp;quot; so the first mapping is
easy. We currently use &lt;a href=&quot;https://github.com/janestreet/sexplib&quot;&gt;sexplib&lt;/a&gt; to map Node.contents
values onto strings for Irmin.&lt;/p&gt;
&lt;p&gt;The resulting &lt;a href=&quot;https://github.com/mirage/ocaml-xenstore-server/blob/blog/introducing-irmin-in-xenstore/userspace/main.ml#L101&quot;&gt;Irmin glue module&lt;/a&gt; looks like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    let module V = struct
      type t = DB.View.t
      let create = DB.View.create
      let write t path contents =
        DB.View.update t (value_of_filename path) (Sexp.to_string (Node.sexp_of_contents contents))
      (* omit read,list,write,rm for brevity *)
      let merge t origin =
        let origin = IrminOrigin.create &amp;quot;%s&amp;quot; origin in
        DB.View.merge_path ~origin db [] t &amp;gt;&amp;gt;= function
        | `Ok () -&amp;gt; return true
        | `Conflict msg -&amp;gt;
          info &amp;quot;Conflict while merging database view: %s&amp;quot; msg;
          return false
    end in&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;write&lt;/code&gt; function simply calls through to Irmin's &lt;code&gt;update&lt;/code&gt; function, while the &lt;code&gt;merge&lt;/code&gt; function
calls Irmin's &lt;code&gt;merge_path&lt;/code&gt;. If Irmin cannot merge the transaction then our &lt;code&gt;merge&lt;/code&gt; function will
return &lt;code&gt;false&lt;/code&gt; and this will be signalled to the client, which is expected to retry the high-level
operation (e.g. hotplugging or unplugging a device).&lt;/p&gt;
&lt;p&gt;Now all that remains is to carefully adjust the I/O code so that effects (reading and writing packets
along the persistent connections) are interleaved properly with persisted state changes and
voil&amp;agrave;, we now have a xenstore which can recover after a restart.&lt;/p&gt;
&lt;h3&gt;Easy system debugging with Git&lt;/h3&gt;

&lt;p&gt;When something goes wrong on a Xen system it's standard procedure to&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;take a snapshot of the current state of Xenstore; and&lt;/li&gt;&lt;li&gt;examine the log files for signs of trouble.&lt;/li&gt;&lt;/ol&gt;

&lt;p&gt;Unfortunately by the
time this is done, interesting Xenstore state has usually been deleted. Unfortunately the first task
of the human operator is to evaluate by-hand the logged actions in reverse to figure out what the state
actually was when the problem happened. Obviously this is tedious, error-prone and not always
possible since the log statements are ad-hoc and don't always include the data you need to know.&lt;/p&gt;
&lt;p&gt;In the new Irmin-powered Xenstore the history is preserved in a git-format repository, and can
be explored using your favourite git viewing tool. Each store
update has a compact one-line summary, a more verbose multi-line explanation and (of course)
the full state change is available on demand.&lt;/p&gt;
&lt;p&gt;For example you can view the history in a highly-summarised form with:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ git log --pretty=oneline --abbrev-commit --graph
* 2578013 Closing connection -1 to domain 0
* d4728ba Domain 0: rm /bench/local/domain/0/backend/vbd/10 = ()
* 4b55c99 Domain 0: directory /bench/local/domain/0/backend = [ vbd ]
* a71a903 Domain 0: rm /bench/local/domain/10 = ()
* f267b31 Domain 0: rm /bench/vss/uuid-10 = ()
* 94df8ce Domain 0: rm /bench/vm/uuid-10 = ()
* 0abe6b0 Domain 0: directory /bench/vm/uuid-10/domains = [  ]
* 06ddd3b Domain 0: rm /bench/vm/uuid-10/domains/10 = ()
* 1be2633 Domain 0: read /bench/local/domain/10/vss = /bench/vss/uuid-10
* 237a8e4 Domain 0: read /bench/local/domain/10/vm = /bench/vm/uuid-10
* 49d70f6 Domain 0: directory /bench/local/domain/10/device = [  ]
*   ebf4935 Merge view to /
|\
| * e9afd9f Domain 0: read /bench/local/domain/10 =
* | c4e0fa6 Domain 0: merging transaction 375
|/&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The summarised form shows both individual operations as well as isolated transactions which
are represented as git branches.
You can then 'zoom in' and show the exact state change with commands like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ git show bd44e03
commit bd44e0388696380cafd048eac49474f68d41bd3a
Author: 448 &amp;lt;irminsule@openmirage.org&amp;gt;
Date:   Thu Jan 1 00:09:26 1970 +0000

    Domain 0: merging transaction 363

diff --git a/*0/bench.dir/local.dir/domain.dir/7.dir/control.dir/shutdown.value b/*0/bench.dir/local.dir/domain.dir/7.dir/control.dir/shutdown.value
new file mode 100644
index 0000000..aa38106
--- /dev/null
+++ b/*0/bench.dir/local.dir/domain.dir/7.dir/control.dir/shutdown.value
@@ -0,0 +1 @@
+((creator 0)(perms((owner 7)(other NONE)(acl())))(value halt))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Last but not least, you can &lt;code&gt;git checkout&lt;/code&gt; to the exact time the problem occurred and examine
the state of the store.&lt;/p&gt;
&lt;h3&gt;Going really fast&lt;/h3&gt;

&lt;p&gt;Xenstore is part of the control-plane of a Xen system and is most heavily stressed when lots
of VMs are being started in parallel. Each VM has multiple devices and each device is added in a
separate transaction. These transactions remain open for multiple client-server round-trips, as
each individual operation is sent to Xenstore as a separate RPC. 
To provide isolation, each Xenstore transaction is represented by an Irmin &lt;code&gt;VIEW.t&lt;/code&gt; which
is persisted on disk as a git branch.
When starting lots of VMs in
parallel, lots of branches are created and must be merged back together. If a branch cannot
be merged then an abort signal is sent to the client and it must retry.&lt;/p&gt;
&lt;p&gt;Earlier versions of Xenstore had naive transaction merging algorithms
which aborted many of these transactions, causing the clients to re-issue them.This led to a live-lock
where clients were constantly reissuing the same transactions again and again.&lt;/p&gt;
&lt;p&gt;Happily Irmin's default merging strategy is much better: by default Irmin
records the results of every operation and replays the operations on merge
(similar to &lt;code&gt;git rebase&lt;/code&gt;). Irmin will only generate a &lt;code&gt;Conflict&lt;/code&gt; and signal an
abort if the client would now see different results to those it has already
received (imagine reading a key twice within an isolated transaction and seeing
two different values). In the case of parallel VM starts, the keys are disjoint
by construction so all transactions are merged trivially; clients never receive
abort signals; and therefore the system makes steady, predictable progress
starting the VMs.&lt;/p&gt;
&lt;h3&gt;Trying it out&lt;/h3&gt;

&lt;p&gt;The Irmin Xenstore is under &lt;a href=&quot;https://github.com/mirage/ocaml-xenstore-server&quot;&gt;active development&lt;/a&gt;
but you can try it by:&lt;/p&gt;
&lt;p&gt;Install basic development tools along with the xen headers and xenstore tools (NB you don't
actually have to run Xen):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  sudo apt-get install libxen-dev xenstore-utils opam build-essential m4&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Initialise opam (if you haven't already). Make sure you have OCaml 4.01:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  opam init
  opam update
  opam switch 4.01.0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Install the OCaml build dependencies:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  opam install lwt irmin git sexplib cstruct uri sexplib cmdliner xen-evtchn shared-memory-ring io-page ounit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Clone the code and build it:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  git clone git://github.com/mirage/ocaml-xenstore-server
  cd ocaml-xenstore-server
  make&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Run a server (as a regular user):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  ./main.native --database /tmp/db --enable-unix --path /tmp/xenstored&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In a separate terminal, perform some operations:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  export XENSTORED_PATH=/tmp/xenstored
  xenstore-write -s /one/two/three 4 /five/six/seven 8
  xenstore-ls -s /&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Next check out the git repo generated by Irmin:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  cd /tmp/db
  git log&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Comments and/or contributions are welcome: join the &lt;a href=&quot;http://lists.xenproject.org/cgi-bin/mailman/listinfo/mirageos-devel&quot;&gt;Mirage email list&lt;/a&gt; and say hi!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/introducing-irmin-in-xenstore</id><title type="text">Using Irmin to add fault-tolerance to the Xenstore database</title><updated>2014-07-21T11:00:00+00:00</updated><author><email></email><name>Dave Scott</name></author></entry><entry><link href="http://openmirage.org/blog/introducing-irmin" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;blockquote&gt;&lt;p&gt;This is the first post in a series which will describe &lt;a href=&quot;https://github.com/mirage/irmin&quot;&gt;Irmin&lt;/a&gt;,
 the new Git-like storage layer for Mirage OS 2.0. This post gives a
 high-level description on Irmin and its overall architecture, and
 later posts will detail how to use Irmin in real systems.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/mirage/irmin&quot;&gt;Irmin&lt;/a&gt; is a library to persist and synchronize distributed
data structures both on-disk and in-memory. It enables a style of
programming very similar to the &lt;a href=&quot;http://git-scm.com/&quot;&gt;Git&lt;/a&gt; workflow, where
distributed nodes fork, fetch, merge and push data between
each other. The general idea is that you want every active node to
get a local (partial) copy of a global database and always be very
explicit about how and when data is shared and migrated.&lt;/p&gt;
&lt;p&gt;Irmin is &lt;em&gt;not&lt;/em&gt;, strictly speaking, a full database engine. It
is, as are all other components of Mirage OS, a collection of
libraries designed to solve different flavours of the challenges raised
by the &lt;a href=&quot;http://en.wikipedia.org/wiki/CAP_theorem&quot;&gt;CAP theorem&lt;/a&gt;. Each application can select the right
combination of libraries to solve its particular distributed problem. More
precisely, Irmin consists of a core of well-defined low-level
data structures that specify how data should be persisted
and be shared across nodes. It defines algorithms for efficient
synchronization of those distributed low-level constructs. It also
builds a collection of higher-level data structures, like persistent
&lt;a href=&quot;https://github.com/mirage/merge-queues&quot;&gt;mergeable queues&lt;/a&gt;, that can be used by developers without
having to know precisely how Irmin works underneath.&lt;/p&gt;
&lt;p&gt;Since it's a part of Mirage OS, Irmin does not make strong assumptions about the
OS environment that it runs in. This makes the system very portable, and the
details below hold for in-memory databases as well as for slower persistent
serialization such as SSDs, hard drives, web browser local storage, or even
the Git file format.&lt;/p&gt;
&lt;h3&gt;Persistent Data Structures&lt;/h3&gt;

&lt;p&gt;Persistent data structures are well known and used pervasively in many
different areas. The programming language community has
investigated the concepts &lt;a href=&quot;https://www.cs.cmu.edu/~rwh/theses/okasaki.pdf&quot;&gt;widely&lt;/a&gt; (and this is &lt;a href=&quot;http://en.wikipedia.org/wiki/Object_copy&quot;&gt;not
limited&lt;/a&gt; to functional programming), and in the meantime,
the systems community experimented with various persistent
strategies such as &lt;a href=&quot;http://en.wikipedia.org/wiki/Copy-on-write&quot;&gt;copy-on-write&lt;/a&gt; filesystems. In most of these
systems, the main concern is how to optimize the space complexity by
maximizing the sharing of immutable sub-structures.&lt;/p&gt;
&lt;p&gt;The Irmin design ideas share roots with previous works on persistent data
structures, as it provides an efficient way to &lt;em&gt;fork&lt;/em&gt; data structures,
but it also explores new strategies and mechanisms to be able to
efficiently &lt;em&gt;merge&lt;/em&gt; back these forked structures. This offers
programming constructs very similar to the Git workflow.&lt;/p&gt;
&lt;p&gt;Irmin focuses on two main aspects:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Semantics&lt;/strong&gt;: what properties the resulting merged objects should
verify.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Complexity&lt;/strong&gt;: how to design efficient merge and synchronization
primitives, taking advantage of the immutable nature of the underlying
objects.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;Although it is pervasively used, &lt;em&gt;data persistence&lt;/em&gt; has a very broad and
fuzzy meaning. In this blog post, I will refer to data persistence as
a way for:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;a single process to lazily populate a process memory on startup.
 You need this when you want the process to be able to resume while
 holding part of its previous state if it crashes&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;concurrent processes to share references between objects living in
 a global pool of data. Sharing references, as opposed to sharing
 values, reduces memory copies and allow different processes to
 concurrently update a shared store.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;In both cases, you need a global pool of data (the Irmin &lt;em&gt;block store&lt;/em&gt;)
and a way to name values in that pool (the Irmin &lt;em&gt;tag store&lt;/em&gt;).&lt;/p&gt;
&lt;h3&gt;The Block Store: a Virtual Heap&lt;/h3&gt;

&lt;p&gt;Even high-level data structures need to be allocated in memory, and it
is the purpose of the runtime to map such high-level constructs into
low-level memory graph blocks. One of the strengths of &lt;a href=&quot;http://ocaml.org&quot;&gt;OCaml&lt;/a&gt;
is the very simple and deterministic mapping from high-level data
structures to low-level block representations (the &lt;em&gt;heap&lt;/em&gt;): see for
instance, the excellent series of blog posts on &lt;a href=&quot;http://rwmj.wordpress.com/2009/08/04/ocaml-internals/&quot;&gt;OCaml
internals&lt;/a&gt; by Richard W. Jones, or
&lt;a href=&quot;https://realworldocaml.org/v1/en/html/memory-representation-of-values.html&quot;&gt;Chapter 20: Memory Representation of Values&lt;/a&gt; in
&lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;An Irmin &lt;em&gt;block store&lt;/em&gt; can be seen as a virtual OCaml heap that uses a more
abstract way of connecting heap blocks. Instead of using the concrete physical
memory addresses of blocks, Irmin uses the hash of the block contents as an
address. As for any &lt;a href=&quot;http://en.wikipedia.org/wiki/Content-addressable_storage&quot;&gt;content-addressable storage&lt;/a&gt;, this gives Irmin
block stores a lot of nice properties and greatly simplifies the way distributed
stores can be synchronized.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Persistent&lt;/em&gt; data structures are immutable, and once a block is created in
the block store, its contents will never change again.
Updating an immutable data structure means returning a completely new
structure, while trying to share common sub-parts to avoid the cost of
making new allocations as much as possible. For instance, modifying a
value in a persistent tree means creating a chain of new blocks, from
the root of the tree to the modified leaf.
For convenience, Irmin only considers acyclic block graphs --
it is difficult in a non-lazy pure language to generate complex cyclic
values with reasonable space usage.&lt;/p&gt;
&lt;p&gt;Conceptually, an Irmin block store has the following signature:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;type t
(** The type for Irmin block store. *)

type key
(** The type for Irmin pointers *)

type value = ...
(** The type for Irmin blocks *)

val read: t -&amp;gt; key -&amp;gt; value option
(** [read t k] is the block stored at the location [k] of the
store. It is [None] if no block is available at that location. *)

val add: t -&amp;gt; key -&amp;gt; value -&amp;gt; t
(** [add t k v] is the *new* store storing the block [v] at the
location [k]. *)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Persistent data structures are very efficient to store in memory and on
disk as you do not need &lt;a href=&quot;http://en.wikipedia.org/wiki/Write_barrier&quot;&gt;write barriers&lt;/a&gt;, and updates
can be written &lt;a href=&quot;http://en.wikipedia.org/wiki/Write_amplification#Sequential_writes&quot;&gt;sequentially&lt;/a&gt; instead of requiring random
access into the data structure.&lt;/p&gt;
&lt;h3&gt;The Tag Store: Controlled Mutability and Concurrency&lt;/h3&gt;

&lt;p&gt;So far, we have only discussed purely functional data structures,
where updating a structure means returning a pointer to a new
structure in the heap that shares most of its contents with the previous
one. This style of programming is appealing when implementing
&lt;a href=&quot;http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation&quot;&gt;complex protocols&lt;/a&gt; as it leads to better compositional properties.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openmirage.org/graphics/irmin-stores.png&quot; width=&quot;250px&quot; style=&quot;float:right; border: 5px&quot; alt=&quot;Irmin Stores&quot;/&gt;&lt;/p&gt;
&lt;p&gt;However, this makes sharing information between processes much more
difficult, as you need a way to &amp;quot;inject&amp;quot; the state of one structure into another process's memory. In order to do so, Irmin borrows the concept of
&lt;em&gt;branches&lt;/em&gt; from Git by relating every operation to a branch name, and
modifying the tip of the branch if it has side-effects.
The Irmin &lt;em&gt;tag store&lt;/em&gt; is the only mutable part of the whole system and
is responsible for mapping some global (branch) names to blocks in the
block store. These tag names can then be used to pass block references between
different processes.&lt;/p&gt;
&lt;p&gt;A block store and a tag store can be combined to build
a higher-level store (the Irmin store) with fine concurrency control
and atomicity guarantees. As mutation happens only in the tag store,
we can ensure that as long a given tag is not updated, no change made
in the block store will be visible by anyone. This also gives a nice
story for concurrency: as in Git, creating a concurrent view of the
store is the straightforward operation of creating a new tag that
denotes a new branch. All concurrent operations can then happen on
different branches:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;type t
(** The type for Irmin store. *)

type tag
(** Mutable tags *)

type key = ...
(** The type for user-defined keys (for instance a list of strings) *)

type value = ...
(** The type for user-defined values *)

val read: t -&amp;gt; ?branch:tag -&amp;gt; key -&amp;gt; value option
(** [read t ?branch k] reads the contents of the key [k] in the branch
[branch] of the store [t]. If no branch is specified, then use the
[&amp;quot;HEAD&amp;quot;] one. *)

val update: t -&amp;gt; ?branch:tag -&amp;gt; key -&amp;gt; value -&amp;gt; unit
(** [update t ?branch k v] *updates* the branch [branch] of the store
[t] the association of the key [key] to the value [value]. *)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Interactions between concurrent processes are completely explicit and
need to happen via synchronization points and merge events (more on
this below). It is also possible to emulate the behaviour of
transactions by recording the sequence of operations (&lt;code&gt;read&lt;/code&gt; and
&lt;code&gt;update&lt;/code&gt;) on a given branch -- that sequence is used before a merge
to check that all the operations are valid (i.e. that all reads in the
transaction still return the same result on the current tip of the
store) and it can be discarded after the merge takes place.&lt;/p&gt;
&lt;h3&gt;Merging Data Structures&lt;/h3&gt;

&lt;p&gt;To merge two data structures in a consistent way, one has to compute
the sequence of operations which leads, from an initial common state, to two
diverging states (the ones that you want to merge). Once these two
sequences of operations have been found, they must be combined (if
possible) in a sensible way and then applied again back on the initial
state, in order to get the new merged state. This mechanism sounds
nice, but in practice it has two major drawbacks:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;It does not specify how we find the initial state from two diverging
 states -- this is generally not possible (think of diverging
 counters); and&lt;/li&gt;&lt;li&gt;It means we need to compute the sequence of &lt;code&gt;update&lt;/code&gt; operations
 that leads from one state to an other.  This is easier than finding
 the common initial state between two branches, but is still generally
 not very efficient.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;In Irmin, we solve these problems using two mechanisms.&lt;/p&gt;
&lt;p&gt;First of all, an interesting observation is that that we can model the
sequence of store tips as a purely functional data-structure. We model
the partial order of tips as a directed acyclic graph where nodes are
the tips, and there is an edge between two tips if either &lt;em&gt;(i)&lt;/em&gt; one is
the result of applying a sequence of &lt;code&gt;update&lt;/code&gt;s to the other, or &lt;em&gt;(ii)&lt;/em&gt;
one is the result of a merge operation between the other and some
other tips. Practically speaking, that means that every tip should
contains the list of its predecessors as well as the actual data it
associated to. As it is purely functional, we can (and we do) store
that graph in an Irmin block store.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openmirage.org/graphics/irmin-merge.png&quot; width=&quot;150px&quot; style=&quot;float:right; border:5px&quot; alt=&quot;Finding a common ancestor&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Having a persistent and immutable history is good for various obvious
reasons, such as access to a forensics if an error occurs or
snapshot and rollback features for free. But another less obvious
useful property is that we can now find the greatest common
ancestors of two data structures without an expensive global search.&lt;/p&gt;
&lt;p&gt;The second mechanism is that we require the data structures used in
Irmin to be equipped with a well-defined 3-way merge operation, which
takes two diverging states, the corresponding initial state (computed
using the previous mechanism) and that return either a new state or a
conflict (similar to the &lt;code&gt;EAGAIN&lt;/code&gt; exception that you get when you try
to commit a conflicting transaction in more traditional transactional
databases). Having access to the common ancestors makes a great
difference when designing new merge functions, as usually no
modification is required to the data-structure itself. In contrast,
the conventional approach is more invasive as it requires the data
structure to carry more information about the operation history
(for instance &lt;a href=&quot;http://hal.upmc.fr/docs/00/55/55/88/PDF/techreport.pdf&quot;&gt;conflict-free replicated
datatypes&lt;/a&gt;, which relies on unbounded vector clocks).&lt;/p&gt;
&lt;p&gt;We have thus been designing interesting data structure equipped with a 3-way
merge, such as counters, &lt;a href=&quot;https://github.com/mirage/merge-queues&quot;&gt;queues&lt;/a&gt; and ropes.&lt;/p&gt;
&lt;p&gt;This is what the implementation of distributed and mergeable counters
looks like:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;type t = int
(** distributed counters are just normal integers! *)

let merge ~old t1 t2 = old + (t1-old) + (t2-old)
(** Merging counters means:
   - computing the increments of the two states [t1] and [t2]
     relatively to the initial state [old]; and
   - and add these two increments to [old]. *)&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Next steps, how to git at your data&lt;/h3&gt;

&lt;p&gt;From a design perspective, having access to the history makes it easier to
design complex data structures with good compositional properties to use in
unikernels. Moreover, as we made few assumptions on how the substrate of the
low-level constructs need to be implemented, the Irmin engine can be be ported
to many exotic backends such as JavaScript or anywhere else that Mirage OS
runs: this is just a matter of implementing a rather trivial
&lt;a href=&quot;https://github.com/mirage/irmin/blob/4b06467ddee1e20c35bad64812769587fb9fa8a4/lib/core/irminStore.mli#L61&quot;&gt;signature&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;From a developer perspective, this means that the full history of operations is
available to inspect, and that the history model is very similar to the Git
workflow that is increasingly familiar. So similar, in fact, that we've
developed a bidirectional mapping between Irmin data structures and the Git
format to permit the &lt;code&gt;git&lt;/code&gt; command-line to interact with.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;http://openmirage.org/blog/introducing-irmin-in-xenstore&quot;&gt;next post in our series&lt;/a&gt; explains what &lt;a href=&quot;http://dave.recoil.org/&quot;&gt;Dave Scott&lt;/a&gt; has been doing
with the new version of the &lt;a href=&quot;http://wiki.xen.org/wiki/XenStoreReference&quot;&gt;Xenstore&lt;/a&gt; database that powers every Xen host,
where the entire database is stored in a prefix-tree Irmin data-structure and exposed
as a Git repository which is live-updated!  Here's a sneak preview...&lt;/p&gt;
&lt;div class=&quot;flex-video&quot;&gt;
  &lt;iframe allowfullscreen=&quot;1&quot; frameborder=&quot;0&quot; src=&quot;//www.youtube-nocookie.com/embed/DSzvFwIVm5s&quot; height=&quot;360&quot; width=&quot;480&quot;&gt; &amp;nbsp; &lt;/iframe&gt;
&lt;/div&gt;


   </content><id>http://openmirage.org/blog/introducing-irmin</id><title type="text">Introducing Irmin: Git-like distributed, branchable storage</title><updated>2014-07-18T13:00:00+00:00</updated><author><email></email><name>Thomas Gazagnaire</name></author></entry><entry><link href="http://openmirage.org/blog/intro-tcpip" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;A critical part of any unikernel is its network stack -- it's difficult to
think of a project that needs a cloud platform or runs on a set-top box with no
network communications.&lt;/p&gt;
&lt;p&gt;Mirage provides a number of &lt;a href=&quot;https://github.com/mirage/mirage/tree/master/types&quot;&gt;module
types&lt;/a&gt; that abstract
interfaces at different layers of the network stack, allowing unikernels to
customise their own stack based on their deployment needs. Depending on the
abstractions your unikernel uses, you can fulfill these abstract interfaces
with implementations ranging from the venerable and much-imitated Unix sockets
API to a clean-slate Mirage &lt;a href=&quot;https://github.com/mirage/mirage-tcpip&quot;&gt;TCP/IP
stack&lt;/a&gt; written from the ground up in
pure OCaml!&lt;/p&gt;
&lt;p&gt;A Mirage unikernel will not use &lt;em&gt;all&lt;/em&gt; these interfaces, but will pick those that
are appropriate for the particular application at hand. If your unikernel just
needs a standard TCP/IP stack, the &lt;code&gt;STACKV4&lt;/code&gt; abstraction will be sufficient.
However, if you want more control over the implementation of the different
layers in the stack or you don't need TCP support, you might construct your
stack by hand using just the &lt;a href=&quot;https://github.com/mirage/mirage/blob/8b59fbf0b223b3c5c70d4939b5674ecdd7521804/types/V1.mli#L263&quot;&gt;NETWORK&lt;/a&gt;, &lt;a href=&quot;https://github.com/mirage/mirage/blob/8b59fbf0b223b3c5c70d4939b5674ecdd7521804/types/V1.mli#L316&quot;&gt;ETHIF&lt;/a&gt;, &lt;a href=&quot;https://github.com/mirage/mirage/blob/8b59fbf0b223b3c5c70d4939b5674ecdd7521804/types/V1.mli#L368&quot;&gt;IPV4&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirage/mirage/blob/8b59fbf0b223b3c5c70d4939b5674ecdd7521804/types/V1.mli#L457&quot;&gt;UDPV4&lt;/a&gt; interfaces.&lt;/p&gt;
&lt;h2&gt;How a Stack Looks to a Mirage Application&lt;/h2&gt;

&lt;p&gt;Mirage provides a high-level interface to a TCP/IP network stack through the module type
&lt;a href=&quot;https://github.com/mirage/mirage/blob/8b59fbf0b223b3c5c70d4939b5674ecdd7521804/types/V1.mli#L581&quot;&gt;STACKV4&lt;/a&gt;.
(Currently this can be included with &lt;code&gt;open V1_LWT&lt;/code&gt;, but soon &lt;code&gt;open
V2_LWT&lt;/code&gt; will also bring this module type into scope as well when Mirage 2.0 is released.)&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;(** Single network stack *)                                                     
module type STACKV4 = STACKV4                                                   
  with type 'a io = 'a Lwt.t                                                    
   and type ('a,'b,'c) config = ('a,'b,'c) stackv4_config                       
   and type ipv4addr = Ipaddr.V4.t                                              
   and type buffer = Cstruct.t &lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;STACKV4&lt;/code&gt; has useful high-level functions, a subset of which are reproduced below:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;    val listen_udpv4 : t -&amp;gt; port:int -&amp;gt; UDPV4.callback -&amp;gt; unit
    val listen_tcpv4 : t -&amp;gt; port:int -&amp;gt; TCPV4.callback -&amp;gt; unit
    val listen : t -&amp;gt; unit io&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;as well as submodules that include functions for data transmission:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;    module UDPV4 :
      sig
        type callback =
            src:ipv4addr -&amp;gt; dst:ipv4addr -&amp;gt; src_port:int -&amp;gt; buffer -&amp;gt; unit io
        val input :
          listeners:(dst_port:int -&amp;gt; callback option) -&amp;gt; t -&amp;gt; ipv4input
        val write :
          ?source_port:int -&amp;gt;
          dest_ip:ipv4addr -&amp;gt; dest_port:int -&amp;gt; t -&amp;gt; buffer -&amp;gt; unit io&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;    module TCPV4 :
      sig
        type flow
        type callback = flow -&amp;gt; unit io
        val read : flow -&amp;gt; [ `Eof | `Error of error | `Ok of buffer ] io
        val write : flow -&amp;gt; buffer -&amp;gt; unit io
        val close : flow -&amp;gt; unit io
        val create_connection :
          t -&amp;gt; ipv4addr * int -&amp;gt; [ `Error of error | `Ok of flow ] io
        val input : t -&amp;gt; listeners:(int -&amp;gt; callback option) -&amp;gt; ipv4input&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;These should look rather familiar if you've used the Unix sockets
API before, with one notable difference: the stack accepts functional
callbacks to react to events such as a new connection request.  This
permits callers of the library to define the precise datastructures that
are used to store intermediate state (such as active connections).
This becomes important when building very scalable systems that have
to deal with &lt;a href=&quot;https://en.wikipedia.org/wiki/C10k_problem&quot;&gt;lots of concurrent connections&lt;/a&gt;
efficiently.&lt;/p&gt;
&lt;h2&gt;Configuring a Stack&lt;/h2&gt;

&lt;p&gt;The &lt;code&gt;STACKV4&lt;/code&gt; signature shown so far is just a module signature, and you
need to find a concrete module that satisfies that signature.  The known
implementations of a module can be found in the &lt;code&gt;mirage&lt;/code&gt; CLI frontend,
which provids the &lt;a href=&quot;https://github.com/mirage/mirage/blob/8b59fbf0b223b3c5c70d4939b5674ecdd7521804/lib/mirage.mli#L266&quot;&gt;configuration API&lt;/a&gt; for unikernels.&lt;br/&gt;There are currently two implementations for &lt;code&gt;STACKV4&lt;/code&gt;: &lt;code&gt;direct&lt;/code&gt; and &lt;code&gt;socket&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;module STACKV4_direct: CONFIGURABLE with                                        
  type t = console impl * network impl * [`DHCP | `IPV4 of ipv4_config]         
                                                                                
module STACKV4_socket: CONFIGURABLE with                                        
  type t = console impl * Ipaddr.V4.t list  &lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;socket&lt;/code&gt; implementations rely on an underlying OS kernel to provide the
transport, network, and data link layers, and therefore can't be used for a Xen
guest VM deployment.  Currently, the only way to use &lt;code&gt;socket&lt;/code&gt; is by configuring
your Mirage project for Unix with &lt;code&gt;mirage configure --unix&lt;/code&gt;.  This is the mode
you will most often use when developing high-level application logic that doesn't
need to delve into the innards of the network stack (e.g. a REST website).&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;direct&lt;/code&gt; implementations use the &lt;a href=&quot;https://github.com/mirage/mirage-tcpip&quot;&gt;mirage-tcpip&lt;/a&gt; implementations of the
transport, network, and data link layers.  When you use this stack, all the network
traffic from the Ethernet level up will be handled in pure OCaml.  This means that the
&lt;code&gt;direct&lt;/code&gt; stack will work with either a Xen
guest VM (provided there's a valid network configuration for the unikernel's
running environment of course), or a Unix program if there's a valid &lt;a href=&quot;https://en.wikipedia.org/wiki/TUN/TAP&quot;&gt;tuntap&lt;/a&gt; interface.
&lt;code&gt;direct&lt;/code&gt; this works with both &lt;code&gt;mirage configure --xen&lt;/code&gt; and &lt;code&gt;mirage configure --unix&lt;/code&gt;
as long as there is a corresponding available device when the unikernel is run.&lt;/p&gt;
&lt;p&gt;There are a few Mirage functions that provide IPv4 (and UDP/TCP) stack
implementations (of type &lt;code&gt;stackv4 impl&lt;/code&gt;), usable from your application code.
The &lt;code&gt;stackv4 impl&lt;/code&gt; is generated in &lt;code&gt;config.ml&lt;/code&gt; by some logic set when the
program is &lt;code&gt;mirage configure&lt;/code&gt;'d - often by matching an environment variable.
This means it's easy to flip between different stack implementations when
developing an application just be recompiling the application.  The &lt;code&gt;config.ml&lt;/code&gt;
below allows the developer to build socket code with &lt;code&gt;NET=socket make&lt;/code&gt; and
direct code with &lt;code&gt;NET=direct make&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;let main = foreign &amp;quot;Services.Main&amp;quot; (console @-&amp;gt; stackv4 @-&amp;gt; job)

let net =
  try match Sys.getenv &amp;quot;NET&amp;quot; with
    | &amp;quot;direct&amp;quot; -&amp;gt; `Direct
    | &amp;quot;socket&amp;quot; -&amp;gt; `Socket
    | _        -&amp;gt; `Direct
  with Not_found -&amp;gt; `Direct

let dhcp =
  try match Sys.getenv &amp;quot;ADDR&amp;quot; with
    | &amp;quot;dhcp&amp;quot;   -&amp;gt; `Dhcp
    | &amp;quot;static&amp;quot; -&amp;gt; `Static
    | _ -&amp;gt; `Dhcp
  with Not_found -&amp;gt; `Dhcp

let stack console =
  match net, dhcp with
  | `Direct, `Dhcp   -&amp;gt; direct_stackv4_with_dhcp console tap0
  | `Direct, `Static -&amp;gt; direct_stackv4_with_default_ipv4 console tap0
  | `Socket, _       -&amp;gt; socket_stackv4 console [Ipaddr.V4.any]

let () =
  register &amp;quot;services&amp;quot; [
    main $ default_console $ stack default_console
  ]&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Moreover, it's possible to configure multiple stacks individually for use in
the same program, and to &lt;code&gt;register&lt;/code&gt; multiple modules from the same &lt;code&gt;config.ml&lt;/code&gt;.
This means functions can be written such that they're aware of the network
stack they ought to be using, and no other - a far cry from developing network
code over most socket interfaces, where it can be quite difficult to separate
concerns nicely.&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;let client = foreign &amp;quot;Unikernel.Client&amp;quot; (console @-&amp;gt; stackv4 @-&amp;gt; job)
let server = foreign &amp;quot;Unikernel.Server&amp;quot; (console @-&amp;gt; stackv4 @-&amp;gt; job) 

let client_netif = (netif &amp;quot;0&amp;quot;)
let server_netif = (netif &amp;quot;1&amp;quot;) 

let client_stack = direct_stackv4_with_dhcp default_console client_netif
let server_stack = direct_stackv4_with_dhcp default_console server_netif

let () = 
  register &amp;quot;unikernel&amp;quot; [
    main $ default_console $ client_stack;
    server $ default_console $ server_stack 
  ]

&lt;/code&gt;&lt;/pre&gt;

&lt;h2&gt;Acting on Stacks&lt;/h2&gt;

&lt;p&gt;Most network applications will either want to listen for incoming connections
and respond to that traffic with information, or to connect to some remote
host, execute a query, and receive information.  &lt;code&gt;STACKV4&lt;/code&gt; offers simple ways
to define functions implementing either of these patterns.&lt;/p&gt;
&lt;h3&gt;Establishing and Communicating Across Connections&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;STACKV4&lt;/code&gt; offers &lt;code&gt;listen_tcpv4&lt;/code&gt; and &lt;code&gt;listen_udpv4&lt;/code&gt; functions for establishing
listeners on specific ports.  Both take a &lt;code&gt;stack impl&lt;/code&gt;, a named &lt;code&gt;port&lt;/code&gt;, and a
&lt;code&gt;callback&lt;/code&gt; function.&lt;/p&gt;
&lt;p&gt;For UDP listeners, which are datagram-based rather than connection-based,
&lt;code&gt;callback&lt;/code&gt; is a function of the source IP, destination IP, source port, and the
&lt;code&gt;Cstruct.t&lt;/code&gt; that contains the payload data.  Applications that wish to respond
to incoming UDP packets with their own UDP responses (e.g., DNS servers) can
use this information to construct reply packets and send them with
&lt;code&gt;UDPV4.write&lt;/code&gt; from within the callback function.&lt;/p&gt;
&lt;p&gt;For TCP listeners, &lt;code&gt;callback&lt;/code&gt; is a function of &lt;code&gt;TCPV4.flow -&amp;gt; unit Lwt.t&lt;/code&gt;.  &lt;code&gt;STACKV4.TCPV4&lt;/code&gt; offers &lt;code&gt;read&lt;/code&gt;, &lt;code&gt;write&lt;/code&gt;, and &lt;code&gt;close&lt;/code&gt; on &lt;code&gt;flow&lt;/code&gt;s for application writers to build higher-level protocols on top of.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;TCPV4&lt;/code&gt; also offers &lt;code&gt;create_connection&lt;/code&gt;, which allows client application code to establish TCP connections with remote servers.  In success cases, &lt;code&gt;create_connection&lt;/code&gt; returns a &lt;code&gt;TCPV4.flow&lt;/code&gt;, which can be acted on just as the data in a &lt;code&gt;callback&lt;/code&gt; above.  There's also a polymorphic variant for error conditions, such as an unreachable remote server.&lt;/p&gt;
&lt;h3&gt;A Simple Example&lt;/h3&gt;

&lt;p&gt;Some very simple examples of user-level TCP code are included in &lt;a href=&quot;https://github.com/mirage/mirage-tcpip/tree/master/examples&quot;&gt;mirage-tcpip/examples&lt;/a&gt;.  &lt;code&gt;config.ml&lt;/code&gt; is identical to the first configuration example above, and will build a &lt;code&gt;direct&lt;/code&gt; stack by default.&lt;/p&gt;
&lt;p&gt;Imagine a very simple application - one which simply repeats any data back to the sender, until the sender gets bored and wanders off (&lt;a href=&quot;https://en.wikipedia.org/wiki/Echo_Protocol&quot;&gt;RFC 862&lt;/a&gt;, for the curious).&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;open Lwt
open V1_LWT

module Main (C: V1_LWT.CONSOLE) (S: V1_LWT.STACKV4) = struct
  let report_and_close c flow message =
    C.log c message;
    S.TCPV4.close flow

  let rec echo c flow =
    S.TCPV4.read flow &amp;gt;&amp;gt;= fun result -&amp;gt; (
      match result with  
        | `Eof -&amp;gt; report_and_close c flow &amp;quot;Echo connection closure initiated.&amp;quot;
        | `Error e -&amp;gt; 
          let message = 
          match e with 
            | `Timeout -&amp;gt; &amp;quot;Echo connection timed out; closing.\n&amp;quot;
            | `Refused -&amp;gt; &amp;quot;Echo connection refused; closing.\n&amp;quot;
            | `Unknown s -&amp;gt; (Printf.sprintf &amp;quot;Echo connection error: %s\n&amp;quot; s)
             in
          report_and_close c flow message
        | `Ok buf -&amp;gt;
            S.TCPV4.write flow buf &amp;gt;&amp;gt;= fun () -&amp;gt; echo c flow
        ) 

  let start c s = 
    S.listen_tcpv4 s ~port:7 (echo c);
    S.listen s

end&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;All the application programmer needs to do is define functionality in relation to &lt;code&gt;flow&lt;/code&gt; for sending and receiving data, establish this function as a callback with &lt;code&gt;listen_tcpv4&lt;/code&gt;, and start a listening thread with &lt;code&gt;listen&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;More Complex Uses&lt;/h2&gt;

&lt;p&gt;An OCaml HTTP server, &lt;a href=&quot;http://www.github.com/mirage/ocaml-cohttp&quot;&gt;Cohttp&lt;/a&gt;, is currently powering this very blog.  A simple static webserver using Cohttp &lt;a href=&quot;https://github.com/mirage/mirage-skeleton/tree/master/static_website&quot;&gt;is included in &lt;code&gt;mirage-skeleton&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://tls.openmirage.org/&quot;&gt;The OCaml-TLS demonstration server&lt;/a&gt; announced here &lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;just a few days ago&lt;/a&gt; is also running atop Cohttp - &lt;a href=&quot;https://github.com/mirleft/tls-demo-server&quot;&gt;source is available on Github&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;The future&lt;/h2&gt;

&lt;p&gt;Mirage's TCP/IP stack is under active development!  &lt;a href=&quot;https://github.com/mirage/mirage-tcpip/search?q=TODO&amp;amp;ref=cmdform&quot;&gt;Some low-level details&lt;/a&gt; are still stubbed out, and we're working on implementing some of the trickier corners of TCP, as well as &lt;a href=&quot;http://somerandomidiot.com/blog/2014/05/22/throwing-some-fuzzy-dice/&quot;&gt;doing automated testing&lt;/a&gt; on the stack.  We welcome testing tools, bug reports, bug fixes, and new protocol implementations!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/intro-tcpip</id><title type="text">Fitting the modular Mirage TCP/IP stack together</title><updated>2014-07-17T13:00:00+00:00</updated><author><email></email><name>Mindy Preston</name></author></entry><entry><link href="http://openmirage.org/blog/update-on-vchan" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;em&gt;Today's post is an update to &lt;a href=&quot;https://github.com/vbmithr&quot;&gt;Vincent Bernardoff's&lt;/a&gt;
&lt;a href=&quot;http://openmirage.org/blog/introducing-vchan&quot;&gt;introducing vchan&lt;/a&gt; blog
post, updated to use the modern build scheme for Mirage.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Unless you are familiar with Xen's source code, there is little chance
that you've ever heard of the &lt;em&gt;vchan&lt;/em&gt; library or
protocol. Documentation about it is very scarce: a description can be
found on vchan's
&lt;a href=&quot;http://xenbits.xen.org/gitweb/?p=xen.git%3Ba=blob%3Bf=xen/include/public/io/libxenvchan.h%3Bhb=HEAD&quot;&gt;public header file&lt;/a&gt;,
that I quote here for convenience:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Originally borrowed from the
&lt;a href=&quot;http://www.qubes-os.org&quot;&gt;Qubes OS Project&lt;/a&gt;, this code (i.e. libvchan)
has been substantially rewritten [...]
This is a library for inter-domain communication.  A standard Xen ring
buffer is used, with a datagram-based interface built on top.  The
grant reference and event channels are shared in XenStore under a
user-specified path.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;This protocol uses shared memory for inter-domain communication,
i.e. between two VMs residing in the same Xen host, and uses Xen's
mechanisms -- more specifically,
&lt;a href=&quot;http://www.informit.com/articles/article.aspx?p=1160234&amp;amp;seqNum=3&quot;&gt;ring buffers&lt;/a&gt;
and
&lt;a href=&quot;http://xenbits.xen.org/gitweb/?p=xen.git%3Ba=blob%3Bf=tools/libxc/xenctrl.h%3Bh=f2cebafc9ddd4815ffc73fcf9e0d292b1d4c91ff%3Bhb=HEAD#l934&quot;&gt;event channels&lt;/a&gt;
-- in order to achieve its aims. The term &lt;em&gt;datagram-based interface&lt;/em&gt; simply
means that the
&lt;a href=&quot;http://xenbits.xen.org/gitweb/?p=xen.git%3Ba=blob%3Bf=tools/libvchan/libxenvchan.h%3Bh=6365d36a06f8c8f56454724cefc4c2f1d39beba2%3Bhb=HEAD&quot;&gt;interface&lt;/a&gt;
resembles UDP, although there is support for stream based communication (like
TCP) as well.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;vchan&lt;/code&gt; protocol is an important feature in MirageOS 2.0 since it
forms the foundational communication mechanism for &lt;strong&gt;building distributed
clusters of unikernels&lt;/strong&gt; that cooperate to solve problems that are beyond
the power of a single node.  Instead of forcing communication between
nodes via a conventional wire protocol like TCP, it permits highly efficient
low-overhead communication to nodes that are colocated on the same Xen
host machine.&lt;/p&gt;
&lt;p&gt;Before diving into vchan, I thought I'd also take the opportunity to describe the
&lt;a href=&quot;http://releases.ubuntu.com/14.04/&quot;&gt;Ubuntu-Trusty&lt;/a&gt; environment for developing
and running &lt;a href=&quot;http://www.xenproject.org/&quot;&gt;Xen&lt;/a&gt; unikernels.&lt;/p&gt;
&lt;h3&gt;Installing Xen on Ubuntu&lt;/h3&gt;

&lt;p&gt;Ubuntu 14.04 has good support for running Xen 4.4, the most recent release (at time of writing).
For running VMs it's a good idea to install Ubuntu on an LVM volume rather than directly on a
partition, which allows the use of LVs as the virtual disks for your VMs. On my system I have
a 40 Gig partition for '/', an 8 Gig swap partition and the rest is free for my VMs:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo lvs
   LV     VG      Attr      LSize  Pool Origin Data%  Move Log Copy%  Convert
   root   st28-vg -wi-ao--- 37.25g
   swap_1 st28-vg -wi-ao---  7.99g&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In this particular walkthough I won't be using disks, but later posts will.
Install Xen via the meta-package. This brings in all you will need to run VMs:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo apt-get install xen-system-amd64&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It used to be necessary to reorder the grub entries to make sure Xen was started
by default, but this is no longer necessary. Once the machine has rebooted, you
should be able to verify you're running virtualized by invoking 'xl':&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo xl list
Name                                        ID   Mem VCPUs      State   Time(s)
Domain-0                                     0  7958     6     r-----       9.7&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;My machine has 8 Gigs of memory, and this list shows that it's all being used by
my dom0, so I'll need to either balloon down dom0 or reboot with a lower maximum
memory. Ballooning is the most straightfoward:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo xenstore-write /local/domain/0/memory/target 4096000
$ sudo xl list
Name                                        ID   Mem VCPUs      State   Time(s)
Domain-0                                     0  4000     6     r-----      12.2&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is handy for quick testing, but is &lt;a href=&quot;http://wiki.xenproject.org/wiki/Xen_Project_Best_Practices&quot;&gt;discouraged&lt;/a&gt; by the Xen folks. So alternatively, change the xen command line by
editing &lt;code&gt;/etc/default/grub&lt;/code&gt; and add the line:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;GRUB_CMDLINE_XEN_DEFAULT=&amp;quot;dom0_mem=4096M,max:4096M&amp;quot;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once again, update-grub and reboot.&lt;/p&gt;
&lt;h3&gt;Mirage&lt;/h3&gt;

&lt;p&gt;Now lets get Mirage up and running. Install ocaml, opam and set up the opam environment:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo apt-get install ocaml opam ocaml-native-compilers camlp4-extra
...
$ opam init
...
$ eval `opam config env`&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Don't forget the &lt;code&gt;ocaml-native-compilers&lt;/code&gt;, as without this we can't
compile the unikernels. Now we are almost ready to install Mirage; we
need two more dependencies, and then we're good to go.&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo apt-get install m4 libxen-dev
$ opam install mirage mirage-xen mirage-unix vchan&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Where &lt;code&gt;m4&lt;/code&gt; is for ocamlfind, and &lt;code&gt;libxen-dev&lt;/code&gt; is required to compile the
unix variants of the &lt;code&gt;xen-evtchn&lt;/code&gt; and &lt;code&gt;xen-gnt&lt;/code&gt; libraries. Without these
installing vchan will complain that there is no &lt;code&gt;xen-evtchn.lwt&lt;/code&gt;
library installed.&lt;/p&gt;
&lt;p&gt;This second line installs the various Mirage and vchan libraries, but
doesn't build the demo unikernel and Unix CLI.  To get them, clone
the ocaml-vchan repository:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ git clone https://github.com/mirage/ocaml-vchan&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The demo unikernel is a very straightforward capitalizing echo server.
The &lt;a href=&quot;https://github.com/mirage/ocaml-vchan/blob/master/test/echo.ml#L13&quot;&gt;main function&lt;/a&gt; simply consists of&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;let (&amp;gt;&amp;gt;=) = Lwt.bind

let (&amp;gt;&amp;gt;|=) m f = m &amp;gt;&amp;gt;= function
| `Ok x -&amp;gt; f x
| `Eof -&amp;gt; Lwt.fail (Failure &amp;quot;End of file&amp;quot;)
| `Error (`Not_connected state) -&amp;gt;
    Lwt.fail (Failure (Printf.sprintf &amp;quot;Not in a connected state: %s&amp;quot;
      (Sexplib.Sexp.to_string (Node.V.sexp_of_state state))))

let rec echo vch =
  Node.V.read vch &amp;gt;&amp;gt;|= fun input_line -&amp;gt;
  let line = String.uppercase (Cstruct.to_string input_line) in
  let buf = Cstruct.create (String.length line) in
  Cstruct.blit_from_string line 0 buf 0 (String.length line);
  Node.V.write vch buf &amp;gt;&amp;gt;|= fun () -&amp;gt;
  echo vch&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where we've defined an error-handling monadic bind (&lt;code&gt;&amp;gt;&amp;gt;|=&lt;/code&gt;) which
is then used to sequence the read and write operations.&lt;/p&gt;
&lt;p&gt;Building the CLI is done simply via &lt;code&gt;make&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ make
...
$ ls -l node_cli.native
lrwxrwxrwx 1 jludlam jludlam 52 Jul 14 14:56 node_cli.native -&amp;gt; /home/jludlam/ocaml-vchan/_build/cli/node_cli.native&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Building the unikernel is done via the &lt;code&gt;mirage&lt;/code&gt; tool:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ cd test
$ mirage configure --xen
...
$ make depend
...
$ make
...
$ ls -l mir-echo.xen echo.xl
-rw-rw-r-- 1 jludlam jludlam     596 Jul 14 14:58 echo.xl
-rwxrwxr-x 1 jludlam jludlam 3803982 Jul 14 14:59 mir-echo.xen&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This make both the unikernel binary (the mir-echo.xen file) and a convenient
xl script to run it. To run, we use the xl tool, passing '-c' to connect
directly to the console so we can see what's going on:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo xl create -c echo.xl
Parsing config from echo.xl
kernel.c: Mirage OS!
kernel.c:   start_info: 0x11cd000(VA)
kernel.c:     nr_pages: 0x10000
kernel.c:   shared_inf: 0xdf2f6000(MA)
kernel.c:      pt_base: 0x11d0000(VA)
kernel.c: nr_pt_frames: 0xd
kernel.c:     mfn_list: 0x114d000(VA)
kernel.c:    mod_start: 0x0(VA)
kernel.c:      mod_len: 0
kernel.c:        flags: 0x0
kernel.c:     cmd_line:
x86_setup.c:   stack:      0x144f40-0x944f40
mm.c: MM: Init
x86_mm.c:       _text: 0x0(VA)
x86_mm.c:      _etext: 0xb8eec(VA)
x86_mm.c:    _erodata: 0xde000(VA)
x86_mm.c:      _edata: 0x1336f0(VA)
x86_mm.c: stack start: 0x144f40(VA)
x86_mm.c:        _end: 0x114d000(VA)
x86_mm.c:   start_pfn: 11e0
x86_mm.c:     max_pfn: 10000
x86_mm.c: Mapping memory range 0x1400000 - 0x10000000
x86_mm.c: setting 0x0-0xde000 readonly
x86_mm.c: skipped 0x1000
mm.c: MM: Initialise page allocator for 0x1256000 -&amp;gt; 0x10000000
mm.c: MM: done
x86_mm.c: Pages to allocate for p2m map: 2
x86_mm.c: Used 2 pages for map
x86_mm.c: Demand map pfns at 10001000-2010001000.
Initialising timer interface
Initializing Server domid=0 xs_path=data/vchan
gnttab_stubs.c: gnttab_table mapped at 0x10001000
Server: right_order = 13, left_order = 13
allocate_buffer_locations: gntref = 9
allocate_buffer_locations: gntref = 10
allocate_buffer_locations: gntref = 11
allocate_buffer_locations: gntref = 12
Writing config into the XenStore
Shared page is:

00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0d 00 0d 00 02 01 01 00 09 00 00 00 0a 00 00 00
0b 00 00 00 0c 00 00 00
Initialization done!&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Vchan is domain-to-domain communication, and relies on Xen's grant
tables to share the memory. The entries in the grant tables have
domain-level access control, so we need to know the domain ID of the
client and server in order to set up the communications. The test
unikernel server is hard-coded to talk to domain 0, so we only need to
know the domain ID of our echo server. In another terminal,&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo xl list
Name                                        ID   Mem VCPUs      State   Time(s)
Domain-0                                     0  4095     6     r-----    1602.9
echo                                         2   256     1     -b----       0.0&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In this case, the domain ID is 2, so we invoke the CLI as follows:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo ./node_cli.native 2
Client initializing: Received gntref = 8, evtchn = 4
Mapped the ring shared page:

00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0d 00 0d 00 02 01 01 00 09 00 00 00 0a 00 00 00
0b 00 00 00 0c 00 00 00
Correctly bound evtchn number 71&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We're now connected via vchan to the Mirage domain. The test server
is simply a capitalisation service:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;hello from dom0
HELLO FROM DOM0&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Ctrl-C to get out of the CLI, and destroy the domain with an &lt;code&gt;xl destroy&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;console&quot;&gt;&lt;code class=&quot;console&quot;&gt;$ sudo xl destroy test&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;vchan&lt;/code&gt; is a very low-level communication mechanism, and so our next post on
this topic will address how to use it in combination with a name resolver
to intelligently map connection requests to use &lt;code&gt;vchan&lt;/code&gt; if available, and
otherwise fall back to normal TCP or TCP+TLS.&lt;/p&gt;

   </content><id>http://openmirage.org/blog/update-on-vchan</id><title type="text">Vchan: Low-latency inter-VM communication channels</title><updated>2014-07-16T12:00:00+00:00</updated><author><email></email><name>Jon Ludlam</name></author></entry><entry><link href="http://openmirage.org/blog/modular-foreign-function-bindings" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;One of the most frequent questions about MirageOS from developers is
&amp;quot;do I really need to write all my code in OCaml&amp;quot;?  There are, of
course, very good reasons to build the core system in pure OCaml: the
module system permits reusing algorithmic abstractions at scale, and
OCaml's static type checking makes it possible to enforce lightweight
invariants across interfaces.  However, it's ultimately necessary to
support interfacing to existing code, and this blog post will describe
what we're doing to make this possible this without sacrificing the
security benefits afforded by unikernels.&lt;/p&gt;
&lt;p&gt;A MirageOS application works by abstracting the &lt;em&gt;logic&lt;/em&gt; of the
application from the details of &lt;em&gt;platform&lt;/em&gt; that it is compiled for.
The &lt;code&gt;mirage&lt;/code&gt; CLI tool parses a configuration file that represents the
desired hardware target, which can be a Unix binary or a specialized
Xen guest OS.  Our foreign function interface design elaborates on
these design principles by separating the &lt;em&gt;description&lt;/em&gt; of the C
foreign functions from how we &lt;em&gt;link&lt;/em&gt; to that code.  For instance, a
Unix unikernel could use the normal &lt;code&gt;ld.so&lt;/code&gt; to connect to a shared
library, while in Xen we would need to interface to that C library
through some other mechanism (for instance, a separate VM could be
spawned to run the untrusted OpenSSL code).  If you're curious about
how this works, this blog post is for you!&lt;/p&gt;
&lt;h3&gt;Introducing ctypes&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes&quot;&gt;ocaml-ctypes&lt;/a&gt; (&amp;quot;ctypes&amp;quot; for short) is a library for
gluing together OCaml code and C code without writing any C.  This
post introduces the ctypes library with a couple of simple examples,
and outlines how OCaml's module system makes it possible to write
high-level bindings to C that are independent of any particular
linking mechanism.&lt;/p&gt;
&lt;h3&gt;Hello, C&lt;/h3&gt;

&lt;p&gt;Binding a C function using ctypes involves two steps.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;First, construct an OCaml value that represents the type of the function&lt;/li&gt;&lt;li&gt;Second, use the type representation and the function name to resolve and bind the function&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;For example, here's a binding to C's &lt;code&gt;puts&lt;/code&gt; function, which prints a string to
standard output and returns the number of characters written:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;let puts = foreign &amp;quot;puts&amp;quot; (string @-&amp;gt; returning int)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After the call to &lt;code&gt;foreign&lt;/code&gt; the bound function is available to OCaml
immediately.  Here's a call to &lt;code&gt;puts&lt;/code&gt; from the interactive top level:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;# puts &amp;quot;Hello, world&amp;quot;;;
Hello, world
- : int = 13&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&amp;lt;Hello-C/&amp;gt;&lt;/h3&gt;

&lt;p&gt;Now that we've had a taste of ctypes, let's look at a more realistic
example: a program that defines bindings to the &lt;a href=&quot;http://www.libexpat.org/&quot;&gt;expat&lt;/a&gt; XML
parsing library, then uses them to display the structure of an XML
document.&lt;/p&gt;
&lt;p&gt;We'll start by describing the types used by expat.  Since ctypes
represents C types as OCaml values, each of the types we need becomes
a value binding in our OCaml program.  The parser object involves an
incomplete (abstract) struct definition and a typedef for a pointer to
a struct:&lt;/p&gt;
&lt;pre class=&quot;C&quot;&gt;&lt;code class=&quot;C&quot;&gt;struct xml_ParserStruct;
typedef xml_ParserStruct *xml_Parser;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In ctypes these become calls to the &lt;code&gt;structure&lt;/code&gt; and &lt;code&gt;ptr&lt;/code&gt; functions:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;let parser_struct : [`XML_ParserStruct] structure typ = structure &amp;quot;xml_ParserStruct&amp;quot;
let xml_Parser = ptr parser_struct&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Next, we'll use the type representations to bind some functions.  The
&lt;a href=&quot;http://www.xml.com/pub/a/1999/09/expat/reference.html#parsercreate&quot;&gt;&lt;code&gt;XML_ParserCreate&lt;/code&gt;&lt;/a&gt;
and
&lt;a href=&quot;http://www.xml.com/pub/a/1999/09/expat/reference.html#parserfree&quot;&gt;&lt;code&gt;XML_ParserFree&lt;/code&gt;&lt;/a&gt;
functions construct and destroy parser objects.  As with &lt;code&gt;puts&lt;/code&gt;, each
function binding involves a simple call to &lt;code&gt;foreign&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;let parser_create = foreign &amp;quot;XML_ParserCreate&amp;quot;
  (ptr void @-&amp;gt; returning xml_Parser)
let parser_free = foreign &amp;quot;XML_ParserFree&amp;quot;
  (xml_Parser @-&amp;gt; returning void)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Expat operates primarily through callbacks: when start and end elements are
encountered the parser invokes user-registered functions, passing the tag names
and attributes (along with a piece of user data):&lt;/p&gt;
&lt;pre class=&quot;C&quot;&gt;&lt;code class=&quot;C&quot;&gt;typedef void (*start_handler)(void *, char *, char **);
typedef void (*end_handler)(void *, char *);&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In ctypes function pointer types are built using the &lt;code&gt;funptr&lt;/code&gt; function:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;let start_handler =
  funptr (ptr void @-&amp;gt; string @-&amp;gt; ptr string @-&amp;gt; returning void)
let end_handler =
  funptr (ptr void @-&amp;gt; string @-&amp;gt; returning void)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can use the &lt;code&gt;start_handler&lt;/code&gt; and &lt;code&gt;end_handler&lt;/code&gt; type representations to bind
&lt;a href=&quot;http://www.xml.com/pub/a/1999/09/expat/reference.html#elementhandler&quot;&gt;&lt;code&gt;XML_SetElementHandler&lt;/code&gt;&lt;/a&gt;, the callback-registration function:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;let set_element_handler = foreign &amp;quot;XML_SetElementHandler&amp;quot;
  (xml_Parser @-&amp;gt; start_handler @-&amp;gt; end_handler @-&amp;gt; returning void)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The type that OCaml infers for &lt;code&gt;set_element_handler&lt;/code&gt; reveals that the function
accepts regular OCaml functions as arguments, since the argument types are
normal OCaml function types:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;val set_element_handler :
  [ `XML_ParserStruct ] structure ptr -&amp;gt;
  (unit ptr -&amp;gt; string -&amp;gt; string ptr -&amp;gt; unit) -&amp;gt;
  (unit ptr -&amp;gt; string -&amp;gt; unit) -&amp;gt; unit&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There's one remaining function to bind, then we're ready to use the
library.  The
&lt;a href=&quot;http://www.xml.com/pub/a/1999/09/expat/reference.html#parse&quot;&gt;&lt;code&gt;XML_Parse&lt;/code&gt;&lt;/a&gt;
function performs the actual parsing, invoking the callbacks when tags
are encountered:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;let parse = foreign &amp;quot;XML_Parse&amp;quot;
  (xml_Parser @-&amp;gt; string @-&amp;gt; int @-&amp;gt; int @-&amp;gt; returning int)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As before, all the functions that we've bound are available for use
immediately.  We'll start by using them to define a more idiomatic OCaml entry
point to the library.  The &lt;code&gt;parse_string&lt;/code&gt; function accepts the start and end
callbacks as labelled arguments, along with a string to parse:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;let parse_string ~start_handler ~end_handler s =
  let p = parser_create null in
  let () = set_element_handler p start_handler end_handler in
  let _ = parse p s (String.length s) 1 in
  parser_free p&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Using &lt;code&gt;parse_string&lt;/code&gt; we can write a program that prints out the names of each
element in an XML document, indented according to nesting depth:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;let depth = ref 0

let start_handler _ name _ =
  Printf.printf &amp;quot;%*s%s\n&amp;quot; (!depth * 3) &amp;quot;&amp;quot; name;
  incr depth

let end_handler _ _ =
  decr depth

let () =
  parse_string ~start_handler ~end_handler (In_channel.input_all stdin)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The full source of the program is &lt;a href=&quot;https://github.com/yallop/ocaml-ctypes-expat-example&quot;&gt;available on github&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here's the program in action:&lt;/p&gt;
&lt;pre class=&quot;bash&quot;&gt;&lt;code class=&quot;bash&quot;&gt;$ ocamlfind opt -thread -package core,ctypes.foreign expat_example.ml \
   -linkpkg -cclib -lexpat -o expat_example
$ wget -q http://openmirage.org/blog/atom.xml -O /dev/stdout \
  | ./expat_example
feed
   id
   title
   subtitle
   rights
   updated
   link
   link
   contributor
      email
      uri
      name
[...]&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Since this is just a high-level overview we've passed over a number of
details.  The interested reader can find a more comprehensive introduction to
using ctypes in &lt;a href=&quot;https://realworldocaml.org/v1/en/html/foreign-function-interface.html&quot;&gt;Chapter 19: Foreign Function Interface&lt;/a&gt; of &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Dynamic vs static&lt;/h3&gt;

&lt;p&gt;Up to this point we've been using a single function, &lt;code&gt;foreign&lt;/code&gt;, to
make C functions available to OCaml.  Although &lt;code&gt;foreign&lt;/code&gt; is simple to
use, there's quite a lot going on behind the scenes.  The two
arguments to &lt;code&gt;foreign&lt;/code&gt; are used to dynamically construct an OCaml
function value that wraps the C function: the name is used to resolve
the code for the C function, and the type representation is used to
construct a call frame appropriate to the C types invovled and to the
underlying platform.&lt;/p&gt;
&lt;p&gt;The dynamic nature of &lt;code&gt;foreign&lt;/code&gt; that makes it convenient for
interactive use, also makes it unsuitable for some environments.
There are three main drawbacks:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;Binding functions dynamically involves a certain loss of &lt;em&gt;safety&lt;/em&gt;:
 since C libraries typically don't maintain information about the
 types of the functions they contain, there's no way to check whether
 the type representation passed to &lt;code&gt;foreign&lt;/code&gt; matches the actual type of
 the C function.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;Dynamically constructing calls introduces a certain &lt;em&gt;interpretative
 overhead&lt;/em&gt;.  In mitigation, this overhead is much less than might be supposed,
 since much of the work can be done when the function is bound rather than
 when the call is made, and &lt;code&gt;foreign&lt;/code&gt; has been used to bind C functions in
 &lt;a href=&quot;http://erratique.ch/software/tgls&quot;&gt;performance-sensitive applications&lt;/a&gt; without problems.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;The implementation of &lt;code&gt;foreign&lt;/code&gt; uses a low-level library, &lt;a href=&quot;https://sourceware.org/libffi/&quot;&gt;libffi&lt;/a&gt;,
 to deal with calling conventions across platforms.  While libffi is mature
 and widely supported, it's not appropriate for use in every environment.
 For example, introducing such a (relatively) large and complex library into
 Mirage would compromise many of the benefits of writing the rest of the
 system in OCaml.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;Happily, there's a solution at hand.  As the introduction hints, &lt;code&gt;foreign&lt;/code&gt; is
one of a number of binding strategies, and OCaml's module system makes it easy
to defer the choice of which strategy to use when writing the actual code.
Placing the &lt;code&gt;expat&lt;/code&gt; bindings in a functor (parameterised module) makes it
possible to abstract over the linking strategy:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;module Bindings(F : FOREIGN) =
struct
  let parser_create = F.foreign &amp;quot;XML_ParserCreate&amp;quot;
    (ptr void @-&amp;gt; returning xml_Parser)
  let parser_free = F.foreign &amp;quot;XML_ParserFree&amp;quot;
    (xml_Parser @-&amp;gt; returning void)
  let set_element_handler = F.foreign &amp;quot;XML_SetElementHandler&amp;quot;
    (xml_Parser @-&amp;gt; start_handler @-&amp;gt; end_handler @-&amp;gt; returning void)
  let parse = F.foreign &amp;quot;XML_Parse&amp;quot;
    (xml_Parser @-&amp;gt; string @-&amp;gt; int @-&amp;gt; int @-&amp;gt; returning int)
end&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;Bindings&lt;/code&gt; module accepts a single parameter of type &lt;code&gt;FOREIGN&lt;/code&gt;, which
encodes the binding strategy to use.  Instantiating &lt;code&gt;Bindings&lt;/code&gt; with a module
containing the &lt;code&gt;foreign&lt;/code&gt; function used above recovers the
dynamically-constructed bindings that we've been using so far.  However, there
are now other possibilities available.  In particular, we can instantiate
&lt;code&gt;Bindings&lt;/code&gt; with code generators that output code to expose the bound functions
to OCaml.  The actual instantiation is hidden behind a couple of convenient
functions, &lt;code&gt;write_c&lt;/code&gt; and &lt;code&gt;write_ml&lt;/code&gt;, which accept &lt;code&gt;Bindings&lt;/code&gt; as a parameter
and write to a &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/libref/Format.html#TYPEformatter&quot;&gt;formatter&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;Cstubs.write_c formatter ~prefix:&amp;quot;expat&amp;quot; ~bindings:(module Bindings)
Cstubs.write_ml formatter ~prefix:&amp;quot;expat&amp;quot; ~bindings:(module Bindings)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Generating code in this way eliminates the concerns associated with
constructing calls dynamically:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;The C compiler checks the types of the generated calls against the C
 headers (the API), so the safety concerns associated with linking
 directly against the C library binaries (the ABI) don't apply.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;There's no interpretative overhead, since the generated code is
 (statically) compiled.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;The dependency on libffi disappears altogether.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;How easy is it in practice to switch between dynamic and static
binding strategies?  It turns out that it's quite straightforward,
even for code that was originally written without parameterisation.
Bindings written using early releases of ctypes used the dynamic
strategy exclusively, since dynamic binding was then the only option
available.  The commit logs for projects that switched over to static
generation and linking (e.g. &lt;a href=&quot;https://github.com/whitequark/ocaml-lz4/commit/acc257ea1&quot;&gt;ocaml-lz4&lt;/a&gt; and
&lt;a href=&quot;https://github.com/janestreet/async_ssl/commit/ab5ea6f55e&quot;&gt;async-ssl&lt;/a&gt;) when it became available show that
moving to the new approach involved only straightforward and localised
changes.&lt;/p&gt;
&lt;h3&gt;Local vs remote&lt;/h3&gt;

&lt;p&gt;Generating code is safer than constructing calls dynamically, since it
allows the C compiler to check the types of function calls against
declarations.  However, there are some safety problems that even C's
type checking doesn't detect.  For instance, the following call is
type correct (given suitable definitions of &lt;code&gt;p&lt;/code&gt; and &lt;code&gt;q&lt;/code&gt;), but is
likely to misbehave at run time:&lt;/p&gt;
&lt;pre class=&quot;C&quot;&gt;&lt;code class=&quot;C&quot;&gt;memcpy(p, q, SIZE_MAX)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In contrast, code written purely in OCaml detects and prevents
attempts to write beyond the bounds of allocated objects:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;# StringLabels.blit ~src ~dst ~src_pos:0 ~dst_pos:0 ~len:max_int;;
Exception: Invalid_argument &amp;quot;String.blit&amp;quot;.&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It seems a shame to weaken OCaml's safety guarantees by linking in C
code that can potentially write to any region of memory, but what is
the alternative?&lt;/p&gt;
&lt;p&gt;One possibility is to use &lt;a href=&quot;http://en.wikipedia.org/wiki/Privilege_separation&quot;&gt;privilege separation&lt;/a&gt; to separate
trusted OCaml code from untrusted C functions.  The modular design of
ctypes means that privilege separation can be treated as one more
linking strategy: we can run C code in an entirely separate process
(or for Mirage/Xen, in a separate virtual machine), and instantiate
&lt;code&gt;Bindings&lt;/code&gt; with a strategy that forwards calls to the process using
standard inter-process communication.  The remote calling strategy is
not supported in the &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes/releases/tag/0.3.2&quot;&gt;current release&lt;/a&gt; of ctypes, but
it's scheduled for a future version.  As with the switch from dynamic
to static bindings, we anticipate that updating existing bindings to
use cross-process calls will be straightforward.&lt;/p&gt;
&lt;p&gt;This introductory post should give you a sense of the power of the unikernel
approach in Mirage.  By turning the FFI into just another library (for the C
interface description) and protocol (for the linkage model), we can use code
generation to map application logic onto the privilege model most suitable for
the target hardware platform.  This starts with Unix processes, continues onto Xen
paravirtualization, and could even extend into &lt;a href=&quot;http://www.cl.cam.ac.uk/research/security/ctsrd/cheri/&quot;&gt;CHERI&lt;/a&gt; fine-grained
compartmentalization.&lt;/p&gt;
&lt;h3&gt;Further examples&lt;/h3&gt;

&lt;p&gt;Although ctypes is a fairly new library, it's already in use in a
number of projects across a variety of domains: &lt;a href=&quot;http://erratique.ch/software/tgls&quot;&gt;graphics&lt;/a&gt;,
&lt;a href=&quot;http://erratique.ch/software/tsdl&quot;&gt;multimedia&lt;/a&gt;, &lt;a href=&quot;https://github.com/whitequark/ocaml-lz4&quot;&gt;compression&lt;/a&gt;, &lt;a href=&quot;https://github.com/dsheets/ocaml-sodium&quot;&gt;cryptography&lt;/a&gt;,
&lt;a href=&quot;https://github.com/nojb/ocaml-gsasl&quot;&gt;security&lt;/a&gt;, &lt;a href=&quot;https://github.com/hcarty/ocaml-gdal&quot;&gt;geospatial data&lt;/a&gt;, &lt;a href=&quot;http://github.com/rgrinberg/onanomsg&quot;&gt;communication&lt;/a&gt;,
and many others.  Further resources (documentation, forums, etc.) are
available via the &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes&quot;&gt;home page&lt;/a&gt;.&lt;/p&gt;

   </content><id>http://openmirage.org/blog/modular-foreign-function-bindings</id><title type="text">Modular foreign function bindings</title><updated>2014-07-15T12:00:00+00:00</updated><author><email></email><name>Jeremy Yallop</name></author></entry><entry><link href="http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;em&gt;This is the fifth in a series of posts that introduce new libraries for a pure OCaml implementation of TLS.
You might like to begin with the &lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;introduction&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;ocaml-tls&lt;/a&gt; is the new, clean-slate implementation of TLS in OCaml
that we've been working on for the past six months. In this post we
try to document some of its internal design, the reasons for the
decisions we made, and the current security status of that work. Try
our &lt;a href=&quot;https://tls.openmirage.org&quot;&gt;live interactive demonstration server&lt;/a&gt; which visualises TLS
sessions.&lt;/p&gt;
&lt;h3&gt;The OCaml-TLS architecture&lt;/h3&gt;

&lt;p&gt;The OCaml ecosystem has several distinct ways of interacting with the outside world
(and the network in particular): straightforward &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/libref/Unix.html&quot;&gt;unix&lt;/a&gt; interfaces
and the asynchronous programming libraries &lt;a href=&quot;http://ocsigen.org/lwt/&quot;&gt;lwt&lt;/a&gt; and &lt;a href=&quot;https://realworldocaml.org/v1/en/html/concurrent-programming-with-async.html&quot;&gt;async&lt;/a&gt;. One of the
early considerations was not to restrict ourselves to any of those -- we wanted
to support them all.&lt;/p&gt;
&lt;p&gt;There were also two distinct basic &amp;quot;platforms&amp;quot; we wanted to target from the
outset: the case of a simple executable, and the case of &lt;code&gt;Mirage&lt;/code&gt; unikernels.&lt;/p&gt;
&lt;p&gt;So one of the first questions we faced was deciding how to represent
interactions with the network in a portable way. This can be done by
systematically abstracting out the API boundary which gives access to network
operations, but we had a third thing in mind as well: we wanted to exploit the
functional nature of OCaml to its fullest extent!&lt;/p&gt;
&lt;p&gt;Our various prior experiences with Haskell and Idris convinced us to adopt
what is called &amp;quot;purely functional&amp;quot; technique. We believe it to be an approach
which first forces the programmer to give principled answers to all the
difficult design questions (errors and global data-flow) &lt;em&gt;in advance&lt;/em&gt;, and then
leads to far cleaner and composable code later on. A purely functional system
has all the data paths made completely explicit in the form of function
arguments and results. There are no unaccounted-for interactions between
components mediated by shared state, and all the activity of the parts of the
system is exposed through types since, after all, it's only about computing
values from values.&lt;/p&gt;
&lt;p&gt;For these reasons, the library is split into two parts: the directory &lt;code&gt;/lib&lt;/code&gt;
(and the corresponding findlib package &lt;code&gt;tls&lt;/code&gt;) contains the core TLS logic, and
&lt;code&gt;/mirage&lt;/code&gt; and &lt;code&gt;/lwt&lt;/code&gt; (packaged as &lt;code&gt;tls.mirage&lt;/code&gt; and &lt;code&gt;tls.lwt&lt;/code&gt; respectively)
contain front-ends that tie the core to &lt;code&gt;Mirage&lt;/code&gt; and &lt;code&gt;Lwt_unix&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;Core&lt;/h3&gt;

&lt;p&gt;The &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.mli&quot;&gt;core&lt;/a&gt; library is purely functional. A TLS session is represented by the
abstract type &lt;code&gt;Tls.Engine.state&lt;/code&gt;, and various functions consume this session
type together with raw bytes (&lt;code&gt;Cstruct.t&lt;/code&gt; -- which is by itself mutable, but
&lt;code&gt;ocaml-tls&lt;/code&gt; eschews this) and produce new session values and resulting buffers.&lt;/p&gt;
&lt;p&gt;The central entry point is &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.ml#L321&quot;&gt;handle_tls&lt;/a&gt;, which transforms an input state and a
buffer to an output state, a (possibly empty) buffer to send to the
communication partner, and an optional buffer of data intended to be received by
the application:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;type state

type ret = [
  | `Ok of [ `Ok of state | `Eof | `Alert of alert ] *
      [ `Response of Cstruct.t ] * [ `Data of Cstruct.t option ]
  | `Fail of alert * [ `Response of Cstruct.t ]
]

val handle_tls : state -&amp;gt; Cstruct.t -&amp;gt; ret&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As the signature shows, errors are signalled through the &lt;code&gt;ret&lt;/code&gt; type, which is a &lt;a href=&quot;https://realworldocaml.org/v1/en/html/variants.html#polymorphic-variants&quot;&gt;polymorphic variant&lt;/a&gt;. This
reflects the actual internal structure: all the errors are represented as
values, and operations are composed using an error &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/control.ml&quot;&gt;monad&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Other entry points share the same basic behaviour: they transform the prior
state and input bytes into the later state and output bytes.&lt;/p&gt;
&lt;p&gt;Here's a rough outline of what happens in &lt;code&gt;handle_tls&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;TLS packets consist of a header, which contains the protocol
 version, length, and content type, and the payload of the given
 content type. Once inside our &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.ml#L321&quot;&gt;main handler&lt;/a&gt;, we
 &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.ml#L150&quot;&gt;separate&lt;/a&gt; the buffer into TLS records, and
 &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.ml#L275&quot;&gt;process&lt;/a&gt; each individually. We first check that
 the version number is correct, then &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.ml#L95&quot;&gt;decrypt&lt;/a&gt;, and &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.ml#L85&quot;&gt;verify
  the mac&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;Decrypted data is then &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.ml#L240&quot;&gt;dispatched&lt;/a&gt; to one of four
 sub-protocol handlers (Handshake, Change Cipher Spec, Alert and
 Application Data). Each handler can &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/state.ml#L109&quot;&gt;return&lt;/a&gt; a new
 handshake state, outgoing data, application data, the new decryption
 state or an error (with the outgoing data being an interleaved list
 of buffers and new encryption states).&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;The outgoing buffers and the encryption states are
 &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.ml#L48&quot;&gt;traversed&lt;/a&gt; to produce the final output to be sent to the
 communication partner, and the final encryption, decryption and
 handshake states are combined into a new overall state which is
 returned to the caller.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;Handshake is (by far) the most complex TLS sub-protocol, with an elaborate state
machine. Our &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/handshake_client.ml#L285&quot;&gt;client&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/handshake_server.ml#L247&quot;&gt;server&lt;/a&gt; encode
this state as a &amp;quot;flat&amp;quot; &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/state.ml#L61&quot;&gt;sum type&lt;/a&gt;, with exactly one incoming
message allowed per state. The handlers first &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/reader.ml#L361&quot;&gt;parse&lt;/a&gt; the
handshake packet (which fails in case of malformed or unknown data) and then
dispatch it to the handling function. The &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/state.ml#L92&quot;&gt;handshake state&lt;/a&gt; is
carried around and a fresh one is returned from the handler in case it needs
updates. It consists of a protocol version, the handshake state, configuration,
renegotiation data, and possibly a handshake fragment.&lt;/p&gt;
&lt;p&gt;Logic of both handshake handlers is very localised, and does not mutate any
global data structures.&lt;/p&gt;
&lt;h3&gt;Core API&lt;/h3&gt;

&lt;p&gt;OCaml permits the implementation a module to be exported via a more
abstract &lt;em&gt;signature&lt;/em&gt; that hides the internal representation
details. Our public API for the core library consists of the
&lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/engine.mli&quot;&gt;Tls.Engine&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/config.mli&quot;&gt;Tls.Config&lt;/a&gt; modules.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Tls.Engine&lt;/code&gt; contains the basic reactive function &lt;code&gt;handle_tls&lt;/code&gt;, mentioned above,
which processes incoming data and optionally produces a response, together with
several operations that allow one to initiate message transfer like
&lt;code&gt;send_application_data&lt;/code&gt; (which processes application-level messages for
sending), &lt;code&gt;send_close_notify&lt;/code&gt; (for sending the ending message) and &lt;code&gt;reneg&lt;/code&gt;
(which initiates full TLS renegotiation).&lt;/p&gt;
&lt;p&gt;The module also contains the only two ways to obtain the initial state:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;val client : Config.client -&amp;gt; (state * Cstruct.t)
val server : Config.server -&amp;gt; state&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That is, one needs a configuration value to create it. The &lt;code&gt;Cstruct.t&lt;/code&gt;
that &lt;code&gt;client&lt;/code&gt; emits is the initial Client Hello since in TLS,
the client starts the session.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Tls.Config&lt;/code&gt; synthesizes configurations, separately for client and server
endpoints, through the functions &lt;code&gt;client_exn&lt;/code&gt; and &lt;code&gt;server_exn&lt;/code&gt;. They take a
number of parameters that define a TLS session, check them for consistency, and
return the sanitized &lt;code&gt;config&lt;/code&gt; value which can be used to create a &lt;code&gt;state&lt;/code&gt; and,
thus, a session. If the check fails, they raise an exception.&lt;/p&gt;
&lt;p&gt;The parameters include the pair of a certificate and its private key for the
server, and an &lt;code&gt;X509.Authenticator.t&lt;/code&gt; for the client, both produced by our
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509&quot;&gt;ocaml-x509&lt;/a&gt; library and described in a &lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;previous article&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This design reflects our attempts to make the API as close to &amp;quot;fire and forget&amp;quot;
as we could, given the complexity of TLS: we wanted the library to be relatively
straightforward to use, have a minimal API footprint and, above all, fail very
early and very loudly when misconfigured.&lt;/p&gt;
&lt;h3&gt;Effectful front-ends&lt;/h3&gt;

&lt;p&gt;Clearly, reading and writing network data &lt;em&gt;does&lt;/em&gt; change the state of the world.
Having a pure value describing the state of a TLS session is not really useful
once we write something onto the network; it is certainly not the case that we
can use more than one distinct &lt;code&gt;state&lt;/code&gt; to process further data, as only one
value is in sync with the other endpoint at any given time.&lt;/p&gt;
&lt;p&gt;Therefore we wrap the core types into stateful structures loosely inspired by
sockets and provide IO operations on those. The structures of &lt;code&gt;mirage&lt;/code&gt; and &lt;code&gt;lwt&lt;/code&gt;
front-ends mirror one another.&lt;/p&gt;
&lt;p&gt;In both cases, the structure is pull-based in the sense that no processing is
done until the client requires a read, as opposed to a callback-driven design
where the client registers a callback and the library starts spinning in a
listening loop and invoking it as soon as there is data to be processed. We do
this because in an asynchronous context, it is easy to create a callback-driven
interface from a demand-driven one, but the opposite is possible only with
unbounded buffering of incoming data.&lt;/p&gt;
&lt;p&gt;One exception to demand-driven design is the initial session creation: the
library will only yield the connection after the first handshake is over,
ensuring the invariant that it is impossible to interact with a connection if it
hasn't already been fully established.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Mirage&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;Mirage&lt;/code&gt; &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/mirage/tls_mirage_types.mli&quot;&gt;interface&lt;/a&gt; matches the &lt;a href=&quot;https://github.com/mirage/mirage/blob/ae3c966f8d726dc97208595b8005e02e39478cb1/types/V1.mli#L136&quot;&gt;FLOW&lt;/a&gt;
signature (with additional TLS-specific operations). We provide a functor that
needs to be applied to an underlying TCP module, to obtain a TLS transport on
top. For example:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;module Server (Stack: STACKV4) (Entropy: ENTROPY) (KV: KV_RO) =
struct

  module TLS  = Tls_mirage.Make (Stack.TCPV4) (Entropy)
  module X509 = Tls_mirage.X509 (KV) (Clock)

  let accept conf flow =
    TLS.server_of_tcp_flow conf flow &amp;gt;&amp;gt;= function
    | `Ok tls -&amp;gt;
      TLS.read tls &amp;gt;&amp;gt;= function
      | `Ok buf -&amp;gt;
        TLS.write tls buf &amp;gt;&amp;gt;= fun () -&amp;gt; TLS.close buf

  let start stack e kv =
    TLS.attach_entropy e &amp;gt;&amp;gt;= fun () -&amp;gt;
    lwt authenticator = X509.authenticator kv `Default in
    let conf          = Tls.Config.server_exn ~authenticator () in
    Stack.listen_tcpv4 stack 4433 (accept conf) ;
    Stack.listen stack

end&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Lwt&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;lwt&lt;/code&gt; interface has &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lwt/tls_lwt.mli&quot;&gt;two layers&lt;/a&gt;. &lt;code&gt;Tls_lwt.Unix&lt;/code&gt; is loosely based
on read/write operations from &lt;code&gt;Lwt_unix&lt;/code&gt; and provides in-place update of
buffers. &lt;code&gt;read&lt;/code&gt;, for example, takes a &lt;code&gt;Cstruct.t&lt;/code&gt; to write into and returns the
number of bytes read. The surrounding module, &lt;code&gt;Tls_lwt&lt;/code&gt;, provides a simpler,
&lt;code&gt;Lwt_io&lt;/code&gt;-compatible API built on top:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;let main host port =
  Tls_lwt.rng_init () &amp;gt;&amp;gt;= fun () -&amp;gt;
  lwt authenticator = X509_lwt.authenticator (`Ca_dir nss_trusted_ca_dir) in
  lwt (ic, oc)      = Tls_lwt.connect ~authenticator (host, port) in
  let req = String.concat &amp;quot;\r\n&amp;quot; [
    &amp;quot;GET / HTTP/1.1&amp;quot; ; &amp;quot;Host: &amp;quot; ^ host ; &amp;quot;Connection: close&amp;quot; ; &amp;quot;&amp;quot; ; &amp;quot;&amp;quot;
  ] in
  Lwt_io.(write oc req &amp;gt;&amp;gt;= fun () -&amp;gt; read ic &amp;gt;&amp;gt;= print)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We have further plans to provide wrappers for &lt;a href=&quot;https://realworldocaml.org/v1/en/html/concurrent-programming-with-async.html&quot;&gt;`Async`&lt;/a&gt; and plain &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/libref/Unix.html&quot;&gt;`Unix`&lt;/a&gt; in a
similar vein.&lt;/p&gt;
&lt;h3&gt;Attacks on TLS&lt;/h3&gt;

&lt;p&gt;TLS the most widely deployed security protocol on the Internet and, at
over 15 years, is also showing its age. As such, a flaw is a valuable
commodity due to the commercially sensitive nature of data that is
encrypted with TLS. Various vulnerabilities on different layers of TLS
have been found - &lt;a href=&quot;https://en.wikipedia.org/wiki/Heartbleed&quot;&gt;heartbleed&lt;/a&gt; and others are implementation
specific, advancements in cryptanalysis such as &lt;a href=&quot;http://eprint.iacr.org/2005/067&quot;&gt;collisions of
MD5&lt;/a&gt; lead to vulnerabilities, and even others are due
to incorrect usage of TLS (&lt;a href=&quot;http://www.theregister.co.uk/2013/08/01/gmail_hotmail_hijacking/&quot;&gt;truncation attack&lt;/a&gt; or
&lt;a href=&quot;http://breachattack.com/&quot;&gt;BREACH&lt;/a&gt;). Finally, some weaknesses are in the protocol
itself. Extensive &lt;a href=&quot;http://eprint.iacr.org/2013/049.pdf&quot;&gt;overviews&lt;/a&gt; of &lt;a href=&quot;http://www.mitls.org/wsgi/tls-attacks&quot;&gt;attacks on
TLS&lt;/a&gt; are available.&lt;/p&gt;
&lt;p&gt;We look at protocol level attacks of TLS and how &lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;ocaml-tls&lt;/a&gt;
implements mitigations against these.  &lt;a href=&quot;https://tools.ietf.org/html/rfc5246#appendix-D.4&quot;&gt;TLS 1.2 RFC&lt;/a&gt; provides an
overview of attacks and mitigations, and we &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues/31&quot;&gt;track&lt;/a&gt; our progress in
covering them. This is slightly out of date as the RFC is roughly six years old and
in the meantime more attacks have been published, such as the &lt;a href=&quot;http://www.educatedguesswork.org/2009/11/understanding_the_tls_renegoti.html&quot;&gt;renegotiation
flaw&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;As &lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;already mentioned&lt;/a&gt;, we track all our
&lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues?labels=security%20concern&amp;amp;page=1&amp;amp;state=closed&quot;&gt;mitigated&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues?labels=security%20concern&amp;amp;page=1&amp;amp;state=open&quot;&gt;open&lt;/a&gt; security issues on our GitHub
issue tracker.&lt;/p&gt;
&lt;p&gt;Due to the choice of using OCaml, a memory managed programming
language, we obstruct entire bug classes, namely temporal and spatial
memory safety.&lt;/p&gt;
&lt;p&gt;Cryptanalysis and improvement of computational power weaken some
ciphers, such as RC4 and 3DES (see &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues/8&quot;&gt;issue 8&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues/10&quot;&gt;issue
10&lt;/a&gt;). If we phase these two ciphers out, there wouldn't be
any matching ciphersuite left to communicate with some compliant TLS-1.0
implementations, such as Windows XP, that do not support AES.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Timing attacks&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;When the timing characteristics between the common case and the error
case are different, this might potentially leak confidential
information. Timing is a very prominent side-channel and there are a huge
variety of timing attacks on different layers, which are observable by
different attackers. Small differences in timing behaviour might
initially be exploitable only by a local attacker, but advancements to
the attack (e.g. increasing the number of tests) might allow a 
remote attacker to filter the noise and exploit the different timing
behaviour.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Timing of cryptographic primitives&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We &lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;already mentioned&lt;/a&gt; &lt;a href=&quot;http://www.cs.tau.ac.il/~tromer/papers/cache.pdf&quot;&gt;cache&lt;/a&gt; &lt;a href=&quot;http://cr.yp.to/antiforgery/cachetiming-20050414.pdf&quot;&gt;timing&lt;/a&gt;
attacks on our AES implementation, and that we use &lt;a href=&quot;https://en.wikipedia.org/wiki/Blinding_(cryptography)&quot;&gt;blinding&lt;/a&gt;
techniques to mitigate RSA timing attacks.&lt;/p&gt;
&lt;p&gt;By using a memory managed programming language, we open the attack
vector of garbage collector (GC) timing attacks (also mentioned &lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;in
our nocrypto introduction&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Furthermore, research has been done on virtual machine side channels
(&lt;a href=&quot;http://eprint.iacr.org/2013/448.pdf&quot;&gt;l3&lt;/a&gt;, &lt;a href=&quot;http://www.cs.unc.edu/~reiter/papers/2012/CCS.pdf&quot;&gt;cross vm&lt;/a&gt; and &lt;a href=&quot;http://fc12.ifca.ai/pre-proceedings/paper_70.pdf&quot;&gt;cache timing&lt;/a&gt;), which we
will need to study and mitigate appropriately.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;For the time being we suggest to not use the stack on a multi-tenant
shared host or on a shared host which malicious users might have
access to.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bleichenbacher&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In 1998, Daniel Bleichenbacher discovered a &lt;a href=&quot;http://archiv.infsec.ethz.ch/education/fs08/secsem/Bleichenbacher98.pdf&quot;&gt;timing flaw in the
PKCS1&lt;/a&gt; encoding of the premaster secret: the TLS server
failed faster when the padding was wrong than when the decryption
failed. Using this timing, an attacker can run an adaptive chosen
ciphertext attack and find out the plain text of a PKCS1 encrypted
message. In TLS, when RSA is used as the key exchange method, this
leads to discovery of the premaster secret, which is used to derive the
keys for the current session.&lt;/p&gt;
&lt;p&gt;The mitigation is to have both padding and decryption failures use the
exact same amount of time, thus there should not be any data-dependent
branches or different memory access patterns in the code. We
implemented this mitigation in &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/c06cbaaffe49024d8570916b70f7839603a54692/lib/handshake_server.ml#L45&quot;&gt;Handshake_server&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Padding oracle and CBC timing&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.iacr.org/archive/eurocrypt2002/23320530/cbc02_e02d.pdf&quot;&gt;Vaudenay&lt;/a&gt; discovered a vulnerability involving block ciphers: if an
attacker can distinguish between bad mac and bad padding, recovery of
the plaintext is possible (within an adaptive chosen ciphertext
attack). Another approach using the same issue is to use
&lt;a href=&quot;http://lasecwww.epfl.ch/memo/memo_ssl.shtml&quot;&gt;timing&lt;/a&gt; information instead of separate error messages.
Further details are described &lt;a href=&quot;https://www.openssl.org/~bodo/tls-cbc.txt&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The countermeasure, which we implement &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/c06cbaaffe49024d8570916b70f7839603a54692/lib/engine.ml#L100&quot;&gt;here&lt;/a&gt;, is to continue
with the mac computation even though the padding is
incorrect. Furthermore, we send the same alert (&lt;code&gt;bad_record_mac&lt;/code&gt;)
independent of whether the padding is malformed or the mac is
incorrect.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Lucky 13&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;An advancement of the CBC timing attack was discovered in 2013, named
&lt;a href=&quot;http://www.isg.rhul.ac.uk/tls/Lucky13.html&quot;&gt;Lucky 13&lt;/a&gt;. Due to the fact that the mac is computed over the
plaintext without padding, there is a slight (but measurable)
difference in timing between computing the mac of the plaintext and
computing the fake mac of the ciphertext. This leaks information. We
do not have proper mitigation against Lucky 13 in place yet.  You can
find further discussion in &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues/7&quot;&gt;issue 7&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/pull/49&quot;&gt;pull request
49&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Renegotiation not authenticated&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In 2009, Marsh Ray published a vulnerability of the TLS protocol which
lets an attacker prepend arbitrary data to a session due to
&lt;a href=&quot;http://www.educatedguesswork.org/2009/11/understanding_the_tls_renegoti.html&quot;&gt;unauthenticated renegotiation&lt;/a&gt;. The attack
exploits the fact that a renegotiation of ciphers and key material is
possible within a session, and this renegotiated handshake is not
authenticated by the previous handshake. A man in the middle can
initiate a session with a server, send some data, and hand over the
session to a client. Neither the client nor the server can detect the
man in the middle.&lt;/p&gt;
&lt;p&gt;A fix for this issue is the &lt;a href=&quot;https://tools.ietf.org/html/rfc5746&quot;&gt;secure renegotiation extension&lt;/a&gt;,
which embeds authenticated data of the previous handshake into the
client and server hello messages. Now, if a man in the middle
initiates a renegotiation, the server will not complete it due to
missing authentication data (the client believes this is the first
handshake).&lt;/p&gt;
&lt;p&gt;We implement and require the secure renegotiation extension by
default, but it is possible to configure &lt;code&gt;ocaml-tls&lt;/code&gt; to not require
it -- to be able to communicate with servers and
clients which do not support this extension.&lt;/p&gt;
&lt;p&gt;Implementation of the mitigation is on the server side in
&lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/c06cbaaffe49024d8570916b70f7839603a54692/lib/handshake_server.ml#L85&quot;&gt;ensure_reneg&lt;/a&gt; and on the client side in &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/c06cbaaffe49024d8570916b70f7839603a54692/lib/handshake_client.ml#L50&quot;&gt;validate_reneg&lt;/a&gt;. The
data required for the secure renegotiation is stored in
&lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/c06cbaaffe49024d8570916b70f7839603a54692/lib/state.ml#L97&quot;&gt;`handshake_state`&lt;/a&gt; while sending and receiving Finished
messages. You can find further discussion in &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues/3&quot;&gt;issue 3&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TLS 1.0 and known-plaintext (BEAST)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;TLS 1.0 reuses the last ciphertext block as IV in CBC mode. If an attacker
has a (partially) known plaintext, she can find the remaining plaintext.
This is known as the &lt;a href=&quot;http://vnhacker.blogspot.co.uk/2011/09/beast.html&quot;&gt;BEAST&lt;/a&gt; attack and there is a &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=665814&quot;&gt;long discussion&lt;/a&gt;
about mitigations. Our mitigation is to prepend each TLS-1.0
application data fragment with an empty fragment to randomize the IV.
We do this exactly &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/c06cbaaffe49024d8570916b70f7839603a54692/lib/engine.ml#L375&quot;&gt;here&lt;/a&gt;. There is further discussion in
&lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues/2&quot;&gt;issue 2&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Our mitigation is slightly different from the 1/n-1 splitting proposed
&lt;a href=&quot;https://community.qualys.com/blogs/securitylabs/2013/09/10/is-beast-still-a-threat&quot;&gt;here&lt;/a&gt;: we split every application data frame into a 0 byte
and n byte frame, whereas they split into a 1 byte and a n-1 byte
frame.&lt;/p&gt;
&lt;p&gt;Researchers have exploited this vulnerability in 2011, although it was
known since &lt;a href=&quot;http://eprint.iacr.org/2006/136&quot;&gt;2006&lt;/a&gt;. TLS versions 1.1 and 1.2 use an explicit IV,
instead of reusing the last cipher block on the wire.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Compression and information leakage (CRIME)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;When using compression on a chosen-plaintext, encrypting this can leak
information, known as &lt;a href=&quot;http://arstechnica.com/security/2012/09/crime-hijacks-https-sessions/&quot;&gt;CRIME&lt;/a&gt;. &lt;a href=&quot;http://breachattack.com/&quot;&gt;BREACH&lt;/a&gt; furthermore
exploits application layer compression, such as HTTP compression. We
mitigate CRIME by not providing any TLS compression support, while we
cannot do anything to mitigate BREACH.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Traffic analysis&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Due to limited amount of padding data, the actual size of transmitted
data can be recovered. The mitigation is to implement &lt;a href=&quot;http://tools.ietf.org/html/draft-pironti-tls-length-hiding-02&quot;&gt;length hiding
policies&lt;/a&gt;. This is tracked as &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues/162&quot;&gt;issue 162&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Version rollback&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;SSL-2.0 is insecure, a man in the middle can downgrade the version to
SSL-2.0. The mitigation we implement is that we do not support
SSL-2.0, and thus cannot be downgraded. Also, we check that the
version of the client hello matches the first two bytes in the
premaster secret &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/c06cbaaffe49024d8570916b70f7839603a54692/lib/handshake_server.ml#L55&quot;&gt;here&lt;/a&gt;. You can find further discussion in
&lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues/5&quot;&gt;issue 5&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Triple handshake&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A vulnerability including session resumption and renegotiation was
discovered by the &lt;a href=&quot;http://www.mitls.org&quot;&gt;miTLS team&lt;/a&gt;, named &lt;a href=&quot;https://secure-resumption.com/&quot;&gt;triple
handshake&lt;/a&gt;.  Mitigations include disallowing renegotiation,
disallowing modification of the certificate during renegotiation, or
a hello extension. Since we do not support session resumption yet, we
have not yet implemented any of the mentioned mitigations. There is
further discussion in &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues/9&quot;&gt;issue 9&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Alert attack&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A &lt;a href=&quot;http://www.mitls.org/wsgi/alert-attack&quot;&gt;fragment of an alert&lt;/a&gt; can be sent by a man in the
middle during the initial handshake. If the fragment is not cleared
once the handshake is finished, the authentication of alerts is
broken. This was discovered in 2012; our mitigation is to discard
fragmented alerts.&lt;/p&gt;
&lt;h3&gt;EOF.&lt;/h3&gt;

&lt;p&gt;Within six months, two hackers managed to develop a clean-slate TLS
stack, together with required crypto primitives, ASN.1, and X.509
handling, in a high-level pure language. We interoperate with widely
deployed TLS stacks, as shown by our &lt;a href=&quot;https://tls.openmirage.org&quot;&gt;demo server&lt;/a&gt;.  The code
size is nearly two orders of magnitude smaller than OpenSSL, the most
widely used open source library (written in C, which a lot of
programming languages wrap instead of providing their own TLS
implementation). Our code base seems to be robust -- the &lt;a href=&quot;https://tls.openmirage.org&quot;&gt;demo
server&lt;/a&gt; successfully finished over 22500 sessions in less than a
week, with only 11 failing traces.&lt;/p&gt;
&lt;p&gt;There is a huge need for high quality TLS implementations, because
several TLS implementations suffered this year from severe security
problems, such as &lt;a href=&quot;https://en.wikipedia.org/wiki/Heartbleed&quot;&gt;heartbleed&lt;/a&gt;, &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1266&quot;&gt;goto fail&lt;/a&gt;, &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3466&quot;&gt;session
id&lt;/a&gt;, &lt;a href=&quot;http://armoredbarista.blogspot.de/2014/04/easter-hack-even-more-critical-bugs-in.html&quot;&gt;Bleichenbacher&lt;/a&gt;, &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224&quot;&gt;change cipher
suite&lt;/a&gt; and &lt;a href=&quot;https://polarssl.org/tech-updates/security-advisories/polarssl-security-advisory-2014-02&quot;&gt;GCM DoS&lt;/a&gt;. The main cause is
implementation complexity due to lack of abstraction, and memory
safety issues.&lt;/p&gt;
&lt;p&gt;We still need to address some security issues, and improve our performance. We
invite people to do rigorous code audits (both manual and automated) and try
testing our code in their services.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Please be aware that this release is a &lt;em&gt;beta&lt;/em&gt; and is missing external code audits.
It is not yet intended for use in any security critical applications.&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;Acknowledgements&lt;/h3&gt;

&lt;p&gt;Since this is the final post in our series, we would like to thank all
people who reported issues so far: &lt;a href=&quot;http://anil.recoil.org/&quot;&gt;Anil Madhavapeddy&lt;/a&gt;, &lt;a href=&quot;https://github.com/edwintorok&quot;&gt;T&amp;ouml;r&amp;ouml;k
Edwin&lt;/a&gt;, &lt;a href=&quot;http://erratique.ch/&quot;&gt;Daniel B&amp;uuml;nzli&lt;/a&gt;, &lt;a href=&quot;http://blog.andreas.org/&quot;&gt;Andreas Bogk&lt;/a&gt;, &lt;a href=&quot;http://gregorkopf.de/blog/&quot;&gt;Gregor Kopf&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/graham_steel&quot;&gt;Graham
Steel&lt;/a&gt;, &lt;a href=&quot;https://github.com/vouillon&quot;&gt;Jerome Vouillon&lt;/a&gt;, &lt;a href=&quot;http://amirchaudhry.com/&quot;&gt;Amir Chaudhry&lt;/a&gt;,
&lt;a href=&quot;http://ashishagarwal.org&quot;&gt;Ashish Agarwal&lt;/a&gt;. Additionally, we want to thank the
&lt;a href=&quot;http://www.mitls.org&quot;&gt;miTLS&lt;/a&gt; team (especially Cedric and Karthikeyan) for fruitful
discussions, as well as the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/&quot;&gt;OCaml Labs&lt;/a&gt; and
&lt;a href=&quot;http://www.openmirage.org&quot;&gt;Mirage&lt;/a&gt; teams. And thanks to &lt;a href=&quot;http://www.cl.cam.ac.uk/~pes20/&quot;&gt;Peter Sewell&lt;/a&gt; and
&lt;a href=&quot;http://www.cs.nott.ac.uk/~rmm/&quot;&gt;Richard Mortier&lt;/a&gt; for funding within the &lt;a href=&quot;http://rems.io&quot;&gt;REMS&lt;/a&gt;, &lt;a href=&quot;http://usercentricnetworking.eu/&quot;&gt;UCN&lt;/a&gt;, and &lt;a href=&quot;http://www.horizon.ac.uk&quot;&gt;Horizon&lt;/a&gt;
projects. The software was started in &lt;a href=&quot;http://www.aftasmirleft.com/&quot;&gt;Aftas beach house&lt;/a&gt; in
Mirleft, Morocco.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openmirage.org/graphics/aftas-mirleft.jpg&quot; alt=&quot;Aftas Beach&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;hr/&gt;Posts in this TLS series:
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;Introducing transport layer security (TLS) in pure OCaml&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;OCaml-TLS: building the nocrypto library core&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;OCaml-TLS: adventures in X.509 certificate parsing and validation&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-asn1&quot;&gt;OCaml-TLS: ASN.1 and notation embedding&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation&quot;&gt;OCaml-TLS: the protocol implementation and mitigations to known attacks&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;


   </content><id>http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation</id><title type="text">OCaml-TLS: the protocol implementation and mitigations to known attacks</title><updated>2014-07-14T12:00:00+00:00</updated><author><email></email><name>David Kaloper</name></author></entry><entry><link href="http://openmirage.org/blog/introducing-asn1" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;em&gt;This is the fourth in a series of posts that introduce new libraries for a pure OCaml implementation of TLS.
You might like to begin with the &lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;introduction&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/mirleft/ocaml-asn1-combinators&quot;&gt;asn1-combinators&lt;/a&gt; is a library that allows one to express
&lt;a href=&quot;https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One&quot;&gt;ASN.1&lt;/a&gt; grammars directly in OCaml, manipulate them as first-class entities,
combine them with one of several ASN encoding rules and use the result to parse
or serialize values.&lt;/p&gt;
&lt;p&gt;It is the parsing and serialization backend for our &lt;a href=&quot;https://github.com/mirleft/ocaml-x509&quot;&gt;X.509&lt;/a&gt;
certificate library, which in turn provides certificate handling for
&lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;ocaml-tls&lt;/a&gt;.
We wrote about the X.509 certificate handling &lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;yesterday&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;What is ASN.1, really?&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One&quot;&gt;ASN.1&lt;/a&gt; (Abstract Syntax Notation, version one) is a way to describe
on-the-wire representation of messages. It is split into two components: a way
to describe the content of a message, i.e. a notation for its abstract syntax,
and a series of standard encoding rules that define the exact byte
representations of those syntaxes. It is defined in ITU-T standards X.680-X.683
and X.690-X.695.&lt;/p&gt;
&lt;p&gt;The notation itself contains primitive grammar elements, such as &lt;code&gt;BIT STRING&lt;/code&gt; or
&lt;code&gt;GeneralizedTime&lt;/code&gt;, and constructs that allow for creation of compound grammars
from other grammars, like &lt;code&gt;SEQUENCE&lt;/code&gt;. The notation is probably best introduced
through a real-world example:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-- Simple name bindings
UniqueIdentifier ::= BIT STRING

-- Products
Validity ::= SEQUENCE {
  notBefore Time,
  notAfter  Time
}

-- Sums
Time ::= CHOICE {
  utcTime     UTCTime,
  generalTime GeneralizedTime
}&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(Example from &lt;a href=&quot;http://tools.ietf.org/html/rfc5280#appendix-A.2&quot;&gt;RFC 5280&lt;/a&gt;, the RFC that describes X.509
certificates which heavily rely on ASN.)&lt;/p&gt;
&lt;p&gt;The first definition shows that we can introduce an alias for any existing ASN
grammar fragment, in this case the primitive &lt;code&gt;BIT STRING&lt;/code&gt;. The second and third
definitions are, at least morally, a product and a sum.&lt;/p&gt;
&lt;p&gt;At their very core, ASN grammars look roughly like algebraic data types, with a
range of pre-defined primitive grammar fragments like &lt;code&gt;BIT STRING&lt;/code&gt;, &lt;code&gt;INTEGER&lt;/code&gt;,
&lt;code&gt;NULL&lt;/code&gt;, &lt;code&gt;BOOLEAN&lt;/code&gt; or even &lt;code&gt;GeneralizedTime&lt;/code&gt;, and a number of combining
constructs that can be understood as denoting sums and products.&lt;/p&gt;
&lt;p&gt;Definitions such as the above are arranged into named modules. The standard even
provides for some abstractive capabilities: initially just a macro facility, and
later a form of parameterized interfaces.&lt;/p&gt;
&lt;p&gt;To facilitate actual message transfer, a grammar needs to be coupled with an
encoding. By far the most relevant ones are Basic Encoding Rules (BER) and
Distinguished Encoding Rules (DER), although other encodings exist.&lt;/p&gt;
&lt;p&gt;BER and DER are tag-length-value (TLV) encodings, meaning that every value is
encoded as a triplet containing a tag that gives the interpretation of its
contents, a length field, and the actual contents which can in turn contain
other TLV triplets.&lt;/p&gt;
&lt;p&gt;Let's drop the time from the example above, as time encoding is a little
involved, and assume a simpler version for a moment:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Pair ::= SEQUENCE {
  car Value,
  cdr Value
}

Value ::= CHOICE {
  v_str UTF8String,
  v_int INTEGER
}&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then two possible BER encodings of a &lt;code&gt;Pair&lt;/code&gt; &lt;code&gt;(&amp;quot;foo&amp;quot;, 42)&lt;/code&gt; are:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  30         - SEQUENCE            30         - SEQUENCE
  08         - length              0c         - length
  [ 0c       - UTF8String          [ 2c       - UTF8String, compound
    03       - length                07       - length
    [ 66     - 'f'                   [ 0c     - UTF8String
      6f     - 'o'                     01     - length
      6f ]   - 'o'                     [ 66 ] - 'f'
    02       - INTEGER                 0c     - UTF8String
    01       - length                  02     - length
    [ 2a ] ] - 42                      [ 6f   - 'o'
                                         6f ] - 'o'
                                     02       - INTEGER
                                     01       - length
                                     [ 2a ] ] - 42&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The left one is also the only valid DER encoding of this value: BER allows
certain freedoms in encoding, while DER is just a BER subset without those
freedoms. The property of DER that any value has exactly one encoding is useful,
for example, when trying to digitally sign a value.&lt;/p&gt;
&lt;p&gt;If this piqued your curiosity about ASN, you might want to take a detour and
check out this &lt;a href=&quot;http://luca.ntop.org/Teaching/Appunti/asn1.html&quot;&gt;excellent writeup&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;A bit of history&lt;/h3&gt;

&lt;p&gt;The description above paints a picture of a technology a little like &lt;a href=&quot;https://code.google.com/p/protobuf/&quot;&gt;Google's
Protocol Buffers&lt;/a&gt; or &lt;a href=&quot;https://thrift.apache.org/&quot;&gt;Apache Thrift&lt;/a&gt;: a way to declaratively
specify the structure of a set of values and derive parsers and serializers,
with the addition of multiple concrete representations.&lt;/p&gt;
&lt;p&gt;But the devil is in the detail. For instance, the examples above intentionally
gloss over the fact that often concrete tag values &lt;a href=&quot;http://tools.ietf.org/html/rfc5280#page-128&quot;&gt;leak&lt;/a&gt; into
the grammar specifications for various disambiguation reasons. And ASN has more
than 10 different &lt;a href=&quot;http://www.obj-sys.com/asn1tutorial/node128.html&quot;&gt;string types&lt;/a&gt;, most of which use
long-obsolete character encodings. Not to mention that the full standard is
close to 200 pages of relatively dense language and quite difficult to
follow. In general, ASN seems to have too many features for the relatively
simple task it is solving, and its specification has evolved over decades, apparently
trying to address various other semi-related problems, such as providing a
general &lt;a href=&quot;https://en.wikipedia.org/wiki/Information_Object_Class_(ASN.1)&quot;&gt;Interface Description Language&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Which is to say, ASN is &lt;em&gt;probably&lt;/em&gt; not what you are looking for. So why
implement it?&lt;/p&gt;
&lt;p&gt;Developed in the context of the telecom industry around 30 years ago, modified
several times after that and apparently suffering from a lack of a coherent
goal, by the early 90s ASN was still probably the only universal, machine- and
architecture-independent external data representation.&lt;/p&gt;
&lt;p&gt;So it came easily to hand around the time RSA Security started publishing its
series of &lt;a href=&quot;https://en.wikipedia.org/wiki/PKCS&quot;&gt;PKCS&lt;/a&gt; standards, aimed at the standardization of
cryptographic material exchange. RSA keys and digital signatures are often
exchanged ASN-encoded.&lt;/p&gt;
&lt;p&gt;At roughly the same time, ITU-T started publishing the &lt;a href=&quot;https://en.wikipedia.org/wiki/X.500&quot;&gt;X.500&lt;/a&gt; series
of standards which aimed to provide a comprehensive directory service. Much of
this work ended up as LDAP, but one little bit stands out in particular: the
&lt;a href=&quot;https://en.wikipedia.org/wiki/X.509&quot;&gt;X.509&lt;/a&gt; PKI certificate.&lt;/p&gt;
&lt;p&gt;So a few years later, when Netscape tried to build an authenticated and
confidential layer to tunnel HTTP through, they based it on -- amongst other
things -- X.509 certificates. Their work went through several revisions as SSL
and was finally standardized as TLS. Modern TLS still requires X.509.&lt;/p&gt;
&lt;p&gt;Thus, even though TLS uses ASN only for encoding certificates (and the odd PKCS1
signature), every implementation needs to know how to deal with ASN. In fact,
many other general cryptographic libraries also need to deal with ASN, as various PKCS
standards mandate ASN as the encoding for exchange of cryptographic material.&lt;/p&gt;
&lt;h3&gt;The grammar of the grammar&lt;/h3&gt;

&lt;p&gt;As its name implies, ASN was meant to be used with a specialized compiler. ASN
is really a standard for &lt;em&gt;writing down&lt;/em&gt; abstract syntaxes, and ASN compilers
provided with the target encoding will generate code in your programming
language of choice that, when invoked, parses to or serializes from ASN.&lt;/p&gt;
&lt;p&gt;As long as your programming language of choice is C, C++, Java or C#, obviously
-- there doesn't seem to be one freely available that targets OCaml. In any case, generating code for such a high-level language feels wrong somehow. In
its effort to be language-neutral, ASN needs to deal with things like modules,
abstraction and composition. At this point, most functional programmers reading
this are screaming: &amp;quot;I &lt;em&gt;already&lt;/em&gt; have a language that can deal with modules,
abstraction and composition perfectly well!&amp;quot;&lt;/p&gt;
&lt;p&gt;So we're left with implementing ASN in OCaml.&lt;/p&gt;
&lt;p&gt;One strategy is to provide utility functions for parsing elements of ASN and
simply invoke them in the appropriate order, as imposed by the target grammar.
This amounts to hand-writing the parser and is what TLS libraries in C
typically do.&lt;/p&gt;
&lt;p&gt;As of release 1.3.7, &lt;a href=&quot;https://github.com/polarssl/polarssl/tree/development/library&quot;&gt;PolarSSL&lt;/a&gt; includes ~7,500 lines of rather
beautifully written C, that implement a specialized parser for dealing with
X.509. OpenSSL's &lt;a href=&quot;https://github.com/openssl/openssl&quot;&gt;libcrypto&lt;/a&gt; contains ~50,000 lines of C in its
&lt;a href=&quot;https://github.com/openssl/openssl/tree/e3ba6a5f834f24aa5ffe9bc1849e3410c87388d5/crypto/asn1&quot;&gt;'asn1'&lt;/a&gt;, &lt;a href=&quot;https://github.com/openssl/openssl/tree/e3ba6a5f834f24aa5ffe9bc1849e3410c87388d5/crypto/x509&quot;&gt;'x509'&lt;/a&gt; and
&lt;a href=&quot;https://github.com/openssl/openssl/tree/e3ba6a5f834f24aa5ffe9bc1849e3410c87388d5/crypto/x509v3&quot;&gt;'x509v3'&lt;/a&gt; directories, and primarily deals with X.509
specifically as required by TLS.&lt;/p&gt;
&lt;p&gt;In both cases, low-level control flow is intertwined with the parsing logic and,
above the ASN parsing level, the code that deals with interpreting the ASN
structure is not particularly concise.
It is certainly a far cry from the (relatively)
simple grammar description ASN itself provides.&lt;/p&gt;
&lt;p&gt;Since in BER every value fully describes itself, another strategy is to parse
the input stream without reference to the grammar. This produces a value that
belongs to the general type of all ASN-encoded trees, after which we need to
process the &lt;em&gt;structure&lt;/em&gt; according to the grammar. This is similar to a common
treatment of JSON or XML, where one decouples parsing of bytes from the
higher-level concerns about the actual structure contained therein. The problem
here is that either the downstream client of such a parser needs to constantly
re-check whether the parts of the structure it's interacting with are really
formed according to the grammar (probably leading to a tedium of
pattern-matches), or we have to turn around and solve the parsing problem
&lt;em&gt;again&lt;/em&gt;, mapping the uni-typed contents of a message to the actual, statically
known structure we require the message to have.&lt;/p&gt;
&lt;p&gt;Surely we can do better?&lt;/p&gt;
&lt;h3&gt;LAMBDA: The Ultimate Declarative&lt;/h3&gt;

&lt;p&gt;Again, ASN is a language with a number of built-in primitives, a few combining
constructs, (recursive) name-binding and a module system. Our target language is
a language with a perfectly good module system and it can certainly express
combining constructs. It includes an abstraction mechanism arguably far simpler
and easier to use than those of ASN, namely, functions. And the OCaml compilers
can already parse OCaml sources. So why not just reuse this machinery?&lt;/p&gt;
&lt;p&gt;The idea is familiar. Creating embedded languages for highly declarative
descriptions within narrowly defined problem spaces is the staple of functional
programming. In particular, combinatory parsing has been known, studied and
used for &lt;a href=&quot;http://comjnl.oxfordjournals.org/content/32/2/108.short&quot;&gt;decades&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;However, we also have to diverge from traditional parser combinators in two major ways.
Firstly, a single grammar expression needs to be able to generate
different concrete parsers, corresponding to different ASN encodings. More
importantly, we desire our grammar descriptions to act &lt;strong&gt;bidirectionally&lt;/strong&gt;,
producing both parsers and complementary deserializers.&lt;/p&gt;
&lt;p&gt;The second point severely restricts the signatures we can support. The usual
monadic parsers are off the table because the expression such as:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;( (pa : a t) &amp;gt;&amp;gt;= fun (a : a) -&amp;gt;
  (pb : b t) &amp;gt;&amp;gt;= fun (b : b) -&amp;gt;
  return (b, b, a) ) : (b * b * a) t&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;... &amp;quot;hides&amp;quot; parts of the parser inside the closures, especially the method of
mapping the parsed values into the output values, and can not be run &amp;quot;in
reverse&amp;quot; [&lt;a href=&quot;http://openmirage.org/blog/atom.xml#footnote-1&quot;&gt;1&lt;/a&gt;].&lt;/p&gt;
&lt;p&gt;We have a similar problem with &lt;a href=&quot;http://www.soi.city.ac.uk/~ross/papers/Applicative.html&quot;&gt;applicative functors&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;( (fun a b -&amp;gt; (b, b, a))
  &amp;lt;$&amp;gt; (pa : a t)
  &amp;lt;*&amp;gt; (pb : b t) ) : (b * b * a) t&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(Given the usual &lt;code&gt;&amp;lt;$&amp;gt; : ('a -&amp;gt; 'b) -&amp;gt; 'a t -&amp;gt; 'b t&lt;/code&gt; and &lt;code&gt;&amp;lt;*&amp;gt; : ('a -&amp;gt; 'b) t -&amp;gt;
'a t -&amp;gt; 'b t&lt;/code&gt;.) Although the elements of ASN syntax are now exposed, the process
of going from intermediate parsing results to the result of the whole is still
not accessible.&lt;/p&gt;
&lt;p&gt;Fortunately, due to the regular structure of ASN, we don't really &lt;em&gt;need&lt;/em&gt; the
full expressive power of monadic parsing. The only occurrence of sequential
parsing is within &lt;code&gt;SEQUENCE&lt;/code&gt; and related constructs, and we don't need
look-ahead. All we need to do is provide a few specialized combinators to handle
those cases -- combinators the likes of which would be derived in a
more typical setting.&lt;/p&gt;
&lt;p&gt;So if we imagine we had a few values, like:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;val gen_time : gen_time t
val utc_time : utc_time t
val choice   : 'a t -&amp;gt; 'b t -&amp;gt; ('a, 'b) choice t
val sequence : 'a t -&amp;gt; 'b t -&amp;gt; ('a * 'b) t&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Assuming appropriate OCaml types &lt;code&gt;gen_time&lt;/code&gt; and &lt;code&gt;utc_time&lt;/code&gt; that reflect their
ASN counterparts, and a simple sum type &lt;code&gt;choice&lt;/code&gt;, we could express the
&lt;code&gt;Validity&lt;/code&gt; grammar above using:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;type time = (gen_time, utc_time) choice
let time     : time t          = choice gen_time utc_time
let validity : (time * time) t = sequence time time&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In fact, ASN maps quite well to algebraic data types. Its &lt;code&gt;SEQUENCE&lt;/code&gt; corresponds
to n-ary products and &lt;code&gt;CHOICE&lt;/code&gt; to sums. ASN &lt;code&gt;SET&lt;/code&gt; is a lot like &lt;code&gt;SEQUENCE&lt;/code&gt;,
except the elements can come in any order; and &lt;code&gt;SEQUENCE_OF&lt;/code&gt; and &lt;code&gt;SET_OF&lt;/code&gt; are
just lifting an &lt;code&gt;'a&lt;/code&gt;-grammar into an &lt;code&gt;'a list&lt;/code&gt;-grammar.&lt;/p&gt;
&lt;p&gt;A small wrinkle is that &lt;code&gt;SEQUENCE&lt;/code&gt; allows for more contextual information on its
components (so does &lt;code&gt;CHOICE&lt;/code&gt; in reality, but we ignore that): elements can carry
labels (which are not used for parsing) and can be marked as optional. So
instead of working directly on the grammars, our &lt;code&gt;sequence&lt;/code&gt; must work on their
annotated versions. A second wrinkle is the arity of the &lt;code&gt;sequence&lt;/code&gt; combinator.&lt;/p&gt;
&lt;p&gt;Thus we introduce the type of annotated grammars, &lt;code&gt;'a element&lt;/code&gt;, which
corresponds to one &lt;code&gt;,&lt;/code&gt;-delimited syntactic element in ASN's own &lt;code&gt;SEQUENCE&lt;/code&gt;
grammar, and the type &lt;code&gt;'a sequence&lt;/code&gt;, which describes the entire contents (&lt;code&gt;{ ...
}&lt;/code&gt;) of a &lt;code&gt;SEQUENCE&lt;/code&gt; definition:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;val required : 'a t -&amp;gt; 'a element
val optional : 'a t -&amp;gt; 'a option element
val ( -@ )   : 'a element -&amp;gt; 'b element -&amp;gt; ('a * 'b) sequence
val ( @ )    : 'a element -&amp;gt; 'a sequence -&amp;gt; ('a * 'b) sequence
val sequence : 'a sequence -&amp;gt; 'a t&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The following are then equivalent:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Triple ::= SEQUENCE {
  a INTEGER,
  b BOOLEAN,
  c BOOLEAN OPTIONAL
}&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;let triple : (int * (bool * bool option)) t =
  sequence (
      required int
    @ required bool
   -@ optional bool
  )&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can also re-introduce functions, but in a controlled manner:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;val map : ('a -&amp;gt; 'b) -&amp;gt; ('b -&amp;gt; 'a) -&amp;gt; 'a t -&amp;gt; 'b t&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Keeping in line with the general theme of bidirectionality, we require functions
to come in pairs. The deceptively called &lt;code&gt;map&lt;/code&gt; could also be called &lt;code&gt;iso&lt;/code&gt;, and
comes with a nice property: if the two functions are truly inverses,
the serialization process is fully reversible, and so is parsing, under
single-representation encodings (DER)!&lt;/p&gt;
&lt;h3&gt;ASTs of ASNs&lt;/h3&gt;

&lt;p&gt;To go that last mile, we should probably also &lt;em&gt;implement&lt;/em&gt; what we discussed.&lt;/p&gt;
&lt;p&gt;Traditional parser combinators look a little like this:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;type 'a p = string -&amp;gt; 'a * string

let bool : bool p = fun str -&amp;gt; (s.[0] &amp;lt;&amp;gt; &amp;quot;\000&amp;quot;, tail_of_string str)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Usually, the values inhabiting the parser type are the actual parsing functions,
and their composition directly produces larger parsing functions. We would
probably need to represent them with &lt;code&gt;'a p * 'a s&lt;/code&gt;, pairs of a parser and its
inverse, but the same general idea applies.&lt;/p&gt;
&lt;p&gt;Nevertheless, we don't want to do this.
The grammars need to support more than one concrete
parser/serializer, and composing what is common between them and extracting out
what is not would probably turn into a tangled mess. That is one reason. The other is that if we encode the grammar purely as
(non-function) value, we can traverse it for various other purposes.&lt;/p&gt;
&lt;p&gt;So we turn from what is sometimes called &amp;quot;shallow embedding&amp;quot; to &amp;quot;deep
embedding&amp;quot; and try to represent the grammar purely as an algebraic data type.&lt;/p&gt;
&lt;p&gt;Let's try to encode the parser for bools, &lt;code&gt;boolean : bool t&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;type 'a t =
  | Bool
  ...

let boolean : bool t = Bool&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Unfortunately our constructor is fully polymorphic, of type &lt;code&gt;'a. 'a t&lt;/code&gt;. We can
constrain it for the users, but once we traverse it there is nothing left to
prove its intended association with booleans!&lt;/p&gt;
&lt;p&gt;Fortunately, starting with the release of &lt;a href=&quot;http://ocaml.org/releases/4.00.1.html&quot;&gt;OCaml 4.00.0&lt;/a&gt;,
OCaml joined the ranks of
languages equipped with what is probably the supreme tool of deep embedding,
&lt;a href=&quot;http://en.wikipedia.org/wiki/Generalized_algebraic_data_type&quot;&gt;GADTs&lt;/a&gt;. Using them, we can do things like:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;type _ t =
  | Bool   : bool t
  | Pair   : ('a t * 'b t) -&amp;gt; ('a * 'b) t
  | Choice : ('a t * 'b t) -&amp;gt; ('a, 'b) choice t
  ...&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In fact, this is very close to how the library is &lt;a href=&quot;https://github.com/mirleft/ocaml-asn1-combinators/blob/4328bf5ee6f20ad25ff7971ee8013f79e5bfb036/src/core.ml#L19&quot;&gt;actually&lt;/a&gt;
implemented.&lt;/p&gt;
&lt;p&gt;There is only one thing left to worry about: ASN definitions can be recursive.
We might try something like:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;let rec list = choice null (pair int list)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But this won't work. Being just trees of applications, our definitions never
contain &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-400/manual021.html#toc70&quot;&gt;statically constructive&lt;/a&gt; parts -- this expression could never
terminate in a strict language.&lt;/p&gt;
&lt;p&gt;We can get around that by wrapping grammars in &lt;code&gt;Lazy.t&lt;/code&gt; (or just closures), but
this would be too awkward to use. Like many other similar libraries, we need to
provide a fixpoint combinator:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;val fix : ('a t -&amp;gt; 'a t) -&amp;gt; 'a t&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And get to write:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;let list = fix @@ fun list -&amp;gt; choice null (pair int list)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This introduces a small problem. So far we simply reused binding inherited
from OCaml without ever worrying about identifiers and references, but with a
fixpoint, the grammar encodings need to be able to somehow express a cycle.&lt;/p&gt;
&lt;p&gt;Borrowing an idea from higher-order abstract syntax, we can represent the entire
fixpoint node using exactly the function provided to define it, re-using OCaml's
own binding and identifier resolution:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;type _ t =
  | Fix : ('a t -&amp;gt; 'a t) -&amp;gt; 'a t
  ...&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This treatment completely sidesteps the problems with variables. We need no
binding environments or De Brujin indices, and need not care about the desired
scoping semantics. A little trade-off is that with this simple encoding it
becomes more difficult to track cycles (when traversing the AST, if we keep
applying a &lt;code&gt;Fix&lt;/code&gt; node to itself while descending into it, it looks like an
infinite tree), but with a little opportunistic caching it all plays out well
[&lt;a href=&quot;http://openmirage.org/blog/atom.xml#footnote-2&quot;&gt;2&lt;/a&gt;].&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://github.com/mirleft/ocaml-asn1-combinators/blob/4328bf5ee6f20ad25ff7971ee8013f79e5bfb036/src/ber_der.ml#L49&quot;&gt;parser&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirleft/ocaml-asn1-combinators/blob/4328bf5ee6f20ad25ff7971ee8013f79e5bfb036/src/ber_der.ml#L432&quot;&gt;serializer&lt;/a&gt; proper then emerge as interpreters for
this little language of typed trees, traversing them with an input string, and
parsing it in a fully type-safe manner.&lt;/p&gt;
&lt;h3&gt;How does it play out?&lt;/h3&gt;

&lt;p&gt;The entire ASN library comes down to ~1,700 lines of OCaml, with around ~1,100
more in tests, giving a mostly-complete treatment of BER and DER.&lt;/p&gt;
&lt;p&gt;Its main use so far is in the context of the &lt;code&gt;X.509&lt;/code&gt; library
(discussed &lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;yesterday&lt;/a&gt;). It allowed the
grammar of certificates and RSA keys, together with a number of transformations
from the raw types to more pleasant, externally facing ones, to be written in
~900 &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/6c96f11a2c7911ae0b308af9b328aee38f48b270/lib/asn_grammars.ml&quot;&gt;lines&lt;/a&gt; of OCaml. And the code looks a lot like the
actual standards the grammars were taken from -- the fragment from the beginning
of this article becomes:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;let unique_identifier = bit_string_cs

let time =
  map (function `C1 t -&amp;gt; t | `C2 t -&amp;gt; t) (fun t -&amp;gt; `C2 t)
      (choice2 utc_time generalized_time)

let validity =
  sequence2
    (required ~label:&amp;quot;not before&amp;quot; time)
    (required ~label:&amp;quot;not after&amp;quot;  time)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We added &lt;code&gt;~label&lt;/code&gt; to &lt;code&gt;'a element&lt;/code&gt;-forming injections, and have:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;val choice2 : 'a t -&amp;gt; 'b t -&amp;gt; [ `C1 of 'a | `C2 of 'b ] t&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To get a sense of how the resulting system eases the translation of standardized
ASN grammars into working code, it is particularly instructive to compare
&lt;a href=&quot;https://github.com/polarssl/polarssl/blob/b9e4e2c97a2e448090ff3fcc0f99b8f6dbc08897/library/x509_crt.c#L531&quot;&gt;these&lt;/a&gt; &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/asn_grammars.ml#L772&quot;&gt;two&lt;/a&gt; definitions.&lt;/p&gt;
&lt;p&gt;Reversibility was a major simplifying factor during development. Since the
grammars are traversable, it is easy to generate their &lt;a href=&quot;https://github.com/mirleft/ocaml-asn1-combinators/blob/cf1a1ffb4a31d02979a6a0bca8fe58856f8907bf/src/asn_random.ml&quot;&gt;random&lt;/a&gt;
inhabitants, encode them, parse the result and verify the reversibility still
&lt;a href=&quot;https://github.com/mirleft/ocaml-asn1-combinators/blob/cf1a1ffb4a31d02979a6a0bca8fe58856f8907bf/tests/testlib.ml#L83&quot;&gt;holds&lt;/a&gt;. This can't help convince us the parsing/serializing pair
is actually correct with respect to ASN, but it gives a simple tool to generate
large amounts of test cases and convince us that that pair is &lt;em&gt;equivalent&lt;/em&gt;. A
number of hand-written cases then check the conformance to the actual ASN.&lt;/p&gt;
&lt;p&gt;As for security, there were two concerns we were aware of. There is a history of
catastrophic &lt;a href=&quot;https://technet.microsoft.com/en-us/library/security/ms04-007.aspx&quot;&gt;buffer overruns&lt;/a&gt; in some ASN.1 implementations,
but -- assuming our compiler and runtime system are correct -- we are immune to
these as we are subject to bounds-checking. And
there are some documented &lt;a href=&quot;https://www.viathinksoft.de/~daniel-marschall/asn.1/oid_facts.html&quot;&gt;problems&lt;/a&gt; with security of X.509
certificate verification due to overflows of numbers in ASN OID types, which we
explicitly guard against.&lt;/p&gt;
&lt;p&gt;You can check our security status on our &lt;a href=&quot;https://github.com/mirleft/ocaml-asn1-combinators/issues?state=open&quot;&gt;issue tracker&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Footnotes&lt;/h4&gt;

&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a name=&quot;footnote-1&quot;&gt; &lt;/a&gt; In fact, the problem with embedding functions in
 combinator languages, and the fact that in a functional language it is not
 possible to extract information from a function other than by applying it,
 was discussed more than a decade ago. Such discussions led to the development of
 &lt;a href=&quot;http://www.haskell.org/arrows/biblio.html#Hug00&quot;&gt;Arrows&lt;/a&gt;, amongst other things.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a name=&quot;footnote-2&quot;&gt; &lt;/a&gt; Actually, a version of the library used the more
 &lt;a href=&quot;http://dl.acm.org/citation.cfm?id=1411226&quot;&gt;proper&lt;/a&gt; encoding to be able to inject results of reducing
 referred-to parts of the AST into the referring sites directly, roughly
 like &lt;code&gt;Fix : ('r -&amp;gt; ('a, 'r) t) -&amp;gt; ('a, 'r) t&lt;/code&gt;. This approach was abandoned because terms need to be polymorphic in &lt;code&gt;'r&lt;/code&gt;, and this becomes
 impossible to hide from the user of the library, creating unwelcome noise.&lt;/p&gt;
&lt;/li&gt;&lt;/ol&gt;

&lt;p&gt;&lt;/p&gt;&lt;hr/&gt;Posts in this TLS series:
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;Introducing transport layer security (TLS) in pure OCaml&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;OCaml-TLS: building the nocrypto library core&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;OCaml-TLS: adventures in X.509 certificate parsing and validation&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-asn1&quot;&gt;OCaml-TLS: ASN.1 and notation embedding&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation&quot;&gt;OCaml-TLS: the protocol implementation and mitigations to known attacks&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;


   </content><id>http://openmirage.org/blog/introducing-asn1</id><title type="text">OCaml-TLS: ASN.1 and notation embedding</title><updated>2014-07-11T12:00:00+00:00</updated><author><email></email><name>David Kaloper</name></author></entry><entry><link href="http://openmirage.org/blog/introducing-x509" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;em&gt;This is the third in a series of posts that introduce new libraries for a pure OCaml implementation of TLS.
You might like to begin with the &lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;introduction&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;h3&gt;The problem of authentication&lt;/h3&gt;

&lt;p&gt;The authenticity of the remote server needs to be verified while
establishing a secure connection to it, or else an
attacker (&lt;a href=&quot;https://en.wikipedia.org/wiki/Man-in-the-middle_attack&quot;&gt;MITM&lt;/a&gt;) between the client and the server can eavesdrop on
the transmitted data. To the best of our knowledge, authentication
cannot be done solely in-band, but needs external
infrastructure. The most common methods used in practice rely on
public key encryption.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Web of trust&lt;/em&gt; (used by &lt;a href=&quot;https://en.wikipedia.org/wiki/OpenPGP&quot;&gt;OpenPGP&lt;/a&gt;) is a decentralised public key
infrastructure. It relies on out-of-band verification of public keys
and transitivity of trust. If Bob signed Alice's public key, and
Charlie trusts Bob (and signed his public key), then Charlie can trust
that Alice's public key is hers.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Public key infrastructure&lt;/em&gt; (used by &lt;a href=&quot;https://en.wikipedia.org/wiki/Transport_Layer_Security&quot;&gt;TLS&lt;/a&gt;) relies on trust
anchors which are communicated out-of-band (e.g. distributed with the
client software). In order to authenticate a server, a chain of trust
between a trust anchor and the server certificate (public key) is
established. Only those clients which have the trust anchor deployed
can verify the authenticity of the server.&lt;/p&gt;
&lt;h3&gt;X.509 public key infrastructure&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/X.509&quot;&gt;X.509&lt;/a&gt; is an ITU standard for a public key infrastructure,
developed in 1988. Amongst other things, it specifies the format of
certificates, their attributes, revocation lists, and a path
validation algorithm. X.509 certificates are encoded using abstract
syntax notation one (ASN.1).&lt;/p&gt;
&lt;p&gt;A &lt;em&gt;certificate&lt;/em&gt; contains a public key, a subject (server name), a
validity period, a purpose (i.e. key usage), an issuer, and
possibly other extensions. All components mentioned in the certificate
are signed by an issuer.&lt;/p&gt;
&lt;p&gt;A &lt;em&gt;certificate authority&lt;/em&gt; (CA) receives a certificate signing request
from a server operator. It verifies that this signing request is
legitimate (e.g. requested server name is owned by the server
operator) and signs the request. The CA certificate must be trusted by
all potential clients. A CA can also issue intermediate CA
certificates, which are allowed to sign certificates.&lt;/p&gt;
&lt;p&gt;When a server certificate or intermediate CA certificate is
compromised, the CA publishes this certificate in its certificate
revocation list (CRL), which each client should poll periodically.&lt;/p&gt;
&lt;p&gt;The following certificates are exchanged before a TLS session:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;CA -&amp;gt; Client: CA certificate, installed as trust anchor on the client&lt;/li&gt;&lt;li&gt;Server -&amp;gt; CA: certificate request, to be signed by the CA&lt;/li&gt;&lt;li&gt;CA -&amp;gt; Server: signed server certificate&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;During the TLS handshake the server sends the certificate chain to the
client. When a client wants to verify a certificate, it has to verify
the signatures of the entire chain, and find a trust anchor which
signed the outermost certificate. Further constraints, such as the
maximum chain length and the validity period, are checked as
well. Finally, the server name in the server certificate is checked to
match the expected identity.
For an example, you can see the sequence diagram of the TLS handshake your browser makes when you visit our &lt;a href=&quot;https://tls.openmirage.org&quot;&gt;demonstration server&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Example code for verification&lt;/h3&gt;

&lt;p&gt;OpenSSL implements &lt;a href=&quot;https://tools.ietf.org/html/rfc5280&quot;&gt;RFC5280&lt;/a&gt; path validation, but there is no
implementation to validate the identity of a certificate. This has to
be implemented by each client, which is rather complex (e.g. in
&lt;a href=&quot;https://github.com/freebsd/freebsd/blob/bf1a15b165af779577b0278b3d47151edb0d47f9/lib/libfetch/common.c#L326-665&quot;&gt;libfetch&lt;/a&gt; it spans over more than 300 lines). A client of the
&lt;code&gt;ocaml-x509&lt;/code&gt; library (such as our &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lwt/examples/http_client.ml&quot;&gt;http-client&lt;/a&gt;) has to
write only two lines of code:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;lwt authenticator = X509_lwt.authenticator (`Ca_dir ca_cert_dir) in
lwt (ic, oc) =
  Tls_lwt.connect_ext
    (Tls.Config.client_exn ~authenticator ())
    (host, port)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The authenticator uses the default directory where trust anchors are
stored (&lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lwt/examples/ex_common.ml#L6&quot;&gt;'ca_cert_dir'&lt;/a&gt;), and this authenticator is
passed to the &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lwt/tls_lwt.ml#L227&quot;&gt;'connect_ext'&lt;/a&gt; function. This initiates
the TLS handshake, and passes the trust anchors and the hostname to
the TLS library.&lt;/p&gt;
&lt;p&gt;During the client handshake when the certificate chain is received by
the server, the given authenticator and hostname are used to
authenticate the certificate chain (in &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/blob/6dc9258a38489665abf2bd6cdbed8a1ba544d522/lib/handshake_client.ml#L84&quot;&gt;'validate_chain'&lt;/a&gt;):&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;match
 X509.Authenticator.authenticate ?host:server_name authenticator stack
with
 | `Fail SelfSigned         -&amp;gt; fail Packet.UNKNOWN_CA
 | `Fail NoTrustAnchor      -&amp;gt; fail Packet.UNKNOWN_CA
 | `Fail CertificateExpired -&amp;gt; fail Packet.CERTIFICATE_EXPIRED
 | `Fail _                  -&amp;gt; fail Packet.BAD_CERTIFICATE
 | `Ok                      -&amp;gt; return server_cert&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Internally, &lt;code&gt;ocaml-x509&lt;/code&gt; extracts the hostname list from a
certificate in &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L134-144&quot;&gt;'cert_hostnames'&lt;/a&gt;, and the
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L325-L346&quot;&gt;wildcard or strict matcher&lt;/a&gt; compares it to the input.
In total, this is less than 50 lines of pure OCaml code.&lt;/p&gt;
&lt;h3&gt;Problems in X.509 verification&lt;/h3&gt;

&lt;p&gt;Several weaknesses in the verification of X.509 certificates have been
discovered, ranging from cryptographic attacks due to
&lt;a href=&quot;http://www.win.tue.nl/~bdeweger/CollidingCertificates/ddl-full.pdf&quot;&gt;collisions in hash algorithms&lt;/a&gt; (&lt;a href=&quot;http://www.win.tue.nl/hashclash/rogue-ca/&quot;&gt;practical&lt;/a&gt;) over
&lt;a href=&quot;http://www.blackhat.com/presentations/bh-usa-09/MARLINSPIKE/BHUSA09-Marlinspike-DefeatSSL-SLIDES.pdf&quot;&gt;misinterpretation of the name&lt;/a&gt; in the certificate (a C
string is terminated by a null byte), and treating X.509 version 1
certificates always as a &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0092&quot;&gt;trust anchor in GnuTLS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;An &lt;a href=&quot;https://crypto.stanford.edu/~dabo/pubs/abstracts/ssl-client-bugs.html&quot;&gt;empirical study of software that does certificate
verification&lt;/a&gt; showed that badly designed APIs are the
root cause of vulnerabilities in this area. They tested various
implementations by using a list of certificates, which did not form a
chain, and would not authenticate due to being self-signed, or
carrying a different server name.&lt;/p&gt;
&lt;p&gt;Another recent empirical study (&lt;a href=&quot;http://www.cs.utexas.edu/~suman/publications/frankencert.pdf&quot;&gt;Frankencert&lt;/a&gt;) generated random
certificates and validated these with various stacks. They found lots
of small issues in nearly all certificate verification stacks.&lt;/p&gt;
&lt;p&gt;Our implementation mitigates against some of the known attacks: we
require a complete valid chain, check the extensions of a certificate,
and implement hostname checking as specified in &lt;a href=&quot;https://tools.ietf.org/html/rfc6125&quot;&gt;RFC6125&lt;/a&gt;. We have a
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/tree/master/tests&quot;&gt;test suite&lt;/a&gt; with over 3200 tests and multiple CAs. We do not yet discard
certificates which use MD5 as hash algorithm. Our TLS stack
requires certificates to have at least 1024 bit RSA keys.&lt;/p&gt;
&lt;h3&gt;X.509 library internals&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;x509&lt;/code&gt; library uses &lt;a href=&quot;https://github.com/mirleft/ocaml-asn-combinators&quot;&gt;asn-combinators&lt;/a&gt; to parse X.509 certificates and
the &lt;a href=&quot;https://github.com/mirleft/ocaml-nocrypto&quot;&gt;nocrypto&lt;/a&gt; library for signature verification
(which we wrote about &lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;previously&lt;/a&gt;).
At the moment we do not yet
expose certificate builders from the library, but focus on certificate parsing
and certificate authentication.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/x509.ml&quot;&gt;x509&lt;/a&gt; module provides modules which parse
PEM-encoded (&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/x509.ml#L18&quot;&gt;pem&lt;/a&gt;) certificates (&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/x509.ml#L85&quot;&gt;Cert&lt;/a&gt;)
and private keys
(&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/x509.ml#L105&quot;&gt;Pk&lt;/a&gt;), and an authenticator module
(&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/x509.ml#L123&quot;&gt;Authenticators&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;So far we have two authenticators implemented:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/x509.ml#L137&quot;&gt;'chain_of_trust'&lt;/a&gt;, which implements the basic path
 validation algorithm from &lt;a href=&quot;https://tools.ietf.org/html/rfc5280&quot;&gt;RFC5280&lt;/a&gt; (section 6) and the hostname
 validation from &lt;a href=&quot;https://tools.ietf.org/html/rfc6125&quot;&gt;RFC6125&lt;/a&gt;. To construct such an authenticator, a
 timestamp and a list of trust anchors is needed.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/x509.ml#L142&quot;&gt;'null'&lt;/a&gt;, which always returns success.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;The method &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/x509.mli#L42&quot;&gt;'authenticate'&lt;/a&gt;, to be called when a
certificate stack should be verified, receives an authenticator, a
hostname and the certificate stack. It returns either &lt;code&gt;Ok&lt;/code&gt; or &lt;code&gt;Fail&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Our &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/asn_grammars.ml#L734&quot;&gt;certificate type&lt;/a&gt; is very similar to the described structure in the RFC:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;type tBSCertificate = {
  version    : [ `V1 | `V2 | `V3 ] ;
  serial     : Z.t ;
  signature  : Algorithm.t ;
  issuer     : Name.dn ;
  validity   : Time.t * Time.t ;
  subject    : Name.dn ;
  pk_info    : PK.t ;
  issuer_id  : Cstruct.t option ;
  subject_id : Cstruct.t option ;
  extensions : (bool * Extension.t) list
}

type certificate = {
  tbs_cert       : tBSCertificate ;
  signature_algo : Algorithm.t ;
  signature_val  : Cstruct.t
}&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The certificate itself wraps the to be signed part (&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/asn_grammars.ml#L734&quot;&gt;'tBSCertificate'&lt;/a&gt;),
the used signature algorithm, and the actual signature. It consists of
a version, serial number, issuer, validity, subject, public key
information, optional issuer and subject identifiers, and a list of
extensions -- only version 3 certificates may have extensions.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/certificate.mli&quot;&gt;'certificate'&lt;/a&gt; module implements the actual
authentication of certificates, and provides some useful getters such
as &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/certificate.ml#L91&quot;&gt;'cert_type'&lt;/a&gt;, &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/certificate.ml#L95&quot;&gt;'cert_usage'&lt;/a&gt;, and
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/certificate.ml#L100&quot;&gt;'cert_extended_usage'&lt;/a&gt;. The main entry for
authentication is &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L419&quot;&gt;'verify_chain_of_trust'&lt;/a&gt;,
which checks correct signatures of the chain, extensions and validity
of each certificate, and the hostname of the server certificate.&lt;/p&gt;
&lt;p&gt;The grammar of X.509 certificates is developed in the
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/asn_grammars.ml&quot;&gt;'asn_grammars'&lt;/a&gt; module, and the object
identifiers are gathered in the &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/cdea2b1ae222e88a403f2d8f954a6aa31c984941/lib/registry.ml&quot;&gt;'registry'&lt;/a&gt; module.&lt;/p&gt;
&lt;h3&gt;Implementation of certificate verification&lt;/h3&gt;

&lt;p&gt;We provide the function &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L438&quot;&gt;'valid_cas'&lt;/a&gt;, which takes a
timestamp and a list of certificate authorities. Each certificate
authority is checked to be &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L282&quot;&gt;valid&lt;/a&gt;, self-signed,
correctly signed, and having 
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L277&quot;&gt;proper X.509 v3 extensions&lt;/a&gt;.
As mentioned above, version 1 and version 2
certificates do not contain extensions. For a version 3 certificate,
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L206&quot;&gt;'validate_ca_extensions'&lt;/a&gt; is called: The
basic constraints extensions must be present, and its value must be
true. Also, key usage must be present and the certificate must be
allowed to sign certificates. Finally, we reject the certificate if
there is any extension marked critical, apart from the two mentioned
above.&lt;/p&gt;
&lt;p&gt;When we have a list of validated CA certificates, we can use these to
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L419&quot;&gt;verify the chain of trust&lt;/a&gt;, which gets a
hostname, a timestamp, a list of trust anchors and a certificate chain
as input. It first checks that the &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L384&quot;&gt;server certificate is
valid&lt;/a&gt;, the &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L264&quot;&gt;validity of the intermediate
certificates&lt;/a&gt;, and that the &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L421&quot;&gt;chain is complete&lt;/a&gt;
(the pathlen constraint is not validated) and rooted in a trust
anchor. A server certificate is valid if the validity period matches
the current timestamp, the given hostname &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml#L333&quot;&gt;matches&lt;/a&gt;
its subject alternative name extension or common name (might be
wildcard or strict matching, &lt;a href=&quot;https://tools.ietf.org/html/rfc6125&quot;&gt;RFC6125&lt;/a&gt;), and it does not have a
basic constraints extension which value is true.&lt;/p&gt;
&lt;h3&gt;Current status of ocaml-x509&lt;/h3&gt;

&lt;p&gt;We currently support only RSA certificates. We do not check revocation
lists or use the online certificate status protocol (&lt;a href=&quot;http://en.wikipedia.org/wiki/Online_Certificate_Status_Protocol&quot;&gt;OCSP&lt;/a&gt;). Our
implementation does not handle name constraints and policies. However, if
any of these extensions is marked critical, we refuse to validate the
chain. To keep our main authentication free of side-effects, it currently uses
the timestamp when the authenticator was created rather than when it is used
(this isn't a problem if lifetime of the OCaml-TLS process is comparatively
short, as in the worst case the lifetime of the certificates can be extended by
the lifetime of the process).&lt;/p&gt;
&lt;p&gt;We invite people to read through the
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/certificate.ml&quot;&gt;certificate verification&lt;/a&gt; and the
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509/blob/7bd25d152445263d7659c653e4a761222f43c75b/lib/asn_grammars.ml&quot;&gt;ASN.1 parsing&lt;/a&gt;. We welcome discussion on the
&lt;a href=&quot;http://lists.xenproject.org/archives/html/mirageos-devel/&quot;&gt;mirage-devel mailing list&lt;/a&gt; and bug reports
on the &lt;a href=&quot;https://github.com/mirleft/ocaml-x509/issues&quot;&gt;GitHub issue tracker&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;hr/&gt;Posts in this TLS series:
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;Introducing transport layer security (TLS) in pure OCaml&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;OCaml-TLS: building the nocrypto library core&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;OCaml-TLS: adventures in X.509 certificate parsing and validation&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-asn1&quot;&gt;OCaml-TLS: ASN.1 and notation embedding&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation&quot;&gt;OCaml-TLS: the protocol implementation and mitigations to known attacks&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;


   </content><id>http://openmirage.org/blog/introducing-x509</id><title type="text">OCaml-TLS: Adventures in X.509 certificate parsing and validation</title><updated>2014-07-10T13:00:00+00:00</updated><author><email></email><name>Hannes Mehnert</name></author></entry><entry><link href="http://www.somerandomidiot.com/blog/2014/07/09/how-to-set-the-evil-bit/" rel="alternate"/><contributor><uri>http://www.somerandomidiot.com/blog/categories/ocaml/atom.xml</uri><name>Mindy Preston</name></contributor><content type="html">&lt;p&gt;Our mission: fuzzing &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/07/07/parsers-optional/&quot;&gt;TCP options&lt;/a&gt; from &lt;code&gt;scapy&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Our target: the &lt;code&gt;echo&lt;/code&gt; service from &lt;code&gt;mirage-tcpip/examples/services.ml&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Outcome: a revision on a widely-used OCaml dependency, gleeful murder and resurrection of several EC2 instances, something to brag to my mom about, a look at a case worse than failure, and great justice.&lt;/p&gt;&lt;h3&gt;Okay, Let&amp;rsquo;s Get To It&lt;/h3&gt;&lt;p&gt;&lt;code&gt;scapy&lt;/code&gt; has facilities for programmatically generating TCP options from an option-kind number and some data, but there isn&amp;rsquo;t a nicely provided function for doing so randomly, so I had to &lt;a href=&quot;https://github.com/yomimono/client-fuzzball/blob/master/random_options.py&quot;&gt;write my own&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Let&amp;rsquo;s have a look at how our automated fuzzer will generate a random TCP option to send to the hapless unikernel.&lt;/p&gt;&lt;p&gt;``` python optionNumber = RandNum(0, 255) optionLength = RandNum(0, 60 &amp;ndash; 20 &amp;ndash; 2) if(optionLength == 0):&lt;/p&gt;&lt;pre&gt;&lt;code&gt;optionValue = ''
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;else:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;# make an optionLength-long string of random bytes
optionValue = RandBin(size=optionLength)._fix()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;return(optionNumber, optionValue) ```&lt;/p&gt;&lt;p&gt;The results of this function &amp;ndash; a tuple consisting of a random option kind and some random data &amp;ndash; are used as an argument in the connection-initiating packet construction. &lt;code&gt;scapy&lt;/code&gt; calculates the option-length automatically when building the packet to send to the destination host.&lt;/p&gt;&lt;p&gt;I wrote some surrounding code to &lt;a href=&quot;https://github.com/yomimono/client-fuzzball/blob/master/fuzz_tcp.py&quot;&gt;attempt a full TCP conversation with the echo server&lt;/a&gt; with random options attached to TCP messages. I left it to run repeatedly against the &lt;code&gt;echo&lt;/code&gt; server, running as a host instance in Xen, for a few hours while I worked on a Secret Project. When I came back, I was surprised to see that it had uncovered a most exciting result indeed! Here is what became of my test &lt;code&gt;echo&lt;/code&gt; instance:&lt;/p&gt;&lt;p&gt;&lt;code&gt;plain mm.c: Cannot handle page request order 8! Fatal error: out of memory. exit: 2 kernel.c: Do_exit called! $ sudo xm list # show running virtual machines Name ID Mem VCPUs State Time(s) Domain-0 0 15837 8 r----- 44361.6 $ &lt;/code&gt;&lt;/p&gt;&lt;p&gt;In other words, I found some unintended behavior.&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://www.flickr.com/photos/statelibraryofnsw/3883631824/in/photolist-bvkQxf-9wgxVo-4idhFf-4MB5r1-4Tr1N3-9wdwgz-7ubrhE-atvz2p-7ubraC-9vUb6y-nXCNoA-6VmeLt-6Vqjt7-6VqjvS-5h6yRC-5TyDkY-7S8PLD-5h6yLf-5h2dW4-5d1XQ3-5d1XWb-5cWCSz-5cWCHv-7S8PKz-5h6ySQ-7u7xXz-4THqSk-e514eM-dk3jSF-e514eZ-nXJFJx-nXCNsU-nVGdiY-nFfke9-nFf8Wk-nVGdxL-7ubppy-nFfoDC-nFfoLS-nFfkju-nVGdro-6VbCro-dXTuXx-bUy2uf-7u7wNx-7ubt9S-7u7xUa-4V6XyN-7ubre9-d2ABLo/&quot;&gt;&lt;img src=&quot;http://www.somerandomidiot.com/images/train_cliff.jpg&quot; class=&quot;center&quot; title=&quot;&amp;lsquo;Unintended behavior&amp;rsquo; &amp;lsquo;A locomotive with its nose off the edge of a cliff.&amp;rsquo;&quot;/&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;No &lt;code&gt;echo&lt;/code&gt; instance running at all! It had been completely crashed by something the fuzzer ran against it. I used some rough &lt;a href=&quot;https://github.com/yomimono/client-fuzzball/blob/master/tcp_analyzer.py&quot;&gt;analysis tools&lt;/a&gt; to figure out which conversations resulted in unfinished conversations, and was soon able to narrow it down to a single packet with an options field that looked like this one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;plain +-----+-----+-----+-----+ | | | | | | 001 | 002 | 000 | 000 | | | | | | +-----+-----+-----+-----+ &lt;/code&gt;&lt;/p&gt;&lt;h3&gt;Get Your Fins, We&amp;rsquo;re Goin' Divin'&lt;/h3&gt;&lt;p&gt;Armed with the magic four-byte sequence that crashed my unikernel, I was ready to go sourcediving in the Mirage TCP/IP stack.&lt;/p&gt;&lt;p&gt;I happen to know (read: I used &lt;code&gt;find mirage-tcpip -name *.ml|xargs grep options&lt;/code&gt; on my local &lt;code&gt;mirage-tcpip&lt;/code&gt; repository to discover) that the options-parsing code for TCP sits in &lt;code&gt;mirage-tcpip/tcp/options.ml&lt;/code&gt;, in a function called &lt;code&gt;unmarshal&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;When looking at &lt;code&gt;unmarshal&lt;/code&gt;, I was in the unenviable position of knowing what it must be trying to do, knowing that it must mostly succeed, knowing that it was failing under some circumstance for some reason, and knowing that I was missing some important information I needed in order to understand it. Here are some useful things to know when trying to understand &lt;code&gt;unmarshal&lt;/code&gt;, followed by how I went about understanding it:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;In this context, you can imagine a &lt;a href=&quot;https://github.com/mirage/ocaml-cstruct&quot;&gt;Cstruct&lt;/a&gt; as a byte array with placeholder and a known overall length &amp;ndash; in other words, a bunch of data in an ordered list, plus a bookmark pointer. (In other contexts, Cstructs can give you &lt;a href=&quot;https://github.com/mirage/ocaml-cstruct/blob/master/README.md&quot;&gt;very convenient autogenerated code&lt;/a&gt;, but variable-length specifications like this aren&amp;rsquo;t so lucky.)&lt;/li&gt;&lt;li&gt;&lt;code&gt;iter&lt;/code&gt; and &lt;code&gt;fold&lt;/code&gt; are &lt;code&gt;Cstruct.iter&lt;/code&gt; and &lt;code&gt;Cstruct.fold&lt;/code&gt;, not the functions included in &lt;code&gt;Pervasives&lt;/code&gt;, and they have differing type signatures.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;``` ocaml let unmarshal buf = let open Cstruct in let i = iter&lt;/p&gt;&lt;pre&gt;&lt;code&gt;(fun buf -&amp;gt;
  match get_uint8 buf 0 with
  |0 -&amp;gt; None   (* EOF *)
  |1 -&amp;gt; Some 1 (* NOP *)
  |n -&amp;gt; Some (get_uint8 buf 1)
)
(fun buf -&amp;gt;
  match get_uint8 buf 0 with
  |0 -&amp;gt; assert false
  |1 -&amp;gt; Noop
  |2 -&amp;gt; MSS (BE.get_uint16 buf 2)
  |3 -&amp;gt; Window_size_shift (get_uint8 buf 2)
  |4 -&amp;gt; SACK_ok
  (* I've elided processing for an option not relevant to the post here *)
  |8 -&amp;gt; Timestamp ((BE.get_uint32 buf 2), (BE.get_uint32 buf 6))
  |n -&amp;gt; Unknown (n, (copy buf 2 (len buf - 2)))
) buf in
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; fold (fun a b &amp;ndash;&amp;gt; b :: a) i [] ```&lt;/p&gt;&lt;p&gt;Let&amp;rsquo;s have a look at the &lt;code&gt;Cstruct.iter&lt;/code&gt; and &lt;code&gt;Cstruct.fold&lt;/code&gt; documentation.&lt;/p&gt;&lt;p&gt;``` ocaml type &amp;lsquo;a iter = unit &amp;ndash;&amp;gt; 'a option (&lt;em&gt;* Type of an iterator. &lt;/em&gt;)&lt;/p&gt;&lt;p&gt;val iter: (t &amp;ndash;&amp;gt; int option) &amp;ndash;&amp;gt; (t &amp;ndash;&amp;gt; &amp;lsquo;a) &amp;ndash;&amp;gt; t &amp;ndash;&amp;gt; 'a iter &lt;br/&gt; (** [iter lenf of_cstr cstr] is an iterator over [cstr] that returns&lt;/p&gt;&lt;pre&gt;&lt;code&gt;elements of size [lenf cstr] and type [of_cstr cstr]. *)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;val fold: (&amp;lsquo;b &amp;ndash;&amp;gt; 'a &amp;ndash;&amp;gt; 'b) &amp;ndash;&amp;gt; 'a iter &amp;ndash;&amp;gt; 'b &amp;ndash;&amp;gt; 'b &lt;br/&gt; (&lt;em&gt;* [fold f iter acc] is [(f iterN accN &amp;hellip; (f iter acc)&amp;hellip;)]. &lt;/em&gt;)&lt;br/&gt; ```&lt;/p&gt;&lt;p&gt;The &lt;em&gt;type&lt;/em&gt; &lt;code&gt;'a iter&lt;/code&gt; is something that takes no input (because it advances an internal placeholder) and produces a &lt;code&gt;'a option&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;So &lt;code&gt;iter&lt;/code&gt;, in our &lt;code&gt;unmarshal&lt;/code&gt; function, takes a &lt;code&gt;Cstruct.t -&amp;gt; int option&lt;/code&gt;, a &lt;code&gt;Cstruct.t -&amp;gt; Option&lt;/code&gt;, and a Cstruct, and returns an &lt;code&gt;Option iter&lt;/code&gt; &amp;ndash; in other words, a function that takes no output and produces an &lt;code&gt;Option option&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;&lt;code&gt;fold&lt;/code&gt;, in turn, takes that function and applies it to &lt;code&gt;(fun a b -&amp;gt; b :: a)&lt;/code&gt;, a basic list-appending function that also, in this case, is reversing the order of elements in the list. (Because this is combined with the stacklike effects of &lt;code&gt;fold&lt;/code&gt;, this has the end result of making the resulting list of options mirror the input in its order.)&lt;/p&gt;&lt;p&gt;After some brow-furrowing, I came to understand the end result of this code to be &amp;ldquo;use the first function to figure out how many bytes to consider in the second function, then run the second function on that chunk of Cstruct and stick the results on the end of the list.&amp;rdquo;&lt;/p&gt;&lt;h3&gt;Why the Fireworks?&lt;/h3&gt;&lt;p&gt;Consider our problem input to this function, a 4-byte buffer of &lt;code&gt;001&lt;/code&gt;, &lt;code&gt;002&lt;/code&gt;, &lt;code&gt;000&lt;/code&gt;, &lt;code&gt;000&lt;/code&gt;. In order to make this explanation clearer, I&amp;rsquo;m going to name the two functions used in constructing our &lt;code&gt;Option iter&lt;/code&gt; above, and reproduce them here:&lt;/p&gt;&lt;p&gt;``` ocaml let option_length_of_cstr buf =&lt;/p&gt;&lt;pre&gt;&lt;code&gt;  match get_uint8 buf 0 with
  |0 -&amp;gt; None   (* EOF *)
  |1 -&amp;gt; Some 1 (* NOP *)
  |n -&amp;gt; Some (get_uint8 buf 1)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;let option_of_cstr buf =&lt;/p&gt;&lt;pre&gt;&lt;code&gt;  match get_uint8 buf 0 with
  |0 -&amp;gt; assert false
  |1 -&amp;gt; Noop
  |2 -&amp;gt; MSS (BE.get_uint16 buf 2)
  |3 -&amp;gt; Window_size_shift (get_uint8 buf 2)
  |4 -&amp;gt; SACK_ok
  (* I've elided processing for an option not relevant to the post here *)
  |8 -&amp;gt; Timestamp ((BE.get_uint32 buf 2), (BE.get_uint32 buf 6))
  |n -&amp;gt; Unknown (n, (copy buf 2 (len buf - 2)))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;```&lt;/p&gt;&lt;p&gt;When we call &lt;code&gt;option_length_of_cstr&lt;/code&gt; on &lt;code&gt;001&lt;/code&gt;, we get &lt;code&gt;Some 1&lt;/code&gt; from the pattern match. &lt;code&gt;option_of_cstr&lt;/code&gt; on &lt;code&gt;001&lt;/code&gt; is similarly unproblematic &amp;ndash; it&amp;rsquo;s a simple match to &lt;code&gt;Noop&lt;/code&gt;. The result from &lt;code&gt;fold&lt;/code&gt;&amp;rsquo;s first call to &lt;code&gt;iter&lt;/code&gt; will be &lt;code&gt;Noop&lt;/code&gt;, so &lt;code&gt;fold&lt;/code&gt; will put that in the accumulator (which begins as &lt;code&gt;[]&lt;/code&gt;, and after the first run, contains &lt;code&gt;[Noop]&lt;/code&gt;).&lt;/p&gt;&lt;p&gt;When we call &lt;code&gt;option_length_of_cstr&lt;/code&gt; on &lt;code&gt;002 000 000&lt;/code&gt;, we get a different result. &lt;code&gt;002&lt;/code&gt; matches neither &lt;code&gt;0&lt;/code&gt; nor &lt;code&gt;1&lt;/code&gt;, so the function reads the next byte to get the length, and the result is &lt;code&gt;Some 0&lt;/code&gt;, because &lt;code&gt;0&lt;/code&gt; is the first byte after &lt;code&gt;002&lt;/code&gt;. (That&amp;rsquo;s already a problem, because returning &lt;code&gt;Some 0&lt;/code&gt; from the length function will cause the iterator never to advance, and the program to be stuck in an infinite loop while trying to parse the buffer.)&lt;/p&gt;&lt;p&gt;Also suboptimally, when we try to call &lt;code&gt;option_of_cstr&lt;/code&gt; on &lt;code&gt;002 000 000&lt;/code&gt;, we&amp;rsquo;ll try to construct a 16-bit number out of the two bytes starting with our second &lt;code&gt;000&lt;/code&gt;. But there&amp;rsquo;s not a second byte there that we should be able to see, and if we get a number out of this request, it means we&amp;rsquo;ve accessed memory that we shouldn&amp;rsquo;t have been able to. &lt;code&gt;Cstruct.BE.get_uint16&lt;/code&gt; doesn&amp;rsquo;t stop us from accessing this memory, and constructs an &lt;code&gt;MSS&lt;/code&gt; object of some size between 0 and 255, depending on the contents of whatever happens to be in memory after our buffer.&lt;/p&gt;&lt;p&gt;Let&amp;rsquo;s suppose this byte contains the value &lt;code&gt;127&lt;/code&gt;, so the first invocation by &lt;code&gt;fold&lt;/code&gt; will result in a list containing &lt;code&gt;[Noop; MSS 127]&lt;/code&gt;. Each subsequent call to &lt;code&gt;iter&lt;/code&gt; by &lt;code&gt;fold&lt;/code&gt; will result in another &lt;code&gt;MSS 127&lt;/code&gt; in the list, until the list grows so large it exhausts the available memory for our virtual machine, and results in a hard crash of the host VM.&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://flic.kr/p/5cWCSz&quot;&gt;&lt;img src=&quot;http://www.somerandomidiot.com/images/sad_train_car.jpg&quot; class=&quot;center&quot; title=&quot;&amp;lsquo;:(&amp;rsquo; &amp;lsquo;A train car is on its side, with a crane hoisting it back into place&amp;rsquo;&quot;/&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;There are a few things we should do to fix this:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;fix &lt;code&gt;Cstruct&lt;/code&gt; to not allow &lt;code&gt;get_uint16 buf&lt;/code&gt; (and friends) to access memory outside the bounds of &lt;code&gt;buf&lt;/code&gt;&lt;/li&gt;&lt;li&gt;fix &lt;code&gt;unmarshal&lt;/code&gt; to check for nonsensible option lengths like 0&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;a href=&quot;http://anil.recoil.org&quot;&gt;Anil&lt;/a&gt; did &lt;a href=&quot;https://github.com/mirage/ocaml-cstruct/issues/25&quot;&gt;the former&lt;/a&gt;, and I did the (much less critical, given the former) &lt;a href=&quot;https://github.com/mirage/mirage-tcpip/pull/57&quot;&gt;latter&lt;/a&gt;.&lt;/p&gt;&lt;h3&gt;That&amp;rsquo;s Pretty Bad. How Could It Be Worse?&lt;/h3&gt;&lt;p&gt;Imagine if the option we&amp;rsquo;d gotten looked like this, instead:&lt;/p&gt;&lt;p&gt;&lt;code&gt;plain +-----+-----+-----+-----+ | | | | | | 001 | 002 | 003 | 000 | | | | | | +-----+-----+-----+-----+ &lt;/code&gt;&lt;/p&gt;&lt;p&gt;Instead of infinitely recursing in the &lt;code&gt;iter&lt;/code&gt; function, this will nicely return an &lt;code&gt;MSS&lt;/code&gt; consisting of &lt;code&gt;000&lt;/code&gt; in the high byte and whatever memory is sitting past the end of this buffer in the low bit. The TCP stack will consider this to be the maximum segment size that the remote host on the other end will accept, and won&amp;rsquo;t send any packets larger than this. A crafty attacker can observe the maximum size of received segments to figure out what was in this byte of memory. This kind of bug is called a data leak, and it has &lt;a href=&quot;http://www.whatisheartbleed.com/&quot;&gt;potentially disastrous implications&lt;/a&gt;, especially for critical infrastructure like &lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;TLS servers&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Without soapboxing too much, I think it&amp;rsquo;s better for developers to catch this kind of problem early. Bugs like this one, where it&amp;rsquo;s obvious that &lt;em&gt;someone&lt;/em&gt; is supposed to making sure that something bad doesn&amp;rsquo;t happen, are difficult to see by reading the source but are made more obvious by automatic testing. &amp;ldquo;Oh no, something went wrong!&amp;rdquo; is a pretty good indication that something could, in fact, go wrong.&lt;/p&gt;&lt;p&gt;If you&amp;rsquo;re saying, &amp;ldquo;Okay, but this particular leak gets you one byte of data at a time, and in a way that&amp;rsquo;s hard to recover programmatically; the actual severity of this doesn&amp;rsquo;t seem very high,&amp;rdquo; consider that &lt;code&gt;Cstruct&lt;/code&gt; is widely used outside the context of the TCP stack, and that any code of this pattern:&lt;/p&gt;&lt;p&gt;&lt;code&gt;ocaml let leak_data flow buf = let reasonable_looking_number = value_past_end_of_buf in let offset = reasonable_looking_number in let data = Cstruct.BE.get_uint32 buf offset in S.TCPV4.write flow data &lt;/code&gt;&lt;/p&gt;&lt;p&gt;is a data leakage that&amp;rsquo;s exploitable by an attacker.&lt;/p&gt;&lt;p&gt;Luckily for us, this bug is fixable in &lt;code&gt;Cstruct&lt;/code&gt;, and folks developing on top of this infrastructure need only update to a version with this bug patched, rather than rewriting code in many places (as they might have to do in another language.&lt;/p&gt;&lt;h3&gt;&amp;hellip;Wait, Why Did We Make That Packet In The First Place?&lt;/h3&gt;&lt;p&gt;I expected my fuzzer to only send options malformed in these ways:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;length syntactically correct, but violates the spec&lt;/li&gt;&lt;li&gt;length correct, but content is invalid&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;because &lt;code&gt;scapy&lt;/code&gt; automatically handles setting the length field of TCP options. To recap, the exciting behavior above was triggered by sending a TCP option that looked like this:&lt;/p&gt;&lt;p&gt;&lt;code&gt;plain +-----+-----+-----+-----+ | | | | | | 001 | 002 | 000 | 000 | | | | | | +-----+-----+-----+-----+ &lt;/code&gt;&lt;/p&gt;&lt;p&gt;which looks an awful lot like an option with an improperly calculated length to me. It took me some staring and frowning to figure out that this packet is produced when the randomly-generated option-kind is &lt;code&gt;001&lt;/code&gt; and the randomly-generated amount of data to send is &lt;code&gt;000&lt;/code&gt;, meaning our &lt;code&gt;scapy&lt;/code&gt; packet gets an options array consisting of &lt;code&gt;[(1, '')]&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Here&amp;rsquo;s the relevant code path for assembling TCP options in &lt;code&gt;scapy&lt;/code&gt; (extracted from a larger function):&lt;/p&gt;&lt;p&gt;``` python&lt;/p&gt;&lt;h1&gt;onum is the option kind, oval is the option data&lt;/h1&gt;&lt;h1&gt;they are passed to this function as (onum, oval), e.g. (02, &amp;lsquo;\xff\xab&amp;rsquo;)&lt;/h1&gt;&lt;h1&gt;opt is the byte string that will be included in the overall field of TCP options&lt;/h1&gt;&lt;h1&gt;e.g. (\x02\x04\xff\xab).&lt;/h1&gt;&lt;p&gt;for oname, oval in x: opt=&amp;ldquo;&amp;rdquo; onum = oname if type(oval) is not str:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;   warning(&amp;quot;option [%i] is not string.&amp;quot;%onum)
   continue
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; opt += chr(onum)+chr(2+len(oval))+oval&lt;/p&gt;&lt;p&gt;return opt+&amp;ldquo;\x00&amp;rdquo;*(3-((len(opt)+3)%4)) ```&lt;/p&gt;&lt;p&gt;In the assembly function, &lt;code&gt;scapy&lt;/code&gt; doesn&amp;rsquo;t differentiate between option-kind &lt;code&gt;001&lt;/code&gt; (or &lt;code&gt;000&lt;/code&gt;, for that matter) and other option-kinds, and gives the option a length and data field. The length is &lt;code&gt;002&lt;/code&gt; and so the option needs padding to be properly aligned, so &lt;code&gt;scapy&lt;/code&gt; appends two &lt;code&gt;000&lt;/code&gt; bytes to the end. That&amp;rsquo;s how we get our Packet of Death.&lt;/p&gt;&lt;h3&gt;What Next?&lt;/h3&gt;&lt;p&gt;It&amp;rsquo;d be nice to be able to generate random packets that test all of the error conditions I laid out in my last post, for all option-kinds:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;option length is greater than the data available&lt;/li&gt;&lt;li&gt;option length is less than the data available&lt;/li&gt;&lt;li&gt;length syntactically correct, but violates the spec&lt;/li&gt;&lt;li&gt;length correct, but content is invalid&lt;/li&gt;&lt;li&gt;options are valid, but not properly included in the overall options field&lt;/li&gt;&lt;li&gt;option list is valid, but not properly padded&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Also, the &lt;a href=&quot;http://www.rfc-editor.org/rfc/rfc791.txt&quot;&gt;IP&lt;/a&gt; header has an options field of its own, which could use some similar investigation.&lt;/p&gt; </content><id>http://www.somerandomidiot.com/blog/2014/07/09/how-to-set-the-evil-bit/</id><title type="text">How to Set the Evil Bit</title><updated>2014-07-09T22:23:55+00:00</updated><author><email></email><name>Mindy Preston</name></author></entry><entry><link href="http://openmirage.org/blog/introducing-nocrypto" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;em&gt;This is the second in a series of posts that introduce new libraries for a pure OCaml implementation of TLS.
You might like to begin with the &lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;introduction&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;h3&gt;What is nocrypto?&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/mirleft/ocaml-nocrypto&quot;&gt;nocrypto&lt;/a&gt; is the small cryptographic library behind the
&lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;ocaml-tls&lt;/a&gt; project. It is built to be straightforward to use, adhere to
functional programming principles and able to run in a Xen-based unikernel.
Its major use-case is &lt;code&gt;ocaml-tls&lt;/code&gt;, which we &lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;announced yesterday&lt;/a&gt;, but we do intend to provide
sufficient features for it to be more widely applicable.&lt;/p&gt;
&lt;p&gt;&amp;quot;Wait, you mean you wrote your own &lt;em&gt;crypto library&lt;/em&gt;?&amp;quot;&lt;/p&gt;
&lt;h3&gt;&amp;quot;Never write your own crypto&amp;quot;&lt;/h3&gt;

&lt;p&gt;Everybody seems to recognize that cryptography is horribly difficult. Building
cryptography, it is all too easy to fall off the deep end and end up needing to
make decisions only a few, select specialists can make. Worse, any mistake is
difficult to uncover but completely compromises the security of the system. Or
in Bruce Schneier's &lt;a href=&quot;https://www.schneier.com/essays/archives/1998/01/security_pitfalls_in.html&quot;&gt;words&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Building a secure cryptographic system is easy to do badly, and very difficult
to do well. Unfortunately, most people can't tell the difference. In other
areas of computer science, functionality serves to differentiate the good from
the bad: a good compression algorithm will work better than a bad one; a bad
compression program will look worse in feature-comparison charts. Cryptography
is different. Just because an encryption program works doesn't mean it is
secure.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Obviously, it would be far wiser not to attempt to do this and instead reuse
good, proven work done by others. And with the wealth of free cryptographic
libraries around, one gets to take their pick.&lt;/p&gt;
&lt;p&gt;So to begin with, we turned to &lt;a href=&quot;https://forge.ocamlcore.org/projects/cryptokit/&quot;&gt;cryptokit&lt;/a&gt;, the more-or-less
standard cryptographic library in the OCaml world. It has a decent coverage of
the basics: some stream ciphers (ARC4), some block ciphers (AES, 3DES and
Blowfish) the core hashes (MD5, SHA, the SHA2 family and RIPEMD) and the
public-key primitives (Diffie-Hellman and RSA). It is also designed with
composability in mind, exposing various elements as stream-transforming objects
that can be combined on top of one another.&lt;/p&gt;
&lt;p&gt;Unfortunately, its API was a little difficult to use. Suppose you have a secret
key, an IV and want to use AES-128 in CBC mode to encrypt a bit of data. You do
it like this:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;let key = &amp;quot;abcd1234abcd1234&amp;quot;
and iv  = &amp;quot;1234abcd1234abcd&amp;quot;
and msg = &amp;quot;fire the missile&amp;quot;

let aes     = new Cryptokit.Block.aes_encrypt key
let aes_cbc = new Cryptokit.Block.cbc_encrypt ~iv aes

let cip =
  let size =
    int_of_float (ceil (float String.(length msg) /. 16.) *. 16.) in
  String.create size

let () = aes_cbc#transform msg 0 cip 0&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;At this point, &lt;code&gt;cip&lt;/code&gt; contains our secret message. This being CBC, both &lt;code&gt;msg&lt;/code&gt; and
the string the output will be written into (&lt;code&gt;cip&lt;/code&gt;) need to have a size that is a
multiple of the underlying block size. If they do not, bad things will
happen -- silently.&lt;/p&gt;
&lt;p&gt;There is also the curious case of hashing-object states:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;let md5 = Cryptokit.Hash.md5 ()

let s1 = Cryptokit.hash_string md5 &amp;quot;bacon&amp;quot;
let s2 = Cryptokit.hash_string md5 &amp;quot;bacon&amp;quot;
let s3 = Cryptokit.hash_string md5 &amp;quot;bacon&amp;quot;

(*
  s1 = &amp;quot;x\019%\142\248\198\1822\221\232\204\128\246\189\166/&amp;quot;
  s2 = &amp;quot;'\\F\017\234\172\196\024\142\255\161\145o\142\128\197&amp;quot;
  s3 = &amp;quot;'\\F\017\234\172\196\024\142\255\161\145o\142\128\197&amp;quot;
*)&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The error here is to try and carry a single instantiated hashing object around,
while trying to get hashes of distinct strings. But with the convergence after
the second step, the semantics of the hashing object still remains unclear to
us.&lt;/p&gt;
&lt;p&gt;One can fairly easily overcome the API style mismatches by making a few
specialized wrappers, of course, except for two major problems:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;Cryptokit is pervasively stateful. While this is almost certainly a result of
 performance considerations combined with its goals of ease of
 compositionality, it directly clashes with the fundamental design property of
 the TLS library we wanted to use it in: our &lt;code&gt;ocaml-tls&lt;/code&gt; library is stateless. We need to
 be able to represent the state the encryption engine is in as a value.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;Cryptokit operates on strings. As a primary target of &lt;code&gt;ocaml-tls&lt;/code&gt; was
 &lt;a href=&quot;http://openmirage.org/&quot;&gt;Mirage&lt;/a&gt;, and Mirage uses separate, non-managed regions of memory to
 store network data in, we need to be able to handle foreign-allocated
 storage. This means &lt;code&gt;Bigarray&lt;/code&gt; (as exposed by &lt;code&gt;Cstruct&lt;/code&gt;), and it seems just
 plain wrong to negate all the careful zero-copy architecture of the stack
 below by copying everything into and out of strings.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;There are further problems. For example, Cryptokit makes no attempts to combat
well-known timing vulnerabilities. It has no support for elliptic curves. And it
depends on the system-provided random number generator, which does not exist
when running in the context of a unikernel.&lt;/p&gt;
&lt;p&gt;At this point, with the &lt;em&gt;de facto&lt;/em&gt; choice off the table, it's probably worth
thinking about writing OCaml bindings to a rock-solid cryptographic library
written in C.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://nacl.cr.yp.to/&quot;&gt;NaCl&lt;/a&gt; is a modern, well-regarded crypto implementation, created by a
group of pretty famous and equally well-regarded cryptographers, and was the
first choice. Or at least its more approachable and packageable &lt;a href=&quot;http://labs.opendns.com/2013/03/06/announcing-sodium-a-new-cryptographic-library/&quot;&gt;fork&lt;/a&gt;
was, which already had &lt;a href=&quot;https://github.com/dsheets/ocaml-sodium&quot;&gt;OCaml bindings&lt;/a&gt;. Unfortunately, &lt;code&gt;NaCl&lt;/code&gt;
provides a narrow selection of implementations of various cryptographic
primitives, the ones its authors thought were best-of-breed (for example, the
only symmetric ciphers it implements are (X-)Salsa and AES in CTR mode). And
they are probably right (in some aspects they are &lt;em&gt;certainly&lt;/em&gt; right), but NaCl
is best used for implementations of newly-designed security protocols. It is
simply too opinionated to support an old, standardized behemoth like TLS.&lt;/p&gt;
&lt;p&gt;Then there is &lt;a href=&quot;https://www.openssl.org/docs/crypto/crypto.html&quot;&gt;crypto&lt;/a&gt;, the library OpenSSL is built on top of. It
is quite famous and provides optimized implementations of a wide range of
cryptographic algorithms. It also contains upwards of 200,000 lines of C and a
very large API footprint, and it's unclear whether it would be possible to run
it in the unikernel context. Recently, the parent project it is embedded in has
become highly suspect, with one high-profile vulnerability piling on top of
another and at least &lt;a href=&quot;http://www.libressl.org/&quot;&gt;two&lt;/a&gt; &lt;a href=&quot;https://boringssl.googlesource.com/boringssl/&quot;&gt;forks&lt;/a&gt; so far attempting to
clean the code base. It just didn't feel like a healthy code base to build
a new project on.&lt;/p&gt;
&lt;p&gt;There are other free cryptographic libraries in C one could try to bind, but at
a certain point we faced the question: is the work required to become intimately
familiar with the nuances and the API of an existing code base, and create
bindings for it in OCaml, really that much smaller than writing one from
scratch? When using a full library one commits to its security decisions and
starts depending on its authors' time to keep it up to date -- maybe this
effort is better spent in writing one in the first place.&lt;/p&gt;
&lt;p&gt;Tantalizingly, the length of the single OCaml source file in &lt;code&gt;Cryptokit&lt;/code&gt; is
2260 lines.&lt;/p&gt;
&lt;p&gt;Maybe if we made &lt;strong&gt;zero&lt;/strong&gt; decisions ourselves, informed all our work by published
literature and research, and wrote the bare minimum of code needed, it might not
even be dead-wrong to do it ourselves?&lt;/p&gt;
&lt;p&gt;And that is the basic design principle. Do nothing fancy. Do only documented
things. Don't write too much code. Keep up to date with security research. Open
up and ask people.&lt;/p&gt;
&lt;h3&gt;The anatomy of a simple crypto library&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;nocrypto&lt;/code&gt; uses bits of C, similarly to other cryptographic libraries written in
high-level languages.&lt;/p&gt;
&lt;p&gt;This was actually less of a performance concern, and more of a security one: for
the low-level primitives which are tricky to implement and for which known,
compact and widely used code already exists, the implementation is probably
better reused. The major pitfall we hoped to avoid that way are side-channel
attacks.&lt;/p&gt;
&lt;p&gt;We use public domain (or BSD licenced) &lt;a href=&quot;https://github.com/mirleft/ocaml-nocrypto/tree/master/src/native&quot;&gt;C sources&lt;/a&gt; for the
simple cores of AES, 3DES, MD5, SHA and SHA2. The impact of errors in this code
is constrained: they contain no recursion, and they perform no allocation,
simply filling in caller-supplied fixed-size buffer by appropriate bytes.&lt;/p&gt;
&lt;p&gt;The block implementations in C have a simple API that requires us to provide the
input and output buffers and a key, writing the single encrypted (or decrypted)
block of data into the buffer. Like this:&lt;/p&gt;
&lt;pre class=&quot;C&quot;&gt;&lt;code class=&quot;C&quot;&gt;void rijndaelEncrypt(const unsigned long *rk, int nrounds,
  const unsigned char plaintext[16], unsigned char ciphertext[16]);

void rijndaelDecrypt(const unsigned long *rk, int nrounds,
  const unsigned char ciphertext[16], unsigned char plaintext[16]);&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The hashes can initialize a provided buffer to serve as an empty accumulator,
hash a single chunk of data into that buffer and convert its contents into a
digest, which is written into a provided fixed buffer.&lt;/p&gt;
&lt;p&gt;In other words, all the memory management happens exclusively in OCaml and all
the buffers passed into the C layer are tracked by the garbage collector (GC).&lt;/p&gt;
&lt;h3&gt;Symmetric ciphers&lt;/h3&gt;

&lt;p&gt;So far, the only provided ciphers are AES, 3DES and ARC4, with ARC4 implemented
purely in OCaml (and provided only for TLS compatibility and for testing).&lt;/p&gt;
&lt;p&gt;AES and 3DES are based on core C code, on top of which we built some standard
&lt;a href=&quot;https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation&quot;&gt;modes of operation&lt;/a&gt; in OCaml. At the moment we support ECB, CBC
and CTR. There is also a nascent &lt;a href=&quot;https://en.wikipedia.org/wiki/Galois/Counter_Mode&quot;&gt;GCM&lt;/a&gt; implementation which is, at the time
of writing, known not to be optimal and possibly prone to timing attacks, and
which we are still working on.&lt;/p&gt;
&lt;p&gt;The exposed API strives to be simple and value-oriented. Each mode of each
cipher is packaged up as a module with a similar signature, with a pair of
functions for encryption and decryption. Each of those essentially takes a key
and a byte buffer and yields the resulting byte buffer, minimising hassle.&lt;/p&gt;
&lt;p&gt;This is how you encrypt a message:&lt;/p&gt;
&lt;pre class=&quot;OCaml&quot;&gt;&lt;code class=&quot;OCaml&quot;&gt;open Nocrypto.Block

let key = AES.CBC.of_secret Cstruct.(of_string &amp;quot;abcd1234abcd1234&amp;quot;)
and iv  = Cstruct.of_string &amp;quot;1234abcd1234abcd&amp;quot;
and msg = Cstruct.of_string &amp;quot;fire the missile&amp;quot;

let { AES.CBC.message ; iv } = AES.CBC.encrypt ~key ~iv msg&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The hashes implemented are just MD5, SHA and the SHA2 family. Mirroring the
block ciphers, they are based on C cores, with the HMAC construction provided in
OCaml. The API is similarly simple: each hash is a separate module with the same
signature, providing a function that takes a byte buffer to its digest, together
with several stateful operations for incremental computation of digests.&lt;/p&gt;
&lt;p&gt;Of special note is that our current set of C sources will probably soon be
replaced. AES uses code that is vulnerable to a &lt;a href=&quot;http://cr.yp.to/antiforgery/cachetiming-20050414.pdf&quot;&gt;timing attack&lt;/a&gt;,
stemming from the fact that substitution tables are loaded into the CPU cache
as-needed. The code does not take advantage of the &lt;a href=&quot;https://en.wikipedia.org/wiki/AES_instruction_set&quot;&gt;AES-NI&lt;/a&gt;
instructions present in modern CPUs that allow AES to be hardware-assisted. SHA
and SHA2 cores turned out to be (comparatively) ill-performing, and static
analysis already uncovered some potential memory issues, so we are looking for
better implementations.&lt;/p&gt;
&lt;h3&gt;Public-key cryptography&lt;/h3&gt;

&lt;p&gt;Bignum arithmetic is provided by the excellent &lt;a href=&quot;https://forge.ocamlcore.org/projects/zarith&quot;&gt;zarith&lt;/a&gt; library, which
in turn uses &lt;a href=&quot;https://gmplib.org/&quot;&gt;GMP&lt;/a&gt;. This might create some portability problems later on,
but as GMP is widely used and well rounded code base which also includes some of
the needed auxiliary number-theoretical functions (its slightly extended
Miller-Rabin probabilistic primality test and the fast next-prime-scanning
function), it seemed like a much saner choice than redoing it from scratch.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://github.com/mirleft/ocaml-nocrypto/blob/a52bba2dcaf1c5fd45249588254dff2722e9f960/src/rsa.mli&quot;&gt;RSA&lt;/a&gt; module provides the basics: raw encryption and decryption,
&lt;a href=&quot;https://en.wikipedia.org/wiki/PKCS_1&quot;&gt;PKCS1&lt;/a&gt;-padded versions of the same operations, and PKCS1 signing and
signature verification. It can generate RSA keys, which it does simply by
finding two large primes, in line with &lt;a href=&quot;http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.310.4183&quot;&gt;Rivest's&lt;/a&gt; own
recommendation.&lt;/p&gt;
&lt;p&gt;Notably, RSA implements the standard &lt;a href=&quot;https://en.wikipedia.org/wiki/Blinding_(cryptography)&quot;&gt;blinding&lt;/a&gt; technique which can mitigate
some side-channel attacks, such as timing or &lt;a href=&quot;http://www.cs.tau.ac.il/~tromer/acoustic/&quot;&gt;acoustic&lt;/a&gt;
cryptanalysis. It seems to foil even stronger, &lt;a href=&quot;http://eprint.iacr.org/2013/448.pdf&quot;&gt;cache eviction&lt;/a&gt;
based attacks, but as of now, we are not yet completely sure.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://github.com/mirleft/ocaml-nocrypto/blob/a52bba2dcaf1c5fd45249588254dff2722e9f960/src/dh.mli&quot;&gt;Diffie-Hellman&lt;/a&gt; module is also relatively basic. We implement some
&lt;a href=&quot;http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.56.1921&quot;&gt;widely&lt;/a&gt; &lt;a href=&quot;http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.21.639&quot;&gt;recommended&lt;/a&gt; checks on the incoming public key to
mitigate some possible MITM attacks, the module can generate strong DH groups
(using safe primes) with guaranteed large prime-order subgroup, and we provide
a catalogue of published DH groups ready for use.&lt;/p&gt;
&lt;h3&gt;Randomness&lt;/h3&gt;

&lt;p&gt;Random number generation used to be a chronically overlooked part of
cryptographic libraries, so much so that nowadays one of the first questions
about a crypto library is, indeed, &amp;quot;Where does it get randomness from?&amp;quot;&lt;/p&gt;
&lt;p&gt;It's an important question. A cryptographic system needs unpredictability in
many places, and violating this causes catastrophic &lt;a href=&quot;https://www.debian.org/security/2008/dsa-1571&quot;&gt;failures&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;nocrypto&lt;/code&gt; contains its own implementation of &lt;a href=&quot;https://www.schneier.com/fortuna.html&quot;&gt;Fortuna&lt;/a&gt;. Like
&lt;a href=&quot;https://www.schneier.com/yarrow.html&quot;&gt;Yarrow&lt;/a&gt;, Fortuna uses a strong block cipher in CTR mode (AES in our
case) to produce the pseudo-random stream, a technique that is considered as
unbreakable as the underlying cipher.&lt;/p&gt;
&lt;p&gt;The stream is both self-rekeyed, and rekeyed with the entropy gathered into its
accumulator pool. Unlike the earlier designs, however, Fortuna is built without
entropy estimators, which usually help the PRNG decide when to actually convert
the contents of an entropy pool into the new internal state. Instead, Fortuna
uses a design where the pools are fed round-robin, but activated with an
exponential backoff. There is &lt;a href=&quot;https://eprint.iacr.org/2014/167&quot;&gt;recent research&lt;/a&gt; showing this
design is essentially sound: after a state compromise, Fortuna wastes no more
than a constant factor of incoming entropy -- whatever the amount of entropy is
-- before coming back to an unpredictable state. The resulting design is both
simple, and robust in terms of its usage of environmental entropy.&lt;/p&gt;
&lt;p&gt;The above paper also suggests a slight improvement to the accumulator regime,
yielding a factor-of-2 improvement in entropy usage over the original. We still
haven't implemented this, but certainly intend to.&lt;/p&gt;
&lt;p&gt;A PRNG needs to be fed with some actual entropy to be able to produce
unpredictable streams. The library itself contains no provisions for doing this
and its PRNG needs to be fed by the user before any output can be produced. We
are &lt;a href=&quot;https://github.com/mirage/mirage-entropy&quot;&gt;working with the Mirage team&lt;/a&gt; on exposing environmental
entropy sources and connecting them to our implementation of Fortuna.&lt;/p&gt;
&lt;h3&gt;Above &amp;amp; beyond&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;nocrypto&lt;/code&gt; is still very small, providing the bare minimum cryptographic
services to support TLS and related X.509 certificate operations. One of the
goals is to flesh it out a bit, adding some more widely deployed algorithms, in
hopes of making it more broadly usable.&lt;/p&gt;
&lt;p&gt;There are several specific problems with the library at this stage:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C code&lt;/strong&gt; - As mentioned, we are seeking to replace some of the C code we use. The hash
cores are underperforming by about a factor of 2 compared to some other
implementations. AES implementation is on one hand vulnerable to a timing attack
and, on the other hand, we'd like to make use of hardware acceleration for this
workhorse primitive -- without it we lose about an order of magnitude of
performance.&lt;/p&gt;
&lt;p&gt;Several options were explored, ranging from looking into the murky waters of
OpenSSL and trying to exploit their heavily optimized primitives, to bringing
AES-NI into OCaml and redoing AES in OCaml. At this point, it is not clear which
path we'll take.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ECC&lt;/strong&gt; - Looking further, the library still lacks support for elliptic curve cryptography
and we have several options for solving this. Since it is used by TLS, ECC is
probably the missing feature we will concentrate on first.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Entropy on Xen&lt;/strong&gt; - The entropy gathering on Xen is incomplete. The current prototype uses current
time as the random seed and the effort to expose noisier sources like interrupt
timings and the RNG from dom0's kernel is still ongoing.  Dave Scott, for example, has
&lt;a href=&quot;http://lists.xen.org/archives/html/xen-devel/2014-06/msg01492.html&quot;&gt;submitted patches&lt;/a&gt; to upstream Xen to make it easier to establish low-bandwidth
channels to supplies guest VMs with strong entropy from a privileged domain
that has access to physical devices and hence high-quality entropy sources.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;GC timing attacks?&lt;/strong&gt; - There is the question of GC and timing attacks: whether doing
cryptography in a high-level language opens up a completely new surface for
timing attacks, given that GC runs are very visible in the timing profile. The
basic approach is to leave the core routines which we know are potentially
timing-sensitive (like AES) and for which we don't have explicit timing
mitigations (like RSA) to C, and invoke them atomically from the perspective of
the GC. So far, it's an open question whether the constructions built on top
of them expose further side-channels.&lt;/p&gt;
&lt;p&gt;Still, we believe that the whole package is a pleasant library to work with. Its
simplicity contributes to the comparative simplicity of the entire TLS library,
and we are actively seeking input on areas that need further improvement.
Although we are obviously biased, we believe it is the best cryptographic base
library available for this project, and it might be equally suited for your next
project too!&lt;/p&gt;
&lt;p&gt;We are striving to be open about the current security status of our code. You
are free to check out our &lt;a href=&quot;https://github.com/mirleft/ocaml-nocrypto/issues?state=open&quot;&gt;issue tracker&lt;/a&gt; and invited to contribute
comments, ideas, and especially audits and code.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;hr/&gt;Posts in this TLS series:
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;Introducing transport layer security (TLS) in pure OCaml&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;OCaml-TLS: building the nocrypto library core&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;OCaml-TLS: adventures in X.509 certificate parsing and validation&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-asn1&quot;&gt;OCaml-TLS: ASN.1 and notation embedding&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation&quot;&gt;OCaml-TLS: the protocol implementation and mitigations to known attacks&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;


   </content><id>http://openmirage.org/blog/introducing-nocrypto</id><title type="text">OCaml-TLS: building the nocrypto library core</title><updated>2014-07-09T16:00:00+00:00</updated><author><email></email><name>David Kaloper</name></author></entry><entry><link href="http://openmirage.org/blog/introducing-ocaml-tls" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;We announce a &lt;strong&gt;beta&lt;/strong&gt; release of &lt;code&gt;ocaml-tls&lt;/code&gt;, a clean-slate implementation of
&lt;a href=&quot;https://en.wikipedia.org/wiki/Transport_Layer_Security&quot;&gt;Transport Layer Security&lt;/a&gt; (TLS) in
OCaml.&lt;/p&gt;
&lt;h3&gt;What is TLS?&lt;/h3&gt;

&lt;p&gt;Transport Layer Security (TLS) is probably the most widely deployed
security protocol on the Internet. It provides communication privacy
to prevent eavesdropping, tampering, and message forgery. Furthermore,
it optionally provides authentication of the involved endpoints. TLS
is commonly deployed for securing web services (&lt;a href=&quot;http://tools.ietf.org/html/rfc2818&quot;&gt;HTTPS&lt;/a&gt;), emails,
virtual private networks, and wireless networks.&lt;/p&gt;
&lt;p&gt;TLS uses asymmetric cryptography to exchange a symmetric key, and
optionally authenticate (using X.509) either or both endpoints. It
provides algorithmic agility, which means that the key exchange
method, symmetric encryption algorithm, and hash algorithm are
negotiated.&lt;/p&gt;
&lt;h3&gt;TLS in OCaml&lt;/h3&gt;

&lt;p&gt;Our implementation &lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;ocaml-tls&lt;/a&gt; is already able to interoperate with
existing TLS implementations, and supports several important TLS extensions
such as server name indication (&lt;a href=&quot;https://tools.ietf.org/html/rfc4366&quot;&gt;RFC4366&lt;/a&gt;, enabling virtual hosting)
and secure renegotiation (&lt;a href=&quot;https://tools.ietf.org/html/rfc5746&quot;&gt;RFC5746&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Our &lt;a href=&quot;https://tls.openmirage.org/&quot;&gt;demonstration server&lt;/a&gt; runs &lt;code&gt;ocaml-tls&lt;/code&gt; and renders exchanged
TLS messages in nearly real time by receiving a trace of the TLS
session setup. If you encounter any problems, please give us &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues&quot;&gt;feedback&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ocaml-tls&lt;/code&gt; and all dependent libraries are available via &lt;a href=&quot;https://opam.ocaml.org/packages/tls/tls.0.1.0/&quot;&gt;OPAM&lt;/a&gt; (&lt;code&gt;opam install tls&lt;/code&gt;). The &lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;source is available&lt;/a&gt;
under a BSD license. We are primarily working towards completeness of
protocol features, such as client authentication, session resumption, elliptic curve and GCM
cipher suites, and have not yet optimised for performance.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ocaml-tls&lt;/code&gt; depends on the following independent libraries: &lt;a href=&quot;https://github.com/mirleft/ocaml-nocrypto&quot;&gt;ocaml-nocrypto&lt;/a&gt; implements the
cryptographic primitives, &lt;a href=&quot;https://github.com/mirleft/ocaml-asn1-combinators&quot;&gt;ocaml-asn1-combinators&lt;/a&gt; provides ASN.1 parsers/unparsers, and
&lt;a href=&quot;https://github.com/mirleft/ocaml-x509&quot;&gt;ocaml-x509&lt;/a&gt; implements the X509 grammar and certificate validation (&lt;a href=&quot;https://tools.ietf.org/html/rfc5280&quot;&gt;RFC5280&lt;/a&gt;). &lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;ocaml-tls&lt;/a&gt; implements TLS (1.0, 1.1 and 1.2; &lt;a href=&quot;https://tools.ietf.org/html/rfc2246&quot;&gt;RFC2246&lt;/a&gt;,
&lt;a href=&quot;https://tools.ietf.org/html/rfc4346&quot;&gt;RFC4346&lt;/a&gt;, &lt;a href=&quot;https://tools.ietf.org/html/rfc5246&quot;&gt;RFC5246&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;We invite the community to audit and run our code, and we are particularly interested in discussion of our APIs.
Please use the &lt;a href=&quot;http://lists.xenproject.org/archives/html/mirageos-devel/&quot;&gt;mirage-devel mailing list&lt;/a&gt; for discussions.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Please be aware that this release is a &lt;em&gt;beta&lt;/em&gt; and is missing external code audits.
It is not yet intended for use in any security critical applications.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In our &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues&quot;&gt;issue tracker&lt;/a&gt; we transparently document known attacks against TLS and our mitigations
(&lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues?labels=security%20concern&amp;amp;page=1&amp;amp;state=open&quot;&gt;checked&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirleft/ocaml-tls/issues?labels=security%20concern&amp;amp;page=1&amp;amp;state=closed&quot;&gt;unchecked&lt;/a&gt;).
We have not yet implemented mitigations against either the
&lt;a href=&quot;http://www.isg.rhul.ac.uk/tls/Lucky13.html&quot;&gt;Lucky13&lt;/a&gt; timing attack or traffic analysis (e.g. &lt;a href=&quot;http://tools.ietf.org/html/draft-pironti-tls-length-hiding-02&quot;&gt;length-hiding padding&lt;/a&gt;).&lt;/p&gt;
&lt;h3&gt;Trusted code base&lt;/h3&gt;

&lt;p&gt;Designed to run on Mirage, the trusted code base of &lt;code&gt;ocaml-tls&lt;/code&gt; is small. It includes the libraries already mentioned,
&lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;`ocaml-tls`&lt;/a&gt;, &lt;a href=&quot;https://github.com/mirleft/ocaml-asn1-combinators&quot;&gt;`ocaml-asn-combinators`&lt;/a&gt;, &lt;a href=&quot;https://github.com/mirleft/ocaml-x509&quot;&gt;`ocaml-x509`&lt;/a&gt;,
and &lt;a href=&quot;https://github.com/mirleft/ocaml-nocrypto&quot;&gt;`ocaml-nocrypto`&lt;/a&gt; (which uses C implementations of block
ciphers and hash algorithms). For arbitrary precision integers needed in 
asymmetric cryptography, we rely on &lt;a href=&quot;https://forge.ocamlcore.org/projects/zarith&quot;&gt;`zarith`&lt;/a&gt;, which wraps
&lt;a href=&quot;https://gmplib.org/&quot;&gt;`libgmp`&lt;/a&gt;. As underlying byte array structure we use
&lt;a href=&quot;https://github.com/mirage/ocaml-cstruct&quot;&gt;`cstruct`&lt;/a&gt; (which uses OCaml &lt;code&gt;Bigarray&lt;/code&gt; as storage).&lt;/p&gt;
&lt;p&gt;We should also mention the OCaml runtime, the OCaml compiler, the
operating system on which the source is compiled and the binary is executed, as
well as the underlying hardware. Two effectful frontends for
the pure TLS core are implemented, dealing
with side-effects such as reading and writing from the network: &lt;a href=&quot;http://ocsigen.org/lwt/api/Lwt_unix&quot;&gt;Lwt_unix&lt;/a&gt; and
Mirage, so applications can run directly as a Xen unikernel.&lt;/p&gt;
&lt;h3&gt;Why a new TLS implementation?&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Update:&lt;/strong&gt;
Thanks to &lt;a href=&quot;http://frama-c.com/&quot;&gt;Frama-C&lt;/a&gt; guys for &lt;a href=&quot;https://twitter.com/spun_off/status/486535304426188800&quot;&gt;pointing&lt;/a&gt; &lt;a href=&quot;https://twitter.com/spun_off/status/486536572792090626&quot;&gt;out&lt;/a&gt;
that &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1266&quot;&gt;CVE-2014-1266&lt;/a&gt; and &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224&quot;&gt;CVE-2014-0224&lt;/a&gt; are &lt;em&gt;not&lt;/em&gt; memory safety issues, but
logic errors. This article previously stated otherwise.&lt;/p&gt;
&lt;p&gt;There are only a few TLS implementations publicly available and most
programming languages bind to OpenSSL, an open source implementation written
in C. There are valid reasons to interface with an existing TLS library,
rather than developing one from scratch, including protocol complexity and
compatibility with different TLS versions and implementations. But from our
perspective the disadvantage of most existing libraries is that they
are written in C, leading to:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Memory safety issues, as recently observed by &lt;a href=&quot;https://en.wikipedia.org/wiki/Heartbleed&quot;&gt;Heartbleed&lt;/a&gt; and GnuTLS
 session identifier memory corruption (&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3466&quot;&gt;CVE-2014-3466&lt;/a&gt;) bugs;&lt;/li&gt;&lt;li&gt;Control flow complexity (Apple's goto fail, &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1266&quot;&gt;CVE-2014-1266&lt;/a&gt;);&lt;/li&gt;&lt;li&gt;And difficulty in encoding state machines (OpenSSL change cipher suite
 attack, &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224&quot;&gt;CVE-2014-0224&lt;/a&gt;).&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;Our main reasons for &lt;code&gt;ocaml-tls&lt;/code&gt; are that OCaml is a modern functional
language, which allows concise and declarative descriptions of the
complex protocol logic and provides type safety and memory safety to help
guard against programming errors. Its functional nature is extensively
employed in our code: the core of the protocol is written in purely
functional style, without any side effects.&lt;/p&gt;
&lt;p&gt;Subsequent blog posts &lt;a href=&quot;https://github.com/mirage/mirage/issues/257&quot;&gt;over the coming
days&lt;/a&gt; will examine in more detail
the design and implementation of the four libraries, as well as the security
trade-offs and some TLS attacks and our mitigations against them.  For now
though, we invite you to try out our &lt;strong&gt;&lt;a href=&quot;https://tls.openmirage.org/&quot;&gt;demonstration server&lt;/a&gt;&lt;/strong&gt;
running our stack over HTTPS.  We're particularly interested in feedback on our &lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;issue tracker&lt;/a&gt; about
clients that fail to connect, and any queries from anyone reviewing the &lt;a href=&quot;https://github.com/mirleft/&quot;&gt;source code&lt;/a&gt;
of the constituent libraries.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;hr/&gt;Posts in this TLS series:
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-ocaml-tls&quot;&gt;Introducing transport layer security (TLS) in pure OCaml&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-nocrypto&quot;&gt;OCaml-TLS: building the nocrypto library core&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-x509&quot;&gt;OCaml-TLS: adventures in X.509 certificate parsing and validation&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/introducing-asn1&quot;&gt;OCaml-TLS: ASN.1 and notation embedding&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/blog/ocaml-tls-api-internals-attacks-mitigation&quot;&gt;OCaml-TLS: the protocol implementation and mitigations to known attacks&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;


   </content><id>http://openmirage.org/blog/introducing-ocaml-tls</id><title type="text">Introducing transport layer security (TLS) in pure OCaml</title><updated>2014-07-08T15:00:00+00:00</updated><author><email></email><name>Hannes Mehnert</name></author></entry><entry><link href="http://openmirage.org/blog/mirage-1.2-released" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;Summer is in full swing here in Mirage HQ with torrential rainstorms, searing
sunshine, and our &lt;a href=&quot;http://www.oscon.com/oscon2014/public/schedule/detail/35024&quot;&gt;OSCON 2014&lt;/a&gt; talk
rapidly approaching in just a few weeks.  We've been steadily releasing point releases
since the &lt;a href=&quot;http://openmirage.org/blog/mirage-1.1-released&quot;&gt;first release&lt;/a&gt; back in December, and today's &lt;a href=&quot;https://github.com/mirage/mirage/releases/tag/v1.2.0&quot;&gt;Mirage
1.2.0&lt;/a&gt; is the last of the &lt;code&gt;1.x&lt;/code&gt; series.
The main improvements are usability-oriented:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;The Mirage frontend tool now generates a &lt;code&gt;Makefile&lt;/code&gt; with a &lt;code&gt;make depend&lt;/code&gt;
 target, instead of directly invoking OPAM as part of &lt;code&gt;mirage configure&lt;/code&gt;.
 This greatly improves usability on slow platforms such as ARM, since the
 output of OPAM as it builds can be inspected more easily. Users will now
 need to run &lt;code&gt;make depend&lt;/code&gt; to ensure they have the latest package set
 before building their unikernel.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;Improve formatting of the &lt;code&gt;mirage&lt;/code&gt; output, including pretty colours!
 This makes it easier to distinguish complex unikernel configurations
 that have lots of deployment options.  The generated files are built
 more verbosely by default to facilitate debugging, and with debug
 symbols and backtraces enabled by default.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;Added several &lt;a href=&quot;https://github.com/mirage/mirage/tree/master/types&quot;&gt;device module types&lt;/a&gt;, including &lt;code&gt;ENTROPY&lt;/code&gt; for random
 noise, &lt;code&gt;FLOW&lt;/code&gt; for stream-oriented connections, and exposed the &lt;code&gt;IPV4&lt;/code&gt;
 device in the &lt;code&gt;STACKV4&lt;/code&gt; TCP/IP stack type.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;Significant bugfixes in supporting libraries such as the TCP/IP
 stack (primarily thanks to &lt;a href=&quot;http://www.somerandomidiot.com/&quot;&gt;Mindy Preston&lt;/a&gt; fuzz testing
 and finding some good &lt;a href=&quot;https://github.com/mirage/mirage-tcpip/issues/56&quot;&gt;zingers&lt;/a&gt;).  There are too many
 library releases to list individually here, but you can &lt;a href=&quot;http://openmirage.org/releases&quot;&gt;browse the changelog&lt;/a&gt; for more details.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;h4&gt;&amp;nbsp;Towards Mirage OS 2.0&lt;/h4&gt;

&lt;p&gt;We've also been working hard on the &lt;strong&gt;Mirage OS 2.x series&lt;/strong&gt;, which introduces
a number of new features and usability improvements that emerged from actually
using the tools in practical projects.  Since there have been so many &lt;a href=&quot;http://openmirage.org/blog/welcome-to-our-summer-hackers&quot;&gt;new
contributors&lt;/a&gt; recently,
&lt;a href=&quot;http://amirchaudhry.com&quot;&gt;Amir Chaudhry&lt;/a&gt; is coordinating a &lt;a href=&quot;https://github.com/mirage/mirage/issues/257&quot;&gt;series of blog
posts&lt;/a&gt; in the runup to
&lt;a href=&quot;http://www.oscon.com/oscon2014/public/schedule/detail/35024&quot;&gt;OSCON&lt;/a&gt; that
explains the new work in depth.  Once the release rush has subsided, we'll
be working on integrating these posts into our &lt;a href=&quot;http://openmirage.org/docs&quot;&gt;documentation&lt;/a&gt;
properly.&lt;/p&gt;
&lt;p&gt;The new 2.0 features include the &lt;a href=&quot;https://github.com/mirage/irmin&quot;&gt;Irmin&lt;/a&gt; branch-consistent distributed storage
library, the pure OCaml &lt;a href=&quot;https://github.com/mirleft/&quot;&gt;TLS stack&lt;/a&gt;, &lt;a href=&quot;https://github.com/mirage/mirage-platform/pull/93&quot;&gt;Xen/ARM support&lt;/a&gt; and the Conduit I/O
subsystem for &lt;a href=&quot;http://anil.recoil.org/papers/2012-resolve-fable.pdf&quot;&gt;mapping names to connections&lt;/a&gt;.  Also included in the blog series
are some sample usecases on how these tie together for real applications (as a
teaser, here's a video of &lt;a href=&quot;https://www.youtube.com/watch?v=DSzvFwIVm5s&quot;&gt;Xen VMs booting using
Irmin&lt;/a&gt; thanks to &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave
Scott&lt;/a&gt; and &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt;!)&lt;/p&gt;
&lt;h4&gt;Upcoming talks and tutorials&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://mort.io&quot;&gt;Richard Mortier&lt;/a&gt; and myself will be gallivanting around the world
to deliver a few talks this summer:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;The week of &lt;a href=&quot;http://www.oscon.com/oscon2014&quot;&gt;OSCON&lt;/a&gt; on July 20th-24th.  Please get in touch via the conference website or a direct e-mail, or &lt;a href=&quot;http://www.oscon.com/oscon2014/public/schedule/detail/35024&quot;&gt;attend our talk&lt;/a&gt; on Thursday morning.
There's a &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; book signing on Tuesday morning for the super keen as well.&lt;/li&gt;&lt;li&gt;The &lt;a href=&quot;http://ecoop14.it.uu.se/programme/ecoop-school.php&quot;&gt;ECOOP summer school&lt;/a&gt; in beautiful Uppsala in Sweden on Weds 30th July. &lt;/li&gt;&lt;li&gt;I'll be presenting the Irmin and Xen integration at &lt;a href=&quot;http://events.linuxfoundation.org/events/xen-project-developer-summit&quot;&gt;Xen Project Developer Summit&lt;/a&gt; in
 Chicago on Aug 18th (as part of LinuxCon North America).  &lt;a href=&quot;http://mort.io&quot;&gt;Mort&lt;/a&gt; and &lt;a href=&quot;http://somerandomidiot.com&quot;&gt;Mindy&lt;/a&gt; (no jokes please) will be
 joining the community panel about &lt;a href=&quot;http://openmirage.org/blog/applying-for-gsoc2014&quot;&gt;GSoC/OPW&lt;/a&gt; participation.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;As always, if there are any particular topics you would like to see more
on, then please comment on the &lt;a href=&quot;https://github.com/mirage/mirage/issues/257&quot;&gt;tracking issue&lt;/a&gt;
or &lt;a href=&quot;http://openmirage.org/community&quot;&gt;get in touch directly&lt;/a&gt;.  There will be a lot of releases coming out
in the next few weeks (including a beta of the new version of &lt;a href=&quot;http://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt;,
so &lt;a href=&quot;https://github.com/mirage/mirage/issues&quot;&gt;bug reports&lt;/a&gt; are very much appreciated for those
things that slip past &lt;a href=&quot;http://travis-ci.org&quot;&gt;Travis CI&lt;/a&gt;!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/mirage-1.2-released</id><title type="text">Mirage 1.2 released and the 2.0 runup begins</title><updated>2014-07-08T11:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2014/06/24/highlights-from-recent-sessions" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;h2&gt;Highlights from recent sessions&lt;/h2&gt;

&lt;p&gt;With the &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/2014/06/20/sixth-compiler-hacking-session.html&quot;&gt;next compiler hacking meeting&lt;/a&gt; due to take place in a couple of days it's time for a look back at some results from our last couple of sessions.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;the-front-end&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;The front end&lt;/h3&gt;

&lt;figure style=&quot;float: right; padding: 15px; width: 350px&quot;&gt;
&lt;img src=&quot;https://farm3.staticflickr.com/2756/4150220583_57a993cc61_z_d.jpg&quot; style=&quot;width: 350px&quot; alt=&quot;Camel front end&quot;/&gt;&lt;br/&gt;
&lt;figcaption&gt;&lt;center&gt;&lt;small&gt;(&lt;a href=&quot;https://www.flickr.com/photos/paperpariah/4150220583&quot;&gt;&lt;i&gt;today I stared a camel in the face&lt;/i&gt;&lt;/a&gt; by &lt;a href=&quot;https://www.flickr.com/photos/paperpariah/&quot;&gt;Adam Foster&lt;/a&gt;)&lt;/small&gt;&lt;/center&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;The front end (i.e. &lt;a href=&quot;https://realworldocaml.org/v1/en/html/the-compiler-frontend-parsing-and-type-checking.html&quot;&gt;the parser and type checker&lt;/a&gt;) saw a number of enhancements.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;succinct-functor-syntax&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Succinct functor syntax&lt;/h4&gt;

&lt;p&gt;Syntax tweaks are always popular, if &lt;a href=&quot;http://www.haskell.org/haskellwiki/Wadler's_Law&quot;&gt;often contentious&lt;/a&gt;.   However, reaching agreement is significantly easier when adding syntax is a simple matter of extending an existing correspondence between two parts of the language.  For example, it was clear which syntax to use when adding support for &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-400/manual021.html#toc73&quot;&gt;lazy patterns&lt;/a&gt;: since patterns generally mirror the syntax for the values they match, patterns for destructing lazy values should use the same &lt;code&gt;lazy&lt;/code&gt; keyword as the expressions which construct them.&lt;/p&gt;

&lt;p&gt;A second correspondence in OCaml's syntax relates modules and values.  Module names and variables are both bound with &lt;code&gt;=&lt;/code&gt;; module signatures and types are both ascribed with &lt;code&gt;:&lt;/code&gt;; module fields and record fields are both projected with &lt;code&gt;.&lt;/code&gt;.  The syntax for functors and functions is also similar, but the latter offers a number of shortcuts not available in the module language; you can write&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;instead of the more prolix equivalent:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;but multi-argument functors must be written out in full:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;functor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;functor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;functor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;M&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In February's meeting, &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas&lt;/a&gt; wrote a &lt;a href=&quot;https://github.com/ocaml/ocaml/pull/16&quot;&gt;patch&lt;/a&gt; that adds an analogue of the shorter syntax to the module language, allowing the repeated &lt;code&gt;functor&lt;/code&gt; to be left out:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;functor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;M&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The patch also adds support for a corresponding abbreviation at the module type level.  Defining the type of a multi-argument functor currently involves writing a rather clunky sequence of &lt;code&gt;functor&lt;/code&gt; abstractions:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;functor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;functor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;functor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;U&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;With Thomas's patch all but the first occurrence of &lt;code&gt;functor&lt;/code&gt; disappear:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;functor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;U&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Since Thomas's patch has been merged into trunk, you can try out the new syntax using the &lt;a href=&quot;http://alan.petitepomme.net/cwn/2014.05.27.html#2&quot;&gt;4.02.0 beta&lt;/a&gt;, which is available as a compiler switch in the OPAM repository:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;opam switch 4.02.0+trunk
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The next step is to find out whether the verbose syntax was a symptom or a cause of the infrequency of higher-order functors in OCaml code.  Will we see a surge in the popularity of higher-order modules as the syntax becomes more accommodating?&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;integer-ranges&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Integer ranges&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://github.com/dsheets&quot;&gt;David&lt;/a&gt; started work on extending OCaml's range patterns, which currently support only characters, to support &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on#wiki-integer-range-patterns&quot;&gt;integer ranges&lt;/a&gt;.  For example, consider the following &lt;a href=&quot;https://github.com/ygrek/mldonkey/blob/03896bfc/src/utils/ocamlrss/rss_date.ml#L195-L202&quot;&gt;code from MLDonkey&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mdn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;            &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;true&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;true&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;            &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt;                            &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;                              &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Although this is fairly clear, it could be made even clearer if we had a &lt;a href=&quot;http://en.wikipedia.org/wiki/Rule_of_least_power&quot;&gt;&lt;em&gt;less&lt;/em&gt; powerful language&lt;/a&gt; for expressing the tests involving &lt;code&gt;h&lt;/code&gt;.  Since the whole OCaml language is available in the &lt;code&gt;when&lt;/code&gt; guard of a case, the reader has to examine the code carefully before concluding that the tests are all simple range checks.  Perhaps worse, using guards inhibits the useful checks that the OCaml compiler performs to determine whether patterns are exhaustive or redundant.  David's patch makes it possible to rewrite the tests without guards, making the simple nature of the tests on &lt;code&gt;h&lt;/code&gt; clear at a glance (and making it possible once again to check exhaustiveness and redundancy):&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mdn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt;                 &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The work on range patterns led to a robust exchange of views about which other types should be supported -- should we support any enumerable type (e.g. variants with nullary constructors)? or perhaps even any ordered type (e.g. floats or strings)?  For the moment, there seems to be a much clearer consensus in favour of supporting integer types than there is for generalising range patterns any further.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;extensible-variants&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Extensible variants&lt;/h4&gt;

&lt;p&gt;Since the compiler hacking group only meets for an evening every couple of months or so, most of the &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;projects we work on&lt;/a&gt; are designed so that it's possible to implement them in a few hours.  &lt;a href=&quot;http://www.lpw25.net/&quot;&gt;Leo&lt;/a&gt;'s proposal for extensible variants is a notable exception, &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2012-01/msg00050.html&quot;&gt;predating&lt;/a&gt; both the &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/2013/09/17/compiler-hacking-july-2013.html&quot;&gt;compiler hacking group&lt;/a&gt; and &lt;a href=&quot;http://anil.recoil.org/2012/10/19/announcing-ocaml-labs.html&quot;&gt;OCaml Labs&lt;/a&gt; itself.&lt;/p&gt;

&lt;p&gt;Extensible variants generalise exceptions: with Leo's patch the exception type &lt;code&gt;exn&lt;/code&gt; becomes a particular instance of a class of types that can be defined by the user rather than a special builtin provided by the compiler:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;c&quot;&gt;(* Define an extensible variant type *)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;(* Extend the type with a constructor *)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Not_found&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;(* Extend the type with another constructor *)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Invalid_argument&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Even better, extensible variants come with all the power of regular variant types: they can take type parameters, and even support GADT definitions:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;c&quot;&gt;(* Define a parameterised extensible variant type *)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;(* Extend the type with a constructor *)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Error&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;(* Extend the type with a GADT constructor *)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IntError&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;On the evening of the last compiler hacking meeting, Leo &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5584#c11335&quot;&gt;completed&lt;/a&gt; the patch; shortly afterwards it was &lt;a href=&quot;https://github.com/ocaml/ocaml/commit/b56dc4b3df8d022b54f40682a9d5d4168c690413&quot;&gt;merged to trunk&lt;/a&gt;, ready for inclusion in &lt;a href=&quot;http://alan.petitepomme.net/cwn/2014.05.27.html#2&quot;&gt;OCaml 4.02&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Extensible variants are a significant addition to the language, and there's more to them than these simple examples show.  A forthcoming post from Leo will describe the new feature in more detail.  In the meantime, since they've been merged into the 4.02 release candidate, you can try them out with OPAM:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;opam switch 4.02.0+trunk
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a name=&quot;lazy-record-fields&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Lazy record fields&lt;/h4&gt;

&lt;p&gt;Not everything we work on makes is destined to make it upstream.  A few years ago, &lt;a href=&quot;http://alain.frisch.fr/&quot;&gt;Alain Frisch&lt;/a&gt; &lt;a href=&quot;http://www.lexifi.com/blog/ocaml-extensions-lexifi-semi-implicit-laziness&quot;&gt;described&lt;/a&gt; an OCaml extension in use at &lt;a href=&quot;http://lexifi.com/&quot;&gt;Lexifi&lt;/a&gt; for marking record fields lazy, making it possible to delay the evaluation of initializing expressions without writing the &lt;code&gt;lazy&lt;/code&gt; keyword every time a record is constructed.  Alain's post was received enthusiastically, and lazy record fields seemed like an obvious candidate for inclusion upstream, so in April's meeting Thomas put together a &lt;a href=&quot;https://github.com/ocaml/ocaml/pull/48&quot;&gt;patch&lt;/a&gt; implementing the design.  Although the OCaml team decided not to merge the patch, it led to an enlightening &lt;a href=&quot;https://github.com/ocaml/ocaml/pull/48#issuecomment-41758626&quot;&gt;discussion&lt;/a&gt; with comments from several core developers, including Alain, who described &lt;a href=&quot;https://github.com/ocaml/ocaml/pull/48#issuecomment-41758626&quot;&gt;subsequent, less positive, experience with the feature at Lexifi&lt;/a&gt;, and Xavier, who explained the &lt;a href=&quot;https://github.com/ocaml/ocaml/pull/48#issuecomment-41779525&quot;&gt;rationale underlying the current design&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;back-end&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;The back end&lt;/h3&gt;

&lt;figure style=&quot;float: right; padding: 15px; width: 350px&quot;&gt;
&lt;img src=&quot;http://farm4.staticflickr.com/3157/2877029132_b34943c8d7_z_d.jpg&quot; style=&quot;width: 350px&quot; alt=&quot;Camel back end&quot;/&gt;&lt;br/&gt;
&lt;figcaption&gt;&lt;center&gt;&lt;small&gt;(&lt;a href=&quot;http://www.flickr.com/photos/16230215@N08/2877029132&quot;&gt;&lt;i&gt;Relief&lt;/i&gt;&lt;/a&gt;
by &lt;a href=&quot;http://www.flickr.com/photos/h-k-d/&quot;&gt;Hartwig HKD&lt;/a&gt;)&lt;/small&gt;&lt;/center&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;The OCaml back end (i.e. the &lt;a href=&quot;https://realworldocaml.org/v1/en/html/the-compiler-backend-byte-code-and-native-code.html&quot;&gt;code generation portion of the compiler&lt;/a&gt;) also saw a proposed enhancement.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;constant-arithmetic-optimization&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Constant arithmetic optimization&lt;/h4&gt;

&lt;p&gt;Stephen submitted a &lt;a href=&quot;https://github.com/ocaml/ocaml/pull/17&quot;&gt;patch&lt;/a&gt; improving the generated code for functions that perform constant arithmetic on integers.&lt;/p&gt;

&lt;p&gt;In OCaml, integers and characters are &lt;a href=&quot;https://realworldocaml.org/v1/en/html/memory-representation-of-values.html#table20-1_ocaml&quot;&gt;represented as shifted immediate values&lt;/a&gt;, with the least significant bit set to distinguish them from pointers.  This makes some arithmetic operations &lt;a href=&quot;https://realworldocaml.org/v1/en/html/memory-representation-of-values.html#idm181610127856&quot;&gt;a little more expensive&lt;/a&gt;.  For example, consider a function that &lt;code&gt;int_of_digits&lt;/code&gt; that builds an integer from three character digits:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;n&quot;&gt;int_of_digits&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'3'&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'4'&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'5'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;345&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We might define &lt;code&gt;int_of_digits&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_of_digits&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
  &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'0'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
   &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'0'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'0'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Passing the &lt;code&gt;-dcmm&lt;/code&gt; flag to ocamlopt shows the results of compiling the function to the &lt;a href=&quot;https://github.com/ocaml/ocaml/blob/trunk/asmcomp/cmm.mli&quot;&gt;C-- intermediate language&lt;/a&gt;. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ocamlopt -dcmm int_of_digits.ml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The generated code has the following form (reformatted for readability):&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The right shifts convert the tagged representation into native integers, and the final &lt;code&gt;+ 1&lt;/code&gt; converts the result back to a tagged integer.&lt;/p&gt;

&lt;p&gt;Stephen's patch floats the arithmetic operations that involve constant operands outwards, eliminating most of the tag-munging code in favour of a final correcting addition:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10766&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Although these changes are not yet merged, you can easily try them out, thanks to Anil's script that &lt;a href=&quot;http://anil.recoil.org/2014/03/25/ocaml-github-and-opam.html&quot;&gt;makes compiler pull requests available as OPAM switches&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;opam switch 4.03.0+pr17
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a name=&quot;standard-library&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;Standard library and beyond&lt;/h3&gt;

&lt;figure style=&quot;float: right; padding: 15px; width: 350px&quot;&gt;
&lt;img src=&quot;http://i.imgur.com/KKsM0tu.jpg&quot; style=&quot;width: 350px&quot; alt=&quot;Camel library&quot;/&gt;&lt;br/&gt;
&lt;figcaption&gt;&lt;center&gt;&lt;small&gt;(Literary advocate &lt;a href=&quot;http://www.papertigers.org/wordpress/interview-with-dashdondog-jamba-mongolian-author-and-literacy-advocate/&quot;&gt;Dashdondog Jamba&lt;/a&gt;, and his mobile library, described in &lt;a href=&quot;http://www.bookdepository.com/My-Librarian-Is-a-Camel-Margriet-Ruurs/9781590780930&quot;&gt;&lt;i&gt;My librarian is a camel&lt;/i&gt;&lt;/a&gt;)&lt;/small&gt;&lt;/center&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Our compiler hacking group defines &amp;quot;compiler&amp;quot; rather broadly.  As a result people often work on improving the standard library and tools as well as the compiler proper.  For example, in recent sessions, David added a small patch to &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6105&quot;&gt;expose the is_inet6_addr&lt;/a&gt; function, and &lt;a href=&quot;http://philippewang.info/&quot;&gt;Philippe&lt;/a&gt; proposed &lt;a href=&quot;https://github.com/ocaml/ocaml/pull/15&quot;&gt;a patch that eliminates unnecessary bounds checking&lt;/a&gt; in the buffer module.  The last session also saw &lt;a href=&quot;http://www.cl.cam.ac.uk/~rp452/&quot;&gt;Rapha&amp;euml;l&lt;/a&gt; and Simon push a &lt;a href=&quot;https://github.com/ocaml/opam-repository/pull/1961&quot;&gt;number&lt;/a&gt; &lt;a href=&quot;https://github.com/ocaml/opam-repository/pull/1968&quot;&gt;of&lt;/a&gt; &lt;a href=&quot;https://github.com/ocaml/opam-repository/pull/1972&quot;&gt;patches&lt;/a&gt; for integrating &lt;a href=&quot;https://github.com/the-lambda-church/merlin&quot;&gt;merlin&lt;/a&gt; with the &lt;a href=&quot;http://en.wikipedia.org/wiki/Acme_(text_editor)&quot;&gt;acme&lt;/a&gt; editor to OPAM, improving OCaml support in Plan 9.&lt;/p&gt;

&lt;h2&gt;Next session&lt;/h2&gt;

&lt;p&gt;The compiler hacking group is open to anyone with an interest in contributing to the OCaml compiler.  If you're local to Cambridge, you're welcome to join us at the &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/2014/06/20/sixth-compiler-hacking-session.html&quot;&gt;next session&lt;/a&gt;!&lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2014/06/24/highlights-from-recent-sessions</id><title type="text">Highlights from recent sessions</title><updated>2014-06-24T04:00:00+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2014/06/20/sixth-compiler-hacking-session" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;p&gt;(Update (2014-06-24): Stephen Dolan will be giving a demo of multicore OCaml!)&lt;/p&gt;

&lt;p&gt;It's time for the sixth Cambridge OCaml compiler-hacking session!  We'll be meeting in the &lt;a href=&quot;http://www.cl.cam.ac.uk/&quot;&gt;Computer Lab&lt;/a&gt; again next Wednesday evening (25th June).&lt;/p&gt;

&lt;p&gt;If you're planning to come along, it'd be helpful if you could &lt;a href=&quot;http://doodle.com/2ps9gunbkiy3tp6i&quot;&gt;&lt;em&gt;indicate interest via Doodle&lt;/em&gt;&lt;/a&gt; and &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;&lt;em&gt;sign up to the mailing list&lt;/em&gt;&lt;/a&gt; to receive updates:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Where&lt;/em&gt;: Room &lt;a href=&quot;http://www.cl.cam.ac.uk/research/dtg/openroommap/static/?s=FW11&amp;amp;amp%3Blabels=1&quot;&gt;FW11&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/directions/&quot;&gt;Computer Laboratory, Madingley Road&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;When&lt;/em&gt;: 6.30pm, Wednesday 25th June&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Who&lt;/em&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;What&lt;/em&gt;: fixing bugs, implementing new features, learning about OCaml internals&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Wiki&lt;/em&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience (see also some &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;things we've worked on in previous sessions&lt;/a&gt;), but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll also be ordering pizza, so if you want to be counted for food you should aim to arrive by 6.45pm.&lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2014/06/20/sixth-compiler-hacking-session</id><title type="text">Sixth OCaml compiler hacking session</title><updated>2014-06-20T20:50:00+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://openmirage.org/blog/welcome-to-our-summer-hackers" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;Following our participation in the &lt;a href=&quot;http://openmirage.org/blog/applying-for-gsoc2014&quot;&gt;Google Summer of Code&lt;/a&gt; program, we've now finalised selections.  We've also got a number of other visitors joining us to hack on Mirage over the summer time, so here are introductions!&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;SSL support&lt;/strong&gt;: &lt;a href=&quot;https://github.com/hannesm&quot;&gt;Hannes Mehnert&lt;/a&gt; and &lt;a href=&quot;https://github.com/pqwy&quot;&gt;David Kaloper&lt;/a&gt; have been working hard on a safe &lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;OCaml TLS&lt;/a&gt; implementation. They're going to hack on &lt;a href=&quot;https://github.com/mirage/mirage/issues/242&quot;&gt;integrating it all&lt;/a&gt; into working under Xen so we can make HTTPS requests (and our Twitter bot will finally be able to tweet!).  Both are also interested in formal verification of the result, and several loooong conversations with &lt;a href=&quot;http://www.cl.cam.ac.uk/~pes20/&quot;&gt;Peter Sewell&lt;/a&gt; will magically transform into machine specifications by summer's end, I'm reliably informed.&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Cloud APIs&lt;/strong&gt;: &lt;a href=&quot;http://1000hippos.wordpress.com/&quot;&gt;Jyotsna Prakash&lt;/a&gt; will spend her summer break as part of &lt;a href=&quot;http://www.google-melange.com/gsoc/org2/google/gsoc2014/xen_project&quot;&gt;Google Summer of Code&lt;/a&gt; working on improving cloud provider APIs in OCaml (modelled from her notes on how the &lt;a href=&quot;https://github.com/avsm/ocaml-github&quot;&gt;GitHub&lt;/a&gt; bindings &lt;a href=&quot;http://1000hippos.wordpress.com/2014/04/24/ocaml-github/&quot;&gt;are built&lt;/a&gt;).  This will let the &lt;code&gt;mirage&lt;/code&gt; command-line tool have much more natural integration with remote cloud providers for executing the unikernels straight from a command-line.  If you see Jyotsna wandering around aimlessly muttering darkly about HTTP, JSON and REST, then the project is going well.&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Network Stack fuzzing&lt;/strong&gt;: &lt;a href=&quot;http://www.somerandomidiot.com/&quot;&gt;Mindy Preston&lt;/a&gt; joins us for the summer after her &lt;a href=&quot;https://www.hackerschool.com/&quot;&gt;Hacker School&lt;/a&gt; stay, courtesy of the &lt;a href=&quot;https://opw.gnome.org&quot;&gt;OPW&lt;/a&gt; program.  She's been delving into the network stack running on EC2 and figuring out how to debug issues when the unikernel is running a cloud far, far away (see the post series here: &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/03/14/its-a-mirage/&quot;&gt;1&lt;/a&gt;, &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/03/24/advancing-toward-the-mirage/&quot;&gt;2&lt;/a&gt;, &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/04/02/tying-the-knot/&quot;&gt;3&lt;/a&gt;, &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/03/24/arriving-at-the-mirage/&quot;&gt;4&lt;/a&gt;).&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Visualization&lt;/strong&gt;: &lt;a href=&quot;http://erratique.ch/contact.en&quot;&gt;Daniel Buenzli&lt;/a&gt; returns to Cambridge this summer to continue his work on extremely succinctly named graphics libaries.  His &lt;a href=&quot;https://github.com/dbuenzli/vz&quot;&gt;Vz&lt;/a&gt;, &lt;a href=&quot;https://github.com/dbuenzli/vg&quot;&gt;Vg&lt;/a&gt; and &lt;a href=&quot;https://github.com/dbuenzli/gg&quot;&gt;Gg&lt;/a&gt; libaries build a set of primitives for 2D graphics programming.  Since the libraries compile to JavaScript, we're planning to use this as the basis for &lt;a href=&quot;http://erratique.ch/software/vg/demos/rhtmlc&quot;&gt;visualization&lt;/a&gt; of Mirage applications via a built-in webserver.&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Modular implicits&lt;/strong&gt;: &lt;a href=&quot;https://github.com/def-lkb&quot;&gt;Frederic Bour&lt;/a&gt;, author of the popular &lt;a href=&quot;https://github.com/the-lambda-church/merlin&quot;&gt;Merlin&lt;/a&gt; IDE tool is also in Cambridge this summer working on adding modular implicits to the core OCaml language. Taking inspiration from &lt;a href=&quot;http://www.mpi-sws.org/~dreyer/papers/mtc/main-long.pdf&quot;&gt;Modular Type-classes&lt;/a&gt; and Scala's &lt;a href=&quot;http://twitter.github.io/scala_school/advanced-types.html&quot;&gt;implicits&lt;/a&gt;,  modular implcits allow functions to take implicit module arguments which will be filled-in by the compiler by searching the environment for a module with the appropriate type. This enables ad-hoc polymorphism in a very similar way to Haskell's type classes.&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Irmin storage algorithms&lt;/strong&gt;: Benjamin Farinier (from &lt;a href=&quot;http://www.ens-lyon.eu/&quot;&gt;ENS Lyon&lt;/a&gt;) and Matthieu Journault (from &lt;a href=&quot;http://www.ens-cachan.fr/&quot;&gt;ENS Cachan&lt;/a&gt;) will work on datastructures for the &lt;a href=&quot;https://github.com/mirage/irmin/wiki/Getting-Started&quot;&gt;Irmin&lt;/a&gt; storage system that the next version of Mirage will use.  They'll be grabbing copies of the &lt;a href=&quot;http://www.amazon.co.uk/Purely-Functional-Structures-Chris-Okasaki/dp/0521663504&quot;&gt;Okasaki&lt;/a&gt; classic text and porting some of them into a branch-consistent form.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;Of course, work continues apace by the rest of the team as usual, with a &lt;a href=&quot;http://www.openmirage.org/releases&quot;&gt;steady stream of releases&lt;/a&gt; that are building up to some exciting new features.  We'll be blogging about ARM support, PVHVM, Irmin storage and SSL integration just as soon as they're pushed into the stable branches.  As always, &lt;a href=&quot;http://www.openmirage.org/community/&quot;&gt;get in touch&lt;/a&gt; via the IRC channel (&lt;code&gt;#mirage&lt;/code&gt; on Freenode) or the mailing lists with questions.&lt;/p&gt;

   </content><id>http://openmirage.org/blog/welcome-to-our-summer-hackers</id><title type="text">Welcome to the summer Mirage hackers</title><updated>2014-05-08T18:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://amirchaudhry.com/writing-planet-in-pure-ocaml" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;p&gt;I&amp;rsquo;ve been learning OCaml for some time now but not really had a problem that
I wanted to solve. As such, my progress has been rather slow and sporadic
and I only make time for exercises when I&amp;rsquo;m travelling. In order to focus my
learning, I have to identify and tackle something specific. That&amp;rsquo;s usually
the best way to advance and I recently found something I can work on.&lt;/p&gt;

&lt;p&gt;As I&amp;rsquo;ve been trying to write more blog posts, I want to be able to keep as
much content on my own site as possible and syndicate my posts out to other
sites I run. Put simply, I want to be able to take multiple feeds from
different sources and merge them into one feed, which will be served from
some other site. In addition, I also want to render that feed as HTML on a
webpage. All of this has to remain within the OCaml toolchain so it can be
used as part of &lt;a href=&quot;http://openmirage.org/&quot;&gt;Mirage&lt;/a&gt; (i.e. I can use it when
&lt;a href=&quot;http://amirchaudhry.com/from-jekyll-to-unikernel-in-fifty-lines&quot;&gt;building unikernels&lt;/a&gt;). &lt;/p&gt;

&lt;p&gt;What I&amp;rsquo;m describing might sound familiar and there&amp;rsquo;s a well-known tool that
does this called &lt;a href=&quot;http://en.wikipedia.org/wiki/Planet_(software)&quot;&gt;Planet&lt;/a&gt;. It&amp;rsquo;s a &amp;lsquo;river of news&amp;rsquo; feed reader, which
aggregates feeds and can display posts on webpages and you can find the
&lt;a href=&quot;http://www.planetplanet.org&quot;&gt;original Planet&lt;/a&gt; and it&amp;rsquo;s successor &lt;a href=&quot;http://intertwingly.net/code/venus/docs/index.html&quot;&gt;Venus&lt;/a&gt;, both written in Python.
However, Venus seems to be unmaintained as there are a number of
&lt;a href=&quot;https://github.com/rubys/venus/issues&quot;&gt;unresolved issues and pull requests&lt;/a&gt;, which have been
languishing for quite some time with no discussion. There does appear to be
a more active Ruby implementation called &lt;a href=&quot;http://feedreader.github.io/&quot;&gt;Pluto&lt;/a&gt;, with recent commits and
no reported issues.&lt;/p&gt;



&lt;h3&gt;Benefits of a Planet in pure OCaml&lt;/h3&gt;

&lt;p&gt;Although I could use the one of the above options, it would be much more
useful to keep everything within the OCaml ecosystem.  This way I can make
the best use of the &lt;a href=&quot;https://queue.acm.org/detail.cfm?id=2566628&quot;&gt;unikernel approach&lt;/a&gt; with Mirage (i.e lean,
single-purpose appliances). Obviously, the existing options don&amp;rsquo;t lend
themselves to this approach and there are &lt;a href=&quot;https://forge.ocamlcore.org/tracker/index.php?func=detail&amp;amp;aid=1349&amp;amp;group_id=1&amp;amp;atid=101&quot;&gt;known bugs&lt;/a&gt; as a lot has
changed on the web since Planet Venus (e.g the adoption of HTML5).
Having said that, I can learn a lot from the existing implementations and
I&amp;rsquo;m glad I&amp;rsquo;m not embarking into completely uncharted territory.&lt;/p&gt;

&lt;p&gt;In addition, the OCaml version doesn&amp;rsquo;t need to (and &lt;em&gt;shouldn&amp;rsquo;t&lt;/em&gt;) be written
as one monolithic library.  Instead, pulling together a collection of
smaller, reusable libraries that present clear interfaces to each other
would make things much more maintainable. This would bring substantially
greater benefits to everyone and &lt;a href=&quot;https://opam.ocaml.org/&quot;&gt;OPAM&lt;/a&gt; can manage the dependencies. &lt;/p&gt;



&lt;h3&gt;Breaking down the problem&lt;/h3&gt;

&lt;p&gt;The first cut is somewhat straightforward as we have a piece that deals with
the consumption and manipulation of feeds and another that takes the result
and emits HTML. This is also how the original Planet is put together, with a
library called &lt;a href=&quot;https://pypi.python.org/pypi/feedparser/&quot;&gt;feedparser&lt;/a&gt; and another for templating pages.  &lt;/p&gt;

&lt;p&gt;For the feed-parsing aspect, I can break it down further by considering Atom
and RSS feeds separately and then even further by thinking about how to (1)
consume such feeds and (2) output them. Then there is the HTML component,
where it may be necessary to consider existing representations of HTML. These
are not new ideas and since I&amp;rsquo;m claiming that individual pieces might be
useful then it&amp;rsquo;s worth finding out which ones are already available.&lt;/p&gt;

&lt;h4&gt;Existing components&lt;/h4&gt;

&lt;p&gt;The easiest way to find existing libraries is via the
&lt;a href=&quot;http://opam.ocaml.org/packages&quot;&gt;OPAM package list&lt;/a&gt;. Some quick searches for &lt;code&gt;RSS&lt;/code&gt;, &lt;code&gt;XML&lt;/code&gt;, &lt;code&gt;HTML&lt;/code&gt;
and &lt;code&gt;net&lt;/code&gt; bring up a lot of packages. The most relevant of these seem to be
&lt;a href=&quot;https://opam.ocaml.org/packages/xmlm/xmlm.1.2.0/&quot;&gt;xmlm&lt;/a&gt;, &lt;a href=&quot;https://opam.ocaml.org/packages/ocamlrss/ocamlrss.2.2.2/&quot;&gt;ocamlrss&lt;/a&gt;, &lt;a href=&quot;https://opam.ocaml.org/packages/cow/cow.0.9.1/&quot;&gt;cow&lt;/a&gt; and maybe &lt;a href=&quot;http://opam.ocaml.org/packages/xmldiff/xmldiff.0.1/&quot;&gt;xmldiff&lt;/a&gt;. I noticed that
nothing appears, when searching for &lt;code&gt;Atom&lt;/code&gt;, but I do know that &lt;code&gt;cow&lt;/code&gt; has an
Atom module for creating feeds. In terms of turning feeds into pages and
HTML, I&amp;rsquo;m aware of &lt;a href=&quot;https://github.com/ocaml/ocaml.org/blob/master/script/rss2html.ml&quot;&gt;rss2html&lt;/a&gt; used on the &lt;a href=&quot;http://ocaml.org&quot;&gt;OCaml&lt;/a&gt; website and parts of
&lt;a href=&quot;http://opam.ocaml.org/packages/ocamlnet/ocamlnet.3.7.3/&quot;&gt;ocamlnet&lt;/a&gt; that may be relevant (e.g &lt;code&gt;nethtml&lt;/code&gt; and &lt;code&gt;netstring&lt;/code&gt;) as well as
&lt;code&gt;cow&lt;/code&gt;.  There is likely to be other code I&amp;rsquo;m missing but this is useful as a
first pass. &lt;/p&gt;

&lt;p&gt;Overall, a number of components are already out there but it&amp;rsquo;s not obvious
if they&amp;rsquo;re compatible (e.g html) and there are still gaps (e.g atom). Since
I also want to minimise dependencies, I&amp;rsquo;ll try and use whatever works but
may ultimately have to roll my own. Either way, I can learn from what
already exists. Perhaps I&amp;rsquo;m being overconfident but if I can break things
down sensibly and keep the scope constrained then this should be an
achievable project. &lt;/p&gt;

&lt;h3&gt;The first (baby) steps - an Atom parser&lt;/h3&gt;

&lt;p&gt;As this is an exercise for me to learn OCaml by solving a problem, I need to
break it down into bite-size pieces and take each one at a time. Practically
speaking, this means limiting the scope to be as narrow as possible while
still producing a useful result &lt;em&gt;for me&lt;/em&gt;.  That last part is important as I
have specific needs and it&amp;rsquo;s likely that the first thing I make won&amp;rsquo;t be
particularly interesting for many others. &lt;/p&gt;

&lt;p&gt;For my specific use-case, I&amp;rsquo;m only interested in dealing with Atom feeds as
that&amp;rsquo;s what I use on my site and others I&amp;rsquo;m involved with. Initial feedback
is that creating an Atom parser will be the bulk of the work and I should
start by defining the types. To keep this manageable, I&amp;rsquo;m only going to deal
with my own feeds instead of attempting a fully compliant parser (in other
words, I&amp;rsquo;ll only consider the subset of &lt;a href=&quot;https://tools.ietf.org/html/rfc4287&quot;&gt;RFC4287&lt;/a&gt; that&amp;rsquo;s relevant to me).
Once I can parse, merge and write such feeds I should be able to iterate
from there. &lt;/p&gt;

&lt;p&gt;To make my requirements more concrete:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Only consider &lt;em&gt;my own&lt;/em&gt; Atom feeds for now&lt;/li&gt;
  &lt;li&gt;Initially, be able to parse and emit just one Atom feed&lt;/li&gt;
  &lt;li&gt;Then be able to merge 2+ feeds, specifically:
    &lt;ul&gt;
      &lt;li&gt;Use tag-based feeds from my personal site as starting points&lt;/li&gt;
      &lt;li&gt;Be able to de-dupe content&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;No database or storage (construct it afresh every time)&lt;/li&gt;
  &lt;li&gt;Minimise library dependencies&lt;/li&gt;
&lt;/ul&gt;



&lt;h4&gt;Timeframes and workflow&lt;/h4&gt;

&lt;p&gt;I&amp;rsquo;ve honestly no idea how long this might take and I&amp;rsquo;m treating it as a
side-project. I know there are many people out there who could produce a
working version of everything in a week or two but I&amp;rsquo;m not one of them (yet).
There are also &lt;em&gt;a lot&lt;/em&gt; of ancillary things I need to learn on the way, like
packaging, improving my knowledge of Git and dealing with build systems. If
I had to put a vague time frame on this, I&amp;rsquo;d be thinking in months rather
than weeks.  It might even be the case that others start work on parts of
this and ship things sooner but that&amp;rsquo;s great as I&amp;rsquo;ll probably be able to use
whatever they create and move further along the chain.&lt;/p&gt;

&lt;p&gt;In terms of workflow, everything will be done in the open, warts and all, and
I expect to make embarrassing mistakes as I go. You can follow along on my
freshly created &lt;a href=&quot;https://github.com/amirmc/ocamlatom&quot;&gt;OCaml Atom&lt;/a&gt; repo, and I&amp;rsquo;ll be using the issue tracker as
the main way of dealing with bugs and features. Let the fun begin.&lt;/p&gt;



&lt;hr/&gt;

&lt;p&gt;&lt;em&gt;Acknowledgements:&lt;/em&gt; Thanks to &lt;a href=&quot;http://erratique.ch&quot;&gt;Daniel&lt;/a&gt;, &lt;a href=&quot;http://ashishagarwal.org&quot;&gt;Ashish&lt;/a&gt;, &lt;a href=&quot;https://github.com/Chris00&quot;&gt;Christophe&lt;/a&gt;,
&lt;a href=&quot;http://philippewang.info/&quot;&gt;Philippe&lt;/a&gt; and &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas&lt;/a&gt; for discussions on an earlier draft of this post
and providing feedback on my approach.&lt;/p&gt;



</content><id>http://amirchaudhry.com/writing-planet-in-pure-ocaml</id><title type="text">Writing Planet in pure OCaml</title><updated>2014-04-29T09:30:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2014/04/24/fifth-compiler-hacking-session" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;p&gt;It's time for the fifth Cambridge OCaml compiler-hacking session!  We'll be meeting in the &lt;a href=&quot;http://www.cl.cam.ac.uk/&quot;&gt;Computer Lab&lt;/a&gt; again next Tuesday evening.&lt;/p&gt;

&lt;p&gt;If you're planning to come along, it'd be helpful if you could &lt;a href=&quot;http://doodle.com/iapgw89dvmxhnb4e&quot;&gt;&lt;em&gt;indicate interest via Doodle&lt;/em&gt;&lt;/a&gt; and &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;&lt;em&gt;sign up to the mailing list&lt;/em&gt;&lt;/a&gt; to receive updates:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Where&lt;/em&gt;: Room &lt;a href=&quot;http://www.cl.cam.ac.uk/research/dtg/openroommap/static/?s=FW11&amp;amp;amp%3Blabels=1&quot;&gt;FW11&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/directions/&quot;&gt;Computer Laboratory, Madingley Road&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;When&lt;/em&gt;: 6pm, Tuesday 29th April&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Who&lt;/em&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;What&lt;/em&gt;: fixing bugs, implementing new features, learning about OCaml internals&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Wiki&lt;/em&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience (see also some &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;things we've worked on in previous sessions&lt;/a&gt;), but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll also be ordering pizza, so if you want to be counted for food you should aim to arrive by 6.30pm.&lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2014/04/24/fifth-compiler-hacking-session</id><title type="text">Fifth OCaml compiler hacking session</title><updated>2014-04-24T02:16:01+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://amirchaudhry.com/from-jekyll-to-unikernel-in-fifty-lines" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;p&gt;&lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage&lt;/a&gt; has reached a point where it&amp;rsquo;s possible to easily set up
end-to-end toolchains to build &lt;a href=&quot;http://queue.acm.org/detail.cfm?id=2566628&quot;&gt;unikernels&lt;/a&gt;! 
My first use-case is to be able to generate a unikernel which can serve my
personal static site but to do it with as much automation as possible. It
turns out this is possible with less than 50 lines of code.&lt;/p&gt;

&lt;p&gt;I use Jekyll and GitHub Pages at the moment so I wanted a workflow that&amp;rsquo;s as
easy to use, though I&amp;rsquo;m happy to spend some time up front to set up and
configure things.
The tools for achieving what I want are in good shape so
this post takes the example of a Jekyll site (i.e this one) and goes through
the steps to produce a unikernel on
&lt;a href=&quot;https://travis-ci.org&quot;&gt;Travis CI&lt;/a&gt; (a continuous integration service) which can later be
deployed.  Many of these instructions already exist in various forms but
they&amp;rsquo;re collated here to aid this use-case.  &lt;/p&gt;

&lt;p&gt;I will take you, dear reader, through the process and when we&amp;rsquo;re finished,
the workflow will be as follows:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;You&amp;rsquo;ll write your posts on your local machine as normal&lt;/li&gt;
  &lt;li&gt;A push to GitHub will trigger a unikernel build for each commit&lt;/li&gt;
  &lt;li&gt;The Xen unikernel will be pushed to a repo for deployment&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;To achieve this, we&amp;rsquo;ll first check that we can build a unikernel VM locally,
then we&amp;rsquo;ll set up a continuous integration service to automatically build
them for us and finally we&amp;rsquo;ll adapt the CI service to also deploy the built
VM.  Although the amount of code required is small, each of these steps is
covered below in some detail.
For simplicity, I&amp;rsquo;ll assume you already have OCaml and Opam
installed &amp;ndash; if not, you can find out how via the
&lt;a href=&quot;http://realworldocaml.org/install&quot;&gt;Real Word OCaml install instructions&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;Building locally&lt;/h2&gt;

&lt;p&gt;To ensure that the build actually works, you should run things locally at
least once before pushing to Travis.  It&amp;rsquo;s worth noting that the
&lt;a href=&quot;https://github.com/mirage/mirage-skeleton&quot;&gt;mirage-skeleton&lt;/a&gt; repo contains a lot of useful, public domain examples
and helpfully, the specific code we need is in
&lt;a href=&quot;https://github.com/mirage/mirage-skeleton/tree/master/static_website&quot;&gt;mirage-skeleton/static_website&lt;/a&gt;.  Copy both the &lt;code&gt;config.ml&lt;/code&gt;
and &lt;code&gt;dispatch.ml&lt;/code&gt; files from that folder into a new &lt;code&gt;_mirage&lt;/code&gt; folder in your
jekyll repository.&lt;/p&gt;

&lt;p&gt;Edit &lt;code&gt;config.ml&lt;/code&gt; so that the two mentions of &lt;code&gt;./htdocs&lt;/code&gt; are replaced with
&lt;code&gt;../_site&lt;/code&gt;.  This is the only change you&amp;rsquo;ll need to make and you should now
be able to build the unikernel with the unix backend.  Make sure you have
the mirage package installed by running &lt;code&gt;$ opam install mirage&lt;/code&gt; and then run:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(edit: If you already have &lt;code&gt;mirage&lt;/code&gt;, remember to &lt;code&gt;opam update&lt;/code&gt; to make sure you&amp;rsquo;ve got the latest packages.)&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;_mirage
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mirage configure --unix
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make depend         &lt;span class=&quot;c&quot;&gt;# needed as of mirage 1.2 onward&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mirage build
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ..&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;That&amp;rsquo;s all it takes!  In a few minutes there will be a unikernel built on
your system (symlinked as &lt;code&gt;_mirage/mir-www&lt;/code&gt;).  If there are any errors, make
sure that Opam is up to date and that you have the latest version of the
static_website files from &lt;a href=&quot;https://github.com/mirage/mirage-skeleton&quot;&gt;mirage-skeleton&lt;/a&gt;. &lt;/p&gt;

&lt;h3&gt;Serving the site locally&lt;/h3&gt;

&lt;p&gt;If you&amp;rsquo;d like to see this site locally, you can do so from within the
&lt;code&gt;_mirage&lt;/code&gt; folder by running unikernel you just built.  There&amp;rsquo;s more
information about the details of this on the &lt;a href=&quot;http://openmirage.org/wiki/mirage-www&quot;&gt;Mirage docs site&lt;/a&gt;
but the quick instructions are:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;_mirage
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo mirage run

&lt;span class=&quot;c&quot;&gt;# in another terminal window&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo ifconfig tap0 10.0.0.1 255.255.255.0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You can now point your browser at http://10.0.0.2/ and see your site!
Once you&amp;rsquo;re finished browsing, &lt;code&gt;$ mirage clean&lt;/code&gt; will clear up all the
generated files. &lt;/p&gt;

&lt;p&gt;Since the build is working locally, we can set up a continuous integration
system to perform the builds for us.&lt;/p&gt;

&lt;h2&gt;Setting up Travis CI&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/jekyll-unikernel/travis.png&quot; style=&quot;float: right; margin-left: 10px&quot;/&gt;&amp;lt;/img&amp;gt;&lt;/p&gt;

&lt;p&gt;We&amp;rsquo;ll be using the &lt;a href=&quot;https://travis-ci.org&quot;&gt;Travis CI&lt;/a&gt; service, which is free for open-source
projects (so this assumes you&amp;rsquo;re using a public repo).  The benefit of using
Travis is that you can build a unikernel &lt;em&gt;without&lt;/em&gt; needing a local OCaml
environment, but it&amp;rsquo;s always quicker to debug things locally.&lt;/p&gt;

&lt;p&gt;Log in to Travis using your GitHub ID which will then trigger a scan of your
repositories.  When this is complete, go to your Travis accounts page and
find the repo you&amp;rsquo;ll be building the unikernel from.  Switch it &amp;lsquo;on&amp;rsquo; and
Travis will automatically set your GitHub post-commit hook and token for you.
That&amp;rsquo;s all you need to do on the website.&lt;/p&gt;

&lt;p&gt;When you next make a push to your repository, GitHub will inform Travis,
which will then look for a YAML file in the root of the repo called
&lt;code&gt;.travis.yml&lt;/code&gt;.  That file describes what Travis should do and what the build
matrix is.  Since OCaml is not one of the supported languages, we&amp;rsquo;ll be
writing our build script manually (this is actually easier than it sounds).
First, let&amp;rsquo;s set up the YAML file and then we&amp;rsquo;ll examine the build script.&lt;/p&gt;

&lt;h3&gt;The Travis YAML file - .travis.yml&lt;/h3&gt;

&lt;p&gt;The &lt;a href=&quot;http://docs.travis-ci.com/user/ci-environment/#CI-environment-OS&quot;&gt;Travis CI environment&lt;/a&gt; is based on Ubuntu 12.04, with a
number of things pre-installed (e.g Git, networking tools etc).  Travis
doesn&amp;rsquo;t support OCaml (yet) so we&amp;rsquo;ll use the &lt;code&gt;c&lt;/code&gt; environment to get the
packages we need, specifically, the OCaml compiler, Opam and Mirage. Once
those are set up, our build should run pretty much the same as it did locally.&lt;/p&gt;

&lt;p&gt;For now, let&amp;rsquo;s keep things simple and only focus on the latest releases
(OCaml 4.01.0 and Opam 1.1.1), which means our build matrix is very simple.
The build instructions will be in the file &lt;code&gt;_mirage/travis.sh&lt;/code&gt;, which we
will move to and trigger from the &lt;code&gt;.travis.yml&lt;/code&gt; file.  This means our YAML
file should look like:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;l-Scalar-Plain&quot;&gt;language&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;c&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;before_script&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;cd _mirage&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;bash -ex travis.sh&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;l-Scalar-Plain&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;MIRAGE_BACKEND=xen DEPLOY=0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;MIRAGE_BACKEND=unix&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The matrix enables us to have parallel builds for different environments and
this one is very simple as it&amp;rsquo;s only building two unikernels. One worker
will build for the Xen backend and another worker will build for the Unix
backend. The &lt;code&gt;_mirage/travis.sh&lt;/code&gt; script will clarify what each of these
environments translates to.  We&amp;rsquo;ll come back to the &lt;code&gt;DEPLOY&lt;/code&gt; flag later on
(it&amp;rsquo;s not necessary yet).  Now that this file is set up, we can work on the
build script itself.&lt;/p&gt;

&lt;h3&gt;The build script - travis.sh&lt;/h3&gt;

&lt;p&gt;To save time, we&amp;rsquo;ll be using an Ubuntu PPA to quickly get
&lt;a href=&quot;https://launchpad.net/~avsm&quot;&gt;pre-packaged versions of the OCaml compiler and Opam&lt;/a&gt;, so the
first thing to do is define which PPAs each line of the build matrix
corresponds to.  Since we&amp;rsquo;re keeping things simple, we only need one PPA
that has the most recent releases of OCaml and Opam.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml41+opam11
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;yes&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; sudo add-apt-repository ppa:&lt;span class=&quot;nv&quot;&gt;$ppa&lt;/span&gt;
sudo apt-get update -qq
sudo apt-get install -qq ocaml ocaml-native-compilers camlp4-extra opam&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;[NB: There are many &lt;a href=&quot;https://launchpad.net/~avsm&quot;&gt;other PPAs&lt;/a&gt; for different combinations of
OCaml/Opam which are useful for testing].  Once the appropriate PPAs have
been set up it&amp;rsquo;s time to initialise Opam and install Mirage. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OPAMYES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
opam init
opam install mirage
&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;opam config env&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We set &lt;code&gt;OPAMYES=1&lt;/code&gt; to get non-interactive use of Opam (it defaults to &amp;lsquo;yes&amp;rsquo;
for any user input) and if we want full build logs, we could also set
&lt;code&gt;OPAMVERBOSE=1&lt;/code&gt; (I haven&amp;rsquo;t in this example).
The rest should be straight-forward and you&amp;rsquo;ll end up with an
Ubuntu machine with OCaml, Opam and the Mirage package installed.  It&amp;rsquo;s now
trivial to do the next step of actually building the unikernel!&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;mirage configure --&lt;span class=&quot;nv&quot;&gt;$MIRAGE_BACKEND&lt;/span&gt;
mirage build&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You can see how we&amp;rsquo;ve used the environment variable from the Travis file and
this is where our two parallel builds begin to diverge.  When you&amp;rsquo;ve saved
this file, you&amp;rsquo;ll need to change permissions to make it executable by doing
&lt;code&gt;$ chmod +x _mirage/travis.sh&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;That&amp;rsquo;s all you need to build the unikernel on Travis!  You should now commit
both the YAML file and the build script to the repo and push the changes to
GitHub.  Travis should automatically start your first build and you can
watch the console output online to check that both the Xen and Unix backends
complete properly.  If you notice any errors, you should go back over your
build script and fix it before the next step.&lt;/p&gt;

&lt;h2&gt;Deploying your unikernel&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/jekyll-unikernel/octocat.png&quot; style=&quot;float: right; margin-left: 10px&quot;/&gt;&amp;lt;/img&amp;gt;&lt;/p&gt;

&lt;p&gt;When Travis has finished its builds it will simply destroy the worker and
all its contents, including the unikernels we just built.  This is perfectly
fine for testing but if we want to also &lt;em&gt;deploy&lt;/em&gt; a unikernel, we need to get
it out of the Travis worker after it&amp;rsquo;s built. In this case, we want to
extract the Xen-based unikernel so that we can later start it on a Xen-based
machine (e.g Amazon, Rackspace or - in our case - a machine on &lt;a href=&quot;http://www.bytemark.co.uk&quot;&gt;Bytemark&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Since the unikernel VMs are small (only tens of MB), our method for
exporting will be to commit the Xen unikernel into a repository on GitHub.
It can be retrieved and started later on and keeping the VMs in version
control gives us very effective snapshots (we can roll back the site without
having to rebuild).  This is something that would be much more challenging
if we were using the &amp;lsquo;standard&amp;rsquo; web toolstack.&lt;/p&gt;

&lt;p&gt;The deployment step is a little more complex as we have to send the
Travis worker a private SSH key, which will give it push access to a GitHub
repository.  Of course, we don&amp;rsquo;t want to expose that key by simply adding it
to the Travis file so we have to encrypt it somehow. &lt;/p&gt;

&lt;h3&gt;Sending Travis a private SSH key&lt;/h3&gt;

&lt;p&gt;Travis supports &lt;a href=&quot;http://docs.travis-ci.com/user/encryption-keys/&quot;&gt;encrypted environment variables&lt;/a&gt;. Each
repository has its own public key and the &lt;a href=&quot;http://rubygems.org/gems/travis&quot;&gt;Travis gem&lt;/a&gt; uses
this public key to encrypt data, which you then add to your &lt;code&gt;.travis.yml&lt;/code&gt;
file for decryption by the worker.  This is meant for sending things like
private API tokens and other small amounts of data. Trying to encrypt an SSH
key isn&amp;rsquo;t going to work as it&amp;rsquo;s too large.  Instead we&amp;rsquo;ll use
&lt;a href=&quot;https://github.com/avsm/travis-senv&quot;&gt;travis-senv&lt;/a&gt;, which encodes, encrypts and chunks up the key into smaller
pieces and then reassembles those pieces on the Travis worker.  We still use
the Travis gem to encrypt the pieces to add them to the &lt;code&gt;.travis.yml&lt;/code&gt; file.&lt;/p&gt;

&lt;p&gt;While you could give Travis a key that accesses your whole GitHub account, my
preference is to create a &lt;em&gt;new&lt;/em&gt; deploy key, which will only be used for
&lt;a href=&quot;https://help.github.com/articles/managing-deploy-keys#deploy-keys&quot;&gt;deployment to one repository&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# make a key pair on your local machine&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/.ssh/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen -t dsa -C &lt;span class=&quot;s2&quot;&gt;&amp;quot;travis.deploy&amp;quot;&lt;/span&gt; -f travis-deploy_dsa
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; -&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Note that this is a 1024 bit key so if you decide to use a 2048 bit key,
then be aware that Travis &lt;a href=&quot;https://github.com/avsm/travis-senv/issues/1&quot;&gt;sometimes has issues&lt;/a&gt;. Now that we have
a key, we can encrypt it and add it to the Travis file. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# on your local machine&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# install the necessary components&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gem install travis
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam install travis-senv

&lt;span class=&quot;c&quot;&gt;# chunk the key, add to yml file and rm the intermediate&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;travis-senv encrypt ~/.ssh/travis-deploy_dsa _travis_env
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat _travis_env &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; travis encrypt -ps --add
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rm _travis_env&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;travis-senv&lt;/code&gt; encrypts and chunks the key locally on your machine, placing
its output in a file you decide (&lt;code&gt;_travis_env&lt;/code&gt;).  We then take that output
file and pipe it to the &lt;code&gt;travis&lt;/code&gt; ruby gem, asking it to encrypt the input,
treating each line as separate and to be appended (&lt;code&gt;-ps&lt;/code&gt;) and then actually
adding that to the Travis file (&lt;code&gt;--add&lt;/code&gt;).  You can run &lt;code&gt;$ travis encrypt -h&lt;/code&gt;
to understand these options.  Once you&amp;rsquo;ve run the above commands,
&lt;code&gt;.travis.yml&lt;/code&gt; will look as follows.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;l-Scalar-Plain&quot;&gt;language&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;c&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;before_script&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;cd _mirage&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;bash -ex travis.sh&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;l-Scalar-Plain&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;MIRAGE_BACKEND=xen DEPLOY=0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;MIRAGE_BACKEND=unix&lt;/span&gt;
  &lt;span class=&quot;l-Scalar-Plain&quot;&gt;global&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;secure&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;....&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;encrypted&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;....&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;secure&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;....&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;encrypted&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;....&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;secure&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;....&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;encrypted&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;....&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;l-Scalar-Plain&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The number of secure variables added depends on the type and size of the key
you had to chunk, so it could vary from 8 up to 29. We&amp;rsquo;ll commit
these additions later on, alongside additions to the build script.&lt;/p&gt;

&lt;p&gt;At this point, we also need to make a repository on GitHub
and add the public deploy key so
that Travis can push to it.  Once you&amp;rsquo;ve created your repo and added a
README, follow GitHub&amp;rsquo;s instructions on &lt;a href=&quot;https://help.github.com/articles/managing-deploy-keys#deploy-keys&quot;&gt;adding deploy keys&lt;/a&gt;
and paste in the public key (i.e. the content of &lt;code&gt;travis-deploy_dsa.pub&lt;/code&gt;).  &lt;/p&gt;

&lt;p&gt;Now that we can securely pass a private SSH key to the worker
and have a repo that the worker can push to, we need to
make additions to the build script.&lt;/p&gt;

&lt;h3&gt;Committing the unikernel to a repository&lt;/h3&gt;

&lt;p&gt;Since we can set &lt;code&gt;DEPLOY=1&lt;/code&gt; in the YAML file we only need to make
additions to the build script.  Specifically, we want to assure that: only
the Xen backend is deployed; only &lt;em&gt;pushes&lt;/em&gt; to the repo result in
deployments, not pull requests (we do still want &lt;em&gt;builds&lt;/em&gt; for pull requests).&lt;/p&gt;

&lt;p&gt;In the build script (&lt;code&gt;_mirage/travis.sh&lt;/code&gt;), which is being run by the worker,
we&amp;rsquo;ll have to reconstruct the SSH key and configure Git.  In addition,
Travis gives us a set of useful &lt;a href=&quot;http://docs.travis-ci.com/user/ci-environment/#Environment-variables&quot;&gt;environment variables&lt;/a&gt; so we&amp;rsquo;ll
use the latest commit hash (&lt;code&gt;$TRAVIS_COMMIT&lt;/code&gt;) to name the the VM (which also
helps us trace which commit it was built from).&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s easier to consider this section of code at once so I&amp;rsquo;ve explained the
details in the comments. This section is what you need to add at the end of
your existing build script (i.e straight after &lt;code&gt;mirage build&lt;/code&gt;).&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Only deploy if the following conditions are met.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$MIRAGE_BACKEND&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;xen&amp;quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
            -a &lt;span class=&quot;s2&quot;&gt;&amp;quot;$DEPLOY&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
            -a &lt;span class=&quot;s2&quot;&gt;&amp;quot;$TRAVIS_PULL_REQUEST&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;false&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# The Travis worker will already have access to the chunks&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# passed in via the yaml file. Now we need to reconstruct &lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# the GitHub SSH key from those and set up the config file.&lt;/span&gt;
    opam install travis-senv
    mkdir -p ~/.ssh
    travis-senv decrypt &amp;gt; ~/.ssh/id_dsa &lt;span class=&quot;c&quot;&gt;# This doesn't expose it&lt;/span&gt;
    chmod &lt;span class=&quot;m&quot;&gt;600&lt;/span&gt; ~/.ssh/id_dsa             &lt;span class=&quot;c&quot;&gt;# Owner can read and write&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Host some_user github.com&amp;quot;&lt;/span&gt;   &amp;gt;&amp;gt; ~/.ssh/config
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;  Hostname github.com&amp;quot;&lt;/span&gt;          &amp;gt;&amp;gt; ~/.ssh/config
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;  StrictHostKeyChecking no&amp;quot;&lt;/span&gt;     &amp;gt;&amp;gt; ~/.ssh/config
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;  CheckHostIP no&amp;quot;&lt;/span&gt;               &amp;gt;&amp;gt; ~/.ssh/config
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;  UserKnownHostsFile=/dev/null&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config

    &lt;span class=&quot;c&quot;&gt;# Configure the worker's git details&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# otherwise git actions will fail.&lt;/span&gt;
    git config --global user.email &lt;span class=&quot;s2&quot;&gt;&amp;quot;user@example.com&amp;quot;&lt;/span&gt;
    git config --global user.name &lt;span class=&quot;s2&quot;&gt;&amp;quot;Travis Build Bot&amp;quot;&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Do the actual work for deployment.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Clone the deployment repo. Notice the user,&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# which is the same as in the ~/.ssh/config file.&lt;/span&gt;
    git clone git@some_user:amirmc/www-test-deploy
    &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;www-test-deploy

    &lt;span class=&quot;c&quot;&gt;# Make a folder named for the commit. &lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# If we're rebuiling a VM from a previous&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# commit, then we need to clear the old one.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Then copy in both the config file and VM.&lt;/span&gt;
    rm -rf &lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;
    mkdir -p &lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;
    cp ../mir-www.xen ../config.ml &lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Compress the VM and add a text file to note&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# the commit of the most recently built VM.&lt;/span&gt;
    bzip2 -9 &lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;/mir-www.xen
    git pull --rebase
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt; &amp;gt; latest    &lt;span class=&quot;c&quot;&gt;# update ref to most recent&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# Add, commit and push the changes!&lt;/span&gt;
    git add &lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt; latest
    git commit -m &lt;span class=&quot;s2&quot;&gt;&amp;quot;adding $TRAVIS_COMMIT built for $MIRAGE_BACKEND&amp;quot;&lt;/span&gt;
    git push origin master
    &lt;span class=&quot;c&quot;&gt;# Go out and enjoy the Sun!&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;At this point you should commit the changes to &lt;code&gt;./travis.yml&lt;/code&gt; (don&amp;rsquo;t forget
the deploy flag) and &lt;code&gt;_mirage/travis.sh&lt;/code&gt; and push the changes to GitHub.
Everything else will take place automatically and in a few minutes you will
have a unikernel ready to deploy on top of Xen! &lt;/p&gt;

&lt;p&gt;You can see both the complete YAML file and build script in use on my
&lt;a href=&quot;https://github.com/amirmc/www-test&quot;&gt;test repo&lt;/a&gt;, as well as the &lt;a href=&quot;https://travis-ci.org/amirmc/www-test&quot;&gt;build logs&lt;/a&gt; for that repo
and the &lt;a href=&quot;https://github.com/amirmc/www-test-deploy&quot;&gt;deploy repo&lt;/a&gt; with a VM.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;[Pro-tip: If you add *&lt;code&gt;[skip ci]&lt;/code&gt;&lt;/em&gt; anywhere in your
commit message, Travis will skip the build for that commit.
This is very useful if you&amp;rsquo;re making minor changes, like updating a
README.]*&lt;/p&gt;

&lt;h2&gt;Finishing up&lt;/h2&gt;

&lt;p&gt;Since I&amp;rsquo;m still using Jekyll for my website, I made a short script in my
jekyll repository (&lt;code&gt;_deploy-unikernel.sh&lt;/code&gt;) that builds the site, commits the
contents of &lt;code&gt;_site&lt;/code&gt; and pushes to GitHub. I simply run this after I&amp;rsquo;ve
committed a new blog post and the rest takes care of itself.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;
jekyll build
git add _site
git commit -m &lt;span class=&quot;s1&quot;&gt;'update _site'&lt;/span&gt;
git push origin master&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Congratulations! You now have an end-to-end workflow that will produce a
unikernel VM from your Jekyll-based site and push it to a repo.  If you
strip out all the comments, you&amp;rsquo;ll see that we&amp;rsquo;ve written less than 50 lines
of code! Admittedly, I&amp;rsquo;m not counting the 80 or so lines that came for free
in the &lt;code&gt;*.ml&lt;/code&gt; files but that&amp;rsquo;s still pretty impressive.&lt;/p&gt;

&lt;p&gt;Of course, we still need a machine to take that VM and run it but that&amp;rsquo;s a
topic for another post.  For the time-being, I&amp;rsquo;m still using GitHub Pages
but once the VM is hosted somewhere, I will:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Turn off GitHub Pages and serve from the VM &amp;ndash; but still using Jekyll in
the workflow.&lt;/li&gt;
  &lt;li&gt;Replace Jekyll with OCaml-based static-site generation.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Although all the tools already exist to switch now, I&amp;rsquo;m taking my time so
that I can easily maintain the code I end up using.&lt;/p&gt;

&lt;h2&gt;Expanding the script for testing&lt;/h2&gt;

&lt;p&gt;You may have noticed that the examples here are not very flexible or
extensible but that was a deliberate choice to keep them readable.  It&amp;rsquo;s
possible to do much more with the build matrix and script, as you can see
from the Travis files on my &lt;a href=&quot;https://github.com/amirmc/amirmc.github.com/tree/master/_mirage&quot;&gt;website repo&lt;/a&gt;, which were based on
those of the &lt;a href=&quot;https://github.com/mirage/mirage-www&quot;&gt;Mirage site&lt;/a&gt; and &lt;a href=&quot;https://github.com/mor1/mort-www&quot;&gt;Mort&amp;rsquo;s site&lt;/a&gt;.
Specifically, you can note the use of more environment variables and case
statements to decide which PPAs to grab.  Once you&amp;rsquo;ve got your builds
working, it&amp;rsquo;s worth improving your scripts to make them more maintainable
and cover the test cases you feel are important.&lt;/p&gt;

&lt;h3&gt;Not just for static sites (surprise!)&lt;/h3&gt;

&lt;p&gt;You might have noticed that in very few places in the toolchain above have I
mentioned anything specific to static sites per se.  The workflow is simply
(1) do some stuff locally, (2) push to a continuous integration service
which then (3) builds and deploys a Xen-based unikernel.  Apart from the
convenient folder structure, the specific work to treat this as a static
site lives in the &lt;code&gt;*.ml&lt;/code&gt; files, which I&amp;rsquo;ve skipped over for this post.  &lt;/p&gt;

&lt;p&gt;As such, the GitHub+Travis workflow we&amp;rsquo;ve developed here is quite general
and will apply to almost &lt;em&gt;any&lt;/em&gt; unikernels that we may want to construct.
I encourage you to explore the examples in the &lt;a href=&quot;https://github.com/mirage/mirage-skeleton&quot;&gt;mirage-skeleton&lt;/a&gt; repo and
keep your build script maintainable.  We&amp;rsquo;ll be using it again the next time
we build unikernel devices.&lt;/p&gt;

&lt;hr/&gt;

&lt;p&gt;&lt;em&gt;Acknowledgements:&lt;/em&gt; There were lots of things I read over while writing this
post but there were a few particularly useful things that you should look up.
Anil&amp;rsquo;s posts on &lt;a href=&quot;http://anil.recoil.org/2013/09/30/travis-and-ocaml.html&quot;&gt;Testing with Travis&lt;/a&gt; and
&lt;a href=&quot;http://anil.recoil.org/2013/10/06/travis-secure-ssh-integration.html&quot;&gt;Travis for secure deployments&lt;/a&gt; are quite succinct (and
were themselves prompted by &lt;a href=&quot;http://blog.mlin.net/2013/02/testing-ocaml-projects-on-travis-ci.html&quot;&gt;Mike Lin&amp;rsquo;s Travis post&lt;/a&gt; several
months earlier). Looking over Mort&amp;rsquo;s &lt;a href=&quot;https://github.com/mor1/mort-www/blob/master/.travis-build.sh&quot;&gt;build script&lt;/a&gt; and that of
&lt;a href=&quot;https://github.com/mirage/mirage-www/blob/master/.travis-ci.sh&quot;&gt;mirage-www&lt;/a&gt; helped me figure out the deployment steps as well as improve
my own script. Special thanks also to &lt;a href=&quot;http://erratique.ch&quot;&gt;Daniel&lt;/a&gt;, &lt;a href=&quot;http://www.lpw25.net&quot;&gt;Leo&lt;/a&gt; and &lt;a href=&quot;http://anil.recoil.org&quot;&gt;Anil&lt;/a&gt; for
commenting on an earlier draft of this post.&lt;/p&gt;

</content><id>http://amirchaudhry.com/from-jekyll-to-unikernel-in-fifty-lines</id><title type="text">From Jekyll site to Unikernel in fifty lines of code.</title><updated>2014-03-10T18:30:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://openmirage.org/blog/applying-for-gsoc2014" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;MirageOS will part of the &lt;a href=&quot;https://www.google-melange.com/gsoc/homepage/google/gsoc2014&quot;&gt;Google Summer of Code&lt;/a&gt; 2014
program, thanks to the Xen Project's participation!  It's been a few years
since I've mentored for GSoc, but I still have fond memories of some great
projects in the past (such as the legendary &lt;a href=&quot;http://vmgl.sourceforge.net/&quot;&gt;Quake testing&lt;/a&gt;
we were forced to do for hours on end).  I've already received a number of
queries about this year's program from potential students, so here's a few
things to note to become a successful applicant.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;Students still need to apply and be accepted. Your chances of being
 selected are much higher if you demonstrate some participation and
 code contributions (even minor) &lt;em&gt;before&lt;/em&gt; submitting an application.
 Thus, even if you don't have a copy of Xen around, roll up your sleeves
 and head over to the &lt;a href=&quot;http://openmirage.org/wiki/install&quot;&gt;installation instructions&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;Contributions do not have to be just code.  They can be documentation,
 help with packaging, wiki posts about a particular use, or test cases
 to improve code coverage.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;It's unlikely that we'll get students who are very familiar with both
 OCaml and Xen (if you are, definitely get in touch with us!).  You should
 therefore look over the &lt;a href=&quot;http://wiki.xen.org/wiki/GSoc_2014#Mirage_OS&quot;&gt;project ideas&lt;/a&gt;
 as a set of guidelines and not firm suggestions.  If you have a particular
 thing you'd like to do with Mirage (for example, work on the JavaScript
 backend, an &lt;a href=&quot;https://github.com/andrewray/iocamljs&quot;&gt;IPython interface&lt;/a&gt; or
 a particular protocol implementation such as XMPP, then that's fine.  Just
 get in touch with us on the &lt;a href=&quot;http://openmirage.org/community&quot;&gt;mailing lists&lt;/a&gt; or directly via
 e-mail, and we can work through them.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;Under some circumstances, we can provide resources such as a login to
 a Xen machine, or delegated credits on a cloud provider.  Don't let that
 stop you from applying for a project idea.  In general though, it's best
 to only depend on your own computer resources if practical to do so.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;
   </content><id>http://openmirage.org/blog/applying-for-gsoc2014</id><title type="text">MirageOS is in Google Summer of Code 2014</title><updated>2014-02-25T18:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://openmirage.org/blog/mirage-1.1-released" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;We've just released &lt;a href=&quot;https://github.com/ocaml/opam-repository/pull/1655&quot;&gt;Mirage 1.1.0&lt;/a&gt; into OPAM.  Once the
live site updates, you should be able to run &lt;code&gt;opam update -u&lt;/code&gt; and get the latest
version.  This release is the &amp;quot;&lt;a href=&quot;http://en.wikipedia.org/wiki/Eating_your_own_dog_food&quot;&gt;eat our own
dogfood&lt;/a&gt;&amp;quot; release; as I
mentioned earlier in January, a number of the Mirage developers have decided to
shift our own personal homepages onto Mirage.  There's nothing better than
using our own tools to find all the little annoyances and shortcomings, and so
Mirage 1.1.0 contains some significant usability and structural improvements
for building unikernels.&lt;/p&gt;
&lt;h4&gt;Functional combinators to build device drivers&lt;/h4&gt;

&lt;p&gt;Mirage separates the
application logic from the concrete backend in use by writing the application
as an &lt;a href=&quot;https://realworldocaml.org/v1/en/html/functors.html&quot;&gt;OCaml functor&lt;/a&gt;
that is parameterized over module types that represent the device driver
signature.  All of the module types used in Mirage can be browsed in &lt;a href=&quot;https://github.com/mirage/mirage/blob/1.1.0/types/V1.mli&quot;&gt;one
source file&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In Mirage 1.1.0, &lt;a href=&quot;http://gazagnaire.org/&quot;&gt;Thomas Gazagnaire&lt;/a&gt; implemented a
a &lt;a href=&quot;https://github.com/mirage/mirage/blob/1.1.0/lib/mirage.mli#L28&quot;&gt;combinator library&lt;/a&gt;
that makes it easy to separate the definition of application logic from the details
of the device drivers that actually execute the code (be it a Unix binary or a
dedicated Xen kernel).  It lets us write code of this form
(taken from &lt;a href=&quot;https://github.com/mirage/mirage-skeleton/tree/master/block&quot;&gt;mirage-skeleton/block&lt;/a&gt;):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;let () =
  let main = foreign &amp;quot;Unikernel.Block_test&amp;quot; (console @-&amp;gt; block @-&amp;gt; job) in
  let img = block_of_file &amp;quot;disk.img&amp;quot; in
  register &amp;quot;block_test&amp;quot; [main $ default_console $ img]&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In this configuration fragment, our unikernel is defined as a functor over a
console and a block device by using &lt;code&gt;console @-&amp;gt; block @-&amp;gt; job&lt;/code&gt;.  We then
define a concrete version of this job by applying the functor (using the &lt;code&gt;$&lt;/code&gt;
combinator) to a default console and a file-backed disk image.&lt;/p&gt;
&lt;p&gt;The combinator approach lets us express complex assemblies of device driver
graphs by writing normal OCaml code, and the &lt;code&gt;mirage&lt;/code&gt; command line tool
parses this at build-time and generates a &lt;code&gt;main.ml&lt;/code&gt; file that has all the
functors applied to the right device drivers. Any mismatches in module signatures
will result in a build error, thus helping to spot nonsensical combinations
(such as using a Unix network socket in a Xen unikernel).&lt;/p&gt;
&lt;p&gt;This new feature is walked through in the &lt;a href=&quot;http://openmirage.org/docs/hello-world&quot;&gt;tutorial&lt;/a&gt;, which
now walks you through several skeleton examples to explain all the different
deployment scenarios.  It's also followed by the &lt;a href=&quot;http://openmirage.org/docs/mirage-www&quot;&gt;website tutorial&lt;/a&gt;
that explains how this website works, and how our &lt;a href=&quot;http://openmirage.org/docs/deploying-via-ci&quot;&gt;Travis autodeployment&lt;/a&gt;
throws the result onto the public Internet.&lt;/p&gt;
&lt;p&gt;Who will win the race to get our website up and running first?  Sadly for Anil,
&lt;a href=&quot;http://www.cs.nott.ac.uk/~rmm/&quot;&gt;Mort&lt;/a&gt; is currently &lt;a href=&quot;https://github.com/mor1/mort-www&quot;&gt;in the
lead&lt;/a&gt; with an all-singing, all-dancing shiny
new website.  Will he finish in the lead though? Stay tuned!&lt;/p&gt;
&lt;h4&gt;Less magic in the build&lt;/h4&gt;

&lt;p&gt;Something that's more behind-the-scenes, but important for easier development,
is a simplication in how we build libraries.  In Mirage 1.0, we had several
packages that couldn't be simultaneously installed, as they had to be compiled 
in just the right order to ensure dependencies.&lt;/p&gt;
&lt;p&gt;With Mirage 1.1.0, this is all a thing of the past.  All the libraries can
be installed fully in parallel, including the network stack.  The 1.1.0
&lt;a href=&quot;https://github.com/mirage/mirage-tcpip&quot;&gt;TCP/IP stack&lt;/a&gt; is now built in the
style of the venerable &lt;a href=&quot;http://www.cs.cmu.edu/~fox/foxnet.html&quot;&gt;FoxNet&lt;/a&gt; network
stack, and is parameterized across its network dependencies.  This means
that once can quickly assemble a custom network stack from modular components,
such as this little fragment below from &lt;a href=&quot;https://github.com/mirage/mirage-skeleton/blob/master/ethifv4/unikernel.ml&quot;&gt;mirage-skeleton/ethifv4/&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;module Main (C: CONSOLE) (N: NETWORK) = struct

  module E = Ethif.Make(N)
  module I = Ipv4.Make(E)
  module U = Udpv4.Make(I)
  module T = Tcpv4.Flow.Make(I)(OS.Time)(Clock)(Random)
  module D = Dhcp_clientv4.Make(C)(OS.Time)(Random)(E)(I)(U)
  &lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This functor stack starts with a &lt;code&gt;NETWORK&lt;/code&gt; (i.e. Ethernet) device, and then applies
functors until it ends up with a UDPv4, TCPv4 and DHCPv4 client.  See the &lt;a href=&quot;https://github.com/mirage/mirage-skeleton/blob/master/ethifv4/unikernel.ml&quot;&gt;full
file&lt;/a&gt;
to see how the rest of the logic works, but this serves to illustrate how
Mirage makes it possible to build custom network stacks out of modular
components.  The functors also make it easier to embed the network stack in
non-Mirage applications, and the &lt;code&gt;tcpip&lt;/code&gt; OPAM package installs pre-applied Unix
versions for your toplevel convenience.&lt;/p&gt;
&lt;p&gt;To show just how powerful the functor approach is, the same stack can also
be mapped onto a version that uses kernel sockets simply by abstracting the
lower-level components into an equivalent that uses the Unix kernel to provide
the same functionality.  We explain how to swap between these variants in
the &lt;a href=&quot;http://openmirage.org/wiki/hello-world&quot;&gt;tutorials&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Lots of library releases&lt;/h4&gt;

&lt;p&gt;While doing the 1.1.0 release in January, we've also released quite a few libraries
into &lt;a href=&quot;https://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt;.  Here are some of the highlights.&lt;/p&gt;
&lt;p&gt;Low-level libraries:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/samoht/ocaml-mstruct/&quot;&gt;mstruct&lt;/a&gt; is a streaming layer for handling lists of memory buffers with a simpler read/write interface.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/xapi-project/nbd/&quot;&gt;nbd&lt;/a&gt; is an implementation of the &lt;a href=&quot;http://en.wikipedia.org/wiki/Network_block_device&quot;&gt;Network Block Device&lt;/a&gt; protocol for block drivers.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;Networking and web libraries:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-ipaddr&quot;&gt;ipaddr&lt;/a&gt; now has IPv6 parsing support thanks to &lt;a href=&quot;https://github.com/hhugo/&quot;&gt;Hugo Heuzard&lt;/a&gt; and David Sheets.  This is probably the hardest bit of adding IPv6 support to our network stack!&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/cowabloga&quot;&gt;cowabloga&lt;/a&gt; is slowly emerging as a library to handle the details of rendering Zurb Foundation websites.  It's still in active development, but being used for a few of our &lt;a href=&quot;https://github.com/mor1/mort-www&quot;&gt;personal websites&lt;/a&gt; as well as this website.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/avsm/ocaml-cohttp&quot;&gt;cohttp&lt;/a&gt; has had several releases thanks to external contributions, particular from &lt;a href=&quot;https://github.com/rgrinberg&quot;&gt;Rudy Grinberg&lt;/a&gt; who added s-expression support and several &lt;a href=&quot;https://github.com/avsm/ocaml-cohttp/blob/master/CHANGES&quot;&gt;other improvements&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/avsm/ocaml-uri&quot;&gt;uri&lt;/a&gt; features performance improvements and the elimination of Scanf (considered &lt;a href=&quot;http://www.lexifi.com/blog/note-about-performance-printf-and-format&quot;&gt;rather slow&lt;/a&gt; by OCaml standards).&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-cow&quot;&gt;cow&lt;/a&gt; continues its impossible push to make coding HTML and CSS a pleasant experience, with better support for Markdown now.&lt;/li&gt;&lt;li&gt;The &lt;a href=&quot;https://github.com/avsm/ocaml-github&quot;&gt;github&lt;/a&gt; bindings are now also in use as part of an experiment to make &lt;a href=&quot;http://gallium.inria.fr/blog/patch-review-on-github/&quot;&gt;upstream OCaml development&lt;/a&gt; easier for newcomers, thanks to Gabriel Scherer.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; led the splitting up of several low-level Xen libraries as part of the build simplication.  These now compile on both Xen (using the direct hypercall interface) and Unix (using the dom0 &lt;code&gt;/dev&lt;/code&gt; devices) where possible.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/xapi-project/ocaml-evtchn&quot;&gt;xen-evtchn&lt;/a&gt; for the event notification mechanism. There are a couple of wiki posts that explain how &lt;a href=&quot;http://openmirage.org/wiki/xen-events&quot;&gt;event channels&lt;/a&gt; and &lt;a href=&quot;http://openmirage.org/wiki/xen-suspend&quot;&gt;suspend/resume&lt;/a&gt; work in Mirage/Xen guests.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/xapi-project/ocaml-gnt&quot;&gt;xen-gnt&lt;/a&gt; for the grant table mechanism that controls inter-process memory.&lt;/li&gt;&lt;li&gt;The &lt;a href=&quot;https://github.com/mirage/io-page&quot;&gt;io-page&lt;/a&gt; library no longer needs Unix and Xen variants, as the interface has been standardized to work in both.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;All of Dave's hacking on Xen device drivers is showcased in this &lt;a href=&quot;http://openmirage.org/wiki/xen-synthesize-virtual-disk&quot;&gt;xen-disk wiki post&lt;/a&gt; that 
explains how you can synthesize your own virtual disk backends using Mirage.  Xen uses a &lt;a href=&quot;https://www.usenix.org/legacy/event/usenix05/tech/general/full_papers/short_papers/warfield/warfield.pdf&quot;&gt;split device&lt;/a&gt; model,
and now Mirage lets us build &lt;em&gt;backend&lt;/em&gt; device drivers that service VMs as well as the frontends!&lt;/p&gt;
&lt;p&gt;Last, but not least, &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; has been building a brand new storage system for Mirage guests that uses git-style branches under the hood to help coordinate clusters of unikernels.  We'll talk about how this works in a future update, but there are some cool libraries and prototypes available on OPAM for the curious.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/samoht/ocaml-lazy-trie/&quot;&gt;lazy-trie&lt;/a&gt; is a lazy version of the Trie data structure, useful for exposing Git graphs.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/samoht/ocaml-git&quot;&gt;git&lt;/a&gt; is a now-fairly complete implementation of the Git protocol in pure OCaml, which can interoperate with normal Git servers via the &lt;code&gt;ogit&lt;/code&gt; command-line tool that it installs.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/irmin&quot;&gt;irmin&lt;/a&gt; is the main library that abstracts Git DAGs into an OCaml programming API.  The homepage has &lt;a href=&quot;https://github.com/mirage/irmin/wiki/Getting-Started&quot;&gt;instructions&lt;/a&gt; on how to play with the command-line frontend to experiment with the database.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/samoht/git2fat&quot;&gt;git2fat&lt;/a&gt; converts a Git checkout into a FAT block image, useful when bundling up unikernels.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;We'd also like to thank several conference organizers for giving us the opportunity to demonstrate Mirage.  The talk video from &lt;a href=&quot;http://www.infoq.com/presentations/mirage-os&quot;&gt;QCon SF&lt;/a&gt; is now live, and we also had a &lt;em&gt;great&lt;/em&gt; time at &lt;a href=&quot;http://fosdem.org&quot;&gt;FOSDEM&lt;/a&gt; recently (summarized by Amir &lt;a href=&quot;http://nymote.org/blog/2014/fosdem-summary/&quot;&gt;here&lt;/a&gt;). 
So lots of activities, and no doubt little bugs lurking in places (particularly around installation).  As always, please do let us know of any problem by &lt;a href=&quot;https://github.com/mirage/mirage/issues&quot;&gt;reporting bugs&lt;/a&gt;, or feel free to &lt;a href=&quot;http://openmirage.org/community&quot;&gt;contact us&lt;/a&gt; via our e-mail lists or IRC.  Next stop: our unikernel homepages!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/mirage-1.1-released</id><title type="text">Mirage 1.1.0: the eat-your-own-dogfood release</title><updated>2014-02-11T16:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2014/02/11/fourth-compiler-hacking-session" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;p&gt;It's time for the fourth Cambridge OCaml compiler-hacking session!  We'll be meeting in the &lt;a href=&quot;http://www.cl.cam.ac.uk/&quot;&gt;Computer Lab&lt;/a&gt; again next Tuesday evening.&lt;/p&gt;

&lt;p&gt;If you're planning to come along, it'd be helpful if you could &lt;a href=&quot;http://doodle.com/5tk8rs5k3mh82qqx&quot;&gt;&lt;em&gt;indicate interest via Doodle&lt;/em&gt;&lt;/a&gt; and &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;&lt;em&gt;sign up to the mailing list&lt;/em&gt;&lt;/a&gt; to receive updates:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Where&lt;/em&gt;: Room &lt;a href=&quot;http://www.cl.cam.ac.uk/research/dtg/openroommap/static/?s=FW11&amp;amp;amp%3Blabels=1&quot;&gt;FW11&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/directions/&quot;&gt;Computer Laboratory, Madingley Road&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;When&lt;/em&gt;: 6pm, Tuesday 18th February&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Who&lt;/em&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;What&lt;/em&gt;: fixing bugs, implementing new features, learning about OCaml internals&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Wiki&lt;/em&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience (see also some &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;things we've worked on in previous sessions&lt;/a&gt;), but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll also be ordering pizza, so if you want to be counted for food you should aim to arrive by 6.30pm.&lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2014/02/11/fourth-compiler-hacking-session</id><title type="text">Fourth OCaml compiler hacking session</title><updated>2014-02-11T12:10:29+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2014/02/04/handler-case" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;p&gt;(Update (2014-05-28): Added notes on &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/rss.xml#delimcc&quot;&gt;delimcc&lt;/a&gt; and &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/rss.xml#catch-me&quot;&gt;Catch me if you can&lt;/a&gt; to the &lt;em&gt;Discoveries&lt;/em&gt; section.)&lt;/p&gt;

&lt;p&gt;(Update (2014-05-05): The &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/rss.xml#match-exception&quot;&gt;&lt;code&gt;match/exception&lt;/code&gt;&lt;/a&gt; variant of this proposal has been &lt;a href=&quot;https://github.com/ocaml/ocaml/commit/0f1fb19cbe48918c5d070e475c39052875623a85&quot;&gt;merged into OCaml trunk&lt;/a&gt;, ready for release in 4.02.)&lt;/p&gt;

&lt;p&gt;(Update: there's a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6318&quot;&gt;Mantis issue open&lt;/a&gt; to discuss this proposal.)&lt;/p&gt;

&lt;p&gt;OCaml's &lt;code&gt;try&lt;/code&gt; construct is good at dealing with exceptions, but not so good at handling the case where no exception is raised.  This post describes a simple extension to &lt;code&gt;try&lt;/code&gt; that adds support for handling the &amp;quot;success&amp;quot; case.&lt;/p&gt;

&lt;p&gt;Here's an example of code that benefits from the extension.  On a recent &lt;a href=&quot;http://caml.inria.fr/resources/forums.en.html&quot;&gt;caml-list&lt;/a&gt; thread, &lt;a href=&quot;http://cedeela.fr/~simon/&quot;&gt;Simon Cruanes&lt;/a&gt; posted &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2014-01/msg00113.html&quot;&gt;the following function&lt;/a&gt; for iterating over a stream:&lt;/p&gt;

&lt;blockquote&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;

&lt;p&gt;For each element of a stream, &lt;code&gt;iter_stream&lt;/code&gt; wraps the element with &lt;code&gt;Some&lt;/code&gt;, then unwraps it again and passes it to &lt;code&gt;f&lt;/code&gt;.  At first glance, wrapping and immediately unwrapping in this way seems like needless obfuscation.  However, moving the last two lines out of the body of the &lt;code&gt;try&lt;/code&gt; in this way serves two essential purposes: it turns the recursive call to &lt;code&gt;iter_stream&lt;/code&gt; into a tail call, and it allows exceptions raised by &lt;code&gt;f&lt;/code&gt; to propagate.  More generally, this use of options makes it easy to specify the &lt;em&gt;success continuation&lt;/em&gt; of a &lt;code&gt;try&lt;/code&gt; expression, i.e. the piece of code that receives the value of the body when no exception is raised.&lt;/p&gt;

&lt;p&gt;As Simon notes, the &lt;code&gt;match (try Some ...)&lt;/code&gt; idiom is widely used in OCaml code.  Examples can be found in the source of &lt;a href=&quot;https://github.com/ocsigen/lwt/blob/b63b2a/src/unix/lwt_unix.ml#L118-L125&quot;&gt;lwt&lt;/a&gt;, &lt;a href=&quot;https://github.com/ocaml-batteries-team/batteries-included/blob/92ea390c/benchsuite/bench_nreplace.ml#L45-L48&quot;&gt;batteries&lt;/a&gt;, &lt;a href=&quot;https://github.com/savonet/liquidsoap/blob/a81cd8b6/src/decoder/metadata_decoder.ml#L53-L55&quot;&gt;liquidsoap&lt;/a&gt;, &lt;a href=&quot;https://github.com/janestreet/sexplib/blob/f9bd413/lib/conv.ml#L256-L259&quot;&gt;sexplib&lt;/a&gt;, &lt;a href=&quot;https://github.com/MLstate/opalang/blob/0802728/compiler/opalang/opaParser.ml#L127-L135&quot;&gt;opa&lt;/a&gt;, &lt;a href=&quot;https://github.com/avsm/ocaml-uri/blob/35af64db/lib/uri.ml#L250-L255&quot;&gt;uri&lt;/a&gt;, &lt;a href=&quot;https://github.com/coq/coq/blob/724c9c9f/tools/coqdoc/tokens.ml#L36-L41&quot;&gt;coq&lt;/a&gt;, &lt;a href=&quot;https://github.com/pascal-bach/Unison/blob/4788644/src/ubase/prefs.ml#L97-L106&quot;&gt;unison&lt;/a&gt;, and many other packages.  &lt;/p&gt;

&lt;p&gt;In response to Simon's message, &lt;a href=&quot;http://okmij.org/ftp&quot;&gt;Oleg&lt;/a&gt; pointed out &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2014-01/msg00146.html&quot;&gt;a solution&lt;/a&gt;: the 2001 paper &lt;a href=&quot;http://research.microsoft.com/~akenn/sml/exceptionalsyntax.pdf&quot;&gt;Exceptional Syntax&lt;/a&gt;  (&lt;a href=&quot;http://research.microsoft.com/~nick/&quot;&gt;Benton&lt;/a&gt; and &lt;a href=&quot;http://research.microsoft.com/~akenn/&quot;&gt;Kennedy&lt;/a&gt;) extends &lt;code&gt;try&lt;/code&gt; with a &lt;code&gt;let&lt;/code&gt;-like binding construct that supports the success continuation idiom directly without the need for the option value.&lt;/p&gt;



&lt;p&gt;This post describes a patch to OCaml that implements a variant of Benton and Kennedy's design called &lt;em&gt;handler case&lt;/em&gt;.  Like Exceptional Syntax, handler case extends &lt;code&gt;try&lt;/code&gt; with explicit success continuation handling.  However, unlike Exceptional syntax, handler case uses &lt;code&gt;match&lt;/code&gt; binding for both the success continuation and the exception-handling clauses.  Here's the extended &lt;code&gt;try&lt;/code&gt; syntax:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1'&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As in &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/expr.html#@manual.kwd50&quot;&gt;current OCaml&lt;/a&gt;, the clauses &lt;code&gt;pattern_1 -&amp;gt; expr_1&lt;/code&gt; ... &lt;code&gt;pattern_n -&amp;gt; expr_n&lt;/code&gt; handle exceptions raised during the evaluation of &lt;code&gt;expr&lt;/code&gt;.  The clauses  &lt;code&gt;val pattern_1' -&amp;gt; expr_1'&lt;/code&gt; ... &lt;code&gt;val pattern_n' -&amp;gt; expr_n'&lt;/code&gt; handle the case where no exception is raised; in this case the value of &lt;code&gt;expr&lt;/code&gt; is matched against &lt;code&gt;pattern_1'&lt;/code&gt; ... &lt;code&gt;pattern_n'&lt;/code&gt; to select the expression to evaluate to produce the result value.  (The actual syntax is implemented slightly more permissively: it allows value-matching and exception-matching clauses to be freely interleaved.)&lt;/p&gt;

&lt;p&gt;Using handler case we can rewrite &lt;code&gt;iter_stream&lt;/code&gt; to remove the extraneous option value:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We don't need to look far to find other code that benefits from the new construct.  Here's a function from the &lt;a href=&quot;https://github.com/ocaml/ocaml/blob/6a296a02/otherlibs/num/big_int.ml#L323-L328&quot;&gt;Big_int&lt;/a&gt; module in the standard library: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_of_big_int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_of_nat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abs_value&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Failure&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq_big_int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monster_big_int&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monster_int&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;failwith&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;int_of_big_int&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The core of the function --- the call to &lt;code&gt;int_of_nat&lt;/code&gt; --- is rather buried in the complex control flow.  There are two &lt;code&gt;if&lt;/code&gt;-&lt;code&gt;then&lt;/code&gt;-&lt;code&gt;else&lt;/code&gt; constructs, a &lt;code&gt;let&lt;/code&gt; binding, and a &lt;code&gt;try&lt;/code&gt; expression with a complex body.  Using handler case we can disentangle the code to make the four possible outcomes from the call to &lt;code&gt;int_of_nat&lt;/code&gt; explicit:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_of_big_int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_of_nat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abs_value&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Failure&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq_big_int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monster_big_int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;monster_int&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Failure&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;failwith&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;int_of_big_int&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here's a simpler example from &lt;a href=&quot;https://github.com/ocaml/ocaml/blob/6a296a02/stdlib/string.ml#L195&quot;&gt;the String module&lt;/a&gt;, which also involves code that cannot raise an exception in the body of a &lt;code&gt;try&lt;/code&gt; block:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ignore&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index_rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Not_found&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using handler case we can separate the code that may raise an exception (the call to &lt;code&gt;index_rec&lt;/code&gt;) from the expression that produces the result:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index_rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Not_found&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Trying it out&lt;/h3&gt;

&lt;p&gt;Using &lt;a href=&quot;http://opam.ocaml.org/&quot;&gt;opam&lt;/a&gt; you can install an OCaml compiler extended with handler case as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ opam remote add ocamllabs git@github.com:ocamllabs/opam-repo-dev.git
ocamllabs Fetching git@github.com:ocamllabs/opam-repo-dev.git
[...]
$ opam switch 4.02.0dev+handler-syntax
# To complete the configuration of OPAM, you need to run:
eval `opam config env`
$ eval `opam config env`
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;js&lt;em&gt;of&lt;/em&gt;ocaml&lt;/h4&gt;

&lt;p&gt;You can also try out the handler case construct in your browser, using the following modified version of &lt;a href=&quot;http://www.ocamlpro.com/&quot;&gt;OCamlPro&lt;/a&gt;'s &lt;a href=&quot;http://try.ocamlpro.com/&quot;&gt;Try OCaml&lt;/a&gt; application:&lt;/p&gt;

&lt;h3&gt;The discoveries of success continuations&lt;/h3&gt;

&lt;p&gt;As &lt;a href=&quot;http://homepages.inf.ed.ac.uk/wadler&quot;&gt;Philip Wadler&lt;/a&gt; &lt;a href=&quot;http://wadler.blogspot.co.uk/2008/02/great-minds-think-alike.html&quot;&gt;notes&lt;/a&gt;, constructs for handling success continuations have been independently discovered multiple times.  In fact, the history goes back even further than described in Wadler's blog; constructs like handler case date back over thirty years and have been introduced, apparently independently, into at least four languages.  Curiously, all the languages use &lt;code&gt;let&lt;/code&gt;-binding for success continuations and &lt;code&gt;match&lt;/code&gt; binding for failure continuations.&lt;/p&gt;

&lt;h4&gt;Lisp&lt;/h4&gt;

&lt;p&gt;In &lt;a href=&quot;http://www.lispworks.com/documentation/HyperSpec/Front/&quot;&gt;Common Lisp&lt;/a&gt; the construct analogous to &lt;code&gt;try&lt;/code&gt; is &lt;a href=&quot;http://clhs.lisp.se/Body/m_hand_1.htm&quot;&gt;&lt;code&gt;handler-case&lt;/code&gt;&lt;/a&gt; (from which the construct discussed here borrows its name).  A &lt;code&gt;handler-case&lt;/code&gt; expression has a body and a sequence of clauses which specify how various conditions (exceptions) should be handled.  The special condition specification &lt;code&gt;:no-error&lt;/code&gt; specifies the code to run when no condition is signalled.  The &lt;code&gt;iter_stream&lt;/code&gt; function might be written as follows in Common Lisp:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-common-lisp&quot; data-lang=&quot;common-lisp&quot;&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;defun&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;iter-stream&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;handler-case&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;get-stream&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;end-of-stream&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:no-error&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;|s'|&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;funcall&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;iter-stream&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;|s'|&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The Common Lisp specification was completed in 1994 but the &lt;code&gt;handler-case&lt;/code&gt; construct and its &lt;code&gt;:no-error&lt;/code&gt; clause were present in some of Common Lisp's progenitors.  The construct was apparently introduced to Symbolics Lisp some time around 1982: it appears in the &lt;a href=&quot;http://bitsavers.informatik.uni-stuttgart.de/pdf/mit/cadr/chinual_5thEd_Jan83/chinualJan83_27_Errors.pdf&quot;&gt;5th edition&lt;/a&gt; of the Lisp Machine manual (January 1983) but not the &lt;a href=&quot;http://bitsavers.trailing-edge.com/pdf/mit/cadr/chinual_4thEd_Jul81.pdf&quot;&gt;4th edition&lt;/a&gt; from 18 months earlier (July 1981).&lt;/p&gt;

&lt;h4&gt;Python&lt;/h4&gt;

&lt;p&gt;Python has supported success continuations in exception handlers since May 1994, when the &lt;code&gt;else&lt;/code&gt; clause was added to &lt;code&gt;try&lt;/code&gt; blocks.  The &lt;a href=&quot;http://hg.python.org/cpython/file/36214c861144/Grammar/Grammar#l9&quot;&gt;Changelog in old versions of the Grammar/Grammar file&lt;/a&gt; has an entry&lt;/p&gt;

&lt;blockquote&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;# 3-May-94:
#Added else clause to try-except
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;

&lt;p&gt;introduced in a &lt;a href=&quot;http://hg.python.org/cpython/rev/6c0e11b94009&quot;&gt;commit from August 1994&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;changeset:   1744:6c0e11b94009
branch:      legacy-trunk
user:        Guido van Rossum &amp;lt;guido@python.org&amp;gt;
date:        Mon Aug 01 11:00:20 1994 +0000
summary:     Bring alpha100 revision back to mainline
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;

&lt;p&gt;Unlike the &lt;code&gt;:no-error&lt;/code&gt; clause in Lisp's &lt;code&gt;handler-case&lt;/code&gt;, Python's &lt;code&gt;else&lt;/code&gt; clause doesn't bind variables.  Since Python variables have function scope, not block scope, bindings in the body of the try block are visible throughout the function.  In Python we might write &lt;code&gt;iter_stream&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;iter_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;End_of_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The provenance of the &lt;code&gt;else&lt;/code&gt; clause is unclear, but it doesn't seem to derive from Lisp's &lt;code&gt;handler-case&lt;/code&gt;.  The design of Python's exception handling constructs &lt;a href=&quot;http://docs.python.org/3/faq/general.html#why-was-python-created-in-the-first-place&quot;&gt;comes from Modula-3&lt;/a&gt;, but the exception handling construct described in the &lt;a href=&quot;http://www.hpl.hp.com/techreports/Compaq-DEC/SRC-RR-52.pdf&quot;&gt;Modula-3 report&lt;/a&gt; does not include a way of specifying the success continuation.  The syntax of the Modula-3 &lt;code&gt;TRY&lt;/code&gt;/&lt;code&gt;EXCEPT&lt;/code&gt; statement (found on p21 of the report) does include an &lt;code&gt;ELSE&lt;/code&gt; clause:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;   TRY    
     Body
   EXCEPT
     id1 (v1) =&amp;gt; Handler1
   | ...
   | idn (vn) =&amp;gt; Handlern
   ELSE Handler0
   END
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, whereas Python's &lt;code&gt;else&lt;/code&gt; handles the case where no exception is raised, Modula-3's &lt;code&gt;ELSE&lt;/code&gt; handles the case where an exception not named in one of the &lt;code&gt;EXCEPT&lt;/code&gt; clauses is raised: it is equivalent to Python's catch-all &lt;code&gt;except:&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Python also adds success handlers to other constructs.  Both the &lt;a href=&quot;http://docs.python.org/2/reference/compound_stmts.html#the-for-statement&quot;&gt;&lt;code&gt;for&lt;/code&gt;&lt;/a&gt; and the &lt;a href=&quot;http://docs.python.org/2/reference/compound_stmts.html#the-while-statement&quot;&gt;&lt;code&gt;while&lt;/code&gt;&lt;/a&gt; statements have an optional &lt;code&gt;else&lt;/code&gt; clause which is executed unless the loop terminates prematurely with an exception or &lt;code&gt;break&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;exceptional-syntax&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Exceptional Syntax&lt;/h4&gt;

&lt;p&gt;The 2001 paper &lt;a href=&quot;http://research.microsoft.com/~akenn/sml/exceptionalsyntax.pdf&quot;&gt;Exceptional Syntax&lt;/a&gt; (&lt;a href=&quot;http://research.microsoft.com/~nick/&quot;&gt;Benton&lt;/a&gt; and &lt;a href=&quot;http://research.microsoft.com/~akenn/&quot;&gt;Kennedy&lt;/a&gt;) proposed the following construct for handling exceptions in Standard ML:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;expr&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;unless&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pattern_1'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1'&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Evaluation of the &lt;code&gt;let&lt;/code&gt; binding proceeds as normal, except that if any of &lt;code&gt;expr_1&lt;/code&gt; to &lt;code&gt;expr_n&lt;/code&gt; raises an exception, control is transferred to the right hand side of the first of the clauses after &lt;code&gt;unless&lt;/code&gt; whose left hand side matches the exception.  The construct is largely similar to our proposed variation, except that the bindings used in the success continuation are based on &lt;code&gt;let&lt;/code&gt;, so scrutinising the values requires a separate &lt;code&gt;case&lt;/code&gt; (i.e. &lt;code&gt;match&lt;/code&gt;) expression.&lt;/p&gt;

&lt;p&gt;Using the Exceptional Syntax construct we might write &lt;code&gt;iter_stream&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Exceptional Syntax has been implemented in the SML-to-Java compiler &lt;a href=&quot;http://www.dcs.ed.ac.uk/home/mlj/&quot;&gt;MLj&lt;/a&gt;.&lt;/p&gt;

&lt;h4&gt;Erlang&lt;/h4&gt;

&lt;p&gt;The 2004 paper &lt;a href=&quot;http://erlang.se/workshop/2004/exception.pdf&quot;&gt;Erlang's Exception Handling Revisited&lt;/a&gt; (Richard Carlsson, Bj&amp;ouml;rn Gustavsson and Patrik Nyblom) proposed an exception-handling construct for Erlang along the same lines as exceptional syntax, although apparently developed independently.  In the proposed extension to Erlang we might write &lt;code&gt;iter_stream&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-erlang&quot; data-lang=&quot;erlang&quot;&gt;&lt;span class=&quot;nf&quot;&gt;iter_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Mystream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;S_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;S_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Eff&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://homepages.inf.ed.ac.uk/gdp/&quot;&gt;Plotkin&lt;/a&gt; and &lt;a href=&quot;http://matija.pretnar.info/&quot;&gt;Pretnar&lt;/a&gt;'s work on &lt;a href=&quot;http://matija.pretnar.info/pdf/handling-algebraic-effects.pdf&quot;&gt;handlers for algebraic effects&lt;/a&gt; generalises Exceptional Syntax to support effects other than exceptions.  The programming language &lt;a href=&quot;http://math.andrej.com/eff/&quot;&gt;eff&lt;/a&gt; implements a design based on this work, and supports Exceptional Syntax, again with &lt;code&gt;let&lt;/code&gt; binding for the success continuation.  (Although the success continuation is incorporated into the exception matching construct, only a single success continuation pattern is allowed.)  In eff we might write &lt;code&gt;iter_stream&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;handle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_stream_get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The second argument in the &lt;code&gt;end_of_stream&lt;/code&gt; clauses binds the continuation of the effect, allowing handling strategies other than the usual stack unwinding.  Since we ignore the continuation argument the behaviour is the same as for a regular exception handler.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://github.com/matijapretnar/eff/blob/2a9a36cc/src/parser.mly#L4-L7&quot;&gt;eff implementation&lt;/a&gt; uses the term &amp;quot;handler case&amp;quot; for the clauses of the &lt;code&gt;handle&lt;/code&gt; construct.&lt;/p&gt;

&lt;h4&gt;OCaml&lt;/h4&gt;

&lt;p&gt;Several OCaml programmers have proposed or implemented constructs related to handler case.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;delimcc&quot;&gt;&lt;/a&gt;
Oleg's &lt;a href=&quot;http://okmij.org/ftp/continuations/implementations.html&quot;&gt;delimcc&lt;/a&gt; library for delimited continuations provides the operations needed to support the success continuation style.  The programmer can use &lt;code&gt;push_prompt&lt;/code&gt; to establish a context, then call &lt;code&gt;shift&lt;/code&gt; or &lt;code&gt;shift0&lt;/code&gt; to return control to that context later, much as &lt;code&gt;try&lt;/code&gt; establishes a context to which &lt;code&gt;raise&lt;/code&gt; can transfer control.  If &lt;code&gt;shift&lt;/code&gt; is not called then control returns normally from the continuation argument to &lt;code&gt;push_prompt&lt;/code&gt;.  Using delimcc we might implement &lt;code&gt;iter_stream&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_prompt&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;push_prompt&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my_stream_get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;http://mjambon.com/&quot;&gt;Martin Jambon&lt;/a&gt; has &lt;a href=&quot;http://mjambon.com/mikmatch-manual.html#htoc16&quot;&gt;implemented&lt;/a&gt; a construct equivalent to Exceptional Syntax for OCaml as part of the &lt;a href=&quot;http://mjambon.com/micmatch.html&quot;&gt;micmatch extension&lt;/a&gt;.  His implementation allows us to write &lt;code&gt;iter_stream&lt;/code&gt; in much the same way as Benton and Kennedy's proposal:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_stream_get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The details of the implementation are discussed in &lt;a href=&quot;https://twitter.com/jakedonham&quot;&gt;Jake Donham&lt;/a&gt;'s &lt;a href=&quot;http://ambassadortothecomputers.blogspot.co.uk/2010/09/reading-camlp4-part-11-syntax.html&quot;&gt;articles on Camlp4&lt;/a&gt;.  The micmatch implementation has a novel feature: the &lt;code&gt;let&lt;/code&gt; binding associated with the success continuation may be made recursive.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://alain.frisch.fr/&quot;&gt;Alain Frisch&lt;/a&gt; has proposed and implemented a more powerful extension to OCaml, &lt;a href=&quot;http://www.lexifi.com/blog/static-exceptions&quot;&gt;Static Exceptions&lt;/a&gt;, which allow transfer of control to lexically-visible handlers (along the lines of Common Lisp's &lt;a href=&quot;http://clhs.lisp.se/Body/s_block.htm#block&quot;&gt;&lt;code&gt;block&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;http://clhs.lisp.se/Body/s_ret_fr.htm#return-from&quot;&gt;&lt;code&gt;return-from&lt;/code&gt;&lt;/a&gt;).  Static exceptions are based on an equivalent feature in OCaml's intermediate language.&lt;/p&gt;

&lt;p&gt;There is a straightforward translation from OCaml extended with handler case into OCaml extended with static exceptions by wrapping the body of each &lt;code&gt;try&lt;/code&gt; expression in &lt;code&gt;raise (`Val (...))&lt;/code&gt;, and changing the &lt;code&gt;val&lt;/code&gt; keyword in the binding section to &lt;code&gt;`Val&lt;/code&gt;.  For example, &lt;code&gt;iter_stream&lt;/code&gt; can be written using static exceptions as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(`&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Of course, static exceptions allow many other programs to be expressed that are not readily expressible using handler case.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;catch-me&quot;&gt;&lt;/a&gt;
In their 2008 paper &lt;a href=&quot;http://www.univ-orleans.fr/lifo/Members/David.Teller/publications/ml2008.pdf&quot;&gt;Catch me if you can: Towards type-safe, hierarchical, lightweight, polymorphic and efficient error management in OCaml&lt;/a&gt; David Teller Arnaud Spiwack and Till Varoquaux added an &lt;code&gt;attempt&lt;/code&gt; keyword to OCaml that extends &lt;code&gt;match&lt;/code&gt;-style pattern matching with both a single optional value case and an optional &lt;code&gt;finally&lt;/code&gt; clause.&lt;/p&gt;

&lt;p&gt;Finally, I discovered while writing this article that Christophe Raffalli proposed the handler case design fifteen years ago in a &lt;a href=&quot;http://caml.inria.fr/pub/ml-archives/caml-list/1999/12/a6d3ce9671b16a33530035c2b42df011.en.html&quot;&gt;message to caml-list&lt;/a&gt;!  Christophe's proposal wasn't picked up back then, but perhaps the time has now come to give OCaml programmers a way to handle success.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;match-exception&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;Postscript: a symmetric extension&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;try&lt;/code&gt; construct in current OCaml supports matching against raised exceptions but not against the value produced when no exception is raised.  Contrariwise, the &lt;code&gt;match&lt;/code&gt; construct supports matching against the value produced when no exception is raised, but does not support matching against raised exceptions.  As implemented, the patch addresses this asymmetry, extending &lt;code&gt;match&lt;/code&gt; with clauses that specify the &amp;quot;failure continuation&amp;quot;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1'&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;With this additional extension the choice between &lt;code&gt;match&lt;/code&gt; and &lt;code&gt;try&lt;/code&gt; becomes purely stylistic.  We might optimise for succinctness, and use &lt;code&gt;try&lt;/code&gt; in the case where exceptions are expected (for example, where they're used for control flow), reserving &lt;code&gt;match&lt;/code&gt; for the case where exceptions are truly exceptional.&lt;/p&gt;

&lt;p&gt;For the sake of completeness, here's &lt;code&gt;iter_stream&lt;/code&gt; written with the extended &lt;code&gt;match&lt;/code&gt; construct:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;exception&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Since both &lt;code&gt;val&lt;/code&gt; and &lt;code&gt;exception&lt;/code&gt; are existing keywords, the extensions to both &lt;code&gt;try&lt;/code&gt; and &lt;code&gt;match&lt;/code&gt; are fully backwards compatible. &lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2014/02/04/handler-case</id><title type="text">How to handle success</title><updated>2014-02-04T16:05:05+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://openmirage.org/blog/decks-n-drums" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;A few months ago, partly as a stunt, mostly because we could, Anil and I put together &lt;a href=&quot;http://decks.openmirage.org/oscon13/&quot;&gt;a presentation&lt;/a&gt; for &lt;a href=&quot;http://www.oscon.com/oscon2013/&quot;&gt;OSCON'13&lt;/a&gt; about Mirage in Mirage. That is, as a self-hosting Mirage web application that served up slides using &lt;a href=&quot;http://lab.hakim.se/reveal-js/&quot;&gt;RevealJS&lt;/a&gt;. It was a bit of a hack, but it was cool (we thought!) and it worked. Several more presentations were written and given this way, at venues ranging from the &lt;a href=&quot;http://www.youtube.com/watch?v=3Jype6sP6MQ&quot;&gt;XenSummit 2013&lt;/a&gt; to &lt;a href=&quot;https://www.usenix.org/conference/foci13%E2%80%8E&quot;&gt;ACM FOCI 2013&lt;/a&gt; to the Cambridge Computer Lab's &lt;a href=&quot;http://decks.openmirage.org/cam13/&quot;&gt;MSc in Advanced Computer Science&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;With the &lt;a href=&quot;http://openmirage.org/blog/releasing-mirage&quot;&gt;release of Mirage 1.0&lt;/a&gt;, &lt;a href=&quot;http://github.com/mirage/ocaml-cohttp&quot;&gt;CoHTTP&lt;/a&gt;, &lt;a href=&quot;http://github.com/mirage/cowabloga&quot;&gt;Cowabloga&lt;/a&gt; and
the new &lt;a href=&quot;http://foundation.zurb.com/&quot;&gt;Zurb Foundation&lt;/a&gt; based &lt;a href=&quot;http://openmirage.org/&quot;&gt;website&lt;/a&gt;, it was time to refresh them
and as a little seasonal gift, give them a shiny new index with some actual CSS
styling. So &lt;a href=&quot;http://decks.openmirage.org/&quot;&gt;here they are&lt;/a&gt;, a set of presentations that have been given
by various members of the Mirage team over the last 6 months or so. They cover
a range of topics, from general introductions to the Xen roadmap to more
detailed technical background. And, of course, as Mirage is under constant
rapid development, some of the older content may already be outdated. But &lt;a href=&quot;http://github.com/mirage/mirage-decks&quot;&gt;the
code for the site itself&lt;/a&gt; serves as another example of a simple --
somewhat simpler than the &lt;a href=&quot;http://openmirage.org/&quot;&gt;Mirage website&lt;/a&gt; in fact -- Mirage web
application.&lt;/p&gt;

   </content><id>http://openmirage.org/blog/decks-n-drums</id><title type="text">Presenting Decks</title><updated>2014-01-03T16:00:00+00:00</updated><author><email></email><name>Richard Mortier</name></author></entry><entry><link href="http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Dec%202013" rel="alternate"/><contributor><uri>http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml</uri><name>OCL Monthly News</name></contributor><content type="html">
      &lt;p&gt;This time last year in 2012, I had just
&lt;a href=&quot;http://anil.recoil.org/2012/10/19/announcing-ocaml-labs.html&quot;&gt;announced&lt;/a&gt; the
formation of a new group called &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/&quot;&gt;OCaml Labs&lt;/a&gt; in the
&lt;a href=&quot;http://www.cl.cam.ac.uk&quot;&gt;Cambridge Computer Lab&lt;/a&gt; that would combine research
and community work towards the practical application of functional programming.
An incredible year has absolutely flown by, and I've put together this post to
summarise what's gone on, and point to our future directions for 2014.&lt;/p&gt;
&lt;p&gt;The theme of our group was not to be pure research, but rather a hybrid group
that would take on some of the load of day-to-day OCaml maintenance from
&lt;a href=&quot;http://caml.inria.fr&quot;&gt;INRIA&lt;/a&gt;, as well as help grow the wider OCaml community.
To this end, all of our projects have been highly collaborative, often
involving colleagues from &lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt;,
&lt;a href=&quot;http://gallium.inria.fr/&quot;&gt;INRIA&lt;/a&gt;, &lt;a href=&quot;http://janestreet.com&quot;&gt;Jane Street&lt;/a&gt;,
&lt;a href=&quot;http://www.lexifi.com/&quot;&gt;Lexifi&lt;/a&gt; and &lt;a href=&quot;http://citrix.com&quot;&gt;Citrix&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This post covers progress in &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml#tooling&quot;&gt;tooling&lt;/a&gt;, the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml#core_compiler&quot;&gt;compiler and
language&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml#community_efforts&quot;&gt;community efforts&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml#research_projects&quot;&gt;research
projects&lt;/a&gt; and concludes with our &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml#priorities_for_2014&quot;&gt;priorities for
2014&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Tooling&lt;/h3&gt;

&lt;p&gt;At the start of 2013, OCaml was in the interesting position of being a mature
decades-old language with a small, loyal community of industrial users who built
mission critical applications using it.  We had the opportunity to sit down
with many of them at the &lt;a href=&quot;http://caml.inria.fr/consortium/&quot;&gt;OCaml Consortium&lt;/a&gt;
meeting and prioritise where we started work.  The answer came back clearly:
while the compiler itself is legendary for its stability, the tooling around it
(such as package management) was a pressing problem.&lt;/p&gt;
&lt;h4&gt;OPAM&lt;/h4&gt;

&lt;p&gt;Our solution to this tooling was centered around the
&lt;a href=&quot;http://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt; package manager that
&lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt; released into beta just at the end of 2012, and
had its first stable release in March 2013.  OPAM differs from most system
package managers by emphasising a flexible distributed workflow that uses
version constraints to ensure incompatible libraries aren't mixed up (important
for the statically-typed OCaml that is very careful about dependencies).
Working closely with &lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt; we developed a git-based
workflow to make it possible for users (both individual or industrial) to
easily build up their own package repositories and redistribute OCaml code, and
started curating the &lt;a href=&quot;https://github.com/ocaml/opam-repository&quot;&gt;package
repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The results have been satisfying: we started with an initial set of around 100 packages in
OPAM (mostly imported by the 4 developers), and ended 2013 with 587 unique packages and 2000 individual versions, with contributions from 160 individuals.  We now have a curated
&lt;a href=&quot;https://github.com/ocaml/opam-repository&quot;&gt;central package repository&lt;/a&gt; for anyone
to submit their OCaml code,
several third-party remotes are maintained (e.g. the &lt;a href=&quot;https://github.com/xapi-project/opam-repo-dev&quot;&gt;Xen Project&lt;/a&gt;
and &lt;a href=&quot;https://github.com/ocsigen/opam-ocsigen&quot;&gt;Ocsigen&lt;/a&gt;).  We also regularly
receive releases of the &lt;a href=&quot;http://ocaml.janestreet.com&quot;&gt;Core&lt;/a&gt; libraries
from Jane Street, and updates from sources as varied as &lt;a href=&quot;https://github.com/ocaml/opam-repository/pull/1300&quot;&gt;Facebook&lt;/a&gt;,
&lt;a href=&quot;http://anil.recoil.org/2013/09/16/camlpdf-the-end-of-sucky-pdf-tools.html&quot;&gt;Coherent PDF&lt;/a&gt;,
to the &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/guha.pdf&quot;&gt;Frenetic SDN&lt;/a&gt; research.&lt;/p&gt;
&lt;p&gt;A notable contribution from OCamlPro during this time was to
&lt;a href=&quot;https://github.com/ocaml/opam-repository/issues/955&quot;&gt;clarify&lt;/a&gt; the licensing on
the package repository to be the liberal
&lt;a href=&quot;http://creativecommons.org/choose/zero/&quot;&gt;CC0&lt;/a&gt;, and also to pass ownership to
the &lt;a href=&quot;http://github.com/ocaml&quot;&gt;OCaml&lt;/a&gt; organization on GitHub, where it's now
jointly maintained by OCaml Labs, OCamlPro and anyone else that wishes to
contribute.&lt;/p&gt;
&lt;h4&gt;A lens into global OCaml code&lt;/h4&gt;

&lt;p&gt;It's been quite interesting just watching all the varied code fly into the
repository, but stability quickly became a concern as the new packages piled
up.  OCaml compiles to native code on not just x86, but also PowerPC, Sparc and
&lt;a href=&quot;http://anil.recoil.org/2012/02/25/dreamplug-debian-and-ocaml.html&quot;&gt;ARM&lt;/a&gt; CPUs.
We kicked off various efforts into automated testing: firstly &lt;a href=&quot;https://github.com/dsheets&quot;&gt;David Sheets&lt;/a&gt;
built the
&lt;a href=&quot;http://anil.recoil.org/2013/09/09/ocamlot-autotriaging.html&quot;&gt;OCamlot&lt;/a&gt; daemon
that would schedule builds across all the exotic hardware. Later in the year,
the &lt;a href=&quot;http://travis-ci.org&quot;&gt;Travis&lt;/a&gt; service launched support for testing from GitHub pull requests,
and this became the front line of &lt;a href=&quot;http://anil.recoil.org/2013/09/30/travis-and-ocaml.html&quot;&gt;automated
checking&lt;/a&gt; for all
incoming new packages to OPAM.&lt;/p&gt;
&lt;p&gt;A major headache with automated testing is usually setting up the right build
environment with external library dependencies, and so we &lt;a href=&quot;http://anil.recoil.org/2013/11/15/docker-and-opam.html&quot;&gt;added Docker
support&lt;/a&gt; to make it
easier to bulk-build packages for local developer use, with the results of
builds available &lt;a href=&quot;https://github.com/avsm/opam-bulk-logs&quot;&gt;publically&lt;/a&gt; for
anyone to help triage.  Unfortunately fixing the bugs themselves is still a
&lt;a href=&quot;https://github.com/ocaml/opam-repository/issues/1304&quot;&gt;very manual process&lt;/a&gt;, so
more volunteers are always welcome to help out!&lt;/p&gt;
&lt;p&gt;We're going to be really seeing the rewards from all this effort as OCaml
4.02 development proceeds, since we can now adopt a data-driven approach
to changing language features instead of guessing how much third-party
code will break.  If your code is in OPAM, then it'll be tested as new
features such as &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6063&quot;&gt;module aliases&lt;/a&gt;,
&lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/garrigue.pdf&quot;&gt;injectivity&lt;/a&gt; and
&lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/white.pdf&quot;&gt;extension points&lt;/a&gt; show up.&lt;/p&gt;
&lt;h4&gt;Better documentation&lt;/h4&gt;

&lt;p&gt;The venerable
&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual029.html&quot;&gt;OCamlDoc&lt;/a&gt; tool
has done an admirable job for the last decade, but is increasingly showing its
age due to a lack of support for cross-referencing across packages.  We started
working on this problem in the summer when &lt;a href=&quot;https://github.com/vincent-botbol&quot;&gt;Vincent Botbol&lt;/a&gt;
visited us on an internship, expecting it to be a quick job to come up with
something as good as Haskell's excellent &lt;a href=&quot;http://www.haskell.org/haddock/&quot;&gt;Haddock&lt;/a&gt; online documentation.&lt;/p&gt;
&lt;p&gt;Instead, we ran into the &amp;quot;module wall&amp;quot;: since OCaml makes it so easy to
parameterise code over other modules, it makes it hard to generate static
documentation without outputting hundreds of megabytes of HTML every time.
After some hard work from Vincent and Leo, we've got a working prototype that
lets you simply run &lt;code&gt;opam install opam-doc &amp;amp;&amp;amp; opam doc core async&lt;/code&gt; to generate
package documentation.  You can see the results for
&lt;a href=&quot;http://mirage.github.io/&quot;&gt;Mirage&lt;/a&gt; online, but expect to see this integrated
into the main OCaml site for all OPAM packages as we work through polishing up
the user interface.&lt;/p&gt;
&lt;h4&gt;Turning OPAM into libraries&lt;/h4&gt;

&lt;p&gt;The other behind-the-scenes effort for OPAM has been to keep the core command-line
tool simple and stable, and to have it install OCaml libraries that can be
interfaced with by other tools to do domain-specific tasks.  &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt;,
&lt;a href=&quot;http://louis.gesbert.fr/cv.en.html&quot;&gt;Louis Gesbert&lt;/a&gt; and &lt;a href=&quot;https://github.com/dsheets&quot;&gt;David Sheets&lt;/a&gt; have been steadily hacking away at this and
we now have &lt;a href=&quot;https://github.com/ocamllabs/opamfu&quot;&gt;opamfu&lt;/a&gt; to run operations
over all packages, and an easy-to-template &lt;a href=&quot;https://github.com/ocaml/opam2web&quot;&gt;opam2web&lt;/a&gt;
that generates the live &lt;a href=&quot;http://opam.ocaml.org&quot;&gt;opam.ocaml.org&lt;/a&gt; website.&lt;/p&gt;
&lt;p&gt;This makes OPAM easier to deploy within other organizations that want to integrate
it into their workflow.  For example, the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/pkg/&quot;&gt;software
section&lt;/a&gt; of the OCaml Labs website is regularly
generated from a search of all OPAM packages tagged &lt;code&gt;ocamllabs&lt;/code&gt;.  We also used
it to rewrite the entire OPAM repository &lt;a href=&quot;https://github.com/ocaml/opam-repository/pull/1240&quot;&gt;in one epic diff&lt;/a&gt; to add external
library dependencies via a &lt;a href=&quot;https://github.com/ocaml/opam/pull/886/files&quot;&gt;command-line shim&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;OPAM-in-a-Box&lt;/h4&gt;

&lt;p&gt;All of this effort is geared towards making it easier to maintain reusable
local OPAM installations.  After several requests from big universities to help
out their teaching needs, we're putting together all the support needed to
easily redistribute OPAM packages via an
&amp;quot;&lt;a href=&quot;https://github.com/ocaml/opam/issues/1035&quot;&gt;OPAM-in-a-Box&lt;/a&gt;&amp;quot; command that uses
&lt;a href=&quot;http://docker.io&quot;&gt;Docker&lt;/a&gt; containers to let you clone and do lightweight
modifications of OCaml installations.&lt;/p&gt;
&lt;p&gt;This will also be useful for anyone who'd like to run tutorials or teach OCaml,
without having to rely on flaky network connectivity at conference venues: a problem we've  &lt;a href=&quot;http://amirchaudhry.com/fpdays-review&quot;&gt;suffered from&lt;/a&gt; too!&lt;/p&gt;
&lt;h3&gt;Core Compiler&lt;/h3&gt;

&lt;p&gt;Starting to work on a real compiler can often be a daunting prospect, and so
one initiative we started this year is to host regular &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/2013/10/30/third-compiler-hacking-session.html&quot;&gt;compiler hacking sessions&lt;/a&gt; where people could find a &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;curated list of features&lt;/a&gt; to work on, with the regular developers at hand to help out when people get stuck, and free beer and pizza to oil the coding wheels.  This has worked out well, with around 20 people showing up on average for the three we held, and &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;several patches&lt;/a&gt; submitted upstream to OCaml.  &lt;a href=&quot;http://gallium.inria.fr/~scherer/&quot;&gt;Gabriel Scherer&lt;/a&gt; and &lt;a href=&quot;http://cristal.inria.fr/~doligez/&quot;&gt;Damien Doligez&lt;/a&gt; have been helping this effort by tagging &lt;a href=&quot;http://caml.inria.fr/mantis/search.php?project_id=1&amp;amp;sticky_issues=1&amp;amp;sortby=last_updated&amp;amp;dir=DESC&amp;amp;highlight_changed=24&amp;amp;hide_status_id=90&amp;amp;tag_string=junior_job&quot;&gt;junior jobs&lt;/a&gt; in the OCaml Mantis bug tracker as they are filed.&lt;/p&gt;
&lt;h4&gt;Syntax transformations and extension points&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://www.lpw25.net&quot;&gt;Leo White&lt;/a&gt; started the year fresh out of completing his PhD with &lt;a href=&quot;https://www.cl.cam.ac.uk/~am21/&quot;&gt;Alan Mycroft&lt;/a&gt;, and before he realized what he'd
gotten himelf into was working with &lt;a href=&quot;http://alain.frisch.fr/&quot;&gt;Alain Frisch&lt;/a&gt; on the
future of syntax transformations in OCaml.  We started off our first
&lt;a href=&quot;http://lists.ocaml.org/listinfo/wg-camlp4&quot;&gt;wg-camlp4&lt;/a&gt; working group on the new
&lt;a href=&quot;http://lists.ocaml.org&quot;&gt;lists.ocaml.org&lt;/a&gt; host, and a spirited discussion
&lt;a href=&quot;http://lists.ocaml.org/pipermail/wg-camlp4/2013-January/thread.html&quot;&gt;started&lt;/a&gt; that
went &lt;a href=&quot;http://lists.ocaml.org/pipermail/wg-camlp4/2013-February/thread.html&quot;&gt;on&lt;/a&gt;
and &lt;a href=&quot;http://lists.ocaml.org/pipermail/wg-camlp4/2013-March/thread.html&quot;&gt;on&lt;/a&gt; for
several months.  It ended with a very satisfying design for a simpler &lt;em&gt;extension
points&lt;/em&gt; mechanism which Leo &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/white.pdf&quot;&gt;presented&lt;/a&gt;
at the OCaml 2013 workshop at ICFP, and is now merged into OCaml 4.02-trunk.&lt;/p&gt;
&lt;h4&gt;Namespaces&lt;/h4&gt;

&lt;p&gt;Not all of the working groups were quite as successful in coming to a conclusion as the Camlp4 one.  On the Platform mailing list, Gabriel Scherer started a discussion on the design for &lt;a href=&quot;http://lists.ocaml.org/pipermail/platform/2013-February/000050.html&quot;&gt;namespaces&lt;/a&gt; in OCaml.  The resulting discussion was useful in separating multiple concerns that were intermingled in the initial proposal, and Leo wrote a &lt;a href=&quot;http://www.lpw25.net/2013/03/10/ocaml-namespaces.html&quot;&gt;comprehensive blog post&lt;/a&gt; on a proposed namespace design.&lt;/p&gt;
&lt;p&gt;After further discussion at &lt;a href=&quot;http://icfpconference.org/icfp2013/&quot;&gt;ICFP 2013&lt;/a&gt; with Jacques Garrigue later in the year, it turns out adding support for &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6063&quot;&gt;module aliases&lt;/a&gt; would solve much of the cost associated with compiling large libraries such as &lt;a href=&quot;http://ocaml.janestreet.com&quot;&gt;Core&lt;/a&gt;, with no backwards compatibility issues.  This solution has now been integrated into OCaml 4.02.0dev and is being tested with Core.&lt;/p&gt;
&lt;h4&gt;Delving into the bug tracker&lt;/h4&gt;

&lt;p&gt;Jeremy Yallop joined us in April, and he and Leo also leapt into the core
compiler and started triaging issues on the OCaml &lt;a href=&quot;http://caml.inria.fr/mantis&quot;&gt;bug
tracker&lt;/a&gt;.  This seems unglamorous in the
beginning, but there rapidly turned out to be many fascinating threads that
shed light on OCaml's design and implementation through seemingly harmless
bugs.  Here is a pick of some interesting threads through the year that we've
been involved with:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;An &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5985&amp;amp;nbn=49#bugnotes&quot;&gt;unexpected interaction between variance and GADTs&lt;/a&gt;
 that led to Jacques Garrigue's &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/garrigue.pdf&quot;&gt;talk&lt;/a&gt; at OCaml 2013.&lt;/li&gt;&lt;li&gt;Type unsoundness by &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5992&quot;&gt;pattern matching lazy mutable values&lt;/a&gt;, thus
 shedding light on the precise semantics of the order of pattern matching.&lt;/li&gt;&lt;li&gt;Leo proposed an &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5584&quot;&gt;open types&lt;/a&gt; extension
 to allow abstract types to be declared open. You can try it via &lt;code&gt;opam switch 4.00.1+open-types&lt;/code&gt;.&lt;/li&gt;&lt;li&gt;Designing the popular, but controversial &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5759&quot;&gt;record disambiguation feature&lt;/a&gt; in OCaml 4.01.0, and debating &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6000&quot;&gt;the right warnings&lt;/a&gt; needed to prevent programmer surprise.&lt;/li&gt;&lt;li&gt;Exposing a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6064&quot;&gt;GADT representation for Bigarray&lt;/a&gt;.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;This is just a sample of some of the issues solved in Mantis; if you want to
learn more about OCaml, it's well worth browsing through it to learn from over
a decade of interesting discussions from all the developers.&lt;/p&gt;
&lt;h4&gt;Thread-local storage runtime&lt;/h4&gt;

&lt;p&gt;While OCamlPro was working on their &lt;a href=&quot;https://github.com/lucasaiu/ocaml&quot;&gt;reentrant OCaml runtime&lt;/a&gt;, we took a different tack by adding &lt;a href=&quot;https://github.com/ocamllabs/ocaml/tree/multicore&quot;&gt;thread-local storage&lt;/a&gt; to the runtime instead, courtesy of &lt;a href=&quot;http://mu.netsoc.ie/&quot;&gt;Stephen Dolan&lt;/a&gt;.  This is an important choice to make at the outset of adding multicore, so both approaches are warranted.  The preemptive runtime adds a lot of code churn (due to adding a context parameter to most function calls) and takes up a register, whereas the thread-local storage approach we tried doesn't permit callbacks to different threads.&lt;/p&gt;
&lt;p&gt;Much of this work isn't interesting on its own, but forms the basis for a fully multicore runtime (with associated programming model) in 2014. Stay tuned!&lt;/p&gt;
&lt;h4&gt;Ctypes&lt;/h4&gt;

&lt;p&gt;One other complaint from the Consortium members was quite surprising: the difficulty of using the OCaml foreign function interface safely to interface with C code.  Jeremy Yallop began working on the &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes&quot;&gt;ctypes&lt;/a&gt; library that had the goal of eliminating the need to write any C code at all for the vast majority of foreign bindings.&lt;/p&gt;
&lt;p&gt;Instead, Ctypes lets you describe any C function call as an OCaml value, and provides various linkage options to invoke that function into C.  The first option he implemented was a &lt;code&gt;dlopen&lt;/code&gt; interface, which immediately brought us the same level of functionality as the &lt;a href=&quot;http://docs.python.org/2/library/ctypes.html&quot;&gt;Python&lt;/a&gt; or &lt;a href=&quot;http://www.haskell.org/haskellwiki/Library/libffi&quot;&gt;Haskell&lt;/a&gt; Ctypes equivalents.  This early code was in itself startlingly useful and more pleasant to use than the raw FFI, and various folk (such as David Sheets' &lt;a href=&quot;https://github.com/dsheets/ocaml-sodium&quot;&gt;libsodium&lt;/a&gt; cryptography bindings) started adopting it.&lt;/p&gt;
&lt;p&gt;At this point, I happened to be struggling to write the Foreign Function Interface chapter of &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; without blowing through our page budget with a comprehensive explanation of the existing system.  I decided to take a risk and write about Ctypes instead, since it let new users to the language have a &lt;em&gt;far&lt;/em&gt; more productive experience to get started.  Xavier Leroy pointed out &lt;a href=&quot;https://github.com/realworldocaml/book/issues/1701&quot;&gt;some shortcomings&lt;/a&gt; of the library in his technical book review, most notably with the lack of an interface with C.  The design of Ctypes fully supports alternate linking mechanisms than just &lt;code&gt;dlopen&lt;/code&gt; though, and Jeremy has added automatic C stub generation support as well.  This means that if you use Ctypes to build an OCaml binding in 2014, you can choose several mechanisms for the same source code to link to the external system.  Jeremy even demonstrated a forking model at OCaml 2013 that protects the OCaml runtime from the C binding via process separation.&lt;/p&gt;
&lt;p&gt;The effort is paying off: Daniel B&amp;uuml;nzli &lt;a href=&quot;http://alan.petitepomme.net/cwn/2013.12.17.html#9&quot;&gt;ported SDL2&lt;/a&gt; using ctypes, and gave us extensive &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes/issues&quot;&gt;feedback&lt;/a&gt; about any missing corner cases, and the resulting bindings don't require any C code to be written. &lt;a href=&quot;http://xulforum.org&quot;&gt;Jonathan Protzenko&lt;/a&gt; even used it to implement an OCaml controlle
r for the &lt;a href=&quot;http://gallium.inria.fr/blog/raspi-lcd/&quot;&gt;Adafruit Raspberry Pi RGB LCD&lt;/a&gt;!&lt;/p&gt;
&lt;h3&gt;Community Efforts&lt;/h3&gt;

&lt;p&gt;Our community efforts were largely online, but we also hosted visitors over the year and regular face-to-face tutorials.&lt;/p&gt;
&lt;h4&gt;Online at OCaml.org&lt;/h4&gt;

&lt;p&gt;While the rest of the crew were hacking on OPAM and OCaml, &lt;a href=&quot;http://amirchaudhry.com/&quot;&gt;Amir Chaudhry&lt;/a&gt; and &lt;a href=&quot;http://philippewang.info/CL/&quot;&gt;Philippe Wang&lt;/a&gt; teamed up with Ashish Agarwal and Christophe Troestler to redesign and relaunch the &lt;a href=&quot;http://ocaml.org&quot;&gt;OCaml website&lt;/a&gt;.  Historically, OCaml's homepage has been the &lt;a href=&quot;http://caml.inria.fr&quot;&gt;caml.inria.fr&lt;/a&gt; domain, and the &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt; effort was begun by Christophe and Ashish &lt;a href=&quot;https://www.mail-archive.com/caml-list@inria.fr/msg00169.html&quot;&gt;some years ago&lt;/a&gt; to modernize the web presence.&lt;/p&gt;
&lt;p&gt;The webpages were already rather large with complex scripting (for example, the &lt;a href=&quot;http://ocaml.org/learn/tutorials/99problems.html&quot;&gt;99 Problems&lt;/a&gt; page runs the OCaml code to autogenerate the output). Philippe developed a &lt;a href=&quot;https://github.com/pw374/MPP-language-blender&quot;&gt;template DSL&lt;/a&gt; that made it easier to unify a lot of the templates around the website, and also a &lt;a href=&quot;https://github.com/pw374/omd&quot;&gt;Markdown parser&lt;/a&gt; that we could link to as a library from the rest of the infrastructure without shelling out to Pandoc.&lt;/p&gt;
&lt;p&gt;Meanwhile, Amir designed a series of &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;interactive wireframe sketches&lt;/a&gt;  and &lt;a href=&quot;http://amirchaudhry.com/ocamlorg-request-for-feedback/&quot;&gt;gathered feedback&lt;/a&gt; on it from the community. A local design agency in Cambridge helped with visual look and feel, and finally at the end of the summer we began the &lt;a href=&quot;http://amirchaudhry.com/migration-plan-ocaml-org/&quot;&gt;migration&lt;/a&gt; to the new website, followed by a triumphant &lt;a href=&quot;http://amirchaudhry.com/announcing-new-ocamlorg/&quot;&gt;switchover&lt;/a&gt; in November to the design you see today.&lt;/p&gt;
&lt;p&gt;The domain isn't just limited to the website itself.  Leo and I set up a &lt;a href=&quot;https://github.com/ocaml/ocaml.org-scripts&quot;&gt;SVN-to-Git mirror&lt;/a&gt; of the OCaml compiler &lt;a href=&quot;http://caml.inria.fr/ocaml/anonsvn.en.html&quot;&gt;Subversion repository&lt;/a&gt; on the GitHub &lt;a href=&quot;https://github.com/ocaml/ocaml&quot;&gt;OCaml organization&lt;/a&gt;, which is proving popular with developers.  There is an ongoing effort to simplify the core compiler tree by splitting out some of the larger components, and so &lt;a href=&quot;http://github.com/ocaml/camlp4&quot;&gt;camlp4&lt;/a&gt; is also now hosted on that organization, along with &lt;a href=&quot;https://github.com/ocaml/oasis&quot;&gt;OASIS&lt;/a&gt;.  We also administer several subdomains of &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt;, such as the &lt;a href=&quot;http://lists.ocaml.org&quot;&gt;mailing lists&lt;/a&gt; and the &lt;a href=&quot;http://opam.ocaml.org&quot;&gt;OPAM repository&lt;/a&gt;, and other services such as the &lt;a href=&quot;http://forge.ocamlcore.org&quot;&gt;OCaml Forge&lt;/a&gt; are currently migrating over.  This was made significantly easier thanks to sponsorship from &lt;a href=&quot;http://rackspace.com&quot;&gt;Rackspace Cloud&lt;/a&gt; (users of &lt;a href=&quot;http://xenserver.org&quot;&gt;XenServer&lt;/a&gt; which is written in OCaml). They saw our struggles with managing physical machines and gave us developer accounts, and all of the ocaml.org infrastructure is now hosted on Rackspace.  We're very grateful to their ongoing help!&lt;/p&gt;
&lt;p&gt;If you'd like to contribute to infrastructure help  (for example, I'm experimenting with a &lt;a href=&quot;http://git.ocaml.org/public/&quot;&gt;GitLab&lt;/a&gt; mirror), then please join the &lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure@lists.ocaml.org&lt;/a&gt; mailing list and share your thoughts.  The website team also need help with adding content and &lt;a href=&quot;https://github.com/ocaml/ocaml.org/issues/376&quot;&gt;international translations&lt;/a&gt;, so head over to the &lt;a href=&quot;http://github.com/ocaml/ocaml.org/issues&quot;&gt;website issue tracker&lt;/a&gt; and start proposing improvements you'd like to see.&lt;/p&gt;
&lt;h4&gt;Next steps for ocaml.org&lt;/h4&gt;

&lt;p&gt;The floodgates requesting features opened up after the launch of the new look and feel.  Pretty much everyone wanted deeper OPAM integration into the main website, for features such as:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Starring and reviewing packages&lt;/li&gt;&lt;li&gt;Integrating the &lt;a href=&quot;https://github.com/ocamllabs/opam-doc&quot;&gt;opam-doc&lt;/a&gt; documentation with the metadata&lt;/li&gt;&lt;li&gt;Display test results and a compatibility matrix for non-x86 and non-Linux architectures.&lt;/li&gt;&lt;li&gt;Link to blog posts and tutorials about the package.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;Many of these features were part of the &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;original wireframes&lt;/a&gt; but we're being careful to take a long-term view of how they should be create
d and maintained.Rather than building all of this as a huge bloated &lt;a href=&quot;https://github.com/ocaml/opam2web&quot;&gt;opam2web&lt;/a&gt; extension, David Sheets (our resident relucant-to-admit-it web expert) has designed an overlay directory scheme that permits the overlaying of different metadata onto the website. This lets one particular feature (such as blog post aggregation) be handled separately from the others via Atom aggregators.&lt;/p&gt;
&lt;h4&gt;&amp;nbsp;Real World OCaml&lt;/h4&gt;

&lt;p&gt;A big effort that took up most of the year for me was finishing and publishing an O'Reilly book called &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; with &lt;a href=&quot;https://ocaml.janestreet.com/?q=blog/5&quot;&gt;Yaron Minsky&lt;/a&gt; and Jason Hickey.  Yaron describes how it all started in &lt;a href=&quot;https://ocaml.janestreet.com/?q=node/117&quot;&gt;his blog post&lt;/a&gt;, but I learnt a lot from developing a book using the &lt;a href=&quot;http://anil.recoil.org/2013/06/17/real-world-ocaml-beta-available.html&quot;&gt;open commenting scheme&lt;/a&gt; that we
developed just for this.&lt;/p&gt;
&lt;p&gt;In particular, the book ended up shining a bright light into dark language corners that we might otherwise not have explored in OCaml Labs.  Two chapters of the book that I wasn't satisfied with were the &lt;a href=&quot;https://realworldocaml.org/v1/en/html/objects.html&quot;&gt;objects&lt;/a&gt; and &lt;a href=&quot;https://realworldocaml.org/v1/en/html/classes.html&quot;&gt;classes&lt;/a&gt; chapters, largely since neither Yaron nor Jason nor I had ever really used their full power in our own code.  Luckily, Leo White decided to pick up the baton and champion these oft-maligned (but very powerful) features of OCaml, and the result is the clearest explanation of them that I've read yet.  Meanwhile, Jeremy Yallop helped out with extensive review of the &lt;a href=&quot;https://realworldocaml.org/v1/en/html/foreign-function-interface.html&quot;&gt;Foreign Function Interface&lt;/a&gt; chapter that used his &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes&quot;&gt;ctypes&lt;/a&gt; library.  Finally, &lt;a href=&quot;https://plus.google.com/100586365409172579442/posts&quot;&gt;Jeremie Dimino&lt;/a&gt; at Jane Street worked hard on adding several features to his &lt;a href=&quot;https://github.com/diml/utop&quot;&gt;utop&lt;/a&gt; toplevel that made it compelling enough to become our default recommendation for newcomers.&lt;/p&gt;
&lt;p&gt;All in all, we ended up closing over &lt;a href=&quot;http://anil.recoil.org/2013/08/06/real-world-ocaml-beta2.html&quot;&gt;2000 comments&lt;/a&gt; in the process of writing the book, and I'm very proud of the result (freely available &lt;a href=&quot;https://realworldocaml.org&quot;&gt;online&lt;/a&gt;, but do &lt;a href=&quot;http://www.amazon.com/Real-World-OCaml-Functional-programming/dp/144932391X/&quot;&gt;buy a copy&lt;/a&gt; if you can to support it).  Still, there's more I'd like to do in 2014 to improve the ease of using OCaml further.  In particular, I removed a chapter on packaging and build systems since I wasn't happy with its quality, and both &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; and I intend to spend time in 2014 on improving this part of the ecosystem.&lt;/p&gt;
&lt;h4&gt;Tutorials and Talks&lt;/h4&gt;

&lt;p&gt;We had a lively presence at &lt;a href=&quot;http://icfpconference.org&quot;&gt;ICFP 2013&lt;/a&gt; this year, with the third iteration of the &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/program.html&quot;&gt;OCaml 2013&lt;/a&gt; held there, and Stephen Dolan presenting a paper in the main conference.  I &lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/2013/09/24/liveblogging-ocaml-workshop-2013/&quot;&gt;liveblogged the workshop&lt;/a&gt; as it happened, and all the &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/program.html&quot;&gt;talks&lt;/a&gt; we gave are linked from the program.  The most exciting part of the conference for a lot of us were the two talks by Facebook on their use of OCaml: first for &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/padioleau.pdf&quot;&gt;program analysis using Pfff&lt;/a&gt; and then to migrate their massive PHP codebase &lt;a href=&quot;http://www.youtube.com/watch?feature=player_detailpage&amp;amp;v=gKWNjFagR9k#t=1150&quot;&gt;using an OCaml compiler&lt;/a&gt;.  I also had the  opportunity to participate in a panel at the Haskell Workshop on whether &lt;a href=&quot;http://ezyang.tumblr.com/post/62157468762/haskell-haskell-and-ghc-too-big-to-fail-panel&quot;&gt;Haskell is too big to fail yet&lt;/a&gt;; lots of interesting perspectives on scaling another formerly academic language into the real world.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://ocaml.janestreet.com/?q=blog/5&quot;&gt;Yaron Minsky&lt;/a&gt; and I have been giving tutorials on OCaml at ICFP for several years, but the release of Real World OCaml has made it significantly easier to give tutorials without the sort of labor intensity that it took in previous years (one memorable ICFP 2011 tutorial that we did took almost 2 hours to get everyone installed with OCaml.  In ICFP 2013, it took us 15 minutes or so to get everyone started).  Still, giving tutorials at ICFP is very much preaching to the choir, and so we've started speaking at more general-purpose events.&lt;/p&gt;
&lt;p&gt;Our first local effort was &lt;a href=&quot;http://fpdays.net/2013/&quot;&gt;FPDays&lt;/a&gt; in Cambridge, where Jeremy Yallop and Amir Chaudhry ran the tutorial with help from Phillipe Wang, Leo White and David Sheets. The OCaml session there ended up being the biggest one in the entire two days, and Amir &lt;a href=&quot;http://amirchaudhry.com/fpdays-review/&quot;&gt;wrote up&lt;/a&gt; their experiences.  One interesting change from our ICFP tutorial is that Jeremy used &lt;a href=&quot;https://github.com/ocsigen/js_of_ocaml&quot;&gt;js_of_ocaml&lt;/a&gt; to teach OCaml via JavaScript by building a fun &lt;a href=&quot;https://github.com/ocamllabs/fpdays-skeleton&quot;&gt;Monty Hall&lt;/a&gt; game.&lt;/p&gt;
&lt;h4&gt;Visitors and Interns&lt;/h4&gt;

&lt;p&gt;Since OCaml Labs is a normal group within the &lt;a href=&quot;http://www.cl.cam.ac.uk&quot;&gt;Cambridge Computer Lab&lt;/a&gt;, we often host academic visitors and interns who pass through.  This year was certainly diverse, and we welcomed a range of colleagues:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://www.lip6.fr/actualite/personnes-fiche.php?ident=D1161&amp;amp;LANG=en&quot;&gt;Mathias Bourgoin&lt;/a&gt; has just finished his work on interfacing OCaml with GPUs, and gave us a seminar on how his &lt;a href=&quot;http://www.algo-prog.info/spoc/web/index.php?id=spoc&quot;&gt;SPOC&lt;/a&gt; tool works (also available in OPAM via a &lt;a href=&quot;http://www.algo-prog.info/spoc/distribution/opam/&quot;&gt;custom remote&lt;/a&gt;).&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://www.benjamin.canou.fr/&quot;&gt;Benjamin Canou&lt;/a&gt; (now at OCamlPro) practised his &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/canou.pdf&quot;&gt;OCaml 2013 talk&lt;/a&gt; on building high-level interfaces to JavaScript with OCaml by giving a departmental seminar.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://www.dicosmo.org/&quot;&gt;Roberto Di Cosmo&lt;/a&gt;, who directs the &lt;a href=&quot;http://www.irill.org/&quot;&gt;IRILL&lt;/a&gt; organization on Free Software in Paris delivered a seminar on constraint solving for &lt;a href=&quot;http://mancoosi.org&quot;&gt;package systems&lt;/a&gt; that are as large-scale as Debian's.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; visited during the summer to help plot the &lt;a href=&quot;http://openmirage.org/blog/mirage-1.0.3-released&quot;&gt;Mirage 1.0&lt;/a&gt; and &lt;a href=&quot;http://anil.recoil.org/2013/09/20/opam-1-1-beta.html&quot;&gt;OPAM 1.1&lt;/a&gt; releases.  He has also since joined OCaml Labs fulltime to work on &lt;a href=&quot;http://nymote.org&quot;&gt;Nymote&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://louis.gesbert.fr/cv.en.html&quot;&gt;Louis Gesbert&lt;/a&gt; from OCamlPro visited for 2 weeks in December and kicked off the inaugral OPAM developers summit (which was, admittedly, just 5 developers in the &lt;a href=&quot;http://www.kingston-arms.co.uk/&quot;&gt;Kingston Arms&lt;/a&gt;, but all good things start in a pub, right?)&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://www.xulforum.org/&quot;&gt;Jonathan Protzenko&lt;/a&gt; presented his PhD work on &lt;a href=&quot;http://protz.github.io/mezzo/&quot;&gt;Mezzo&lt;/a&gt; (which is now &lt;a href=&quot;http://gallium.inria.fr/blog/mezzo-on-opam/&quot;&gt;merged into OPAM&lt;/a&gt;), and educated us on the vagaries of &lt;a href=&quot;http://protz.github.io/ocaml-installer/&quot;&gt;Windows support&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://gallium.inria.fr/~scherer/&quot;&gt;Gabriel Scherer&lt;/a&gt; from the Gallium INRIA group visited to discuss the direction of OPAM and various language feature discussions (such as namespaces).  He didn't give a talk, but promises to do so next time!&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/bvaugon&quot;&gt;Beno&amp;icirc;t Vaugon&lt;/a&gt; gave a seminar on his &lt;a href=&quot;http://oud.ocaml.org/2012/slides/oud2012-paper10-slides.pdf&quot;&gt;OCamlCC&lt;/a&gt; OCaml-to-C compiler, talked about porting OCaml to &lt;a href=&quot;http://www.algo-prog.info/ocaml_for_pic/web/index.php?id=ocapic&quot;&gt;8-bit PICs&lt;/a&gt;, and using GADTs to &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6017&quot;&gt;implement Printf&lt;/a&gt; properly.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;We were also visited several times by &lt;a href=&quot;http://danmey.org/&quot;&gt;Wojciech Meyer&lt;/a&gt; from ARM, who was an OCaml developer who maintained (among other things) the &lt;a href=&quot;http://brion.inria.fr/gallium/index.php/Ocamlbuild&quot;&gt;ocamlbuild&lt;/a&gt; system and worked on &lt;a href=&quot;http://www.youtube.com/watch?v=d9Hg5L76FG8&quot;&gt;DragonKit&lt;/a&gt; (an extensible LLVM-like compiler written in OCaml).  Wojciech very sadly passed away on November 18th, and we all fondly remember his enthusiastic and intelligent contributions to our small Cambridge community.&lt;/p&gt;
&lt;p&gt;We also hosted visitors to live in Cambridge and work with us over the summer.  In addition to Vincent Botbol (who worked on OPAM-doc as described earlier) we had the pleasure of having &lt;a href=&quot;http://erratique.ch/&quot;&gt;Daniel B&amp;uuml;nzli&lt;/a&gt; and &lt;a href=&quot;http://www.x9c.fr/&quot;&gt;Xavier Clerc&lt;/a&gt; work here.  Here's what they did in their own words.&lt;/p&gt;
&lt;h5&gt;Xavier Clerc: OCamlJava&lt;/h5&gt;

&lt;p&gt;Xavier Clerc took a break from his regular duties at INRIA to join us over the summer
to work on &lt;a href=&quot;http://ocamljava.x9c.fr/preview/&quot;&gt;OCaml-Java&lt;/a&gt; and adapt it to the latest
JVM features.  This is an incredibly important project to bridge OCaml with the huge
Java community, and here's his report:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;After a four-month visit to the OCaml Labs dedicated to the &lt;a href=&quot;http://ocamljava.x9c.fr/preview/&quot;&gt;OCaml-Java&lt;/a&gt;
project, the time has come for an appraisal! The undertaken work can be split
into two areas: improvements to code generation, and interaction between the
OCaml &amp;amp; Java languages.  Regarding code generation, several classical
optimizations have been added to the compiler, for example loop unrolling,
more aggressive unboxing, better handling of globals, or partial evaluation
(at the bytecode level). A new tool, namely ocamljar, has been introduced
allowing post-compilation optimizations. The underlying idea is that some
optimizations cannot always be applied (e.g. depending whether multiple
threads/programs will coexist), but enabling them through command-line flags
would lead to recompilation and/or multiple installations of each library
according to the set of chosen optimizations. It is thus far more easier to
first build an executable jar file, and then modify it according to these
optimizations. Furthermore, this workflow allows the ocamljar tool to take
advantage of whole-program information for some optimizations.  All these
improvements, combined, often lead to a gain of roughly 1/3 in terms of
execution time.&lt;/p&gt;
&lt;p&gt;Regarding language interoperability, there are actually two directions 
depending on whether you want to call OCaml code from Java, or want to call 
Java code from OCaml. For the first direction, a tool allows to generate Java
source files from OCaml compiled interfaces, mapping the various constructs
of the OCaml language to Java classes. It is then possible to call functions, 
and to manipulate instances of OCaml types in pure Java, still benefiting 
from the type safety provided by the OCaml language. In the other direction,
an extension of the OCaml typer is provided allowing to create and manipulate
Java instances directly from OCaml sources. This typer extension is indeed a
thin layer upon the original OCaml typer, that is mainly responsible for
encoding Java types into OCaml types.  This encoding uses a number of
advanced elements such as polymorphic variants, subtyping, variance
annotations, phantom typing, and printf-hack, but the end-user does not have
to be aware of this encoding. On the surface, the type of instances of the
Java Object classes is &lt;code&gt;java'lang'Object java_instance&lt;/code&gt;, and instances can be
created by calling Java.make &lt;code&gt;Object()&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;While still under heavy development, a working prototype &lt;a href=&quot;http://ocamljava.x9c.fr/preview/&quot;&gt;is available&lt;/a&gt;, and bugs &lt;a href=&quot;http://bugs.x9c.fr/&quot;&gt;can be reported&lt;/a&gt;. Finally, I would like to thank the OCaml Labs for providing a great working
environment.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5&gt;Daniel B&amp;uuml;nzli: Typography and Visualisation&lt;/h5&gt;

&lt;p&gt;Daniel joined us from Switzerland, and spent some time at Citrix before joining us in OCaml Labs.  All of his &lt;a href=&quot;http://erratique.ch/software&quot;&gt;software&lt;/a&gt; is now on OPAM, and is seeing ever-increasing adoption from the community.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Released a first version of &lt;a href=&quot;http://erratique.ch/software/vg&quot;&gt;Vg&lt;/a&gt; [...] I'm
especially happy about that as I wanted to use and work on these ideas since
at least 2008. The project is a long term project and is certainly not
finished yet but this is already a huge step.&lt;/p&gt;
&lt;p&gt;Adjusted and released a first version of
&lt;a href=&quot;http://erratique.ch/software/gg&quot;&gt;Gg&lt;/a&gt;. While the module was already mostly
written before my arrival to Cambridge, the development of Vg and Vz prompted
me to make some changes to the module.&lt;/p&gt;
&lt;p&gt;[...] released &lt;a href=&quot;http://erratique.ch/software/otfm&quot;&gt;Otfm&lt;/a&gt;, a
module to decode OpenType fonts. This is a work in progress as not every
OpenType table has built-in support for decoding yet. But since it is needed
by Vg's PDF renderer I had to cut a release. It can however already be used
to implement certain simple things like font kerning with Vg, this can be
seen in action in the &lt;code&gt;vecho&lt;/code&gt; binary installed by Vg.&lt;/p&gt;
&lt;p&gt;Started to work on &lt;a href=&quot;http://erratique.ch/software/vz/doc/Vz.html&quot;&gt;Vz&lt;/a&gt;, a
module for helping to map data to Vg images. This is really unfinished and is
still considered to be at a design stage. There are a few things that are
however well implemented like (human) perceptually meaningful &lt;a href=&quot;http://erratique.ch/software/vz/demos/color_schemes.html&quot;&gt;color
palettes&lt;/a&gt; and the
small folding stat module (&lt;code&gt;Vz.Stat&lt;/code&gt;). However it quickly became evident that
I needed to have more in the box w.r.t. text rendering in Vg/Otfm. Things
like d3js entirely rely on the SVG/CSS support for text which makes it easy
to e.g. align things (like tick labels on &lt;a href=&quot;http://erratique.ch/software/vz/demos/iris.html&quot;&gt;such
drawings&lt;/a&gt;). If you can't
rely on that you need ways of measuring rendered text. So I decided to
suspend the work on Vz and put more energy in making a first good release of
Vg. Vz still needs quite some design work, especially since it tries to be
independent of Vg's backend and from the mechanism for user input.&lt;/p&gt;
&lt;p&gt;Spent some time figuring out a new &amp;quot;opam-friendly&amp;quot; release workflow in 
pkgopkg. One of my problem is that by designing in the small for programming
in the large --- what a slogan --- the number of packages I'm publishing is
growing (12 and still counting). This means that I need to scale horizontally
maintenance-wise unhelped by the sad state of build systems for OCaml. I need
tools that make the release process flawless, painless and up to my quality
standards. This lead me to enhance and consolidate my old scattered
distribution scripts in that repo, killing my dependencies on Oasis and
ocamlfind along the way. &lt;em&gt;(edited for brevity, see &lt;a href=&quot;https://github.com/dbuenzli/pkgopkg&quot;&gt;here&lt;/a&gt;)&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Daniel also left his bicycle here for future visitors to use, and the &amp;quot;B&amp;uuml;nzli-bike&amp;quot;
is available for our next visitor! (Louis Gesbert even donated lights, giving
it a semblance of safety).&lt;/p&gt;
&lt;h4&gt;Industrial Fellows&lt;/h4&gt;

&lt;p&gt;Most of our regular funding bodies such as &lt;a href=&quot;http://epsrc.ac.uk&quot;&gt;EPSRC&lt;/a&gt; or &lt;a href=&quot;http://cordis.europa.eu/fp7/home_en.html&quot;&gt;EU FP7&lt;/a&gt; provide funding, but leave all the intellectual input to the academics.  A compelling aspect of OCaml Labs has been how involved our industrial colleagues have been with the day-to-day problems that we solve.  Both Jane Street and Citrix have senior staff regularly visiting our group and working alongside us as industrial fellows in the Computer Lab.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://www.three-tuns.net/mark/&quot;&gt;Mark Shinwell&lt;/a&gt; from Jane Street Europe has been working on improving the &lt;a href=&quot;http://www.youtube.com/watch?v=NF2WpWnB-nk&quot;&gt;state of native debugging&lt;/a&gt; in OCaml, by adding extended DWARF debugging information to the compiler output.  Mark is also a useful source of feedback about the forthcoming design of multicore, since he has daily insight into a huge production codebase at Jane Street (and can tell us about it without us requiring access!).&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; is the principal architect of &lt;a href=&quot;http://xenserver.org&quot;&gt;XenServer&lt;/a&gt; at Citrix in Cambridge.  This year has been transformative for that project, since Citrix &lt;a href=&quot;http://blogs.citrix.com/2013/06/26/open-source-what-does-it-mean-for-xenserver/&quot;&gt;open-sourced XenServer&lt;/a&gt; to GitHub and fully adopted OPAM into their workflow.  Dave is the author of numerous libraries that have all been released to OPAM, and his colleagues &lt;a href=&quot;http://jon.recoil.org&quot;&gt;Jon Ludlam&lt;/a&gt; and &lt;a href=&quot;http://www.xenserver.org/blog/blogger/listings/euanh.html&quot;&gt;Euan Harris&lt;/a&gt; are also regular visitors who have also been contributors to the OPAM and Mirage ecosystems.&lt;/li&gt;&lt;/ul&gt;

&lt;h3&gt;Research Projects&lt;/h3&gt;

&lt;p&gt;The other 100% of our time at the Labs is spent on research projects.  When we started the group, I wanted to set up a feedback loop between local people &lt;em&gt;using&lt;/em&gt; OCaml to build systems, with the folk &lt;em&gt;developing&lt;/em&gt; OCaml itself.  This has worked out particularly well with a couple of big research projects in the Lab.&lt;/p&gt;
&lt;h4&gt;&amp;nbsp;Mirage&lt;/h4&gt;

&lt;p&gt;Mirage is a &lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;library operating system&lt;/a&gt; written in OCaml that compiles source code into specialised Xen microkernels, developed at the Cambridge Computer Lab, Citrix and the &lt;a href=&quot;http://horizon.ac.uk&quot;&gt;Horizon Digital Economy&lt;/a&gt; institute at Nottingham.  This year saw several years of effort culminate in the first release of &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage 1.0&lt;/a&gt; as a self-hosting entity.  While Mirage started off as a &lt;a href=&quot;http://anil.recoil.org/papers/2010-hotcloud-lamp.pdf&quot;&gt;quick experiment&lt;/a&gt; into building specialised virtual appliances, it rapidly became useful to make into a real system for use in bigger research projects.  You can learn more about Mirage &lt;a href=&quot;http://openmirage.org/docs&quot;&gt;here&lt;/a&gt;, or read the &lt;a href=&quot;http://cacm.acm.org/magazines/2014/1/170866-unikernels/abstract&quot;&gt;Communications of the ACM&lt;/a&gt; article that &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; and I wrote to close out the year.&lt;/p&gt;
&lt;p&gt;This project is where the OCaml Labs &amp;quot;feedback loop&amp;quot; has been strongest.  A typical &lt;a href=&quot;http://www.openmirage.org/wiki/hello-world&quot;&gt;Mirage application&lt;/a&gt; consists of around 50 libraries that are all installed via OPAM.  These range from &lt;a href=&quot;https://github.com/mirage/mirage-block-xen&quot;&gt;device drivers&lt;/a&gt; to protocol libraries for &lt;a href=&quot;https://github.com/avsm/ocaml-cohttp&quot;&gt;HTTP&lt;/a&gt; or &lt;a href=&quot;https://github.com/mirage/ocaml-dns&quot;&gt;DNS&lt;/a&gt;, to filesystems such as &lt;a href=&quot;https://github.com/mirage/ocaml-fat&quot;&gt;FAT32&lt;/a&gt;.  Coordinating &lt;a href=&quot;http://openmirage.org/blog/mirage-1.0.3-released&quot;&gt;regular releases&lt;/a&gt; of all of these would be near impossible without using OPAM, and has also forced us to use our own tools daily, helping to sort out bugs more quickly.  You can see the full list of libraries on the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/pkg/&quot;&gt;OCaml Labs software page&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Mirage is also starting to share code with big projects such as &lt;a href=&quot;http://xenserver.org&quot;&gt;XenServer&lt;/a&gt; now, and we have been working with Citrix engineers to help them to move to the &lt;a href=&quot;http://ocaml.janestreet.com&quot;&gt;Core&lt;/a&gt; library that Jane Street has released (and that is covered in &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt;).  Moving production codebases this large can take years, but OCaml Labs is turning out to be a good place to start unifying some of the bigger users of OCaml into one place.  We're also now an official &lt;a href=&quot;http://www.xenproject.org/developers/teams/mirage-os.html&quot;&gt;Xen Project incubator project&lt;/a&gt;, which helps us to validate functional programming  to other Linux Foundation efforts.&lt;/p&gt;
&lt;h4&gt;Nymote and User Centric Networking&lt;/h4&gt;

&lt;p&gt;The release of Mirage 1.0 has put us on the road to simplifying embedded systems programming. The move to the centralized cloud has led to regular well-publicised privacy and security threats to the way &lt;a href=&quot;http://de2013.org/wp-content/uploads/2013/09/de2013_submission_25-1.pdf&quot;&gt;we handle&lt;/a&gt; our digital infrastructure, and so &lt;a href=&quot;http://www.cl.cam.ac.uk/~jac22/&quot;&gt;Jon Crowcroft&lt;/a&gt;, &lt;a href=&quot;http://www.cs.nott.ac.uk/~rmm/&quot;&gt;Richard Mortier&lt;/a&gt; and I are leading an effort to build an alternative privacy-preserving infrastructure using embedded devices as part of the &lt;a href=&quot;http://usercentricnetworking.eu/&quot;&gt;User Centric Networking&lt;/a&gt; project, in collaboration with a host of companies led by &lt;a href=&quot;http://www.thlab.net/&quot;&gt;Technicolor&lt;/a&gt; Paris.
This work also plays on the strong points of OCaml: it already has a &lt;a href=&quot;http://anil.recoil.org/2012/02/25/dreamplug-debian-and-ocaml.html&quot;&gt;fast ARM backend&lt;/a&gt;, and Mirage can easily be ported to the new Xen/ARM target as hardware becomes available.&lt;/p&gt;
&lt;p&gt;One of the most difficult aspects of programming on the &amp;quot;wide area&amp;quot; Internet are dealing with the lack of a distributed identity service that's fully secure.  We published &lt;a href=&quot;http://anil.recoil.org/papers/2013-foci-signposts.pdf&quot;&gt;our thoughts&lt;/a&gt; on this at the USENIX Free and Open Communications on the Internet workhsop, and David Sheets is working towards a full implementation using Mirage.  If you're interested in following this effort, Amir Chaudhry is blogging at the &lt;a href=&quot;http://nymote.org/&quot;&gt;Nymote&lt;/a&gt; project website, where we'll talk about the components as they are released.&lt;/p&gt;
&lt;h4&gt;&amp;nbsp;Data Center Networking&lt;/h4&gt;

&lt;p&gt;At the other extreme from embedded programming is datacenter networking, and we started the &lt;a href=&quot;http://gow.epsrc.ac.uk/NGBOViewGrant.aspx?GrantRef=EP/K034723/1&quot;&gt;Network-as-a-Service&lt;/a&gt; research project with &lt;a href=&quot;http://gow.epsrc.ac.uk/NGBOViewGrant.aspx?GrantRef=EP/K032968/1&quot;&gt;Imperial College&lt;/a&gt; and &lt;a href=&quot;http://gow.epsrc.ac.uk/NGBOViewGrant.aspx?GrantRef=EP/K031724/1&quot;&gt;Nottingham&lt;/a&gt;.  With the rapid rise of &lt;a href=&quot;http://en.wikipedia.org/wiki/Software-defined_networking&quot;&gt;Software Defined Networking&lt;/a&gt; this year, we are investigating how application-specific customisation of network resources can build fast, better, cheaper infrasructure.  OCaml is in a good position here: several other groups have built OpenFlow controllers in OCaml (most notably, the &lt;a href=&quot;https://github.com/frenetic-lang&quot;&gt;Frenetic Project&lt;/a&gt;), and Mirage is specifically designed to assemble such bespoke infrastructure.&lt;/p&gt;
&lt;p&gt;Another aspect we've been considering is how to solve the problem of optimal connectivity across nodes.  TCP is increasingly considered harmful in high-through, high-density clusters, and &lt;a href=&quot;http://www.sussex.ac.uk/informatics/people/peoplelists/person/334868&quot;&gt;George Parisis&lt;/a&gt; led the design of &lt;a href=&quot;http://anil.recoil.org/papers/2013-hotnets-trevi.pdf&quot;&gt;Trevi&lt;/a&gt;, which is a fountain-coding based alternative for storage networking.  Meanwhile, &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; (who joined OCaml Labs in November), has been working on a branch-consistent data store called &lt;a href=&quot;https://github.com/samoht/irminsule&quot;&gt;Irminsule&lt;/a&gt; which supports scalable data sharing and reconciliation using Mirage.  Both of these systems will see implementations based on the research done this year.&lt;/p&gt;
&lt;h4&gt;&amp;nbsp;Higher Kinded Programming&lt;/h4&gt;

&lt;p&gt;Jeremy Yallop and Leo White have been developing an approach that makes it possible to write programs with higher-kinded polymorphism (such as monadic functions that are polymorphic in the monad they use) without using functors. It's early days yet, but there's a &lt;a href=&quot;https://github.com/ocamllabs/higher&quot;&gt;library&lt;/a&gt; available on &lt;a href=&quot;http://opam.ocaml.org/pkg/higher/higher.0.1&quot;&gt;OPAM&lt;/a&gt; that implements the approach, and a &lt;a href=&quot;https://github.com/ocamllabs/higher/raw/paper/higher.pdf&quot;&gt;draft
paper&lt;/a&gt; that outlines the design.&lt;/p&gt;
&lt;h3&gt;Priorities for 2014&lt;/h3&gt;

&lt;p&gt;This year has been a wild ride to get us up to speed, but we now have a solid sense of what to work on for 2014.  We've decided on a high-level set of priorities led by the senior members of the group:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Multicore&lt;/strong&gt;: Leo White will be leading efforts in putting an end-to-end multicore capable OCaml together.&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Metaprogramming&lt;/strong&gt;: Jeremy Yallop will direct the metaprogramming efforts, continuing with Ctypes and into macros and extension points.&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Platform&lt;/strong&gt;: Thomas Gazagnaire will continue to drive OPAM development towards becoming the first &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/madhavapeddy.pdf&quot;&gt;OCaml Platform&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Online&lt;/strong&gt;: Amir Chaudhry will develop the online and community efforts that started in 2013.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;These are guidelines to choosing where to spend our time, but not excluding other work or day-to-day bugfixing. Our focus on collaboration with Jane Street, Citrix, Lexifi, OCamlPro and our existing colleagues will continue, as well as warmly welcoming new community members that wish to work with us on any of the projects, either via internships, studentships or good old-fashioned open source hacking.&lt;/p&gt;
&lt;p&gt;I appreciate the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/&quot;&gt;whole team's&lt;/a&gt; feedback in editing this long post into shape, the amazing professorial support from &lt;a href=&quot;http://www.cl.cam.ac.uk/~jac22/&quot;&gt;Jon Crowcroft&lt;/a&gt;, &lt;a href=&quot;https://www.cl.cam.ac.uk/~iml1/&quot;&gt;Ian Leslie&lt;/a&gt; and &lt;a href=&quot;https://www.cl.cam.ac.uk/~am21/&quot;&gt;Alan Mycroft&lt;/a&gt; throughout the year, and of course the funding and support from Jane Street, Citrix, RCUK, EPSRC, DARPA and the EU FP7 that made all this possible.  Roll on 2014, and please do &lt;a href=&quot;mailto:avsm2@cl.cam.ac.uk&quot;&gt;get in touch&lt;/a&gt; with me with any queries!&lt;/p&gt;

   </content><id>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Dec%202013</id><title type="text">Dec 2013 news update</title><updated>2013-12-29T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://openmirage.org/blog/mirage-1.0.3-released" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;We've had a lot of people trying out Mirage since the &lt;a href=&quot;http://openmirage.org/blog/releasing-mirage&quot;&gt;1.0 release&lt;/a&gt; last week, and so we've been steadily cutting point releases and new libraries to OPAM as they're done.
The most common build error by far has been people using outdated OPAM packages.  Do make sure that you have at least &lt;a href=&quot;http://opam.ocaml.org/doc/Quick_Install.html&quot;&gt;OPAM 1.1&lt;/a&gt; installed, and that you've run &lt;code&gt;opam update -u&lt;/code&gt; to get the latest package lists from the &lt;a href=&quot;https://github.com/ocaml/opam-repository&quot;&gt;package repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/mirage/mirage/releases/tag/1.0.3&quot;&gt;Mirage 1.0.3&lt;/a&gt; improves
Xen configuration generation, cleans up HTTP support, and adds support for FAT
filesystems.  Here are some of the libraries we've released this week to go along with it:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-www&quot;&gt;mirage-www&lt;/a&gt; (update): the live website now runs on the 1.0 tools.  Explanation of how to build it in various configurations is available &lt;a href=&quot;http://openmirage.org/wiki/mirage-www&quot;&gt;here&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/samoht/alcotest&quot;&gt;alcotest&lt;/a&gt; (new): a lightweight and colourful test framework built over &lt;a href=&quot;http://ounit.forge.ocamlcore.org/&quot;&gt;oUnit&lt;/a&gt;.  The interface is simpler to facilitate writing tests quickly, and it formats test results nicely.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-block-xen&quot;&gt;mirage-block-xen.1.0.0&lt;/a&gt; (new): is the stable release of the Xen &lt;code&gt;Blkfront&lt;/code&gt; driver for block devices.  The library supports both frontend and backend operation, but only the frontend is plumbed through to Mirage for now (although the backend can be manually configured).&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-block-unix&quot;&gt;mirage-block-unix.1.2.0&lt;/a&gt; (update): fixed some concurrency bugs and added support for buffered I/O to improve performance.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-fat&quot;&gt;fat-filesystem.0.10.0&lt;/a&gt; (update): copies with more sector sizes, uses buffered I/O on Unix, and adds a &lt;code&gt;KV_RO&lt;/code&gt; key/value interface as well as a more complicated filesystem one.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-fs-unix&quot;&gt;mirage-fs-unix.1.0.0&lt;/a&gt; (update): implements the &lt;code&gt;KV_RO&lt;/code&gt; signature as a passthrough to a Unix filesystem.  This is convenient during development to avoid recompile cycles while changing data.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-platform&quot;&gt;mirage-xen.1.0.0&lt;/a&gt; (update): removed several distracting-but-harmless linker warnings about code bloat.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-cohttp&quot;&gt;cohttp.0.9.14&lt;/a&gt; (update): supports Server-Side Events via better channel flushing, has a complete set of HTTP codes autogenerated from &lt;a href=&quot;https://github.com/citricsquid/httpstatus.es&quot;&gt;httpstatus.es&lt;/a&gt; and exposes a platform-independent &lt;code&gt;Cohttp_lwt&lt;/code&gt; module.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-cow&quot;&gt;cow.0.8.1&lt;/a&gt; (update): switch to the &lt;a href=&quot;https://github.com/pw374/omd&quot;&gt;Omd&lt;/a&gt; library for Markdown parsing, which is significantly more compatible with other parsers.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/samoht/ezjsonm&quot;&gt;ezjsonm.0.2.0&lt;/a&gt; (new): a combinator library to parse, select and manipulate JSON structures.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/avsm/ezxmlm&quot;&gt;ezxmlm.1.0.0&lt;/a&gt; (new): a combinator library to parse, select and transform XML tags and attributes.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-http-xen&quot;&gt;mirage-http-xen&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirage/mirage-http-unix&quot;&gt;mirage-http-unix&lt;/a&gt; provide the HTTP drivers on top of Cohttp for Mirage. Although they are very similar at the moment, they will diverge as the Unix variant gains options to use kernel sockets instead of only the network stack.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;We're making great progress on moving our personal homepages over to Mirage.  The first two introductory wiki posts are also now available:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/wiki/hello-world&quot;&gt;Building a hello world example&lt;/a&gt; takes you through the basic steps to build a Unix and Xen binary.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://openmirage.org/wiki/mirage-www&quot;&gt;Building the Mirage website&lt;/a&gt; lets you build this website with several variants, demonstrating the Unix passthrough filesystem, the OCaml FAT filesystem library, and how to attach a network stack to your application.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;As always, please feel free to report any issues via the &lt;a href=&quot;https://github.com/mirage/mirage/issues&quot;&gt;bug tracker&lt;/a&gt; and ask questions on the &lt;a href=&quot;mailto:mirageos-devel@lists.xenproject.org&quot;&gt;mailing list&lt;/a&gt;.&lt;/p&gt;

   </content><id>http://openmirage.org/blog/mirage-1.0.3-released</id><title type="text">Mirage 1.0.3 released; tutorial on building this website available</title><updated>2013-12-19T23:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://openmirage.org/blog/announcing-mirage10" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;em&gt;First&lt;/em&gt;: read the &lt;a href=&quot;http://openmirage.org/wiki/overview-of-mirage&quot;&gt;overview&lt;/a&gt; and
&lt;a href=&quot;http://openmirage.org/wiki/technical-background&quot;&gt;technical background&lt;/a&gt; behind the project.&lt;/p&gt;
&lt;p&gt;When we started hacking on Mirage back in 2009, it started off looking like a
conventional OS, except written in OCaml.   The &lt;a href=&quot;https://github.com/mirage/mirage/tree/old-master&quot;&gt;monolithic
repository&lt;/a&gt; contained all the
libraries and boot code, and exposed a big &lt;code&gt;OS&lt;/code&gt; module for applications to use.
We used this to do several fun &lt;a href=&quot;http://cufp.org/conference/sessions/2011/t3-building-functional-os&quot;&gt;tutorials&lt;/a&gt; at conferences
such as ICFP/CUFP and get early feedback.&lt;/p&gt;
&lt;p&gt;As development continued though, we started to understand what it is we were
building: a &lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;&amp;quot;library operating system&amp;quot;&lt;/a&gt;.  As the number of libraries grew,
putting everything into one repository just wasn't scaling, and it made it hard
to work with third-party code.  We spent some time developing tools to make
Mirage fit into the broader OCaml ecosystem.&lt;/p&gt;
&lt;p&gt;Three key things have emerged from this effort:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt;, a source-based package manager for
 OCaml. It supports multiple simultaneous compiler installations, flexible
 package constraints, and a Git-friendly development workflow.  Since
 releasing 1.0 in March 2013 and 1.1 in October, the community has leapt
 in to contribute over 1800 packages in this short time.  All of the 
 Mirage libraries are now tracked using it, including the Xen libraries.&lt;/li&gt;&lt;li&gt;The build system for embedded programming (such as the Xen target) is
 a difficult one to get right.  After several experiments, Mirage provides
 a single &lt;strong&gt;&lt;a href=&quot;https://github.com/mirage/mirage&quot;&gt;command-line tool&lt;/a&gt;&lt;/strong&gt; that
 combines configuration directives (also written in OCaml) with OPAM to
 make building Xen unikernels as easy as Unix binaries.&lt;/li&gt;&lt;li&gt;All of the Mirage-compatible libraries satisfy a set of module type
 signatures in a &lt;strong&gt;&lt;a href=&quot;https://github.com/mirage/mirage-types/blob/master/lib/v1.mli&quot;&gt;single file&lt;/a&gt;&lt;/strong&gt;.
 This is where Mirage lives up to its name: we've gone from the early
 monolithic repository to a single, standalone interface file that
 describes the interfaces.  Of course, we also have libraries to go along
 with this signature, and they all live in the &lt;a href=&quot;https://github.com/mirage&quot;&gt;Mirage GitHub organization&lt;/a&gt;.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;With these components, I'm excited to announce that Mirage 1.0 is finally ready
to see the light of day!  Since it consists of so many libraries, we've decided
not to have a &amp;quot;big bang&amp;quot; release where we dump fifty complex libraries on the
open-source community.  Instead, we're going to spend the month of December
writing a series of blog posts that explain how the core components work,
leading up to several use cases:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;The development team have all decided to shift our personal homepages to be Mirage
 kernels running on Xen as a little Christmas present to ourselves, so we'll work through that step-by-step how to build 
 a dedicated unikernel and maintain and deploy it (&lt;strong&gt;spoiler:&lt;/strong&gt; see &lt;a href=&quot;https://github.com/mirage/mirage-www-deployment&quot;&gt;this repo&lt;/a&gt;).  This will culminate in
 a webservice that our colleagues at &lt;a href=&quot;http://horizon.ac.uk&quot;&gt;Horizon&lt;/a&gt; have been
 building using Android apps and an HTTP backend.&lt;/li&gt;&lt;li&gt;The &lt;a href=&quot;http://xenserver.org&quot;&gt;XenServer&lt;/a&gt; crew at Citrix are using Mirage to build custom middlebox VMs
 such as block device caches.&lt;/li&gt;&lt;li&gt;For teaching purposes, the &lt;a href=&quot;http://ocaml.io&quot;&gt;Cambridge Computer Lab team&lt;/a&gt; want a JavaScript backend,
 so we'll explain how to port Mirage to this target (which is rather different
 from either Unix or Xen, and serves to illustrate the portability of our approach).&lt;/li&gt;&lt;/ul&gt;

&lt;h3&gt;How to get involved&lt;/h3&gt;

&lt;p&gt;Bear with us while we update all the documentation and start the blog posts off
today (the final libraries for the 1.0 release are all being merged into OPAM
while I write this, and the usually excellent &lt;a href=&quot;http://travis-ci.org&quot;&gt;Travis&lt;/a&gt; continuous integration system is down due to a &lt;a href=&quot;https://github.com/travis-ci/travis-ci/issues/1727&quot;&gt;bug&lt;/a&gt; on their side).  I'll edit this post to contain links to the future posts
as they happen.&lt;/p&gt;
&lt;p&gt;Since we're now also a proud Xen and Linux Foundation incubator project, our mailing
list is shifting to &lt;a href=&quot;http://lists.xenproject.org/cgi-bin/mailman/listinfo/mirageos-devel&quot;&gt;mirageos-devel@lists.xenproject.org&lt;/a&gt;, and we very much
welcome comments and feedback on our efforts over there.
The &lt;code&gt;#mirage&lt;/code&gt; channel on FreeNode IRC is also growing increasingly popular, as
is simply reporting issues on the main &lt;a href=&quot;http://github.com/mirage/mirage&quot;&gt;Mirage GitHub&lt;/a&gt; repository.&lt;/p&gt;
&lt;p&gt;Several people have also commented that they want to learn OCaml properly to
start using Mirage.  I've just co-published an O'Reilly book called
&lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; that's available for free online
and also as hardcopy/ebook.  Our Cambridge colleague John Whittington has
also written an excellent &lt;a href=&quot;http://ocaml-book.com/&quot;&gt;introductory text&lt;/a&gt;, and
you can generally find more resources &lt;a href=&quot;http://ocaml.org/docs/&quot;&gt;online&lt;/a&gt;.
Feel free to ask beginner OCaml questions on our mailing lists and we'll help
as best we can!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/announcing-mirage10</id><title type="text">Mirage 1.0: not just a hallucination!</title><updated>2013-12-09T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://amirchaudhry.com/switching-from-bootstrap-to-zurb-foundation" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;p&gt;I&amp;rsquo;ve just updated my site&amp;rsquo;s HTML/CSS and moved from Twitter Bootstrap to 
&lt;a href=&quot;http://foundation.zurb.com/learn/features.html&quot;&gt;Zurb Foundation&lt;/a&gt;.  This post captures my subjective notes on the 
migration.&lt;/p&gt;

&lt;h4&gt;My use of Bootstrap&lt;/h4&gt;

&lt;p&gt;When I originally set this site up, I didn&amp;rsquo;t know what frameworks existed or 
anything more than the basics of dealing with HTML (and barely any CSS).  I 
came across Twitter Bootstrap and immediately decided it would Solve All My 
Problems.  It really did.  Since then, I&amp;rsquo;ve gone through one &amp;lsquo;upgrade&amp;rsquo; with 
Bootstrap (from 1.x to 2.x), after which I dutifully ignored all the fixes 
and improvements (note that Bootstrap was up to v2.3.2 while I was still 
using v2.0.2).  &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/switch-to-foundation/responsive-design.png&quot; alt=&quot;Responsive Design&quot;/&gt;&lt;/p&gt;

&lt;p&gt;For the most part, this was fine with me but for a while now, I&amp;rsquo;ve been 
meaning to make this site &amp;lsquo;responsive&amp;rsquo; (read: not look like crap from a 
mobile).  Bootstrap v3 purports to be mobile-first so upgrading would likely 
give me what I&amp;rsquo;m after but v3 is &lt;a href=&quot;http://getbootstrap.com/getting-started/&quot;&gt;not backwards compatible&lt;/a&gt;, 
meaning I&amp;rsquo;d have to rewrite parts of the HTML.  Since this step was 
unavoidable, it led me to have another look at front-end frameworks, just to 
see if I was missing anything.  This was especially relevant since we&amp;rsquo;d 
&lt;a href=&quot;http://amirchaudhry.com/announcing-new-ocamlorg/&quot;&gt;just released&lt;/a&gt; the new &lt;a href=&quot;http://ocaml.org&quot;&gt;OCaml.org&lt;/a&gt; 
website, itself built with Bootstrap v2.3.1 (we&amp;rsquo;d done the design/templating 
work long before v3 was released).  It would be useful to know what else is 
out there for any future work.&lt;/p&gt;

&lt;p&gt;Around this time I discovered Zurb Foundation and also the numerous 
comparisons between them (note: Foundation seems to come out ahead in most 
of those).  A few days ago, the folks at Zurb released 
&lt;a href=&quot;http://zurb.com/article/1280/foundation-5-blasts-off--2&quot;&gt;version 5&lt;/a&gt;, so I decided that now is the time to kick the 
tires.  For the last few days, I&amp;rsquo;ve been playing with the framework and in 
the end I decided to migrate my site over completely.  &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://foundation.zurb.com/learn/features.html&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/switch-to-foundation/zurb-yeti.png&quot; alt=&quot;Foundation's Yeti&quot;/&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Swapping out one framework for another&lt;/h4&gt;

&lt;p&gt;Over time, I&amp;rsquo;ve become moderately experienced with HTML/CSS and I can 
usually wrangle things to look the way I want, but my solutions aren&amp;rsquo;t 
necessarily elegant. I was initially concerned that I&amp;rsquo;d already munged 
things so much that changing anything would be a pain.  When I first put the 
styles for this site together, I had to spend quite a bit of time 
overwriting Bootstrap&amp;rsquo;s defaults so I was prepared for the same when using 
Foundation.  Turns out that I was fine.  I currently use &lt;a href=&quot;http://jekyllrb.com&quot;&gt;Jekyll&lt;/a&gt; (and 
&lt;a href=&quot;http://jekyllbootstrap.com&quot;&gt;Jekyll Bootstrap&lt;/a&gt;) so I only had three template files and a couple of 
HTML pages to edit and because I&amp;rsquo;d kept most of my custom CSS in a separate 
file, it was literally a case of swapping out one framework for another and 
bug-fixing from there onwards.  There&amp;rsquo;s definitely a lesson here in using 
automation as much as possible.&lt;/p&gt;

&lt;p&gt;Customising the styles was another area of concern but I was pleasantly 
surprised to find I needed &lt;em&gt;less&lt;/em&gt; customisation than with Bootstrap.  This 
is likely because I didn&amp;rsquo;t have to override as many defaults (and probably 
because I&amp;rsquo;ve learned more about CSS since then).  The one thing I seemed to 
be missing was a way to deal with code sections, so I just took what 
Bootstrap had and copied it in.  At some point I should revisit this.&lt;/p&gt;

&lt;p&gt;It did take me a while to get my head around Foundation&amp;rsquo;s grid but it was 
worth it in the end.  The idea is that you should design for small screens 
first and then adjust things for larger screens as necessary. There are 
several different default sizes which inherit their properties from the size 
below, unless you explicitly override them.  I initially screwed this up by 
explicitly defining the grid using the &lt;code&gt;small-#&lt;/code&gt; classes, which obviously 
looks ridiculous on small screens.  I fixed it by swapping out &lt;code&gt;small-#&lt;/code&gt; for 
&lt;code&gt;medium-#&lt;/code&gt; everywhere in the HTML, after which everything looked reasonable. 
Items flowed sensibly into a default column for the small screens and looked 
acceptable for larger screens and perfectly fine on desktops.  I could do 
more styling of the mobile view but I&amp;rsquo;d already achieved most of what I was 
after.  &lt;/p&gt;

&lt;h4&gt;Fixing image galleries and embedded content&lt;/h4&gt;

&lt;p&gt;The only additional thing I used from Bootstrap was the &lt;a href=&quot;http://getbootstrap.com/javascript/#carousel&quot;&gt;Carousel&lt;/a&gt;. I&amp;rsquo;d 
written some custom helper scripts that would take some images and 
thumbnails from a specified folder and produce clickable thumbnails with a 
slider underneath.  Foundation provides &lt;a href=&quot;http://foundation.zurb.com/docs/components/orbit.html&quot;&gt;Orbit&lt;/a&gt;, so I had to spend time 
rewriting my script to produce the necessary HTML.  This actually resulted 
in cleaner HTML and one of the features I wanted (the ability to link to a 
specific image) was available by default in Orbit.  At this point I also 
tried to make the output look better for the case where JavaScript is 
disabled (in essence, each image is just displayed as a list).  Below is an 
example of an image gallery, taken from a previous post, when I 
&lt;a href=&quot;http://amirchaudhry.com/joined-the-computer-lab/&quot;&gt;joined the computer lab&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;gallery&quot;&gt;
  &lt;noscript&gt;&lt;small&gt;&lt;em&gt;Note: The gallery needs JavaScript but I've tried to make it degrade gracefully. -Amir&lt;/em&gt;&lt;/small&gt;&lt;/noscript&gt;
  &lt;ul class=&quot;inline-list&quot;&gt;
    
      &lt;li&gt;&lt;a data-orbit-link=&quot;join-comp-lab-1&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-thumb-1.png&quot; alt=&quot;join-comp-lab-thumb-1&quot;/&gt;&lt;/a&gt;&lt;/li&gt;
    
      &lt;li&gt;&lt;a data-orbit-link=&quot;join-comp-lab-2&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-thumb-2.png&quot; alt=&quot;join-comp-lab-thumb-2&quot;/&gt;&lt;/a&gt;&lt;/li&gt;
    
      &lt;li&gt;&lt;a data-orbit-link=&quot;join-comp-lab-3&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-thumb-3.png&quot; alt=&quot;join-comp-lab-thumb-3&quot;/&gt;&lt;/a&gt;&lt;/li&gt;
    
  &lt;/ul&gt;
  &lt;ul data-orbit=&quot;&quot; data-options=&quot;next_on_click:true; timer_speed:3000; pause_on_hover:false; bullets:false;&quot;&gt;
    
    &lt;li class=&quot;gallery-image&quot; data-orbit-slide=&quot;join-comp-lab-1&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-1.jpg&quot; alt=&quot;join-comp-lab-1&quot;/&gt;&lt;/li&gt;
    
    &lt;li class=&quot;gallery-image&quot; data-orbit-slide=&quot;join-comp-lab-2&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-2.jpg&quot; alt=&quot;join-comp-lab-2&quot;/&gt;&lt;/li&gt;
    
    &lt;li class=&quot;gallery-image&quot; data-orbit-slide=&quot;join-comp-lab-3&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-3.jpg&quot; alt=&quot;join-comp-lab-3&quot;/&gt;&lt;/li&gt;
    
  &lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;Foundation also provides a component called &lt;a href=&quot;http://foundation.zurb.com/docs/components/flex_video.html&quot;&gt;Flex Video&lt;/a&gt;, which allows the 
browser to scale videos to the appropriate size.  This fix was as simple as 
going back through old posts and wrapping anything that was &lt;code&gt;&amp;lt;iframe&amp;gt;&lt;/code&gt; in a 
&lt;code&gt;&amp;lt;div class=&amp;quot;flex-video&amp;quot;&amp;gt;&lt;/code&gt;.  It really was that simple and all the Vimeo and 
YouTube items scaled perfectly.  Here&amp;rsquo;s an example of a video from an 
earlier post, where I gave a &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;walkthrough of the ocaml.org site&lt;/a&gt;. 
Try changing the width of your browser window to see it scale.&lt;/p&gt;

&lt;div class=&quot;flex-video widescreen vimeo&quot;&gt;
  &lt;iframe src=&quot;http://player.vimeo.com/video/61768157?byline=0&amp;amp;portrait=0&amp;amp;color=de9e6a&quot; width=&quot;540&quot; height=&quot;303&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot; allowfullscreen=&quot;true&quot;&gt;Video demo&lt;/iframe&gt;
&lt;/div&gt;

&lt;h4&gt;Framework differences&lt;/h4&gt;

&lt;p&gt;Another of the main difference between the two frameworks is that Bootstrap 
uses &lt;a href=&quot;http://lesscss.org&quot;&gt;LESS&lt;/a&gt; to manage its CSS whereas Foundation uses &lt;a href=&quot;http://sass-lang.com&quot;&gt;SASS&lt;/a&gt;.  Frankly, 
I&amp;rsquo;ve no experience with either of them so it makes little difference to me. 
It&amp;rsquo;s worth bearing in mind for anyone who&amp;rsquo;s workflow does involve 
pre-processing.  Also, Bootstrap is available under the 
&lt;a href=&quot;http://getbootstrap.com/getting-started/#license-faqs&quot;&gt;Apache 2 License&lt;/a&gt;, while Foundation is released under 
the &lt;a href=&quot;http://foundation.zurb.com/learn/faq.html#question-3&quot;&gt;MIT license&lt;/a&gt;.&lt;/p&gt;

&lt;h4&gt;Summary&lt;/h4&gt;

&lt;p&gt;Overall, the transition was pretty painless and most of the time was spent 
getting familiar with the grid, hunting for docs/examples and trying to make 
the image gallery work the way I wanted.  I do think Bootstrap&amp;rsquo;s docs are 
better but Foundation&amp;rsquo;s aren&amp;rsquo;t bad.  &lt;/p&gt;

&lt;p&gt;Although this isn&amp;rsquo;t meant to be a comparison, I much prefer Foundation to 
Bootstrap.  If you&amp;rsquo;re not sure which to use then I think the secret is in 
the names of the frameworks.  &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Bootstrap (for me) was a &lt;em&gt;great&lt;/em&gt; way to &amp;lsquo;&lt;em&gt;bootstrap&lt;/em&gt;&amp;rsquo; a site quickly with 
lots of acceptable defaults &amp;ndash; it was quick to get started but took some 
work to alter.  &lt;/li&gt;
  &lt;li&gt;Foundation seems to provide a great &amp;lsquo;&lt;em&gt;foundation&lt;/em&gt;&amp;rsquo; on which to create more 
customised sites &amp;ndash; it&amp;rsquo;s more flexible but needs more upfront thought.  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;That&amp;rsquo;s pretty much how I&amp;rsquo;d recommend them to people now.&lt;/p&gt;

</content><id>http://amirchaudhry.com/switching-from-bootstrap-to-zurb-foundation</id><title type="text">Switching from Bootstrap to Zurb Foundation</title><updated>2013-11-26T21:05:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://amirchaudhry.com/announcing-new-ocamlorg" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;p&gt;As some of you may have noticed, the new OCaml.org site is now live!  &lt;/p&gt;

&lt;p&gt;The DNS may still be propagating so if &lt;a href=&quot;http://ocaml.org&quot;&gt;http://ocaml.org&lt;/a&gt; hasn&amp;rsquo;t updated for you then try http://166.78.252.20.  This post is in two parts: the first is the announcement and the second is a call for content.&lt;/p&gt;

&lt;h3&gt;New OCaml.org website design!&lt;/h3&gt;

&lt;p&gt;The new site represents a major milestone in the continuing growth of the OCaml ecosystem. It&amp;rsquo;s the culmination of a lot of volunteer work over the last several months and I&amp;rsquo;d specifically like to thank &lt;a href=&quot;https://github.com/Chris00&quot;&gt;Christophe&lt;/a&gt;, &lt;a href=&quot;http://ashishagarwal.org&quot;&gt;Ashish&lt;/a&gt; and &lt;a href=&quot;http://philippewang.info/CL/&quot;&gt;Philippe&lt;/a&gt; for their dedication (the &lt;a href=&quot;https://github.com/ocaml/ocaml.org/commits/master&quot;&gt;commit logs&lt;/a&gt; speak volumes).  &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/ann-new-ocamlorg/ocaml-home-wire.png&quot; alt=&quot;OCaml.org Wireframes&quot;/&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We began this journey just over 8 months ago with paper, pencils and a lot of ideas. This led to a comprehensive set of &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;wireframes and walk-throughs&lt;/a&gt; of the site, which then developed into a collection of &lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Site-Redesign&quot;&gt;Photoshop mockups&lt;/a&gt;. In turn, these formed the basis for the html templates and style sheets, which we&amp;rsquo;ve adapted to fit our needs across the site.  &lt;/p&gt;

&lt;p&gt;Alongside the design process, we also considered the kind of structure and &lt;a href=&quot;http://lists.ocaml.org/pipermail/infrastructure/2013-July/000211.html&quot;&gt;workflow we aspired to&lt;/a&gt;, both as maintainers and contributors.  This led us to develop completely new tools for &lt;a href=&quot;http://pw374.github.io/posts/2013-09-05-22-31-26-about-omd.html&quot;&gt;Markdown&lt;/a&gt; and &lt;a href=&quot;http://pw374.github.io/posts/2013-10-03-20-35-12-using-mpp-two-different-ways.html&quot;&gt;templating&lt;/a&gt; in OCaml, which are now available in OPAM for the benefit all.  &lt;/p&gt;

&lt;p&gt;Working on all these things in parallel definitely had it challenges (which I&amp;rsquo;ll write about separately) but the result has been worth the effort.  &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://ocaml.org&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/ann-new-ocamlorg/ocaml-home-mockup.png&quot; alt=&quot;OCaml.org&quot;/&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The journey is ongoing and we still have many more improvements we hope to make. The site you see today primarily improves upon the design, structure and workflows but in time, we also intend to incorporate more information on packages and documentation. With the new tooling, moving the website forward will become much easier and I hope that more members of the community become involved in the generation and curation of content.  This brings me to the second part of this post.&lt;/p&gt;

&lt;h3&gt;Call for content&lt;/h3&gt;

&lt;p&gt;We have lots of great content on the website but there are parts that could do with a refresh and gaps that could be filled.  As a community driven site, we need ongoing contributions to ensure that the site best reflects its members.  &lt;/p&gt;

&lt;p&gt;For example, if you do commercial work on OCaml then maybe you&amp;rsquo;d like to add yourself to the &lt;a href=&quot;http://ocaml.org/community/support.html&quot;&gt;support page&lt;/a&gt;? Perhaps there are tutorials you can help to complete, like &lt;a href=&quot;http://ocaml.org/learn/tutorials/99problems.html&quot;&gt;99 problems&lt;/a&gt;?  If you&amp;rsquo;re not sure where to begin, there are already a number of &lt;a href=&quot;https://github.com/ocaml/ocaml.org/issues?labels=content&quot;&gt;content issues&lt;/a&gt; you could contribute to.  &lt;/p&gt;

&lt;p&gt;Although we&amp;rsquo;ve gone through a bug-hunt already, feedback on the site is still very welcome.  You can either &lt;a href=&quot;https://github.com/ocaml/ocaml.org/issues&quot;&gt;create an issue&lt;/a&gt; on the tracker (preferred), or email the infrastructure list. &lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s fantastic how far we&amp;rsquo;ve come and I look forward to the next phase!&lt;/p&gt;

</content><id>http://amirchaudhry.com/announcing-new-ocamlorg</id><title type="text">Announcing the new OCaml.org</title><updated>2013-11-20T23:00:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://amirchaudhry.com/migration-plan-ocaml-org" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;p&gt;We&amp;rsquo;re close to releasing the new design of ocaml.org but need help from the 
OCaml community to identify and fix bugs before we switch next week.&lt;/p&gt;

&lt;p&gt;Ashish, Christophe, Philippe and I have been discussing how we should go 
about this and below is the plan for migration.  If anyone would like to 
discuss any of this, then the &lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure list&lt;/a&gt; is the best 
place to do so.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;We&amp;rsquo;ve made a &lt;strong&gt;&lt;a href=&quot;https://github.com/ocaml/ocaml.org/tree/redesign&quot;&gt;new branch&lt;/a&gt;&lt;/strong&gt; on the main ocaml.org repository with 
the redesign.  This branch is a fork of the master and we&amp;rsquo;ve simply cleaned 
up and replayed our git commits there.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;We&amp;rsquo;ve built a live version of the new site, which is visible at 
&lt;strong&gt;&lt;a href=&quot;http://preview.ocaml.org&quot;&gt;http://preview.ocaml.org&lt;/a&gt;&lt;/strong&gt; - this is rebuilt every few minutes 
from the branch mentioned above.  &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Over the course of one week, we ask the community to review the new site 
and &lt;strong&gt;&lt;a href=&quot;https://github.com/ocaml/ocaml.org/issues&quot;&gt;report any bugs or problems&lt;/a&gt;&lt;/strong&gt; on the issue tracker. We &lt;em&gt;triage&lt;/em&gt; 
those bugs to identify any blockers and work on those first.  This is the 
phase we&amp;rsquo;ll be in from &lt;em&gt;today&lt;/em&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;After one week (7 days), and after blocking bugs have been fixed, we 
&lt;strong&gt;merge the redesign branch&lt;/strong&gt; into the master branch.  This would 
effectively present the new site to the world.  &lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;During the above, we would not be able to accept any new pull requests on 
the master branch but would be happy to accept them on the new, redesign 
branch.  Hence, restricting the time frame to one week.  &lt;/p&gt;

&lt;p&gt;Please note that the above is only intended to merge the &lt;em&gt;design&lt;/em&gt; and 
&lt;em&gt;toolchain&lt;/em&gt; for the new site.  Specifically, we&amp;rsquo;ve created new landing 
pages, have new style sheets and have restructured the site&amp;rsquo;s contents as 
well as made some new libraries (&lt;a href=&quot;http://pw374.github.io/posts/2013-09-05-22-31-26-about-omd.html&quot;&gt;OMD&lt;/a&gt; and &lt;a href=&quot;http://pw374.github.io/posts/2013-10-03-20-39-07-OPAMaging-MPP.html&quot;&gt;MPP&lt;/a&gt;). The new toolchain 
means people can write files in markdown, which makes contributing content a 
lot easier.  &lt;/p&gt;

&lt;p&gt;Since the files are on GitHub, people don&amp;rsquo;t even need to clone the site 
locally to make simple edits (or even add new pages). Just click the &amp;lsquo;Edit 
this page&amp;rsquo; link in the footer to be taken to the right file in the 
repository and GitHub&amp;rsquo;s editing and pull request features will allow you to 
make changes and submit updates, all from within your browser (see the 
&lt;a href=&quot;https://help.github.com/articles/creating-and-editing-files-in-your-repository&quot;&gt;GitHub Article&lt;/a&gt; for details).  &lt;/p&gt;

&lt;p&gt;There is still work to be done on adding new features but the above changes 
are already a great improvement to the site and are ready to be reviewed by 
the OCaml community and merged.&lt;/p&gt;

</content><id>http://amirchaudhry.com/migration-plan-ocaml-org</id><title type="text">Migration plan for the OCaml.org redesign</title><updated>2013-11-06T11:00:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2013/10/30/third-compiler-hacking-session" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;p&gt;It's time for the third Cambridge OCaml compiler-hacking session! This time we're going to be back in the &lt;a href=&quot;http://www.cl.cam.ac.uk/&quot;&gt;Computer Lab&lt;/a&gt;, where the first session was held.&lt;/p&gt;

&lt;p&gt;If you're planning to come along, it'd be helpful if you could &lt;a href=&quot;http://doodle.com/czzp7ik4r72npz6p&quot;&gt;&lt;em&gt;indicate interest via Doodle&lt;/em&gt;&lt;/a&gt; and &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;&lt;em&gt;sign up to the mailing list&lt;/em&gt;&lt;/a&gt; to receive updates:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Where&lt;/em&gt;: Room &lt;a href=&quot;http://www.cl.cam.ac.uk/research/dtg/openroommap/static/?s=FW11&amp;amp;amp%3Blabels=1&quot;&gt;FW11&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/directions/&quot;&gt;Computer Laboratory, Madingley Road&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;When&lt;/em&gt;: 6pm, Wednesday 6th November&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Who&lt;/em&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;What&lt;/em&gt;: fixing bugs, implementing new features, learning about OCaml internals&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Wiki&lt;/em&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-camlp4/manual002.html&quot;&gt;camlp4&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience, but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll also be ordering pizza, so if you want to be counted for food you should aim to arrive by 6.30pm.&lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2013/10/30/third-compiler-hacking-session</id><title type="text">Third OCaml compiler hacking session</title><updated>2013-10-30T11:49:04+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://amirchaudhry.com/fpdays-review" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;p&gt;&lt;a href=&quot;http://fpdays.net/2013/sessions/index.php?session=24&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/web/fpdays-logo.png&quot; style=&quot;float: right; margin-top: 10px; margin-left: 10px&quot;/&gt;&lt;/a&gt;
Last Thursday a bunch of us from the OCaml Labs team gave an OCaml tutorial 
at the &lt;a href=&quot;http://fpdays.net/2013/sessions/index.php?session=24&quot;&gt;FPDays&lt;/a&gt; conference (an event for people interested in Functional 
Programming).  &lt;a href=&quot;https://github.com/yallop&quot;&gt;Jeremy&lt;/a&gt; and I led the session with &lt;a href=&quot;http://www.lpw25.net&quot;&gt;Leo&lt;/a&gt;, &lt;a href=&quot;https://github.com/dsheets&quot;&gt;David&lt;/a&gt; and 
&lt;a href=&quot;http://philippewang.info/CL/&quot;&gt;Philippe&lt;/a&gt; helping everyone progress and dealing with questions.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/fpdays2013/fpdays2013-01.jpg&quot; style=&quot;float: left; margin-right: 10px&quot;/&gt;
It turned out to be by far the &lt;em&gt;most popular session&lt;/em&gt; at the conference with 
over 20 people all wanting to get to grips with OCaml!  An excellent turnout 
and a great indicator of the interest that&amp;rsquo;s out there, especially when you 
offer a hands-on session to people.  This shouldn&amp;rsquo;t be a surprise as we&amp;rsquo;ve 
had good attendance for the general &lt;a href=&quot;http://www.meetup.com/Cambridge-NonDysFunctional-Programmers/&quot;&gt;OCaml meetups&lt;/a&gt; I&amp;rsquo;ve run 
and also the &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/2013/09/17/compiler-hacking-july-2013.html&quot;&gt;compiler hacking sessions&lt;/a&gt;, which Jeremy and 
Leo have been building up (do sign up if you&amp;rsquo;re interested in either of 
those!).  We had a nice surprise for attendees, which were 
&lt;a href=&quot;http://en.wikipedia.org/wiki/Galley_proof&quot;&gt;uncorrected proof&lt;/a&gt; copies of Real World OCaml and luckily, we had just 
enough to go around.&lt;/p&gt;

&lt;p&gt;For the tutorial itself, Jeremy put together a nice sequence of exercises 
and a &lt;a href=&quot;https://github.com/ocamllabs/fpdays-skeleton&quot;&gt;skeleton repo&lt;/a&gt; (with helpful comments in the code) so that people 
could dive in quickly.  The event was set up to be really informal and the 
rough plan was as following:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;em&gt;Installation/Intro&lt;/em&gt; - We checked that people had been able to follow the 
&lt;a href=&quot;http://amirchaudhry.com/fpdays-ocaml-session/&quot;&gt;installation instructions&lt;/a&gt;, which we&amp;rsquo;d sent them in advance. 
We also handed out copies of the book and made sure folks were comfortable 
with &lt;a href=&quot;http://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;em&gt;Hello world&lt;/em&gt; - A light intro to get people familiar with the OCaml 
syntax and installing packages with OPAM. This would also help people to get 
familiar with the toolchain, workflow and compilation.  &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;em&gt;Monty Hall browser game&lt;/em&gt; - Using &lt;a href=&quot;http://ocsigen.org/js_of_ocaml/&quot;&gt;&lt;code&gt;js_of_ocaml&lt;/code&gt;&lt;/a&gt;, we wanted 
people to create and run the &lt;a href=&quot;http://en.wikipedia.org/wiki/Monty_Hall_problem&quot;&gt;Monty Hall problem&lt;/a&gt; in their 
browser.  This would give people a taste of some real world interaction by 
having to deal with the DOM and interfaces.  If folks did well, they could 
add code to keep logs of the game results.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;em&gt;Client-server game&lt;/em&gt; - The previous game was all in the browser (so could 
be examined by players) so here the task was to split it into a client and 
server, ensuring the two stay in sync.  This would demonstrate the 
re-usability of the OCaml code already written and give people a feel for 
client server interactions. If people wanted to do more, they could use 
&lt;a href=&quot;http://opam.ocaml.org/pkg/ctypes/0.1.1/&quot;&gt;ctypes&lt;/a&gt; and get better random numbers.  &lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;We did manage to stick to the overall scheme as above and we think this is a 
great base from which to improve future tutorials.  It has the really nice 
benefit of having visual, interactive elements and the ability to run things 
both in the browser as well as on the server is a great way to show the 
versatility of OCaml.  &lt;code&gt;js_of_ocaml&lt;/code&gt; is quite a mature tool and so it&amp;rsquo;s 
no surprise that it&amp;rsquo;s also used by companies such as Facebook (see the recent 
&lt;a href=&quot;http://www.youtube.com/watch?v=gKWNjFagR9k&quot;&gt;CUFP talk by Julien Verlaguet&lt;/a&gt; - skip to &lt;a href=&quot;http://www.youtube.com/watch?feature=player_detailpage&amp;amp;v=gKWNjFagR9k#t=1149&quot;&gt;19:00&lt;/a&gt;).  &lt;/p&gt;

&lt;p&gt;We learned a lot from running this session so we&amp;rsquo;ve captured the good, the 
bad and the ugly below.  This is useful for anyone who&amp;rsquo;d like to run an 
OCaml tutorial in the future and also for us to be aware of the next 
time we do this.  I&amp;rsquo;ve incorporated the feedback from the attendees as well 
as our own thoughts.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/fpdays2013/fpdays2013-03.jpg&quot; alt=&quot;Heads down and hands on&quot;/&gt;&lt;/p&gt;

&lt;h3&gt;Things we learnt&lt;/h3&gt;

&lt;h4&gt;The Good&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Most people really did follow the install instructions beforehand. This 
made things so much easier on the day as we didn&amp;rsquo;t have to worry about 
compile times and people getting bored.  A few people had even got in touch 
with me the night before to sort out installation problems.  &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Many folks from OCaml Labs also came over to help people, which meant 
no-one was waiting longer than around 10 seconds before getting help.  &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;We had a good plan of the things we wanted to cover but we were happy to 
be flexible and made it clear the aim was to get right into it.  Several 
folks told us that they really appreciated this loose (as opposed to rigid) 
structure.  &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;We didn&amp;rsquo;t spend any time lecturing the room but instead got people right 
into the code.  Having enough of a skeleton to get something interesting 
working was a big plus in this regard. People did progress from the early 
examples to the later ones fairly well.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;We had a VM with the correct set up that we could log people into if they 
were having trouble locally.  Two people made use of this.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Of course, It was great to have early proofs of the book and these were 
well-received.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/fpdays2013/fpdays2013-02.jpg&quot; alt=&quot;RWO books galore!&quot;/&gt;&lt;/p&gt;

&lt;h4&gt;The Bad&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;In our excitement to get right into the exercises, we didn&amp;rsquo;t really give 
an overview of OCaml and its benefits.  A few minutes at the beginning would 
be enough and it&amp;rsquo;s important so that people can leave with a few sound-bites.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Not everyone received my email about installation, and certainly not the 
late arrivals.  This meant some pain getting things downloaded and running 
especially due to the wifi (see &amp;lsquo;Ugly&amp;rsquo; below).  &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;A few of the people who &lt;em&gt;had&lt;/em&gt; installed, didn&amp;rsquo;t complete the instructions 
fully but didn&amp;rsquo;t realise this until the morning of the session.  There was a good 
suggestion about having some kind of test to run that would check 
everything, so you&amp;rsquo;d know if there was something missing.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;We really should have had a cut-off where we told people to use VMs 
instead of fixing installation issues and 10-15 minutes would have been 
enough.  This would have been especially useful for the late-comers.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;We didn&amp;rsquo;t really keep a record of the problems folks were having so we 
can&amp;rsquo;t now go back and fix underlying issues.  To be fair, this would have 
been a little awkward to do ad-hoc but in hindsight, it&amp;rsquo;s a good thing to 
plan for.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;The Ugly&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;The only ugly part was the wifi.  It turned out that the room itself was a 
bit of a dead-spot and that wasn&amp;rsquo;t helped by 30ish devices trying to connect 
to one access point!  Having everyone grab packages at the same time in the 
morning probably didn&amp;rsquo;t help.  It was especially tricky as all our 
mitigation plans seemed to revolve around at least having local connectivity.
In any case, this problem only lasted for the morning session and was a 
little better by the afternoon.  I&amp;rsquo;d definitely recommend a backup plan in 
the case of complete wifi failure next time!  One such plan that Leo got 
started on was to put the repository and other information onto a flash 
drive that could be shared with people.  We didn&amp;rsquo;t need this in the end but 
it&amp;rsquo;ll be useful to have something like this prepared for next time.  If 
anyone fancies donating a bunch of flash drives, I&amp;rsquo;ll happily receive them!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Overall, it was a great session and everyone left happy, having completed 
most of the tutorial (and with a book!).  A few even continued at home 
afterwards and &lt;a href=&quot;https://twitter.com/richardclegg/status/393458073052139520&quot;&gt;got in touch&lt;/a&gt; to let us know that they got 
everything working.
It was a great session and thanks to &lt;a href=&quot;https://twitter.com/MarkDalgarno&quot;&gt;Mark&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/JacquiDDavidson&quot;&gt;Jacqui&lt;/a&gt; and the rest of 
the FPDays crew for a great conference!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/fpdays2013/fpdays2013-04.jpg&quot; alt=&quot;RWO Book giveaway&quot;/&gt;&lt;/p&gt;

&lt;p&gt;(Thanks to Jeremy, Leo, David and Philippe for contributions to this post)&lt;/p&gt;

</content><id>http://amirchaudhry.com/fpdays-review</id><title type="text">Review of the OCaml FPDays tutorial</title><updated>2013-10-28T12:30:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://amirchaudhry.com/fpdays-ocaml-session" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;p&gt;On Thursday, along with &lt;a href=&quot;https://github.com/yallop&quot;&gt;Jeremy&lt;/a&gt; and 
&lt;a href=&quot;http://www.lpw25.net&quot;&gt;Leo&lt;/a&gt;, I&amp;rsquo;ll be running an OCaml Hands-on Session at 
the &lt;a href=&quot;http://fpdays.net/2013/&quot;&gt;FPDays conference&lt;/a&gt;. Below are some prep 
instructions for attendees.&lt;/p&gt;

&lt;h3&gt;Preparation for the session&lt;/h3&gt;

&lt;p&gt;If you&amp;rsquo;re starting from scratch, installation can take some time so it&amp;rsquo;s 
best to get as much done in advance as possible.  You&amp;rsquo;ll need OPAM (the 
package manager), OCaml 4.01 (available through OPAM) and a few libraries 
before Thursday.  If you have any issues, please contact Amir.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;OPAM&lt;/strong&gt;: Follow the instructions for your platform at &lt;a href=&quot;http://opam.ocaml.org/doc/Quick_Install.html&quot;&gt;http://opam.ocaml.org/doc/Quick_Install.html&lt;/a&gt;. 
OPAM requires OCaml so hopefully the relevant dependencies will kick in and 
you&amp;rsquo;ll get OCaml too (most likely version 3.12).  You can get a cup of 
coffee while you wait. After installation, run &lt;code&gt;opam init&lt;/code&gt; to initialise OPAM.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;OCaml 4.01&lt;/strong&gt;: We actually need the latest version of OCaml but OPAM 
makes this easy.  Just run the following (and get more coffee):&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam update
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam switch 4.01.0
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;opam config env&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Libraries&lt;/strong&gt;: For the workshop you will need to check that you have the 
following installed: &lt;code&gt;libffi&lt;/code&gt;, &lt;code&gt;pcre&lt;/code&gt; and &lt;code&gt;pkg-config&lt;/code&gt;.  This will depend on 
your platform so on a Mac with homebrew I would do 
&lt;code&gt;brew install libffi pcre pkg-config&lt;/code&gt; or on Debian or Ubuntu 
&lt;code&gt;apt-get install libffi-dev&lt;/code&gt;.  After this, two OCaml packages it&amp;rsquo;s worth 
installing in advance are &lt;code&gt;core&lt;/code&gt; and &lt;code&gt;js_of_ocaml&lt;/code&gt; so simply run:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam install core js_of_ocaml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;OPAM will take care of the dependencies and the rest we can get on the day!&lt;/p&gt;
</content><id>http://amirchaudhry.com/fpdays-ocaml-session</id><title type="text">FP Days OCaml Session</title><updated>2013-10-22T21:00:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://anil.recoil.org/2013/10/08/fpdays-real-world-ocaml.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://fpdays.net/fpdays2013/sessions/index.php?session=24&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/fpdays-logo-thumb.jpg&quot; style=&quot;padding-left: 15px; float:right;&quot; width=&quot;200&quot;/&gt;&lt;/a&gt;
Yaron Minsky and I have been running OCaml tutorials for a few years at
&lt;a href=&quot;http://icfpconference.org&quot;&gt;ICFP&lt;/a&gt; and &lt;a href=&quot;http://cufp.org&quot;&gt;CUFP&lt;/a&gt;, but haven&amp;rsquo;t
really spread out into the wider conference circuit.  Now that &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World
OCaml&lt;/a&gt; is almost finished, the scene is set for
doing much more.  The first such tutorial is being help at &lt;a href=&quot;http://fpdays.net/fpdays2013/&quot;&gt;FPDays
2013&lt;/a&gt; on October 24th in the lovely Murray
Edwards College in Cambridge.  Check out the &lt;a href=&quot;http://lanyrd.com/2013/fpdays/&quot;&gt;Lanyrd
page&lt;/a&gt; for ticket information, and the &lt;a href=&quot;http://lanyrd.com/2013/fpdays/sckzky/&quot;&gt;OCaml
session&lt;/a&gt; page for more information.&lt;/p&gt;

&lt;p&gt;The basic layout of the tutorial is to get started with the guided tour of the
&lt;a href=&quot;https://realworldocaml.org&quot;&gt;book&lt;/a&gt;, and then work through building a
&lt;a href=&quot;https://bitbucket.org/yminsky/core-hello-world&quot;&gt;distributed message broker&lt;/a&gt;.
This gets you familiar with the &lt;a href=&quot;https://github.com/janestreet/core&quot;&gt;Core&lt;/a&gt;
standard library, the &lt;a href=&quot;https://github.com/janestreet/async&quot;&gt;Async&lt;/a&gt; event-driven
I/O library, and all the strongly-typed RPC plumbing that goes in between.
We&amp;rsquo;re hoping to have physical preprints of the book available for free to
attendees, so do sign up fast if you wish to attend.&lt;/p&gt;

&lt;p&gt;As a bonus, the Cambridge FPDays session will feature Jeremy Yallop working through
the book and conducting the tutorial: he has an incredible depth of knowledge
about the innards of OCaml&amp;rsquo;s type system, and so advanced users will also find
a good home in this tutorial to throw questions at him too!  For those of you
interested in other programming languages, there are also excellent-looking
sessions on Erlang, F# and Scala, and Phil Wadler is giving a keynote speech.
I&amp;rsquo;m most excited about &lt;a href=&quot;http://fpdays.net/fpdays2013/sessions/index.php?session=28&quot;&gt;Sam Aaron&amp;rsquo;s session&lt;/a&gt;
on live coding and music though.  You have to hear it to believe it&amp;hellip;&lt;/p&gt;
</content><id>http://anil.recoil.org/2013/10/08/fpdays-real-world-ocaml.html</id><title type="text">FPDays 2013 Real World OCaml tutorial in Cambridge</title><updated>2013-10-08T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://anil.recoil.org/2013/10/06/travis-secure-ssh-integration.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://travis-ci.org&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/travis-mascot-200px.png&quot; style=&quot;padding-left: 15px; float:right;&quot;/&gt;&lt;/a&gt;
In my &lt;a href=&quot;http://anil.recoil.org/2013/09/30/travis-and-ocaml.html&quot;&gt;previous post&lt;/a&gt;
on Travis, I explained how it can be used to easily test OCaml packages on
GitHub without having to host any infrastructure yourself.&lt;/p&gt;

&lt;p&gt;The next step I wanted to investigate was how to use Travis to trigger service deployments
after a successful build.  One nice feature that Travis has is &lt;a href=&quot;http://about.travis-ci.org/docs/user/encryption-keys/&quot;&gt;support for
encrypted environment variables&lt;/a&gt;. The basic workflow is that you encrypt
key/value pairs using a public key that they publish per GitHub repository.
Once registered, this is made available as a decrypted environment variable
within the Travis worker.  You can use this to transmit API keys or other
authentication data that you need to commit to the &lt;code&gt;travis.yml&lt;/code&gt; file, but
obviously can&amp;rsquo;t leave on a public repository for the world to see.&lt;/p&gt;

&lt;p&gt;The small hitch with this whole scheme is that there&amp;rsquo;s a very small limit
of about 90 bytes or so for the size of each individual environment variable
that&amp;rsquo;s exported, and so you can&amp;rsquo;t just stash an SSH private key in there.
Instead, it needs to be Base64 encoded, split it up into multiple environment
variables of the right size, and then reassembled within the Travis VM.  Rather
than deal with importable shell scripts between MacOS X and Linux, I created
a small &lt;code&gt;travis-senv&lt;/code&gt; command-line binary to make this easier.&lt;/p&gt;

&lt;p&gt;To use it, just &lt;code&gt;opam install travis-senv&lt;/code&gt; and follow the instructions on the
&lt;a href=&quot;https://github.com/avsm/travis-senv&quot;&gt;README at the homepage&lt;/a&gt;.  Here&amp;rsquo;s the
fragment of shell script that pushes the build output to another GitHub
repository:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$DEPLOY&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# get the secure key out for deployment&lt;/span&gt;
  opam install travis-senv
  mkdir -p ~/.ssh
  &lt;span class=&quot;nv&quot;&gt;SSH_DEPLOY_KEY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;~/.ssh/id_dsa
  travis-senv decrypt &amp;gt; &lt;span class=&quot;nv&quot;&gt;$SSH_DEPLOY_KEY&lt;/span&gt;
  chmod &lt;span class=&quot;m&quot;&gt;600&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$SSH_DEPLOY_KEY&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Host mirdeploy github.com&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;   Hostname github.com&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;   StrictHostKeyChecking no&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;   CheckHostIP no&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;   UserKnownHostsFile=/dev/null&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  git config --global user.email &lt;span class=&quot;s2&quot;&gt;&amp;quot;travis@openmirage.org&amp;quot;&lt;/span&gt;
  git config --global user.name &lt;span class=&quot;s2&quot;&gt;&amp;quot;Travis the Build Bot&amp;quot;&lt;/span&gt;
  git clone git@mirdeploy:mirage/mirage-www-deployment
  &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;mirage-www-deployment
  mkdir -p xen/&lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;
  cp ../src/mir-www.xen ../src/mir-www.map ../src/www.conf xen/&lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;
  bzip2 -9 xen/&lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;/mir-www.xen
  git pull --rebase
  git add xen/&lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;
  git commit -m &lt;span class=&quot;s2&quot;&gt;&amp;quot;adding $TRAVIS_COMMIT&amp;quot;&lt;/span&gt;
  git push
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I&amp;rsquo;ve been using this to automate the construction of the &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage Xen unikernel&lt;/a&gt;
homepage.  Every time there&amp;rsquo;s a push to the
&lt;a href=&quot;https://github.com/mirage/mirage-www&quot;&gt;mirage-www&lt;/a&gt;, the &lt;a href=&quot;https://github.com/mirage/mirage-www/blob/master/.travis-ci.sh&quot;&gt;Travis
scripts&lt;/a&gt; now
retrieve an SSH deployment key using &lt;code&gt;travis-senv&lt;/code&gt;, and push the results of the
build to the
&lt;a href=&quot;https://github.com/mirage/mirage-www-deployment&quot;&gt;mirage-www-deployment&lt;/a&gt;
repository that stores the build output.  This repository is polled by the
hosting machines we have to look for new kernels and rotate the website (but
more on this later &amp;ndash; I&amp;rsquo;m just integrating the EC2 and Rackspace scripts to
remove this step entirely next!)&lt;/p&gt;
</content><id>http://anil.recoil.org/2013/10/06/travis-secure-ssh-integration.html</id><title type="text">Using Travis for secure deployments with SSH</title><updated>2013-10-06T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://anil.recoil.org/2013/10/03/merlin-and-vim.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://anil.recoil.org/images/vim-merlin-autocomplete.png&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/vim-merlin-autocomplete-thumb.png&quot; style=&quot;float: right; padding-left: 15px;&quot; width=&quot;250&quot;/&gt;&lt;/a&gt;
I&amp;rsquo;m finalizing the installation instructions for &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; and
finally got around to configuring the awesome &lt;a href=&quot;https://github.com/def-lkb/merlin&quot;&gt;Merlin editor&lt;/a&gt; tool.  I pretty much never configure
my editor, so here are my notes on getting Merlin working with Vim completely from scratch on
MacOS X (I&amp;rsquo;m on 10.9DP7, but this should work with earlier versions of MacOS X too).&lt;/p&gt;

&lt;p&gt;First, install some basic plugin tools by following the Synastic &lt;a href=&quot;https://github.com/scrooloose/syntastic&quot;&gt;installation instructions&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Install &lt;a href=&quot;https://github.com/tpope/vim-pathogen&quot;&gt;vim-pathogen&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;mkdir -p ~/.vim/autoload ~/.vim/bundle&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
curl -so ~/.vim/autoload/pathogen.vim &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
https://raw.github.com/tpope/vim-pathogen/master/autoload/pathogen.vim&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Install &lt;a href=&quot;https://github.com/tpope/vim-sensible.git&quot;&gt;vim-sensible&lt;/a&gt; for useful defaults:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/.vim/bundle
git clone git://github.com/tpope/vim-sensible.git&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Install &lt;a href=&quot;https://github.com/scrooloose/syntastic&quot;&gt;Syntastic&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/.vim/bundle
git clone https://github.com/scrooloose/syntastic.git&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Follow the &lt;a href=&quot;https://github.com/def-lkb/merlin/wiki/vim-from-scratch&quot;&gt;Merlin/vim from scratch&lt;/a&gt; directions:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;opam install merlin&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Finally, add this this in your &lt;code&gt;~/.vimrc&lt;/code&gt; to turn everything on.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-vim&quot; data-lang=&quot;vim&quot;&gt;execute pathogen#infect&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;s&lt;/span&gt;:ocamlmerlin&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;substitute&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;system&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'opam config var share'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'\n$'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; .  &lt;span class=&quot;s2&quot;&gt;&amp;quot;/ocamlmerlin&amp;quot;&lt;/span&gt;
execute &lt;span class=&quot;s2&quot;&gt;&amp;quot;set rtp+=&amp;quot;&lt;/span&gt;.&lt;span class=&quot;k&quot;&gt;s&lt;/span&gt;:ocamlmerlin.&lt;span class=&quot;s2&quot;&gt;&amp;quot;/vim&amp;quot;&lt;/span&gt;
execute &lt;span class=&quot;s2&quot;&gt;&amp;quot;set rtp+=&amp;quot;&lt;/span&gt;.&lt;span class=&quot;k&quot;&gt;s&lt;/span&gt;:ocamlmerlin.&lt;span class=&quot;s2&quot;&gt;&amp;quot;/vimbufsync&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Trying it out&lt;/h2&gt;

&lt;p&gt;Read the excellent instructions at the &lt;a href=&quot;https://github.com/def-lkb/merlin/wiki/vim-from-scratch&quot;&gt;Merlin for Vim from scratch&lt;/a&gt; wiki page.  A few immediately useful things I did are below.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Displaying types:&lt;/em&gt; You can get the local type of something by typing in &lt;code&gt;\t&lt;/code&gt; anywhere.  This is the &lt;code&gt;&amp;lt;LocalLeader&amp;gt;&lt;/code&gt; for anyone who has customized their setup (it is mapped to backslash by default).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Tab completing functions:&lt;/em&gt; You can tab-complete module signatures by pressing &lt;code&gt;Ctrl-X-O&lt;/code&gt; (make sure you keep Ctrl pressed the whole time).  This activates vim&amp;rsquo;s OmniComplete mode.  To get this to work with your external projects, create a &lt;code&gt;.merlin&lt;/code&gt; file.  I use this for &lt;a href=&quot;https://github.com/mirage/ocaml-dns&quot;&gt;ocaml-dns&lt;/a&gt; for example.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;PKG lwt cstruct
S lib
S lib_test
S lwt
B _build/lib
B _build/lib_test
B _build/lwt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Also, don&amp;rsquo;t forget to pass the &lt;code&gt;-bin-annot&lt;/code&gt; function to the compiler to
generate the typed-AST &lt;code&gt;cmt&lt;/code&gt; files.  You can add &lt;code&gt;true: bin_annot&lt;/code&gt; to your
&lt;code&gt;_tags&lt;/code&gt; file if you&amp;rsquo;re using OCamlbuild (in OCaml 4.01.0 or higher, and
it&amp;rsquo;ll be silently ignored on previous versions so you don&amp;rsquo;t need to worry
about breaking older OCaml compilers).&lt;/p&gt;

</content><id>http://anil.recoil.org/2013/10/03/merlin-and-vim.html</id><title type="text">Intellisense for OCaml with Vim and Merlin</title><updated>2013-10-03T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://www.syslog.cl.cam.ac.uk/2013/10/02/liveblogging-the-first-human-data-interaction-workshop/" rel="alternate"/><contributor><uri>http://www.syslog.cl.cam.ac.uk/tag/ocamllabs/feed/atom</uri><name>SRG Syslog</name></contributor><content type="html">&lt;p&gt;I'm at the Open Data institute, with Richard Mortier, Jon Crowcroft, Amir Chaudhry and Hamed Haddadi , live-blogging a daylong workshop about our emerging Human-Data Interaction research initiative. &amp;nbsp;The room is packed with notable researchers from all over the UK, so this promises to be an exciting day!&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Mort opens up with an introduction to the format of the workshop and lays out the problem space:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Visualisation and sense making:&lt;/strong&gt; how do we make sense of such complex, technical systems, and crucially, what is the process of translating the information to&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Transparency and audit:&lt;/strong&gt; is essential to give a feedback loop to users&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Privacy and control:&amp;nbsp;&lt;/strong&gt;...&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Analytics and commerce:&lt;/strong&gt; there is clearly an ecosystem forming around personal data (c.f. several startups specifically around this&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Data to knowledge:&lt;/strong&gt; what are the new business models around&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Attendee introductions&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Danielle&amp;nbsp;&lt;/strong&gt;(missed her last name, is from Switzerland): did a PhD on anomaly detection and then worked at Swiss banks on security monitoring. The key challenges in the area are around the nature of the questions we need to ask about all the data that we have access to.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Steve Brewer:&lt;/strong&gt; coordinator of the IT as a Utility network which is funding all this. &amp;nbsp;Interested in the next steps: both immediate and the overall vision and direction it's all going. &amp;nbsp;Concrete actions emphasised.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ian Brown:&lt;/strong&gt; Oxford University and cybersecurity. Interested broadly in these issues and also has a degree in psychology and behavioural psychology. &amp;nbsp;The challenge is how to balance the &amp;quot;engineering&amp;quot; (this isnt fundamental computer science) and understand why there is so little takeup of this.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Amir Chaudhry:&lt;/strong&gt; working on a toolstack for the Internet of Things. &amp;nbsp;When we have tweeting toasters, how do we make it all useful to people. It's not the raw data, but the insights we present back to people to make it useful.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elizabeth Churchill:&lt;/strong&gt; was at Yahoo, now at eBay Research. &amp;nbsp;Right now the challenge I'm facing is personalisation, and is trying to understand why the models they have of people are rubbush (this is why so much advertising isnt very useful). &amp;nbsp;The reasoning processes and data &lt;em&gt;quality&lt;/em&gt; is important. &amp;nbsp;We are making assertions about people based on data they have gathered for another purpose, and the ethical and business issues are important. Has been pushing on : what the data source, what is the data quality, and are these assertions based off data thats appropriate, and how can we design new algorithms&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jon Crowcroft:&lt;/strong&gt; from the Computer Lab in Cambridge and does anything to do with communication systems, and leads the Horizon project with Mort and PAWS which is working on wifi access in disadvantaged areas. Also working on Nymote. &amp;nbsp;Is interested in new human/data rights vs t&amp;amp;cs. &amp;nbsp;Rights and duties are encoded in terms and conditions (badly) -- see Latier's latest book about this, and see how poor Amazon's recommendations are. &amp;nbsp;We're interested in building a technology where you own your own data but business practises all gel together. &amp;nbsp;We had a workshop at how the EU is pushing the right to be forgotten, so how can we ensure that data can be removed including all references. &amp;nbsp;People go &amp;quot;its too difficult&amp;quot;, but this isn't true -- takedowns work, and why is it that only big corporations can afford to take down stuff. &amp;nbsp;The right to oblivion (&amp;quot;not be there in the first place&amp;quot;) and data shouldn't be a public good but people should have the right to be in a paid avoidance zones. (See Shockwave Rider by Brunner, 30 years old, loads of great technical ideas, and Future Shock is a good read too). &amp;nbsp;Can we shift regulatory positions and have&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Thomas Dedis:&lt;/strong&gt; runs Fab Lab in Barcelona. &amp;nbsp;Cofounder of Smart Citizen, crowdfunded environment sensing platform based on a piece of hardware based on Arduino. &amp;nbsp;Allows people to capture data in their own homes, and push it to an online platform. &amp;nbsp;Allows people to push it in a 'conscious' way? Go to smartcitizen.me to see the data platform. &amp;nbsp;Intended to grow into other places, but capturing air pollution, humidity, temperature and other environment data. &amp;nbsp;Main thing is that you own your own data. &amp;nbsp;Much cheaper than the competition too and crowdfunding.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Martin Dittus&lt;/strong&gt; (@dekstop) is a PhD student at UCL and works on cities.io. Thousands of people mapping the planet in incredibly detailed ways and it works with both commercial and non-commercial stuff. What makes these systems work, what are the processes to coordinate things, questions of data quality and how to assert stuff over it? &amp;nbsp;Used to be part of the last.fm data team which is about personal data gathering and detailed profiling that users themselves put up.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Christos Efstratiou:&lt;/strong&gt; as of September is a lecturer at University of Kent (and is still a visiting research at Cambridge). &amp;nbsp;Works on sensing, more broadly that has to do with people and sensors in the environment and embedded sensing in the environment. &amp;nbsp;Privacy is a huge issue and is his key challenge. &amp;nbsp;This isn't sensing in the old style like Active Badge -- back then, people werent aware of the issues and nowadays, people are more aware of privacy. &amp;nbsp;So the challenge is the evolving user perceptions and how our system design works. &amp;nbsp;Anecdote: at a recent wedding he was at, there was a request from the &amp;nbsp;bride/groom to note post any public photos to Twitter/Facebook. We've lost control over our public personas.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Julie Freeman:&lt;/strong&gt; an actual resident in this building and the art associate for the ODI space! &amp;nbsp;Is a PhD student at QMW and is interested in echoing other people. &amp;nbsp;Interested in physical manifestations of digital data, and how we can &amp;quot;step away from the screen&amp;quot;. &amp;nbsp;Broad interests in transformation of digital data.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Barbara Grimpe:&lt;/strong&gt; from Oxford and is a sociologist in an interdisciplinary EU project on &amp;quot;Governance for Responsible Innovation&amp;quot;. &amp;nbsp;They have a network notion of responsibility which takes into account that a lot of data production and data use takes place in networks that posses strong ties between people. &amp;nbsp;She started two cases studies in two area: telecare technologies for elderly people (relevant due to the EU Horizon 2020 societal challenge in aging and wellbeing due to the demographic change in western societies, and this brings the ethical issue around the use of personal data at scale); there is difficulty of informed consent due to dementia also. The other case study is completely different and is about financial market technology and the data is highly commercially sensitive, so understanding how transparency can be balanced against financial control and the need for genuine market secrets to facilitate trade.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wifak Gueddana&lt;/strong&gt; is a postdoc at information systems group at LSE. &amp;nbsp;Did her PhD on open source communities and how open source can work for NGOs and grass roots. &amp;nbsp;Working on a research project for online platforms -- how to use computational analytics to collect and process data and deal with the qualitative and subjective issues.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hamed Haddadi:&lt;/strong&gt; lecturer in QMUL, asking how we can compute over mobile data and has worked on advertising and privacy aware system systems. &amp;nbsp;Linking the temporal nature of the data and understanding how much of your data is exposed (amusing anecdote about wearing shorts)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Muki Haklay:&lt;/strong&gt; professor of GIScience and the Extreme Citizen Science group. He's interested in participatory citizen science and cyberscience. &amp;nbsp;Interested in GeoWeb and mobiile GeoWeb technologies and understanding how tools for voluntary participation work (open street map, participatory geoweb). &amp;nbsp;&amp;quot;How can you give control to people that are not technical&amp;quot; and how do we build protocols for cultural sensitivity? &amp;nbsp;Working on Open Street Map, while its easy for techies to contribute and feel happy, it might be an issue from a privacy perspective without GPS fuzzing or pseudonyms (you can say &amp;quot;I know where you live&amp;quot; to every OSM user). (discussion about most data being rubbish and is a psychology question about whether this depresses people!)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jenny Harding:&lt;/strong&gt; from the Ordnance Survey who control most of the UK's mapping data and is a principal scientist in the research team team on working on how people interact with geography in business, public service and leisure. &amp;nbsp;Moving beyond just GPS into the connective function about what's going on in places, and the connection between different objects and places. &amp;nbsp;What is the purpose for needing all this connected information, and how can the Ordnance Survey better serve its users with such &lt;em&gt;usable&lt;/em&gt;&amp;nbsp;connected data? &amp;nbsp;She commissions internal and external research and this includes PhDs and postdocs. &amp;nbsp;Challenge for this workshop: how personal data relates to location and the different levels of granularity at which such relationships can be made -- beyond GPS, there is address data in (e.g.) supermarket loyalty cards, and other data at a postcode level, and different types of geographies all have connections. &amp;nbsp;Understanding provenance of data is really really important .&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pat Healey:&amp;nbsp;&lt;/strong&gt;Professor of Human Interaction and head of cognitive science research group and workson health issues. &amp;nbsp;Not here yet so introduced by Hamed.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Tristan Henderson;&amp;nbsp;&lt;/strong&gt;lecturer in compsci at St Andrews in Scotland, did his PhD on first person shooter games and runs a widely used mobile data set called CRAWDAD. They archive and share it and so work a lot on redistribution of data. His undergrad was economics so his interest is on behavioural aspects and usability issues too (Tristan has recently joined the HCI group and the ethics committee at St Andrews). &amp;nbsp;How can we get researchers to further engage with the ethics process and to refine the notions of informed consent in electronic terms. &amp;nbsp;Challenges: what is acceptable HDI and are we conducting it in an acceptable way (q from Mort: how broad? a: everything). &amp;nbsp;And is HDI unique enough that we might need another term.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Laura James:&amp;nbsp;&lt;/strong&gt;from OKF (not here yet)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Helene&amp;nbsp;Lambrix:&amp;nbsp;&lt;/strong&gt;visiting LSE and usually at Paris-Dauphine University in France and is hoping to finish her PhD this year! Interested in corporate reputation and social media.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Neal Lathia:&amp;nbsp;&lt;/strong&gt;researcher at Cambridge University and did his PhD on online recommender systems. Noticed a disparity between data services online and the offline word so started working on recommender systems for urban systems (banging head against TFL data). &amp;nbsp;At Cambridge, started working with psychologists and leads EmotionSense (how satisfied are you with your life, as well as ongoing smartphone sensor data) -- its really popular. &amp;nbsp;Challenges: language issue around how we present issue and motivate people around using that data (how does using EmotionSense affect their behavior)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Panos&lt;/strong&gt; from Brunel: interested in cybersecurity and intelligence from media data mining and cloud based work. Commodification process of digital economy data and what is the legal frameowork surrounding this. &amp;nbsp;What are the personas for data to apply frameworks and data mining techniques to it? &amp;nbsp;Challenges: regulatory system using big personal data.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Eva&lt;/strong&gt; from University of Nottingham and has just submitted PhD and waiting viva. Background is political science and internationl relations, and is interested in informed consent and how we sustain consent rather than just secure it as a one-off. The challenges: the human bit and how we communicate the complexity of systems and how people can make meaningful decisions. If you want people to be engaged with process then we need data to be more social and human.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ursula Martin&lt;/strong&gt;: professor in a Russel Group university in Mile End road. Is a mathematician and is researching the production of mathematics, and how it happens in the first place. Producing maths is a slow, painstaking thing, and is wondering how the rate of production can keep up with our needs. When interacting with an outfit getting her data, she's not just an isolate, but is actually part of a large complex system.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Richard Mortier &amp;quot;mort&amp;quot;&lt;/strong&gt;: From Nottingham and is the dude running this workshop so has introed before!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nora Ni Loideain:&amp;nbsp;&lt;/strong&gt;doing a PhD in the european data protection and this requires the mandatory retention of data by telecomms provider. References recent US events cf Snowden and her PhD is on privacy oversight and the guards (or lack thereof) in current frameworks. &amp;nbsp;Challenges: how can we build these safeguards and what is the nature of informed consent with these.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ernima Ochu:&amp;nbsp;&lt;/strong&gt;based in Manchester. Sometimes an activist, sometimes a writer, sometimes an artist. Background in neuroscience! &amp;nbsp;The social life of data and what happens around it, and how people get around based on it.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Yvonne Rogers&lt;/strong&gt; and is from team UCL and is director of UCLIC (Interaction Center) and also an Intel-funded institute at UCL where they work on connected data. &amp;nbsp;Given lots of data from sources, interested in how people can engage with it and how to visualise . (Hamed: &amp;quot;Human City Interaction is the next thing!&amp;quot;)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Geetanjali Sampemane;&lt;/strong&gt;&amp;nbsp;background in Computer Science, and works at Google on Infrastructure Security and Privacy group. &amp;nbsp;Challenge is how to help people calibrate the benefits and risks for appropriate tradeoffs. &amp;nbsp;How can humans make an informed choice, and this isn't based on informed choice. &amp;nbsp;Giving people buttons and options isn't the most useful way to approach this, and we need a mental model similar to how we judge risks in the physical world. &amp;nbsp;In the online world, noone understands how dangerous it is to reuse passwords. Security people have made is a little worse by telling people to use complicated passwords, but brute force isn't the big problem right now, it's the connectivity of services.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Cerys Willoughby:&amp;nbsp;&lt;/strong&gt;Southhampton and looking at the usability of notebooks and wondering how to make the interfaces usable without being a technological guru. (missed rest due to reading cool comic she projected about her work. Sorry!)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Eiko Yoneki&lt;/strong&gt;: from Cambridge, and she works on digital epidemiology and real world mobility data collection in Africa (e.g. EipPhone). &amp;nbsp;She analyses network structure to understand graphs and connectivity. &amp;nbsp;Also works on CDNs and builds self-adaptive CDNs, and works on graph-specific data parallel algorithms.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jonathan Cave:&amp;nbsp;&lt;/strong&gt;game theorist (Yale, Cambridge, Stanford) and worked in a lot of government/academia/research areas. Works on economics and IoT (festival of things and the boundaries of humanity is coming up soon in Cambridge on 29th October). &amp;nbsp;Fascinating anecdote about price of sick animals&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;George Danezis:&lt;/strong&gt; formerly MSR now UCL, and is interested in technical security aspects of how to glue together distributed mobile devices and not leave our personal data unreadable. &amp;nbsp;Has done work on privacy friendly statistics and how we can process and analyse it as an aggregate data set. Has worked in the context of smart metering in Europe.&lt;/p&gt;
&lt;h2&gt;Breakout sessions&lt;/h2&gt;
&lt;p&gt;We then had breakout sessions to brainstorm the challenges in this area (lots of post it notes and arguments), and Amir Chaudhry has summarised the results of the 5 presentations here:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Disambiguating data.&lt;/strong&gt; For example from the home and organisations. This isn't a new problem but becomes more important the more data collection occurs using different sources. &amp;nbsp;Who are the principles in terms of onwership and provenance? &amp;nbsp;How do we deal with communities/groups &amp;nbsp;and data control?&lt;/p&gt;
&lt;p&gt;Why not try crowd sourcing mechanisms for people to use so that they can improve the use of sites like Ryanair (who deliberately obfuscate things). &amp;nbsp;Changing mindset from consumer perspective to a producer perspective. &amp;nbsp;i.e humans make data and perhaps can provide this to others for economic benefits.&lt;/p&gt;
&lt;p&gt;We have data and different notions of data quality. &amp;nbsp;It's not always the case that the most scientific data is the best, depending on how it's used. &amp;nbsp;We have Collectivist notions of data culture: e.g this conversation right now in the room isn't just individual, it's all of us so we can't ascribe it to individuals. Then there are Network notions, based on transactions that use a reductionist view to decide what they're worth. &amp;nbsp;Can think of these on a continuum and the research challenge is how well do different ends of above scale in producing data and making value. &amp;nbsp;Interesting question is if people opt out (right to forget or right to oblivion), then the data that is left is flawed.&lt;/p&gt;
&lt;p&gt;We need to examine current assumptions and values around data. &amp;nbsp;What is the unit of analysis? Must be clearer on this. Where and when we look at what data also matters as well as global aggregation. &amp;nbsp;Sometimes also want to look at trajectories and data flows and how this changes over time. &amp;nbsp;How do we interact with this data. &amp;nbsp;Do users interact with data directly or with something that sits in front of it? &amp;nbsp;There's an interaction between data science and the creative process of presenting information in a certain way. &amp;nbsp;This depends on ultimate goal being served, for example e.g beavioural changes or just increased engagement.&lt;/p&gt;
&lt;p&gt;There are big challenges in integration of groups who want to construct humans. Groups like social sciences (think about risk), Psychological science (reputation), Data sciences (Epistomology and Ontology), Design science (Interfaces and interactions). What is the new meaning of ownership and liability? e.g who owns this collection of posters and the ideas that have come out? [Hamed and Mort clarify that it's all theirs!] &amp;nbsp;What happens if there are negative consequences as a result of using poor data?&lt;/p&gt;
&lt;p&gt;Business models are also important in order to go from studies to practice. Are there new social structures we could make to help this? &amp;nbsp;For example, we have venture capital that takes risks but what about social capital to spread risk to create new businesses e.g kickstarter and the like.&lt;/p&gt;
&lt;p&gt;What does informed consent mean? Current system puts onus on user to understand all the contractual conditions before deciding. &amp;nbsp;Perhaps there's a social-network method of crowd-sourcing opinions on ToS or providing some kind of health rating? &amp;nbsp;Perhaps data protection agencies could certify terms or maybe the EFF or non-profits can provide some kind of rating system (c.f Moody's etc?). For example from the home and organisations. This isn't a new problem but becomes more important the more data collection occurs using different sources. &amp;nbsp;Who are the principles in terms of onwership and provenance? &amp;nbsp;How do we deal with communities/groups &amp;nbsp;and data control?&lt;/p&gt;
&lt;p&gt;Why not try crowd sourcing mechanisms for people to use so that they can improve the use of sites like Ryanair (who deliberately obfuscate things). &amp;nbsp;Changing mindset from consumer perspective to a producer perspective. &amp;nbsp;i.e humans make data and perhaps can provide this to others for economic benefits.&lt;/p&gt;
&lt;p&gt;We have data and different notions of data quality. &amp;nbsp;It's not always the case that the most scientific data is the best, depending on how it's used. &amp;nbsp;We have Collectivist notions of data culture: e.g this conversation right now in the room isn't just individual, it's all of us so we can't ascribe it to individuals. Then there are Network notions, based on transactions that use a reductionist view to decide what they're worth. &amp;nbsp;Can think of these on a continuum and the research challenge is how well do different ends of above scale in producing data and making value. &amp;nbsp;Interesting question is if people opt out (right to forget or right to oblivion), then the data that is left is flawed.&lt;/p&gt;
&lt;p&gt;We need to examine current assumptions and values around data. &amp;nbsp;What is the unit of analysis? Must be clearer on this. Where and when we look at what data also matters as well as global aggregation. &amp;nbsp;Sometimes also want to look at trajectories and data flows and how this changes over time. &amp;nbsp;How do we interact with this data. &amp;nbsp;Do users interact with data directly or with something that sits in front of it? &amp;nbsp;There's an interaction between data science and the creative process of presenting information in a certain way. &amp;nbsp;This depends on ultimate goal being served, for example e.g beavioural changes or just increased engagement.&lt;/p&gt;
&lt;p&gt;There are big challenges in integration of groups who want to construct humans. Groups like social sciences (think about risk), Psychological science (reputation), Data sciences (Epistomology and Ontology), Design science (Interfaces and interactions). &amp;nbsp;What is the new meaning of ownership and liability? e.g who owns this collection of posters and the ideas that have come out? [Hamed and Mort clarify that it's all theirs!] &amp;nbsp;What happens if there are negative consequences as a result of using poor data? Business models are also important in order to go from studies to practice. Are there new social structures we could make to help this? &amp;nbsp;For example, we have venture capital that takes risks but what about social capital to spread risk to create new businesses e.g kickstarter and the like.&lt;/p&gt;
&lt;p&gt;What does informed consent mean? Current system puts onus on user to understand all the contractual conditions before deciding. &amp;nbsp;Perhaps there's a social-network method of crowd-sourcing opinions on ToS or providing some kind of health rating? &amp;nbsp;Perhaps data protection agencies could certify terms or maybe the EFF or non-profits can provide some kind of rating system (c.f Moody's etc?)&lt;/p&gt;
&lt;h2&gt;Next steps&lt;/h2&gt;
&lt;p&gt;Ian Brown took notes on our breakout session on business models for privacy:&lt;/p&gt;
&lt;p&gt;Collectives/cooperatives sharing data through PDSes&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How to incentivise membership? Dividends, social benefit (e.g. medical research)&lt;/li&gt;
&lt;li&gt;what currently exists where data controller has strong incentive not to leak/breach data e.g. Boots for brand loyalty, Apple/Facebook? So long as customer can switch effectively (portability, erasure)&lt;/li&gt;
&lt;li&gt;Power tool sharing at village level. Hang off existing structures e.g. local councils.&lt;/li&gt;
&lt;li&gt;New forms of micro-markets e.g. physical gatherings? Alternatives to currencies. Kickstarter? Distribution reduces risk of centralised architectures.&lt;/li&gt;
&lt;li&gt;What do syndicalist-anarchist models of data management look like?&lt;/li&gt;
&lt;li&gt;Current uses of data are optimising existing business practices. But what totally new practices could be enabled? Human-facing efficiencies?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What are types of biz models? Startups, personal profit, NGO, medical research, banks. Balanced investment portfolio.&lt;/p&gt;
</content><id>http://www.syslog.cl.cam.ac.uk/2013/10/02/liveblogging-the-first-human-data-interaction-workshop/</id><title type="text">Liveblogging the first Human Data Interaction workshop</title><updated>2013-10-02T09:35:08+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://anil.recoil.org/2013/09/30/travis-and-ocaml.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://travis-ci.org&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/travis-mascot-200px.png&quot; style=&quot;padding-left: 15px; float:right;&quot;/&gt;&lt;/a&gt;
A few months ago, Mike Lin posted &lt;a href=&quot;http://blog.mlin.net/2013/02/testing-ocaml-projects-on-travis-ci.html&quot;&gt;instructions&lt;/a&gt; of how to bootstrap an OCaml testing environment within the &lt;a href=&quot;http://travis-ci.org&quot;&gt;Travis&lt;/a&gt; continuous integration tool.  I finally got around to integrating his prototype scripts properly using the latest OCaml and OPAM versions during my travels last week to ICFP.  It&amp;rsquo;s been an extraordinarily quick and pleasant experience to add the (free!) Travis test runs to my OCaml programs on GitHub, so here&amp;rsquo;s how you can do it too.  &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; and I have used this for about 15 of our own projects already, and I&amp;rsquo;m switching the whole of the &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage&lt;/a&gt; repo infrastructure over to it this week.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(edit: I&amp;rsquo;ve done a followup post about &lt;a href=&quot;http://anil.recoil.org/2013/10/06/travis-secure-ssh-integration.html&quot;&gt;integrating Travis with SSH&lt;/a&gt; to make secure deployments easier.)&lt;/em&gt;&lt;/p&gt;

&lt;h2&gt;Getting started&lt;/h2&gt;

&lt;p&gt;Getting my first Travis build working with one of my OCaml projects took about 2 minutes in total:&lt;/p&gt;

&lt;p&gt;First, log into &lt;a href=&quot;http://travis-ci.com&quot;&gt;Travis&lt;/a&gt; and sign in via Twitter.  Click on the &lt;a href=&quot;https://travis-ci.org/profile&quot;&gt;Accounts&lt;/a&gt; button on the top-right and you should see a list of the all the GitHub repositories that you have access to.  Just click the &lt;i&gt;On&lt;/i&gt; switch for the one you want to start testing.  Nothing will actually happen until the next code push or pull request goes to that repository.  Behind the scenes, the &lt;i&gt;On&lt;/i&gt; button that you clicked use the GitHub APIs to turn on the Travis post-commit hook for your repository.&lt;/p&gt;

&lt;p&gt;Create a &lt;code&gt;.travis.yml&lt;/code&gt; file in your main repository (see below or &lt;a href=&quot;https://gist.github.com/avsm/6757425&quot;&gt;this gist&lt;/a&gt;).  Travis doesn&amp;rsquo;t have native support for OCaml, but it isn&amp;rsquo;t really needed since we can just use &lt;code&gt;C&lt;/code&gt; and write our own shell scripts.  The &lt;code&gt;env&lt;/code&gt; variables define a matrix of the different combinations of OCaml and OPAM that we want to test.  Just remove variations that you don&amp;rsquo;t care about to avoid wasting Travis&amp;rsquo; CPU time (open source projects are supported on a fair-use basis by them).
Here&amp;rsquo;s the &lt;code&gt;.travis.yml&lt;/code&gt; that I used for my &lt;a href=&quot;https://github.com/mirage/ocaml-uri&quot;&gt;ocaml-uri&lt;/a&gt; library: &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;l-Scalar-Plain&quot;&gt;language&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;c&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;bash -ex .travis-ci.sh&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=4.01.0 OPAM_VERSION=1.0.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=4.01.0 OPAM_VERSION=1.1.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=4.00.1 OPAM_VERSION=1.0.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=4.00.1 OPAM_VERSION=1.1.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=3.12.1 OPAM_VERSION=1.0.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=3.12.1 OPAM_VERSION=1.1.0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now you just need the &lt;code&gt;.travis-ci.sh&lt;/code&gt; shell to run the actual tests.  Travis provides an Ubuntu Precise/i386 VM that is destroyed after every test run, so we need to initialize it with the OCaml and OPAM binary packages.  Since you often want to test different versions of all of these, I created a series of stable Ubuntu PPAs that have OCaml 3.12,4.0,4.1 and OPAM 1.0 and the (currently beta) 1.1 package manager.  You can find them all on my &lt;a href=&quot;http://launchpad.net/~avsm&quot;&gt;Launchpad&lt;/a&gt; page, but the below script takes care of it all for you.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Edit this for your own project dependencies&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;OPAM_DEPENDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ocamlfind ounit re&amp;quot;&lt;/span&gt;
	 
&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$OCAML_VERSION,$OPAM_VERSION&amp;quot;&lt;/span&gt; in
3.12.1,1.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml312+opam10 &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
3.12.1,1.1.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml312+opam11 &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
4.00.1,1.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml40+opam10 &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
4.00.1,1.1.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml40+opam11 &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
4.01.0,1.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml41+opam10 &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
4.01.0,1.1.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml41+opam11 &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
*&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;Unknown &lt;span class=&quot;nv&quot;&gt;$OCAML_VERSION&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$OPAM_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;
	 
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;yes&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; sudo add-apt-repository ppa:&lt;span class=&quot;nv&quot;&gt;$ppa&lt;/span&gt;
sudo apt-get update -qq
sudo apt-get install -qq ocaml ocaml-native-compilers camlp4-extra opam
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OPAMYES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
opam init 
opam install &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OPAM_DEPENDS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;opam config env&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
make
make &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now just do a push to your repository (a commit adding the Travis files above will do), and you will soon see the Travis web interface update.  For example, here&amp;rsquo;s the &lt;a href=&quot;https://travis-ci.org/mirage/ocaml-uri/builds/11899338&quot;&gt;output of ocaml-uri&lt;/a&gt; that the above example files are for.  Of course, you should tweak the scripts to run the tests that your own project needs.  Let me know if you make any useful modifications too, by forking the &lt;a href=&quot;https://gist.github.com/avsm/6757425&quot;&gt;gist&lt;/a&gt; or e-mailing me.&lt;/p&gt;

&lt;h2&gt;Testing pull requests in OPAM&lt;/h2&gt;

&lt;p&gt;Travis isn&amp;rsquo;t just for code pushes though; as of a few months ago it can also &lt;a href=&quot;http://about.travis-ci.org/blog/announcing-pull-request-support/&quot;&gt;test pull requests&lt;/a&gt;.  This is an incredibly useful feature for complex projects such as the OPAM repository that has lots of contributors.  You don&amp;rsquo;t need to do anything special to activate it: whenever someone issues a pull request, Travis will merge it locally and trigger the test runs just as if the code had been pushed directly.&lt;/p&gt;

&lt;p&gt;I did do some special scripting to make this work with the OPAM package repository.  Ideally, every new package or metadata change in OPAM will attempt to rebuild just that package set (rebuilding the entire repository would far exceed the 50 minute testing budget that Travis imposes).  I put together a &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/blob/master/.travis-ci.sh&quot;&gt;very hacked up shell script&lt;/a&gt; that greps the incoming diff and rebuilds the subset of packages.  This is now live, and you can see both &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/1144&quot;&gt;successful&lt;/a&gt; and &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/1131&quot;&gt;failed&lt;/a&gt; pull requests (once the request has been merged, there&amp;rsquo;s a tiny little green arrow beside the commit that was tested).&lt;/p&gt;

&lt;p&gt;This is a very unconservative estimate test matrix since a package update will also affect the reverse transitive cone of packages that depend on it, but it does catch several common typos and incompatibilities (for example, packages that use OPAM 1.1-only features by mistake).  The longer term plan is to use the &lt;a href=&quot;http://github.com/ocamllabs/ocamlot&quot;&gt;OCamlot&lt;/a&gt; command line tool to parse the pull request and compute an exact set of packages that need rebuilding.&lt;/p&gt;

&lt;h2&gt;Deployment&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://xkcd.com/303/&quot;&gt;&lt;img src=&quot;http://imgs.xkcd.com/comics/compiling.png&quot; style=&quot;padding-left: 15px; float:right;&quot; width=&quot;250px&quot;/&gt;&lt;/a&gt;
Travis has one last very cool feature up its sleeve.  When a project has successfully built, it can run a scripting hook in the VM, which can be used to trigger a further code push or service update.  If the service requires authentication, you can &lt;a href=&quot;http://about.travis-ci.org/docs/user/encryption-keys/&quot;&gt;encrypt a secret&lt;/a&gt; in the &lt;code&gt;travis.yml&lt;/code&gt; using their public key, and it will be available in the VM as an environment variable (but won&amp;rsquo;t be useful to anyone else looking at the code repository).&lt;/p&gt;

&lt;p&gt;There are quite a few uses for these Travis deployment scripts: automating the rebuilding of the &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt; website infrastructure, rebuilding the central &lt;a href=&quot;http://pw374.github.io/posts/2013-09-24-01-50-14-opamdoc-take1.html&quot;&gt;opam-doc&lt;/a&gt; &lt;code&gt;cmt&lt;/code&gt; file archive, or even autoupdating &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage&lt;/a&gt; microkernels to Amazon EC2 and Rackspace.&lt;/p&gt;

&lt;p&gt;So how does this tie into the ongoing work on &lt;a href=&quot;http://anil.recoil.org/2013/09/09/ocamlot-autotriaging.html&quot;&gt;OCamlot&lt;/a&gt;?  Quite simply, it&amp;rsquo;s saved us a ton of frontend work, and lets us focus on the more interesting OCaml-specific problems.  Travis is also somewhat reactive (since it only runs in response to pushes or pull requests), and we still need to be able to run complete repository sweeps to look for more systematic breakage. It also doesn&amp;rsquo;t support any non-Ubuntu operating systems yet.  However, Travis takes the burden off us for handling the steadily &lt;a href=&quot;http://anil.recoil.org/2013/09/20/opam-1-1-beta.html&quot;&gt;increasing&lt;/a&gt; number of package updates, and can be used to launch further OCamlot jobs on the other architectures and distributions.  All in all, I&amp;rsquo;m very grateful to Mike for taking the trouble to blog about it back in March!&lt;/p&gt;

&lt;h2&gt;And a little bit of cheeky ARM hackery&lt;/h2&gt;

&lt;p&gt;I couldn&amp;rsquo;t resist one final little hack to see if I could actually do some ARM/OCaml testing using the Travis infrastructure.  I adapted Ian Campbell&amp;rsquo;s excellent &lt;a href=&quot;http://www.hellion.org.uk/blog/posts/foreign-chroots-with-schroot-and-qemu/&quot;&gt;guide to ARM cross-chroots&lt;/a&gt;, and ended up with a &lt;a href=&quot;https://github.com/avsm/ocaml/blob/travis/.travis-ci.sh&quot;&gt;rough script&lt;/a&gt; that builds an unattended chroot and can run OCaml/OPAM installations there too.&lt;/p&gt;

&lt;p&gt;This isn&amp;rsquo;t something I&amp;rsquo;m quite comfortable running on all of my repositories just yet though, since an OCaml cross-build using qemu took over 5 hours and was quite rightly terminated when running within Travis.  To mitigate this, I&amp;rsquo;ve built a &lt;a href=&quot;http://www.recoil.org/~avsm/debian-arm&quot;&gt;custom apt-repository&lt;/a&gt; for ARMel packages to install a binary toolchain, and you can see the results of &lt;a href=&quot;https://travis-ci.org/avsm/ocaml/jobs/11942786&quot;&gt;Lwt/ARM building successfully&lt;/a&gt;.  I&amp;rsquo;ll update on this as I get it working on more packages, as I&amp;rsquo;m quite interested in getting a solid Xen/ARM toolstack up and running for another &lt;a href=&quot;http://nymote.org&quot;&gt;exciting project&lt;/a&gt; over in OCaml Labs&amp;hellip;&lt;/p&gt;
</content><id>http://anil.recoil.org/2013/09/30/travis-and-ocaml.html</id><title type="text">Test your OCaml packages in minutes using Travis CI</title><updated>2013-09-30T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://amirchaudhry.com/ocamlorg-request-for-feedback" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;p&gt;There is a work-in-progress site at 
&lt;a href=&quot;http://ocaml-redesign.github.io&quot;&gt;ocaml-redesign.github.io&lt;/a&gt;, where we&amp;rsquo;ve 
been developing both the tools and design for the new ocaml.org pages.  This 
allows us to test our tools and fix issues before we consider merging 
changes upstream.&lt;/p&gt;

&lt;p&gt;There is a more detailed post coming about all the design work to date and 
the workflow we&amp;rsquo;re using, but in the meantime, feedback on the following 
areas would be most welcome.  Please leave feedback in the form of issues on 
the &lt;a href=&quot;https://github.com/ocamllabs/sandbox-ocaml.org/issues&quot;&gt;ocaml.org sandbox repo&lt;/a&gt;.  You can also raise points on the 
&lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure mailing list&lt;/a&gt;.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;OCaml Logo&lt;/strong&gt; - There was some feedback on the last iteration of the 
logo, especially regarding the font, so there are now several options to 
consider.  Please look at the images on the 
&lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Draft-OCaml-Logos&quot;&gt;ocaml.org GitHub wiki&lt;/a&gt; and then leave your feedback on 
&lt;a href=&quot;https://github.com/ocamllabs/sandbox-ocaml.org/issues/16&quot;&gt;issue #16 on the sandbox repo&lt;/a&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Site design&lt;/strong&gt; - Please do give feedback on the design and any glitches 
you notice. Text on each of the new landing pages is still an initial draft 
so comments and improvements there are also welcome (specifically: Home 
Page, Learn, Documentation, Platform, Community). There are already a few 
&lt;a href=&quot;https://github.com/ocamllabs/sandbox-ocaml.org/issues&quot;&gt;known issues&lt;/a&gt;, so do 
add your comments to those threads first.  &lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

</content><id>http://amirchaudhry.com/ocamlorg-request-for-feedback</id><title type="text">Feedback requested on the OCaml.org redesign</title><updated>2013-09-24T14:00:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://www.syslog.cl.cam.ac.uk/2013/09/24/liveblogging-ocaml-workshop-2013/" rel="alternate"/><contributor><uri>http://www.syslog.cl.cam.ac.uk/tag/ocamllabs/feed/atom</uri><name>SRG Syslog</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo10-e1380031931194.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo10-e1380031931194-225x300.jpg&quot; class=&quot;alignright size-medium wp-image-1466&quot; alt=&quot;photo&quot; width=&quot;100&quot;/&gt;&lt;/a&gt;I'm here bright and early at the &lt;a href=&quot;http://ocaml.org/meetings/ocaml/&quot;&gt;OCaml 2013&lt;/a&gt; workshop at ICFP with Heidi Howard, Leo White, Jeremy Yallop and David Sheets! &amp;nbsp;There's a packed session today with lots of us presenting, so we'll swap over editing this post as the day progresses. &amp;nbsp;I also need to pop out to attend a panel on the future of Haskell so I'll be missing the bindings session, sadly!&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;Accessing and using weather data in OCaml&lt;/h2&gt;
&lt;p&gt;Hez Carty from MDA Information Systems on doing large-scale weather data processing.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo9-e1380049811789.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo9-e1380049811789-225x300.jpg&quot; class=&quot;alignright size-medium wp-image-1465&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;He started with OCaml in graduate school and was looking for something better than Python, whereas they are building systems that need to run for many years with high stability. &amp;nbsp;He's not from a formal CS background but from the physical sciences, and found that the static typing made it easy to explore the language features. &amp;nbsp;The native code output is also important, and he finds predictability very important in day-to-day engineering. &amp;nbsp;The simple FFI also made a big difference.&lt;/p&gt;
&lt;p&gt;They do weather data retrieval and use HTTP/zeromq as a message bus to do language interop, and a workflow management tool to handle dependency graphs. &amp;nbsp;They take weather models frmo all these sources, and do various analyses (principal component analysis, probability models for precipitation via Monte Carlo simulations with a first order Markov chains). &amp;nbsp;More generally, there is a bunch of processing for climatology and data extraction and insertion.&lt;/p&gt;
&lt;p&gt;A NAM forecast plots the geo data of the USA, and overlays semitransparent layers (e.g. clouds) that are stacked up to get a fake satellite view of the earth, and then there are simulated radar returns where the model (e.g.) rains. &amp;nbsp;In addition to the structured formats, there is raw streaming data from sensor stations that send back raw binary data such as precipitation events, which is written as a small OCaml library to parses them into more structured formats.&lt;/p&gt;
&lt;p&gt;The big data formats are HDF4 and GRIB, which are binary data formats. There are mature C libraries to parse them and lots of existing analysis tools (e.g. wgrib which can extract lat/longs from a big file). &amp;nbsp;However, the tools arent great for doing larger scale analysis, as shelling out all the time for thousands of points is not ideal -- therefore they bind to OCaml to do the analysis in-house.&lt;/p&gt;
&lt;p&gt;The GRIB bindings use int, float and float arrays and bindings are entirely hand-written &amp;lt;i&amp;gt;(I'm looking forward to the ctypes talk! --anil)&amp;lt;/i&amp;gt;. &amp;nbsp;They expose only an OCaml friendly interface that is safe for callers. &amp;nbsp;The speaker now shows several nice graphs from CloudSat tracks from earth orbit, and how they take intersecting profiles to deduce things about what multiple satellites are seeing.&lt;/p&gt;
&lt;p&gt;They're mixing lots of different tools and satellite sources -- derived information from teleconnections (air surface pressure and how it varies in terms of oscillations between the north and south Atlantic). &amp;nbsp;All the analysis is written in OCaml, and he had to work with several scientists who didn't have access to their initial source code in many cases, so the experience of working with his fresh system was very positive.&lt;/p&gt;
&lt;p&gt;Challenges:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;standard issues when interfacing with C (type mismatches between C and OCaml in particular, and the question of sharing vs copying). &amp;nbsp;The worst failure mode is silent failure with bad data, which leads to bad science!&lt;/li&gt;
&lt;li&gt;&amp;quot;Getting used to the functional way of life&amp;quot; can tough, as is knowing when to balance elegance with the speed benefits of not copying hundreds of megabytes of data around can be tough.&lt;/li&gt;
&lt;li&gt;Development environments other than Emacs and Vim are poorly supported.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The overall project has been very successful, and the bindings for HDF4/GRIB API bindings have been used to process 1TB+/day for over 5 years now. &amp;nbsp;It's based on Bigarray and mmap, and the FFI makes getting up and running quickly.&lt;/p&gt;
&lt;p&gt;He finds OPAM with local repositories fantastic, and used GODI and odb/oasis-db before that.&lt;/p&gt;
&lt;p&gt;Q: how did he do the cool plots?&lt;/p&gt;
&lt;p&gt;A: plplot bindings on github&lt;/p&gt;
&lt;p&gt;Q: Anil: did you move from Fortran&lt;/p&gt;
&lt;p&gt;Q: Nate Foster: terabytes of data makes me wonder about GC?&lt;/p&gt;
&lt;p&gt;A: going through and folding over data generates huge amount of garbage and slows things down considerably. If the project is one-off, he tweaks the GC or manually call the GC more often. Really depends on length of code.&lt;/p&gt;
&lt;p&gt;Q: The data processed is huge, so what was the parallel computation approach?&lt;/p&gt;
&lt;p&gt;A: The task distribution system doesn't need a lot of parallelism, as he can work on one file at a time or chunk the files manually and aggregate the results. &amp;nbsp;He's looking forward to doing some semi-shared memory parallelism.&lt;/p&gt;
&lt;p&gt;Q: Pierre Chambart: Is the numerical code in OCaml or C?&lt;/p&gt;
&lt;p&gt;A: LAPACK in OCaml, but the Monte Carlo is pure OCaml and interpolation is in pure OCaml too. &amp;nbsp;Unless speed is absolutely required, it's written in OCaml.&lt;/p&gt;
&lt;h2&gt;Frenetic Network Controller&lt;/h2&gt;
&lt;p&gt;Arjun Guha about their multiyear project to program software define networks. When he started on this, he thought that networks are just a series of tubes! The reality is very different though, as there are numerous intermediate boxes (firewalls, routers, wireless auth). The real problem is that each of these intermediate boxes runs specialized, vendor-specific software and are configured independently via some proprietary CLI. They're difficult to configure and difficult to statically reason about.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo13-e1380031705305.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo13-e1380031705305-225x300.jpg&quot; class=&quot;alignright size-medium wp-image-1480&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;SDN helps with this by introducing standardized programmable that can deploy in-network features, and a logically centralized controller (a big beefy server) that enables reasoning about whole-network behaviour. SDN is a hot topic right now (lots of commercial startups, 200+ people at HotSDN, generally very busy).&lt;/p&gt;
&lt;p&gt;There are several Openflow controllers out there: Java (Floodlight), Python (Pox), C++ (Nox) and Haskell (Nettle), but Arjun introduces a novel OCaml programmable switch!&lt;/p&gt;
&lt;p&gt;Openflow works via a controller &amp;quot;faulting&amp;quot; in new packets that are routed to the controller when unknown packets show up on the wire. The source code consists of a generic Openflow packet parser (its a binary protocol), and a generic packet parser (e.g. TCP/IP) and a routing engine.&lt;/p&gt;
&lt;p&gt;First library: ocaml-packet that deals with deserializing TCP/IP/ARP/ICMP/Ethernet/802.1Q, and only depends on cstruct by Anil et al. (shows an example of a C struct for IPv4), and the nice thing that they get network byte order for free (thanks to Pierre Chambarts ocplib-endian of course).&lt;/p&gt;
&lt;p&gt;ocaml-openflow uses serialization for OpenFlow 1.0 and 1.3, and is based on a (cleaned up) fork of the mirage-openflow library, using ideas from Nettle about to structure the code. OpenFlow 1.3 is less complete currently but is still quite usable.&lt;/p&gt;
&lt;p&gt;The runtime systems for OpenFlow 1.0 and 1.3 listens for TCP connections from switches, and does the OpenFlow handles and keeps connections to switches alive.&lt;/p&gt;
&lt;p&gt;The source code uses Lwt and so exposes the monad to external users, e.g.:&lt;/p&gt;
&lt;pre&gt;type t
val connect : Lwt_unix.file_descr -&amp;gt; t option Lwt.t&lt;/pre&gt;
&lt;p&gt;They have a tutorial for non-OCaml hackers, and found teaching OCaml, Openflow AND Lwt was too much for new users. Therefore they built a new controller called Ox that hides much of the details of Lwt threading. It still uses them internally (Lwt, ocaml-openflow) but is inspired by Ox.&lt;/p&gt;
&lt;p&gt;Therefore they can build simple openflow tutorials using Ox, and advanced controller such as Frenetic can be built directly using the low level libraries. Good for beginners and weathered OCaml hackers alike!&lt;/p&gt;
&lt;p&gt;The problem with the controller seeing every bit of data is that it gets flooded by packets if it doesnt insert rules into the switches itself. Every switch has a &lt;i&gt;flow table&lt;/i&gt; that has priorities, patterns and actions, and tries to take action without bothering the controller. At start of day, the controller does see everything, but eventually flows settle down. The problem they are solving is avoiding having two copies of the program on both the controller and the switch, and figuring out how to deal with race conditions across the two. The simple, logical structure of the OCaml program gets torn apart if they try to write these two parallel logic rules by hand.&lt;/p&gt;
&lt;p&gt;They deal with this in the Frenetic network controller. This is a DSL for programming OpenFlow networks, and it has boolean predicates, several policy composition operations and compiles to OF flow rules. It implements ideas from several papers (ICFP/POPL/SIGCOMM/PLDI) and is fully open source on GitHub. (frenetic-lang/frenetic).&lt;/p&gt;
&lt;p&gt;They made a transition from Haskell to OCaml for a few reasons. They specified several parts of the Core compiler and runtime in Coq, and found Haskell/Coq extraction very painful (specifically, they had to abandon Coq functors, which had helped them discover key algebraic properties for their work on Kleene algebras). They found it easier for their collaborators to use OCaml than Haskell in general too.&lt;/p&gt;
&lt;p&gt;Lwt programming is mind boggling for beginners although the syntax extension does help, and the lack of multicore is a future problem as the controller needs scale up. Overall, they find that hacks at any layer are possible now and lots of projects have spun up!&lt;/p&gt;
&lt;p&gt;Q: multicore is a common criticism, but could you give an example of how you would actually solve this is you had shared memory vs a fork model?&lt;br/&gt;
A: There are several networking algorithms in the literature, and its a barrier for consumers. Nate notes that they could write one by hand but there's a time issue there and would rather have it automagically.&lt;/p&gt;
&lt;h2&gt;PHP Program analysis at Facebook&lt;/h2&gt;
&lt;p&gt;Pffff is all about deadcode removal, test coverage, checking for undefined function and use of undeclared variables, and syntactical grep rules. They also do taint analysis via abstract interpretation, type driven flow control and eventually (via Monoidics) a separation logic model (they use OCaml too).&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo11-e1380048991412.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo11-e1380048991412-225x300.jpg&quot; class=&quot;alignright size-medium wp-image-1478&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This talk is about static analysis of a huge codebase (5m lines+ of PHP code is scary!). Since he had a lot of big monitors, he built the tools to do analysis over huge codebases. He demonstrates this on the OCaml compiler itself &lt;i&gt;(camlp4 is huge! boo!!! -anil)&lt;/i&gt;. They can also zoom in in realtime to each box and eventually see the content of the file itself!&lt;/p&gt;
&lt;p&gt;The goal is NOT to build an editor, but to analyse and explore large code bases. It opens and editor if required any time. The idea is to transform semantic program analysis into a visual formt that's more easily digestible. Just like in Google Maps where you see the big important roads and only the details when you zoom in. He uses this tool all day on his own codebase too, and gradually realised that when you want to learn a new codebase, you want to start to learn the software architecture first, and then want to figure out the dependency graph before seeing details.&lt;/p&gt;
&lt;p&gt;He then shows an interactive grid map that explains the dependencies of whole subdirectories of the OCaml compiler, and drill down to understand what they're for.&lt;/p&gt;
&lt;p&gt;Audience q: did you consider a flare graph? a: others have done edge graphs and graphviz etc, and none of these scale to quite the heights that this particular grid done. The ordering of the grid is also the transitive order of dependencies, so it starts with the list of simple dependencies (stdlib) and ends with the toplevel (depends on everything). You can spot for example the OCaml dev rule that things in stdlib are only used by the compiler.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo14-e1380031776990.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo14-e1380031776990-225x300.jpg&quot; class=&quot;alignright size-medium wp-image-1481&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;With good software, the top right of the grid is full, which is forbidden by OCaml (no cyclic module deps). With other software, the situation is far worse (audience laughter).&lt;/p&gt;
&lt;p&gt;There are many other tools (CodeQuery, stags, sgrep/spatch and scheck). &amp;nbsp;There are plugins for PHP, OCaml (using the cmt options) and Java (using Joust), C/C++ (using clang) getting all the semantic information from varied source code. &amp;nbsp;There is a plan to move it to the web (from a GTK interface) by using Ocsigen.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Conclusion: CodeMap is a scalable semantic source code vis/searcher for huge codebases, and codeGraph visualizes dependencies. &amp;nbsp; Future work is to minimize backward deps.&lt;/p&gt;
&lt;p&gt;All on Github at github.com/facebook/pfff.git&lt;/p&gt;
&lt;p&gt;Q: can you insert other metadata such as Linux perf output?&lt;/p&gt;
&lt;p&gt;A: yes! (I think)&lt;/p&gt;
&lt;h2&gt;Extension points: an alternative to camlp4&lt;/h2&gt;
&lt;p&gt;Leo White talking about alternatives to camlp4. Why? Camlp4 is very complex and it comes due to its support for an extensible grammar. Did a wg-camlp4 working group to figure out how to evolve common uses towards a more easily parsed standard, to reduce the day-to-day dependency on camlp4. After 400 emails, a consensum emerged.&lt;/p&gt;
&lt;p&gt;sexplib as an example: the old version was&lt;/p&gt;
&lt;pre&gt;type t = {
  float: int default(42);
  bar: float;
} with sexp&lt;/pre&gt;
&lt;p&gt;The annotated version is:&lt;/p&gt;
&lt;pre&gt;type t = {
  foo: int; [@default 42]
  bar: float
} [@@sexp]&lt;/pre&gt;
&lt;p&gt;This has annotation data that is passed straight through to a transformer, with no extensions to the grammar. Thus the sexplib transformer can understand with @default 42 means, and editors can easily hide or fold annotations without having to understand their details precisely.&lt;/p&gt;
&lt;p&gt;The compiler ignores any AST extension fragments that remain after all the transformers are done.&lt;/p&gt;
&lt;p&gt;sedlex&lt;/p&gt;
&lt;pre&gt;[%lexer
  match foo with
  (Range ('a','z') | Range(1000,1500)), 65 -&amp;gt; Foo
  | Star (Range('a','z')) -&amp;gt; Bar
]&lt;/pre&gt;
&lt;p&gt;These are genuine AST nodes and so if these aren't handled by the transformer, an error will result. Another example is&lt;/p&gt;
&lt;p&gt;properly foreign syntax, via COW (Caml on the Web)&lt;/p&gt;
&lt;pre&gt;let world = &amp;quot;world&amp;quot; in
let html =  [%html {|&amp;lt;h1&amp;gt;Hello $str:world$!&amp;lt;/h1&amp;gt;
|}]&lt;/pre&gt;
&lt;p&gt;There's also a shortcut convention for the syntax, such as:&lt;/p&gt;
&lt;pre&gt;match%lexer foo with
 {|&lt;/pre&gt;
&lt;p&gt;There's a shorthand form to avoid have lots of brackets due to deeply nested lets.&lt;/p&gt;
&lt;pre&gt;[%lwt let x = f () in
[%lwt let y = g () in&lt;/pre&gt;
&lt;p&gt;These have all been implemented by Alain Frisch and merged onto trunk (in OCaml 4.02.0dev). Thoughts and feedback are very welcome on the wg-camlp4 list&lt;/p&gt;
&lt;p&gt;Q: how does this affect the quality of error messages?&lt;br/&gt;
A: Leo -- do you mean error messages from the extension itself?&lt;br/&gt;
Q: what if there is an error in the extension?&lt;br/&gt;
A: The 42 that was in the default has an AST fragment and so the transformer will transplant the location. A sensible transformer will therefore be nonlossy.&lt;/p&gt;
&lt;p&gt;Q: can you chain transforms?&lt;br/&gt;
A: yes, thats why we are going with an AST fragment rather than a string, so chaining is easier. If youve got some macro expansion transformer and you want to use it with the sedlex example, they are executed in the other they are given on the command line. The next transformer will just see the resulting AST fragment, and therefore should compose between than camlp4 extensions have in the past.&lt;/p&gt;
&lt;p&gt;Q: do you have ideas about hygiene as Scheme does?&lt;br/&gt;
A: Not particularly in this case, although Leo has some ideas for future systems.&lt;/p&gt;
&lt;p&gt;Q: Ashish Agarwal -- do existing extensions need to be reimplemented&lt;br/&gt;
A: Good thing about all these existing extensions is that they have an existing parser, so you can take your existing implementation in camlp4 and mechanically translate into an extension_points version!&lt;/p&gt;
&lt;p&gt;Q: Yaron: is anyone thinking about good libraries (hygiene etc)&lt;br/&gt;
A: Alain Frisch has merged in ppxtools into OPAM stable (that depends on 4.02.0+)&lt;/p&gt;
&lt;p&gt;Q: Will this improve performance over camlp4&lt;br/&gt;
A: Parsing is an expensive process and this is still doing marshalling. The cost is often the case that we are shelling out to this other process, so we still need to look into improving performance in other ways.&lt;/p&gt;
&lt;h2&gt;GPGPU programming with SPOC&lt;/h2&gt;
&lt;p&gt;M Bourgoin presents his PhD work on SPOC.&lt;/p&gt;
&lt;p&gt;GPGPU is odd hardware: several mutiprocessors, dedicated memory, connected via PCI-E and transferred between a GPU and host using DMA. Currently hardware has 300-2000 cores vs 4-16 CPU cores (wow). However this demands a very specific progamming model to take advantage of all this hardware.&lt;/p&gt;
&lt;p&gt;Shows an example of a vector addition in openCL&lt;/p&gt;
&lt;pre&gt;__kernel vac_add(global const double *c, global const double *a, global double *b, int N)
int nIndex = get_global_id(0);
if (nIndex &amp;gt;= N)
  return;
c[nIndex] = a[nIndex] + b[nIndex]&lt;/pre&gt;
&lt;p&gt;To actually use this though, you need a massive program to set up the kernel and execute it. It does the transforms, initialization, scheduling and so forth.&lt;/p&gt;
&lt;p&gt;OCaml and GPGPU complement each other, since we have sequential high-level OCaml and highly parallel and low-level GPGPU. So the idea with SPOC is to use OCaml to develop high level abstractions in the GPGPU and program it from OCaml.&lt;/p&gt;
&lt;p&gt;SPOC is a stream processing engine in OCaml that emits Cuda but lets it be more hardware independent.&lt;/p&gt;
&lt;pre&gt;let dev = Devices.init ()
let n = 100000
let v1 = Vector.create Vector.float64 in
let v2 = Vector.create Vector.float64 in
let v3 = Vector.create Vector.float64 in

let k = vector_add (v1,v2,v3,n)
let block = {blockX = 1024; blockY=1; blockZ=1}
let grid={gridx=(n+1024-1)/1024; gridY=1; gridZ=1}

let main()=
random_fill v1;
random_fill v2;
Kernel.run k  (block,grid) dev.(0);
#printf of result&lt;/pre&gt;
&lt;p&gt;SPOC takes care of transferring the kernel to the GPU and back and handling the scheduling and exchange of data. Vectors are very similar to Bigarrays in that they are external memory.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo15-e1380048240290.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo15-e1380048240290-224x300.jpg&quot; class=&quot;alignright size-medium wp-image-1493&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We want: simple to express, predictable performance and extensible libraries, and for current high performance libraries to be usable more safely.&lt;/p&gt;
&lt;p&gt;Two solutions: interop with Cuda/OpenCL kernel (better perf and more compatible but less safe). There is also a DSL in OCaml called Sarek, which talk focusses on.&lt;/p&gt;
&lt;p&gt;Sarek vector addition has an ML like syntax, and the language features monomorphic, imperative, toplevel and statically typed checked (with type inference). Its statically compiled to OCaml code and dynamic compilation to Cuda and OpenCL.&lt;/p&gt;
&lt;p&gt;SPOC+Sarek achieves 80% of hand-tuned Fortran performance and SPOC+external kernels is on par with Fortran (93%). It's type safe, 30% code reduction, memory managed by the GC and there are fewer memory transfers. This is ready for the real world and has great performance! Available on OPAM.&lt;/p&gt;
&lt;p&gt;Great performance, portable, great for GPU and for multicore CPU and nice playground for future abstractions.&lt;br/&gt;
Who can benefit?&lt;/p&gt;
&lt;p&gt;OCaml programmers -&amp;gt; better performance&lt;br/&gt;
HPC programmers -&amp;gt; much more flexible and extensible than current state of the art.&lt;/p&gt;
&lt;p&gt;Future work: Sarek needs custom types, function decls, recursions, exceptions, and to build parallel skeletons using SPOC and Sarek.&lt;/p&gt;
&lt;p&gt;Why not use Sarek for multicore? Well, here's the results!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ParMap: data parallel and similar to OCaml mapfold&lt;/li&gt;
&lt;li&gt;OC4MC: posix threads, compatible with current OCaml code&lt;/li&gt;
&lt;li&gt;SPOC : GPGPU kernels on a CPU, mainly data parallel and needs OpenCL.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Simple program to calculate power series and matrix multiplication.&lt;/p&gt;
&lt;p&gt;Power: OCaml 11s14, Parmap 3s30 SPOC &amp;lt;1s&lt;br/&gt;
Matmul: OCaml 85s OC4MC 28s and SPOC 6.2s&lt;/p&gt;
&lt;p&gt;Significant improvements using SPOC -- 11x for power series and 12x for SPOC. Running on a quad core intel i7.&lt;/p&gt;
&lt;p&gt;SPOC is available via OPAM and compatible with x86_64 on Linux and MacOS X, and speaker would love feedback.&lt;/p&gt;
&lt;p&gt;Q: Anil - how hard is OpenCL to install&lt;br/&gt;
A: easy if you know your hardware model and to the vendor website. Harder with multiple GPUs though.&lt;/p&gt;
&lt;p&gt;A: if you want to target CPUs, you need to target OpenCL and not CUDA.&lt;/p&gt;
&lt;h2&gt;High level performance optimisations for OCaml&lt;/h2&gt;
&lt;p&gt;Pierre Chambart at OCamlPro (funded by Jane Street). OCaml is fast, but not an optimizing compiler (it has predictable performance, good generated code, but what can we do to make it go faster?).&lt;/p&gt;
&lt;p&gt;A small modification to high level code shouldnt influence the low level bits.&lt;/p&gt;
&lt;pre&gt;let f x = 
  let cmp = x &amp;gt; 3 in
  if cmp then A else B

let g x =
  if x &amp;gt; 3 then A else B&lt;/pre&gt;
&lt;p&gt;The second bit of code is faster than the first here since 'g' is spotted by the compiler peephole optimizer.&lt;/p&gt;
&lt;pre&gt;let g x = 
  let f v = x + v in
  f 3&lt;/pre&gt;
&lt;p&gt;Abstract code should be compiled less abstractly. Above, we want to inline f, but a closure is still allocated per call unnecessarily. But we also dont want the compiler to be too smart and lose predictability!&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo16-e1380048580650.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo16-e1380048580650-225x300.jpg&quot; class=&quot;alignright size-medium wp-image-1496&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Currently compiler pipeline has a parsetree - typed tree - lambda (untyped) - clambda (lambda+closures) - cmm (simple C like) and then mach (instruction graph similar to llvm) and then lin (assembly like).&lt;/p&gt;
&lt;p&gt;Details: typed tree to lambda (construct elimination) - lambda (high level simplication such as reference elimination and pattern matching generation) - lambda to clambda (inlining, constrant propagation and book keeping in an intricate recursive loop) - clambda to cmm (unboxing, lots of peep hole checks for boxing/unboxing and tagging/untagging) - cmm to mach (instruction selection and some more peephole) - mach (allocation fusion, register allocation and scheduling)&lt;/p&gt;
&lt;p&gt;Where do we do high level optimizations then? For example, where do we do inlining (since it allows other transformations to apply). typedtree is too complicate, lambda (want inlining, simpler with closures), clambda (is too difficult to improve, and Pierre did try) and cmm (good for local optimization but not global) and mach is architecture specific.&lt;/p&gt;
&lt;p&gt;They are adding a new intermediate form between lambda and clambda known as flambda. This needs a highlevel view of values, simple manipulations, explicit closures and explicit value dependencies. lambda to flambda introduces closures, and flambda to clambda is mainly book keeping (and preparing cross-module information). The magic for optimization will be in flambda-flambda passes, and not in the flambda to clambda layers.&lt;/p&gt;
&lt;p&gt;Shows several examples of inlining, simplication and dead code elimination and why its significantly easier in the flambda form for simple microexamples. Also shows lambda lifting!&lt;/p&gt;
&lt;p&gt;Change the performance model. Now its WYSIWYG, but we want some sort of understandable compile-time evaluation. For example, consider a map function as a metaprogramming function that you want to execute at compile time without all the intermediate closure allocation.&lt;/p&gt;
&lt;p&gt;Add build_test to your OPAM to make it easier to test the compiler, and Obj-using code is very likely to break if you do certain mutations behind the compiler, or dead code elimination might happen if you use a value behind the compiler's back.&lt;/p&gt;
&lt;p&gt;Q: SimonPJ: why is it easier to do closure conversion first, as it's a lot easier in GHC to do the opposite. There are now two ways to get a value in scope doing it the other way.&lt;br/&gt;
A: In Haskell you have everything in your closure, since you get the information from the closure.&lt;br/&gt;
Q: Think of lambda calculus with let&lt;br/&gt;
A: We do flow analysis to get around this!&lt;br/&gt;
Q: This is quite complex. Is it whole program analysis?&lt;br/&gt;
A: Restricted to a single compilation unit, and a few other cases, not cross-module yet.&lt;/p&gt;
&lt;p&gt;Q: Yoann: if the prediction is &amp;quot;its always faster&amp;quot; then why do you care about predictability?&lt;/p&gt;
&lt;h2&gt;Replacing the format string hack with GADTs&lt;/h2&gt;
&lt;p&gt;Benoit Vaugon talks about how to improve the typing of Format strings in OCaml by using GADT encodings. He stats with showing basic examples of the Printf module, and advanced examples that include the &amp;quot;%a&amp;quot; callback, date scanning and hex dumping.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo17-e1380051856191.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo17-e1380051856191-300x225.jpg&quot; class=&quot;alignright size-medium wp-image-1508&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The OCaml type checker has an inferred type that encodes the details of the format string in a &amp;quot;format6&amp;quot; type that has lots of type parameters that describe the format string contents.&lt;br/&gt;
During type checking, the literal string is parsed and there is manual inference of the format6 type parameters. At runtime, the format strings are represented by the string from the source code.&lt;/p&gt;
&lt;p&gt;During printing functions, it parses the format and count parameters and accumulates parameters. It then extracts and patches subformats, and finally calls the C printf function. Scanning is more complex but broadly similar.&lt;/p&gt;
&lt;p&gt;There are quite a few problems with this. There are 5 (!) format string parsers (two in Printf, two in Scanf, one in the type checker) and there are lots of little incompatibilities as a result. For example&lt;/p&gt;
&lt;pre&gt;Printf.printf &amp;quot;%1.1s&amp;quot; &amp;quot;hello&amp;quot;&lt;/pre&gt;
&lt;p&gt;Results in Invalid_argument exception despite the static type checking, with a useless error message.&lt;/p&gt;
&lt;p&gt;There is a weakness in the type checker too, for example&lt;/p&gt;
&lt;pre&gt;Printf.sprintf &amp;quot;%s.+f&amp;quot; 3.14&lt;/pre&gt;
&lt;p&gt;results in the format string being printed.&lt;/p&gt;
&lt;p&gt;You can also segfault from there, such as&lt;/p&gt;
&lt;pre&gt;Format.printf &amp;quot;@%d%s&amp;quot; 42 &amp;quot;hello&amp;quot;&lt;/pre&gt;
&lt;p&gt;will segfault.&lt;/p&gt;
&lt;p&gt;Speed is also a concern, as parsing the format at runtime is slow, and reparsing is required by another slow C printing function. Lots of memory allocation is required.&lt;/p&gt;
&lt;p&gt;The new implementation sorts all this out by using GADTs to represent the formats. The format6 type is now concrete and not magic predefined. Formats now also become statically allowed and not multiply passed around dynamically.&lt;/p&gt;
&lt;p&gt;The new implementation (which he shows) is a fairly epic GADT but quite regular when broken down into pattern clauses and examined with respect to the old implementation.&lt;/p&gt;
&lt;p&gt;Issues: evaluation order changes slightly, as for printing functions the parameters are accumulated before printing. String_of_format is implemented by &amp;quot;%identity&amp;quot; and in the new implementation, we need to change the representation (either regenerate the string from the GADT or implement formats by a tuple).&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo18-e1380051839961.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo18-e1380051839961-225x300.jpg&quot; class=&quot;alignright  wp-image-1509&quot; alt=&quot;photo&quot; width=&quot;158&quot; height=&quot;210&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;There's now only one format parser (down from 4-5) for the standard library and OCaml type checker&lt;/p&gt;
&lt;pre&gt;type ('b,'c,'e,'f) fmt_ebb = Fmt_EBB:
 ('a,'b,'c,'d,'e,'f) CamlinternalFormatBasics.fmt -&amp;gt;
 ('b,'c,'e,'f) fmt_ebb
val fmt_ebb_of_string : string -&amp;gt; ('b,'c,'e,'f) fmt_ebb
val type_format: ('x,'b,'c,'t,'u,'v) format6 -&amp;gt;
   ('a,'b,'c,'d,'e,'f) fmtty -&amp;gt; ('a,'b,'c,'d,'e,'f) format6&lt;/pre&gt;
&lt;p&gt;(this looks verbose but isnt really exposed outside of the compiler.&lt;/p&gt;
&lt;p&gt;Another issue is the &amp;quot;%(..%r..%)&amp;quot; construction, since we need to include a proof term of the number of &amp;quot;%r&amp;quot; occurrences. The encoding for this is quite complex.&lt;/p&gt;
&lt;p&gt;Performance of the new system is significantly better across the board. A hello world goes from (230ns to 55ns) timing and (732 to 24 bytes allocated) for example.&lt;/p&gt;
&lt;p&gt;Q: Oleg did it already in Haskell &lt;i&gt;(ha ha -- editor)&lt;/i&gt;. He notes that six parameters arent needed, as the GADT is the interpreter over the paramters.&lt;br/&gt;
A: yes can remove them if we split the Printf and Scanf format, and there is also a format4 which removes several parameters. We also have a problem with error messages since all the type parameters make things really complicated.&lt;br/&gt;
Q: Oleg: the work of interpreting the stream is pushed into the GADT, but if you write an interpreter over the GADT then we have simpler external types.&lt;br/&gt;
...discussion moves into offline discussion.&lt;/p&gt;
&lt;h2&gt;Dynamic types in OCaml&lt;/h2&gt;
&lt;p&gt;Gregoire Henry wants to do dynamic types in OCaml.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo19-e1380052996312.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo19-e1380052996312-150x150.jpg&quot; class=&quot;alignright size-thumbnail wp-image-1515&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Structural type introspection: generic I/O primitives, type-safe (unlike Marshal) and typed (not written in Camlp4) -- these are polytypic functions.&lt;/li&gt;
&lt;li&gt;Normal type introspection, for dynamic values (a k/v store or a DSL with dynamic typing), or extensible polytypic functions for abstract types.&lt;/li&gt;
&lt;li&gt;This would also give us a common type representation for (e.g.) Eliom services that will be converted to Javascript, or for FFI libraries, and to let the debugger explore the heap with exact typing information.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Probably isnt a single representation that fits all these use cases: We need to preserve abstraction when desired, but also to break abstraction when desired (e.g. by the debugger or a generic printer, but not by accident!), and it shouldn't impose a big performance hit.&lt;/p&gt;
&lt;p&gt;Gregoire gives a description of a polytypic printing function&lt;/p&gt;
&lt;pre&gt;let rec print (type t) (ty: t ty) (v:t) =
  match head ty with
  |Int -&amp;gt; print_int v
  | String -&amp;gt; print_string v
  | List ty -&amp;gt; print_list (print ty) v
  | Sum desc -&amp;gt;
  let (name, args) = sum_get desc v in
  print_string name 
  ...&lt;/pre&gt;
&lt;p&gt;We define a predefined type &amp;quot;t ty&amp;quot; and a syntax for type expressions &amp;quot;(type val t) of type &amp;quot;t ty&amp;quot;. We then introduce implicit type arguments which are optional arguments instantiated at call-site with the dynamic representation of the expected type.&lt;/p&gt;
&lt;pre&gt;val print : ?t:(typ val 'a) -&amp;gt; 'a -&amp;gt; string
let print ?(type val t) (v:t) = ...

type t = R of int * int | ...
let x = R (1,2)
let () = print x (* implicit arg is (type val t) *)&lt;/pre&gt;
&lt;p&gt;This is experimental syntax, but is shows how we can keep the representation abstract but the printer can still operate over it since the implicit argument passes the printer around.&lt;/p&gt;
&lt;p&gt;The main problem is now how we mix polytypic function and abstraction, without always printing &amp;quot;abstract&amp;quot; instead of the real underlying structure. One solution is an extensible polytypic function.&lt;/p&gt;
&lt;pre&gt;module M: sig
 type t
 val x: t
end = struct
  type t = R of int * int
  let x = R(22,7) let () = register_printer (external type val t) (fun x -&amp;gt; ... )

end
let () = print x&lt;/pre&gt;
&lt;p&gt;We register a printer internally in the module, without exposing its internal type externally, but still let it be printed. The internal and external types are different though. We do need to figure out a canonical name for types defined outside the current compilation unit (its absolute path).&lt;/p&gt;
&lt;p&gt;By default though, abstraction should consistently introduce new nominal types, but we're not sure how to reference all the of the external names of a given type within its initial compilation unit (open problem). A pragmatic approach to solving this is the manual or semi-automatic creation of runtime &amp;quot;type names&amp;quot;.&lt;/p&gt;
&lt;p&gt;In conclusion, they have a GADT for structural introspection and a RTT representation with global names. &amp;nbsp;There is also a type-constructor index association table. &amp;nbsp;Implicit type arguments (lightweight syntax for calling polytypic function, and explicit type parameters for polymorphic functions).&lt;/p&gt;
&lt;p&gt;Q: what's the gain of putting this into the compiler?&lt;/p&gt;
&lt;p&gt;A: you may miss language corners, such as firstclass modules or functors, as your &amp;quot;userspace&amp;quot; OCaml code has to pass a type witness into a functor or firstclass module. &amp;nbsp;Compiler support makes this passing much easier. &amp;nbsp;The other big benefit is clear error messages from this compiler integration in the long term. &amp;nbsp;It's not currently easy for beginners, and this is very important to get right if this becomes a supported feature.&lt;/p&gt;
&lt;h2&gt;On variation, injectivity and abstraction&lt;/h2&gt;
&lt;p&gt;Jacques Garrigue speaks about an interesting bug in the type checker that needs some language changes. There was PR#5985 which was a serious type checker bug that lost injectivity.&lt;/p&gt;
&lt;pre&gt;module F(S: sig type 'a s end) = struct
  include S
  type _ t = T : 'a -&amp;gt; 'a s t
end
module M = F (struct type 'a s = int end)
let M.T x = M.T 3 in x
- : 'a = &amp;lt;poly&amp;gt; &lt;i&gt;the type is lost!&lt;/i&gt;&lt;/pre&gt;
&lt;p&gt;After expanding &amp;quot;s&amp;quot;, the definition of &amp;quot;M.t&amp;quot; is actually &amp;quot;type _t = T : 'a -&amp;gt; int t&amp;quot; but &amp;quot;'a&amp;quot; is not marked as an existential.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo20-e1380054255495.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo20-e1380054255495-150x150.jpg&quot; class=&quot;alignright size-thumbnail wp-image-1521&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In order to protect against this unsoundness, all variables in type declarations must be bound, either by appearing inside the type parameters or be existentially bound (i.e. only present in GADTs). Inside type parameters, these variables must be &lt;b&gt;injective&lt;/b&gt;.&lt;/p&gt;
&lt;p&gt;OCaml doesnt do injectivity directly, since it relies of variance inference (since we have subtyping). The variance of a parameter is either &lt;i&gt;explicit&lt;/i&gt; for abstract and private types or constrained parameters, or its &lt;i&gt;inferred&lt;/i&gt; from its occurrences otherwise.&lt;/p&gt;
&lt;p&gt;Constrained type parameters have been present since the very start.&lt;/p&gt;
&lt;pre&gt;type 'a t = T of 'b constraint 'a = 'b list&lt;/pre&gt;
&lt;p&gt;Rules for checking variance in this case become much more complicated, since constrained parameters variance must now be &lt;b&gt;explicit&lt;/b&gt; The variance of type variables inside constrained parameters must also be weaker or equal the version inside the body of the definition.&lt;/p&gt;
&lt;pre&gt;type +'a t = T of 'b constraint 'a = 'b list (* 'b covariant *)
type 'a r = 'a -&amp;gt; int                        (* contravariant *)
type +'a t = T of 'b constraint 'a = 'b r    (* Fails *)
(* 'b is contravariant in parameters but covariant inside *)&lt;/pre&gt;
&lt;p&gt;In OCaml though, the variance of a parameter is allowed to be weakened through abstraction.&lt;/p&gt;
&lt;pre&gt;module M : sig
  type +'a u 
end = struct 
  type 'a u = int
end&lt;/pre&gt;
&lt;p&gt;This is correct for the types, but becomes incorrect when used for &lt;i&gt;type parameters&lt;/i&gt;.&lt;/p&gt;
&lt;pre&gt;module F(X: sig type 'a r end) = struct
  type +'a t = T ob 'b constraint 'a = 'b X.r
end
module N = F (struct type 'a r = 'a -&amp;gt; int end)&lt;/pre&gt;
&lt;p&gt;Even when we assume that r is invariant, 'b is inferred as invariant from the parameter of t, which overrides the covariance of the body. Meanwhile in the module N, the variance is now wrong.&lt;/p&gt;
&lt;p&gt;How do we fix this? We need to refine the definition of variance, as traditional variance subumption defines a lower bound on the variance, but we need to add some upper bound information too, to be sure that parameters cannot have a strong variance.&lt;/p&gt;
&lt;p&gt;&lt;i&gt;(technical explanation of how to compose variances omitted here)&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;In OCaml 4.01, full variance inference is done using 7 flags (the last is a special case required for principality). Some uses will no longer type check so programs may be rejected for safety.&lt;/p&gt;
&lt;p&gt;In the future, Jeremy Yallop, Leo White and Jacques would like to add injectivity annotations for abstract types.&lt;/p&gt;
&lt;pre&gt;type #'a s
type _ t = T : 'a -&amp;gt; 'a s t&lt;/pre&gt;
&lt;p&gt;Add new types for isomorphic abbreviations, as Haskell does&lt;/p&gt;
&lt;pre&gt;module M : sig type #'a t val f : int -&amp;gt; ['pos] t end = struct
  type 'a t = new int
  let f x = (abs x : int :&amp;gt; 'a t)
end&lt;/pre&gt;
&lt;p&gt;This is similar to private, but subtyping will work in both directions -- this is useful for efficiency, encoding runtime types and allows coercions to be delayed until the signature rather than in the both (in the example above, the coercion in &amp;quot;f&amp;quot; could be omitted) due to the signature.&lt;/p&gt;
&lt;p&gt;Another problem is that one cannot prove the uniqueness of abstract types, and we dont know whether an abstract type is contractive (so even if you use rectypes, the following functor can never be defined)&lt;/p&gt;
&lt;pre&gt;module Fixpoint (M: sig type 'a t end) = struct
  type fix = fix M.t 
end
Error: the type abbreviation fix is cyclic&lt;/pre&gt;
&lt;p&gt;One also never knows whether an abstract type may be a float, so the float array optimization may be mismatched.&lt;/p&gt;
&lt;h2&gt;OCamlot: lots of OCaml testing!&lt;/h2&gt;
&lt;p&gt;(will post David's slides on the OCaml Labs website since it's one of our talks. Will edit this post when that happens).&lt;/p&gt;
&lt;h2&gt;Merlin: editor support for OCaml&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo21-e1380057773342.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo21-e1380057773342-225x300.jpg&quot; class=&quot;alignright size-medium wp-image-1530&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/def-lkb/merlin&quot;&gt;Merlin&lt;/a&gt; is a sophisticated editor assistant for OCaml that provides autocompletion in vim and emacs. They leap straight into an interactive demo that's awesome: autocompletion, module introspection when writing a functor, and so on.&lt;/p&gt;
&lt;p&gt;Unlike other tools, this doesn't rely on a CMT file, so code doesn't need to compile (except for source browsing). Your project can have type errors when using Merlin!&lt;/p&gt;
&lt;p&gt;It integrates with the ecosystem and has direct support for Findlib. There is no direct support for camlp4 however, with specific support for some extensions. If you want a new shiny extension then talk directly to them&lt;/p&gt;
&lt;p&gt;There is build system support for running either omake or Jenga in polling mode (for iterative recompilation). Omake rules can inform Merlin to get a consistent state of the project!&lt;/p&gt;
&lt;p&gt;A typical session: Parsing is done in two stages and the OCaml parser has been modified to be much more resilient to errors. The usual typing rules are applied, but passed onto a more &amp;quot;relaxed&amp;quot; typers in case of errors to give some support for incremental parsing.&lt;/p&gt;
&lt;p&gt;Coming soon is documentation (ha!) as well as retrieval for ocamldoc comments to further augment hints, as well as even more error recovery heuristics. Some of the patches will also be submitted upstream to improve error handling (by accumulating them instead of printing them directly).&lt;/p&gt;
&lt;p&gt;It's available on OPAM under an MIT license via &amp;quot;opam install merlin&amp;quot; and thanks to Jane Street for letting them work on it during an internship there, and all the bug reporters!&lt;/p&gt;
&lt;p&gt;Q: Have you considered running Merlin on a remote system and speak the same JSON protocol?&lt;br/&gt;
A: They haven't, but it really shouldn't be a problem.&lt;/p&gt;
&lt;p&gt;Q: Julien V: do we have to build first?&lt;br/&gt;
A: No you dont have to build first&lt;br/&gt;
Q: What happens when you change branches in a project&lt;br/&gt;
A: For project-wide information you need to compile and rebuild.&lt;/p&gt;
&lt;p&gt;Q: in the second pass of type checking, what does &amp;quot;relaxed&amp;quot; mean&lt;br/&gt;
A: When typing fails for some branch of the AST, in the simple case we introduce a fresh type variable and attempt to do unification with the result of this. This will never be sound, but lets it make progress and give SOME feedback to the user.&lt;/p&gt;
&lt;p&gt;Q: is this a new type checker?&lt;br/&gt;
A: No its the original type checker with augmented error handling paths to do more unification.&lt;/p&gt;
&lt;p&gt;Q: is the relaxed checking really worthwhile? It wasnt a lot of use in gcc since you get a lot of followon errors that are meaningless.&lt;br/&gt;
A: lots of discussion, opinions split, it can be disabled!&lt;/p&gt;
&lt;h2&gt;Understanding memory behaviour of programs&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo22-e1380058304144.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo22-e1380058304144-150x150.jpg&quot; class=&quot;alignright size-thumbnail wp-image-1533&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;br/&gt;
Cagdas B doing a PhD on memory profiling. He wants to study the behaviour of OCaml programs and work on decreasing memory footprint and generally reduce GC pressure on real OCaml programs.&lt;/p&gt;
&lt;p&gt;Shows Why3 graph (see photograph) and they're running nice finegrained analysis over it on real world analyses. How do they generate these graphs?&lt;/p&gt;
&lt;pre&gt;$ opam switch 4.00.1+ocp-memprof
$ opam install why3
$ OCAMLRUNPARAM=m why3replayer.opt -C why3.conf p9_16&lt;/pre&gt;
&lt;p&gt;Patched compiler and then the OCAMLRUNPARAM will generate a lot of sampled snapshots of the OCaml heap. There's no need to change the code or the compilation options. Then install analysis tools&lt;/p&gt;
&lt;pre&gt;$ opam install ocp-memprof
$ ocp-memprof -loc -sizes PID&lt;/pre&gt;
&lt;p&gt;The final step analyses all the snapshots. But what is a snapshot? It's a compressed version of the OCaml heap, with location ids, a graph with pointers, and has saved globals (toplevel modules). We obtain the snapshots by computing a linear scan of all the heap values.&lt;/p&gt;
&lt;p&gt;The OCAMLRUNPARAM=m forces the program to generate a snapshot after every major GC, or request the program to generate a snapshot via a HUP signal, or via a new &amp;quot;dump_heap&amp;quot; function that's been added to the GC module.&lt;/p&gt;
&lt;p&gt;It works by reserving some space inside the standard OCaml value block, and so there is minimal runtime performance impact except when dumping out snapshots after a GC. There's no space overhead since the header size isnt changed. However, it's only available on 64-bit platforms and reduces block size to 64GB. Ran experiment with OPAM and location identifiers are limited.&lt;/p&gt;
&lt;p&gt;There's one tool based on the snapshot identifiers and the &amp;quot;memprof&amp;quot; tool gets all identifiers from the heap and the corresponding location, and then looks up the right types from a specific location using cmt files (the typed AST).&lt;/p&gt;
&lt;p&gt;Plan for this work is to improve the current framework (aggregate information by type and location) and to recover more types, and build more tools around it!&lt;/p&gt;
&lt;p&gt;Q: Roshan: one common usecase is when grabbing locations, its boring to see Array.create and it would be nice to see a backtrace of the execution to see &lt;i&gt;where&lt;/i&gt; the allocation happened.&lt;br/&gt;
A: this is a problem indeed (discussion about the ongoing Mark Shinwell patches too, and previous talk about backtrace analysis from last years workshop).&lt;/p&gt;
&lt;h2&gt;Benchmarking in Core&lt;/h2&gt;
&lt;p&gt;Roshan James about microbenchmarking in JS Core. Precise measurementis essential for performance critical code. We want to measure the execution cost of functions that are relatively cheap. Functions with a short execution time that run millions of times in a tight loop.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo23-e1380059673542.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo23-e1380059673542-150x150.jpg&quot; class=&quot;alignright size-thumbnail wp-image-1538&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The essence of benchmarking is to run a time loop (like Time.now) a lot of times. We need to figure out how to compute a batch size to account for the time it takes to run the actual timing measurement. Similar to Criterion for Haskell, where they loop Time.now to figure out how long it takes to compute the time itself, and then run the benchmark function, and compute a full estimate. This works ok, but it requires density plots to let you visualise the form of the error (bimodal, or something else, for example).&lt;/p&gt;
&lt;p&gt;There is a lot of noise in microbenchmarking, such as delayed costs due to GC, and variance in execution times is affected by batch sizes. So if we vary the batch size, the variance changes quite a bit since the GC is running in different intervals during the batches. The GC noise has a periodicity though!&lt;/p&gt;
&lt;p&gt;They treat microbenchmarking as a linear regression, and then fit execution time to a batch size. They vary the batch size geometrically to get a better linear fit (shows a very linear graph). Theres now no need to estimate the clock and other constant errors, since they are accounted for by the y-intercept which shows the constant costs.&lt;/p&gt;
&lt;p&gt;Other costs can also be predicted in the same way, such as estimate memory allocations and promotions using batch size too. This also allows measuring a goodness of fit by using R2 and bootstrapping techniques.&lt;/p&gt;
&lt;p&gt;Example use of Core_bech is really easy:just&lt;/p&gt;
&lt;pre&gt;open Core.Std
open Core_bench.Std
let t1 = Bench.Test.create ~name:&amp;quot;id&amp;quot; (fun () -&amp;gt; ())&lt;/pre&gt;
&lt;p&gt;Is the identity run for example, and just put something more complex in there. Output is an Ascii_table with lots of columns showing interesting results.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo24-e1380059880672.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo24-e1380059880672-150x150.jpg&quot; class=&quot;alignright size-thumbnail wp-image-1539&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Some functions have a strange execution time, and the observation isnt a great fit. Between runs, they also directly query the GC and directly query how many times some things have happened (minor collections and so on), and include these along with the batch size in the predictor. With multiple predictors, they are really close to the observed results indeed.&lt;/p&gt;
&lt;p&gt;(lots of interesting maths about how they perform runtime cost decomposition)&lt;/p&gt;
&lt;p&gt;Its available via &amp;quot;opam install core_bench&amp;quot; and they want to expose more predictors by measuring the effect of live words on performance, and counters for major collection work per minor gc. Accuracy of results is interesting as least-squares is susceptible to outliers so they can incorporate the knowledge that the measurement is heavy-tailed.&lt;/p&gt;
</content><id>http://www.syslog.cl.cam.ac.uk/2013/09/24/liveblogging-ocaml-workshop-2013/</id><title type="text">Liveblogging OCaml Workshop 2013</title><updated>2013-09-24T13:16:30+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://www.syslog.cl.cam.ac.uk/2013/09/22/liveblogging-cufp-2013/" rel="alternate"/><contributor><uri>http://www.syslog.cl.cam.ac.uk/tag/ocamllabs/feed/atom</uri><name>SRG Syslog</name></contributor><content type="html">&lt;p&gt;I'm here at the &lt;a href=&quot;http://cufp.org/conference/schedule&quot; title=&quot;CUFP 2013&quot;&gt;Commercial Users of Functional Programming&lt;/a&gt; workshop at &lt;a href=&quot;http://icfpconference.org/icfp2013/&quot;&gt;ICFP 2013&lt;/a&gt;) with Heidi Howard, David Sheets and Leo White.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/marius1-300x292.jpg&quot; class=&quot;size-medium wp-image-1410 alignright&quot; alt=&quot;marius1&quot; width=&quot;150&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Marius Eriksen and Michael Sperber are co-chairing this year. Functional programming is a hot topic these days, and this&amp;nbsp;year's program reflects the maturing nature of the program. Record number of submissions, and we could easily have made this a multi-day&amp;nbsp;program. &amp;nbsp;Videos will be available online after the event.&lt;/p&gt;
&lt;p&gt;Keynote is from &lt;a href=&quot;http://www.davethomas.net&quot;&gt;Dave Thomas&lt;/a&gt; on what we can learn from the &amp;quot;language wars of the past&amp;quot;. &amp;nbsp;His talk will cover the business, social and technical ends of building Smalltalk and his &amp;quot;objaholic&amp;quot; experiences with pushing language technology into businesses, where they never had any intention of changing in this regard. &amp;nbsp;This worked over the years because it made a material difference to these businesses. &amp;nbsp;Dave still uses the &lt;a href=&quot;http://en.wikipedia.org/wiki/K_(programming_language)&quot;&gt;K&lt;/a&gt; programming a lot at work.&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/clark1.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/clark1-300x294.jpg&quot; class=&quot;size-medium wp-image-1409 alignright&quot; alt=&quot;clark1&quot; width=&quot;150&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Dave is responsible for the Eclipse IDE and the IBM Java virtual machines, and has delivered software on everything from mainframes to wristwatches.&lt;/p&gt;
&lt;p&gt;Rush in the 70s with Symbolics and the amazingly cool hardware, followed by the rush to logic programming that led to his grants disappearing. Midway through the 80s, they discovered we wouldnt get parallelism for free with all this magic. After that came the era of machine learning and knowledge ontology crusades, but they are very specialised bits of tech. There remain sectors where ontologies are useful. Nowadays its the multicore crusades, and FP is emerging as useful.&lt;/p&gt;
&lt;p&gt;Every road leads to some form of FP, because the principles underlying it apply. Dave does vector programming, Haskell does this with array transformation.&lt;/p&gt;
&lt;p&gt;Dave was talking to Simon PJ outside and claimed that &amp;quot;FP has won!&amp;quot;, at which point Simon replied &amp;quot;really?&amp;quot; (laughter). OO techniques can also lead to a lot of tangled code: witness the evolution of Smalltalk to the current generation of languages.&lt;/p&gt;
&lt;p&gt;FP technical challenges: what happens when you have a lot of functions, and a group of consenting adults are doing it together. This is called software engineering, or at worst, IT!&lt;/p&gt;
&lt;p&gt;Lots of good work in the community on approaching large scale programming. Scala is a bit too complex for Dave (and audience rumbles in agreement or disagreement?). Java and JNI should just die. Erlang and actors are successful to decouple software. But do we really need to hide all our queues, and do we really need to hide our queues? Static analysis of queues are desired.&lt;/p&gt;
&lt;p&gt;Want to go fast? Computers like rectangles, all the way down! Array operations and vector processing is the way to go in the long-term.&lt;/p&gt;
&lt;p&gt;To go to industry, we need end-to-end toolchains. If you use MS Project, then you probably shouldn't introduce any new tools.&lt;/p&gt;
&lt;p&gt;The first commercial customer for Smalltalk in the 1980s was Techtronix, who wanted to embed reusable tech in their oscilloscopes. If you're building a serious product like this, it needed language interop between C++ (the logic sensor) and the Smalltalk. Respect the language cultures among components (anyone remember s-records?). ROM had to be replaced with Flash because noone can write code that doesn't need upgrading (groans from the audience).&lt;/p&gt;
&lt;p&gt;With the right tools, programmers will be able to go as quickly as Smalltalk, or at worse Java. We need the work of Simon [PJ] and colleagues on Haskell. Scala is so complex will become the Java (which is the Cobol of tomorrow).&lt;/p&gt;
&lt;p&gt;When shipping products, you need to track all the versions of language components in the toolchain. Too many FP toolchains are monolithic and make it hard to track components in the field. JVMs are so slow because they don't have a good sharing model (DLLs).&lt;/p&gt;
&lt;p&gt;What Dave would like is version-to-version transformation in languages. Y2K was a problem not because IBM hadn't fixed it in their OS, but because customers had modified their local installations and were pinned 6-10 versions behind! The same will happen for existing FPs that fragment into multiple implementations, so will they descend into multiple version hell or will standards emerge from the community?&lt;/p&gt;
&lt;p&gt;Also, lets not leave the data behind. Can we alias data from existing legacy sources into our new languages, and not aim for the perfect representations? Most of our programs are dealing with problems with existing data, not code.&lt;/p&gt;
&lt;p&gt;Onto deployment issues. Erlang works very well for the problem domain that it's designed for, but more complex domains exist like OSGI. Hot codeswap and live updates are often viewed as &amp;quot;boring problems&amp;quot; but are vital to real world deployments. Space usage must be paid attention to: how long can a given JVM stay up without leaking? Serialization is important to persist data across versions. If we're going to use &amp;quot;esoteric control structures&amp;quot; like CallCC, tailcalls or tags, the JVM isn't going to get us there.&lt;/p&gt;
&lt;p&gt;These days, if you can't stay in your local cache, you will lose several orders of magnitude performance... you'll need directly connected CPU (or SSD!) memory, and static initalization, and language interop (eagerly vs laziness). Functional data structures and immutable collections are still immature, but need more work to convince doubting Thomas' about their scalability in real applications.&lt;/p&gt;
&lt;p&gt;Hardware support for these are important. Intel Haswell has hardware transaction support (hence can be used by Azul JVMs etc) but we need more for functional langauge performance. There have been $2bn put into speeding up the JVM to make it as fast as C++. Google has a technology called Pinnacle which uses software write barriers that use VMs that execute directly, with a register model and not a stack model (which is easy to put together but hard to make fast). The new generation of language VMs will support direct execution and support modern functional programming languages.&lt;/p&gt;
&lt;p&gt;&amp;quot;We all love types&amp;quot; -- Dave on objects, but not variables (&amp;quot;its easy to be cooperative with that definition!&amp;quot;). Pluggable types by Gilad are really cute, because they move us towards a world where particular features (Dave likes behavioural types) can be woven in. Perhaps can be done in a dependently typed world. Another good candidate are approximate types and dimensional types. When all these are put together though, it all needs to fit together with sound compositional semantics.&lt;/p&gt;
&lt;p&gt;When using an interesting PL, Dave wants warnings to be emitted when the compiler makes space/time tradeoffs so that the programmer can decide between elegance and performance (also mentioned that Haskell programmers do this for .&lt;/p&gt;
&lt;p&gt;How does language evolution work? Arthur Whitney maintains K, and he ensures that every version of K is incompatible with the previous one. This is a blessing (!) since it avoids a kitchen sink language and ensures a high quality set of libraries. Quite often there's a tussle between languages and libraries because there's not enough coevolution. For example, are closures in Java really useful for the tradeoff in the complexity of the VM? Perhaps we should be looking towards a collection of small correct languages instead of a few partly right and largely wrong languages such as Ada or Java (the Java hate is strong here -- editor).&lt;/p&gt;
&lt;p&gt;Those of us that have programmed in vector languages (going back to APL) are largely write once read once languages because the code is so hard to read. One trick Dave does with K is to annotate comments inside expressions and use cold-folding without a point-free style to understand vector codeflow better. Also seeing the environment and current name bindings is extremely useful for teaching new languages.&lt;/p&gt;
&lt;p&gt;The real problem is: comprehensions, folds, monads -- WTF? Yet to see anyone from the monad community give a talk to understand monads. It's typically &amp;quot;you dont need monads&amp;quot; and then the word is used multiple times in the talk. If it's not important, why mention it so often? Quite often, the FP experience makes normal programmers feel stupid because they don't break through this terminology barrier. We as a community need to help people break through the barrier of not being formally trained in mathematics for whatever reason (&amp;quot;category theory for breakfast?&amp;quot;) and *be productive* in FPs.&lt;/p&gt;
&lt;p&gt;Smalltalk was like this in the early days. People see a blank window and aren't sure what to do next. Objects irritated people when they came out, but FP scares people. This is a danger as we go through and wow people with what we can do, but make it look like magic. People change their habits are different rates and we need to understand that. With Haskell, it was odd that he had to get the program &amp;quot;right&amp;quot; (or right/wrong) before it work, as opposed to not working.&lt;/p&gt;
&lt;p&gt;Bill Buxton (UI researcher friend) pointed out that people can't much get beyond programming a VCR. 4GLs were pretty much their limit. Dave's done a lot of work on evangelizing Smalltalk, but feels it was still too hard. People just didn't understand how to separate behavior, as the best practices on how to build objects were foreign to most of them. This all settled on some mix of SQL and some glue code, which doesn't require learning a lot of new technologies.&lt;/p&gt;
&lt;p&gt;Given there are many different types of programmers, do they all really need the full power of FP? Some subset of features is more useful, with one way to do things that doesn't change from release to release. For example, a simple dictionary keeps changing from Hashmap to concurrent Hashmap to something else, but ultimately is still a dictionary. How do we separate the reasoning over performance and structure and not scare people with both at the same time. Knuth started doing this decades ago with literate code, and we *still* dont have a decent way of writing documentation and code in the same place.&lt;/p&gt;
&lt;p&gt;We are still missing a pure FP book that is built in the same style and comprehension as &lt;a href=&quot;http://mitpress.mit.edu/sicp/&quot;&gt;SICP&lt;/a&gt;. We need thinks that you look the code and represent things more densely (for example, why don't we use Unicode in the same style as APL symbols to increase the succinctness?). They are working on J programs that move glyphs around on the iPad as an example of this 4GL density.&lt;/p&gt;
&lt;p&gt;We need to take all these ideas and *talk more* about metaphors in FP. Where's the &amp;quot;Scala, F#, Clojure, the good parts&amp;quot; and a frank exposition about the antipatterns? Don't lie about where the dragons are, but colour code them appropriately to not surprise programmers.&lt;/p&gt;
&lt;p&gt;We need to understand how to design with types. In the vector languages, this is called &amp;quot;shape shifting&amp;quot; as they don't have types, but similar concept. It's also hard to get the community people to talk about shape shifting, and as a result the art is being lost in the new generation of languages. For FP, can the Yodas in the audience help their audience to &amp;quot;trust the types&amp;quot; ?&lt;/p&gt;
&lt;p&gt;Q: In the top 20 languages, every language has a free-or-open-source runtime. This will make a huge difference as it lets people experiment.&lt;/p&gt;
&lt;p&gt;A: It's not been a barrier in experimentation for Dave, but it has been a barrier for commercial use. Dave would not attribute a particular significance to open source as it's never been a real problem for him (using trial versions and so forth). Open source is a mixed sword, as it tends to product impoverished language teams that don't have enough resources to move forward. The really good virtual machine implementors are commercially polished (c.f. the $2bn behind the JVM performance from earlier). Clojure is a great example where they appealed to the community to pay on their own behalf to donate for a production version. To build a serious production PL, you need a lot of government research money or a major commercial sponsor.&lt;/p&gt;
&lt;p&gt;Q: Marius asks about mobile and embedded and why FP hasn't cracked it.&lt;/p&gt;
&lt;p&gt;A: they are often late to the game, and it's often not easy to target the runtimes with a high performance runtime. You have to be willing to understand the interface.&lt;/p&gt;
&lt;p&gt;Q: Phil Walder says the scariest thing is that if you become a success, then Smalltalk takes the form of C++&lt;/p&gt;
&lt;p&gt;A: (or Java!). Being able to maintain the independence of the language creators vs a major player is crucial to conceptual integrity. (Phil) Tools that will migrate between version X and Y and a sustainable ecosystem. It's important to ensure that the creators get paid to maintain -- even the JVM only has 10-20 people in the core team and a vast ecosystem.&lt;/p&gt;
&lt;h3&gt;OCaml at Facebook via the Hack language&lt;/h3&gt;
&lt;p&gt;Julien Verlauget is talking about how Facebook is adopting OCaml.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/1148380_10151682552766094_1789859397_n.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/1148380_10151682552766094_1789859397_n-300x225.jpg&quot; class=&quot;alignright size-medium wp-image-1458&quot; alt=&quot;1148380_10151682552766094_1789859397_n&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Why PHP is good: fast installation times, lots of libraries, easy to learn, and scales in a parallel way (multiple instances).&lt;/p&gt;
&lt;p&gt;However, Facebook doesn't care about any of these features. What Facebook wants is a fast feedback loop between writing code and having it appear on screen. There's no good way to write a unit test for an experience, and instead a fast feedback loop between code and a live site is how people still work at Facebook today.&lt;/p&gt;
&lt;p&gt;Performance at the scale of Facebook really matters. 1% can be a huge bump, but PHP is really hard to optimize due to all the dynamic features in the language. Aside from runtime performance, the other concern is development time for engineers, who need to avoid security problems and general bugs in an incredibly large codebase.&lt;/p&gt;
&lt;p&gt;The first attempt at this was to scale the runtime via HipHop. The first attempt was to compile PHP into an interpreter (via sandboxes) and then compile production code to C++. Unfortunately this lead to a huge divergence in performance characteristics between the interpreter and compiled code which led to confusion in production.&lt;/p&gt;
&lt;p&gt;The current one is HHVM which is a combined model via JIT runtime that patches code at runtime and helps merge these models.&lt;/p&gt;
&lt;p&gt;HHVM is still a PHP platform, and a new model called Hack provides a *new programming language* that targets HHVM (which is essentially a PHP runtime).&lt;/p&gt;
&lt;p&gt;Hack is a &lt;b&gt;statically typed language for HHVM&lt;/b&gt;. It's compatible with PHP and interoperates with no overhead and has the same runtime representation as PHP. It has evolved from PHP, and so if you know PHP, you know Hack. It's designed for &lt;i&gt;incremental adoption&lt;/i&gt; via introducing gradual typing (c.f. keynote talk about not scaring programmers not used to types).&lt;/p&gt;
&lt;pre&gt;function foo(): void {
  $x = 'hello';
  return $x;
}&lt;/pre&gt;
&lt;p&gt;This returns a readable error message in the style of a statically typed language, since the inference algorithm keeps a witness about every value's type and shows counter examples.&lt;/p&gt;
&lt;p&gt;The Hack type system must be annotated with class members, function parameters and return types. Everything else is inferred to minimize programmer burden.&lt;/p&gt;
&lt;p&gt;Hack types include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Nullable such as
&lt;pre&gt;?int&lt;/pre&gt;
&lt;p&gt;mainly because of the huge code base that had no pattern matching, so null propagation is important&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Tuples&lt;/li&gt;
&lt;li&gt;Closures&lt;/li&gt;
&lt;li&gt;Collections such as
&lt;pre&gt;Vector&amp;lt;int&amp;gt;&lt;/pre&gt;
&lt;p&gt;that have generics too&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Constraints&lt;/li&gt;
&lt;li&gt;Type Aliasing&lt;/li&gt;
&lt;li&gt;Extensible Records&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Demo of a simple mailbox demo follows. HH has a command line mode that lets you syntax highlight which parts of the source code are dynamically checked, by outputing the code with red if it's potentially unsafe. Awesome!&lt;/p&gt;
&lt;pre&gt;class Mailbox {
  private $data;
  public function send($data) {
    $this-&amp;gt;data = $data
  }
  public function fetch() {
    return $this-&amp;gt;data;
  }
}&lt;/pre&gt;
&lt;p&gt;(very PHP like but now he annotates it with specific types)&lt;/p&gt;
&lt;pre&gt;class Mailbox {
  private string $data;
  public function send($data) : void {
    $this-&amp;gt;data = $data
  }
  public function fetch() : string {
    return $this-&amp;gt;data;
  }
}&lt;/pre&gt;
&lt;p&gt;As a programmer, I now want to know if this has all been statically checked (since the previous checking mode showed several red sections which were potentially unsafe). He runs the compiler with a strict mode that rejects the source if there is any unsafe bits.&lt;/p&gt;
&lt;p&gt;He then demonstrates how to propagate null types through the code, and then introduces several subtle errors that are all caught.&lt;/p&gt;
&lt;p&gt;An audience members asks what happens if you send both an int and a string to a mailbox, and Julien demonstrates a &amp;quot;mixed&amp;quot; type that covers both (is this some sort of row polymorphism? -- editor).&lt;/p&gt;
&lt;p&gt;The response time of the type checker is close to instantaneous (for the developer loop). Even with a thousand files, the type checkers gets back in a second or less with an error message.&lt;/p&gt;
&lt;p&gt;To get the tooling right, Hack uses js_of_ocaml to compile &lt;i&gt;the entire OCaml type checker&lt;/i&gt; to Javascript and then run in a complete web-based IDE (demonstrates a full cloud9-like IDE they use internally at FB). To work at scale, they created a server that runs persistently in the background and type checks all the files and responds from a memory cache.&lt;/p&gt;
&lt;p&gt;At scale, the the autocomplete requires very lowlatency in the webbased editor, and users also use version control (e.g. switching between branches). The server also has to use a reasonable amount of RAM and have a reasonable initalization time. Fundamentally it has to be stable as developers have to depend on their tools.&lt;/p&gt;
&lt;p&gt;A vast amount of code is written in OCaml for the tools. Good choice because it is ideal for symbolic computation, excellent performance and can be compiled to Javascript. Good C interop is really good. The main challenge is the lack of multicore, although Facebook works around it with their multiprocess architecture.&lt;/p&gt;
&lt;p&gt;Architecture: the master process has multiple processes which uses shared memory to avoid having to go through the master. The underlying buffers are lock free (similar to our Xen shared memory ring! -- editor).&lt;/p&gt;
&lt;p&gt;Advice on OCaml at scale:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IPC -- use lockfree structures and think about sockets/pipes instead of just TCP&lt;/li&gt;
&lt;li&gt;GC small heap and shared memory is compacted by master&lt;/li&gt;
&lt;li&gt;OCaml makes you think hard about shared objects, which is a good thing.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Q: is it open source??&lt;br/&gt;
A: soon, this is the first time Facebook has talked about it publically.&lt;/p&gt;
&lt;h2&gt;OpenX and Erlang ads&lt;/h2&gt;
&lt;p&gt;What is OpenX: (i) An opensource PHP ad server (ii) OpenX is a global company with an ad service featuring a big ad exchange written in Erlang. This talk is about the transition from PHP to Erlang.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-1.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-1-300x300.jpg&quot; class=&quot;size-medium wp-image-1401 alignright&quot; alt=&quot;photo 1&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;1998-2007. it was a conventional PHP management system and MySQL. The company started using it as an EC2-based SaaS ad server and serving up clients successfully.&lt;/p&gt;
&lt;p&gt;In 2008, they wanted to mix in an ad exchange, to add liquidity to marketplaces that have empty ads. At the same time, they moved offices to Pasadena and looked at new tech. Switched to Hadoop (Java) and Postgres (for some reason). Poor technical choices were made, such as writing to the database for every request (sometimes multiple times!).&lt;/p&gt;
&lt;p&gt;In 2009 as the customers increased, there was a big push to scaling things up for performance (this is when the speaker joined the company). Switched Postgres to Cassandra to move from a relational database to a more NoSQL approach that had the appropriate consistency properties. At this time, the architecture was also decomposed to give them headroom to scale for a while, particularly by adding HTTP load balancers and so on.&lt;/p&gt;
&lt;p&gt;They wanted to add even more low latency stuff, such as spot bids for immediate bids on empty slots. Anthony decides that the model was a good fit for Erlang, since one request needed to fan out to multiple backend services with a soft-realtime limit to return a response to the user. It took a few months to prototype an Erlang based solution which worked very well.&lt;/p&gt;
&lt;p&gt;After this first experience with Erlang and evangelising it, and pointing it out to his coworkers, they came up with another good problem: analyzing the frequency of how often someone looks at an ad. This required a new database that would hold bespoke data efficiently, and also integrated Riak from Basho to interface with the database to run the query engine. This now holds on the order of billions of keys.&lt;/p&gt;
&lt;p&gt;In 2007, they ran into problems with Cassandra due to making an incompatible upgrade which would have required OpenX to shut down their business to upgrade, which was unacceptable. Since they had a good experience with Riak core, they developed a new system to move away from Cassandra and add more Erlang for management stack.&lt;/p&gt;
&lt;p&gt;In 2011, they decided to split their UI layer into a more Web 2.0-like UI API. The API continues to be implemented in PHP (with a Javascript UI clientside), but the Erlang evolution continued with a gateway service and marketplace service that are both pure Erlang. The basic problem is ad selection, and the logic for this is written as a DSL implemented in both Erlang and Java to enable code reuse across the tools.&lt;/p&gt;
&lt;p&gt;However, Cassandra was still sticking around, and they wanted to move away from it. They implemented a data service layer to abstract away from the database. From the early days, they made a bad (but fast) choice to have clients directly call Cassandra via Thrift, as it was easy. They moved away to a more abstract model to get away from Thrift, and so could change clients. The new system could call both Cassandra and Riak to help evolve with both services running simultaneously and provide a &lt;i&gt;seamless migration path&lt;/i&gt; to the new service (in stark contrast to the Cassandra upgrade story from earlier).&lt;/p&gt;
&lt;p&gt;They also decided that the PHP use for the API was a bad idea, and so switched to Python. They engaged Erlang Solutions to write them an API router since their core team was busy (an example of external consultants coming in and being useful -- editor). The current system involved RabbitMQ coordination, and Riak's replication logic to move out to the colos for publication.&lt;/p&gt;
&lt;p&gt;Currently they have 14-15 services in Erlang 7-8 in Java, and a blend of Python/PHP.&lt;/p&gt;
&lt;p&gt;How did a PHP shop end up with so much Erlang? Well, they laid off all the PHP developers when they moved offices (lots of audience laughter).&lt;/p&gt;
&lt;p&gt;More seriously, the architectural choices are important:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cloud based (generic hardware, automated bootstrap, deployment, package oriented development and fault tolerance).&lt;/li&gt;
&lt;li&gt;Service based (loosely coupled, single purpose components, pools of components, polyglot so multiple languages/&lt;/li&gt;
&lt;li&gt;Cross language tools: Thrift (RPC between components), protobuf (RTB and Riak) and &lt;a href=&quot;http://www.lwes.org&quot;&gt;Lwes&lt;/a&gt; (logging and monitoring) which was open sourced by Yahoo after being originally written at Goto.com. A system called Framework that provides templates for code layout, builds RPMs/debs and integrates with autotools. It enforces versioning and reproducibility across languages.&lt;/li&gt;
&lt;li&gt;Finally, evangelism is really important. If possible fix the game via architectural choices to set the scene for change. Find a project to showcase the technology, and be responsible for the project's success. Make sure to share work, and remember that tools are &lt;i&gt;really important&lt;/i&gt; to make it easy for others to use.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Really important is figuring out build toolchain -- it can be so arcane. They did spend time on integrating with Erlang (erlrc inegrates with packaging system, erlstart to manage lifecycle, erlnode for ?).&lt;/p&gt;
&lt;p&gt;Hiring: train people rather than trying to hire knowledgeable. Operations have unfamiliar systems to manage, and developers have new concepts and patterns.&lt;/p&gt;
&lt;p&gt;How did Erlang help OpenX developers? The language fit the service model very well. The let-it-crash philosphy and supervision trees led to fewer real service outages.&lt;/p&gt;
&lt;p&gt;OpenX is doing really well as a business, too: 250+ billion monthly transactions, 12+ billion daily bids, thousands of machines in 5 colos, 300 employees and $150m+ revenue in 2012.&lt;/p&gt;
&lt;p&gt;Q: Marius: with a service based solution, how do you library them up?&lt;br/&gt;
A: Their services aren't hugely fine grained and so usually a module or two (not a lot of state)&lt;/p&gt;
&lt;p&gt;Q: Anil: is framework usable from languages? RPM integration seems killer&lt;br/&gt;
A: It's still esoteric and internals not docced, but would welcome a chat!&lt;/p&gt;
&lt;h3&gt;BAE systems on Redesigning the Computer for Security&lt;/h3&gt;
&lt;p&gt;Tom Hawkins speaking on DARPA funded project.&lt;/p&gt;
&lt;p&gt;SAFE is a codesign of:&lt;br/&gt;
a new application langauge (breezE)&lt;br/&gt;
a new systems programming language (Tempest)&lt;br/&gt;
A new OS&lt;br/&gt;
A new processor&lt;br/&gt;
and security at every level for defense in depth.&lt;/p&gt;
&lt;p&gt;Emphasising hardware enforced security since dynamic checking is too much overhead in software, for example for fine-grained information flow control. Hardware IFC handles the most general attack model (scripting down to machine code injection).&lt;/p&gt;
&lt;p&gt;Hardware overview: every word of data contains a tuple of (group 5 bits, tag 59 bits and payload 64 bit). The Atomic Group Unit checks atom typs (e.g. instructions, data pointers and streams). The Fat Pointer Unit (confusingly, FPU) checks pointer operations, and tag management unit (TMU).&lt;/p&gt;
&lt;p&gt;The label model can be used for efficient hardware typing, and more recently they are using labels for Control Flow Integrity (e.g. to prevent return oriented attacks). Register file is 32 elements deep, memory is accessed through load/store, and every bit of data in the system is a well-formed atom (and so has tag/groups associated with it).&lt;/p&gt;
&lt;p&gt;FPU deals with buffer range checks (e.g. underflow or overflows for a buffer).&lt;/p&gt;
&lt;p&gt;The TMU is where the magic is. It combines all the operations from the various operations being worked on (instructions, memory) and the TMU acts as a &amp;quot;database&amp;quot; checking that the operation is consistent with local policy, and the machine can continue execution or raise a security exception.&lt;/p&gt;
&lt;p&gt;At day 1, they had an outline for an ISA but nothing else. TIARA project was a baseline (Howie Shrobe, Andrw DeHon, Tom Knight) and they had no languages, no hardware and no toolchain.&lt;/p&gt;
&lt;p&gt;They started by sketching out an assembly language and then building an ISA simulator. They simulated simple assembly programs, and HW researchers started coding in Bluespec (a Haskell-like FP that Lennart keynoted about at CUFP 2011 in Japan).&lt;/p&gt;
&lt;p&gt;The PL researchers started designing Breeze. Plan was to &amp;quot;steal&amp;quot; Andrew Meyers work on JIF, and &amp;quot;Breeze should be done in a couple of months&amp;quot;!. It didn't quite work out that short (laughter).&lt;/p&gt;
&lt;p&gt;SAFE assembly is as low level as expected, but it adds some new properties:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;frames manage fat pointer bounds&lt;/li&gt;
&lt;li&gt;Atomic group declarations on data mark critical sections&lt;/li&gt;
&lt;li&gt;Tags on data can be marked (e.g. bootloader private)&lt;/li&gt;
&lt;li&gt;Secure closures is code/data with the authority to run code over the data (they call it gates)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Assembly is tedious and so they started with macros. The Breeze interpreter is now running and there was pressure to start building the compiler. The OS guys wanted a language to build the higher level components.&lt;/p&gt;
&lt;p&gt;Solution: a SAFE assembly DSL embedded in Haskell that uses Haskell as the macro language and becomes the library for the future Breeze compiler.&lt;/p&gt;
&lt;p&gt;Breeze Language: version 7 -- just the datatypes for Booleans was hard and took 4-5 weeks (&amp;quot;this IFC stuff is kind of tricky&amp;quot;). The convenience and modularity of lexical authority passing and one-principal per module is extremely inconvenient!&lt;/p&gt;
&lt;p&gt;SAFE Assembly in Haskell looks like a typical EDSL. A monad captures program descriptions, and macros set up data tags and also for better control flow (such as a while loop or ifelse conditionals in the asssembly).&lt;/p&gt;
&lt;p&gt;At Year 1.5, the EDSL is still assembly language, no matter how many macros there are. Manual register allocation, calling conventions and data structures. Meanwhile the Breeze compiler was inching off the ground, but there is an awkward transition from high level CPS IR to assembly. There needs to be an intermediate form somewhere. However, the SAFE EDSL in Haskell works great in the compiler backend plugged in seamlessly with the Breeze code generator, which was nice.&lt;/p&gt;
&lt;p&gt;Breeze Language is now on Version 12 and continues to answer questions. &amp;quot;What do we do on an access violation?&amp;quot;. Simply stopping the machine isn't enough, since &amp;quot;What if I maliciously send you data that you can't access?&amp;quot;. &amp;quot;Simple I'll just check the label before I attempt to read it?&amp;quot;. &amp;quot;But what if the label itself is private?&amp;quot;. This was the big &amp;quot;aha&amp;quot; moment in IFC, since private labels end up being a poison pill in IFC.&lt;/p&gt;
&lt;p&gt;At Year 2.0, the Breeze compiler is going through a major overhaul since it needs improvements (the middle IR is improved but not enough). They temporarily shelve the compiler and they realize it wont come to the rescue of the OS. They really needed a higher low-level language than just assembly.&lt;/p&gt;
&lt;p&gt;Breeze language v23 has a solution to poison pills: make all labels public! To label data you must specify the label in advance (brackets), but public labels are not compatible with lexical authority passing so they had to relax their original vision a little.&lt;/p&gt;
&lt;p&gt;Year 2.5: Tempest is started as the systems PL for SAFE. Imperative with register allocation and optimizations and control of assembly with inlining and user specified calling conventions. It uses the SAFE EDSL to generate assembly (that was a successful DSL) and nicely fills the Breeze IR gap in the compiler for when that is resurrected.&lt;/p&gt;
&lt;p&gt;Breeze language 34: delayed exceptions with not-a-value values (Nav).&lt;/p&gt;
&lt;p&gt;The Tempest EDSL with inline assembly has a SAFE assembly sublanguage. The SAFE flow isnow the Breeze, Templest and Safe Assembly layers, with EDSLs of each gluing the compiler pipeline together. There is a SAFE ISA simulator and debugger, along with a Bluespec simulator to save on the FPGA debugging cycles. The TMU is an elaborate piece of hardware (an exotic CAM and cache structure) that a lot of the effort has gone into.&lt;/p&gt;
&lt;p&gt;Lessons learnt:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;designing a higher order IFC language is &lt;i&gt;very hard&lt;/i&gt; even with some of the most brilliant PL researchers in the world. Optimal number of researchers is 2-7 rather than any more :) Ben Pierce and Greg Morrisett arguing over very hard problems was a lot of fun in a hard problem space.&lt;/li&gt;
&lt;li&gt;Day 1 should have started with Tempest, not assembly. Hard to be productive with assembly code, and tempest is the right level of runtime/processor codesign. Level of indirection provides insulation from a changing ISA.&lt;/li&gt;
&lt;li&gt;EDSLs are great for bootstrapping a language and make excellent backend libraries. However, engineers must be comfortable with the host language and not all the engineers were comfortable with Haskell when they started. EDSLs are hard to debug (line number information apparently hard to get out of error messages vs a concrete syntax).&lt;/li&gt;
&lt;li&gt;Concrete syntax is more relevnt for some languages than others (e.g. Tempest vs SAFE assembly). The best transition point to a concrete syntax is after developer pressure for modular programming. Once language has modularity, then the switch can be made without disruption.&lt;/li&gt;
&lt;li&gt;Would a DSL have helped hardware design? Forever debugging ISS and FPGA instead of raw Bluespec. A DSL describing ISA semantics would have kept is synchronized by generating Bluespec, ISS and SAFE EDSL and Coq documentation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This has been a huge project spanning a vast number of layers. It has produces a large number of interesting &lt;a href=&quot;http://www.crash-safe.org/papers&quot;&gt;papers&lt;/a&gt; including one at ICFP this week on testing non-interference quickly by using QuickCheck to generate programs that don't violate non-interference properties.&lt;/p&gt;
&lt;h2&gt;FRP at Netflix by Jafar Hussain&lt;/h2&gt;
&lt;p&gt;Netflix used to have tight coupling between the middle tier and the UI teams. One-sized fits all messages and led to inefficient call patterns.&lt;/p&gt;
&lt;p&gt;The plan was to decouple this by giving UI developers the ability to decouple components (or &amp;quot;force!&amp;quot;).&lt;/p&gt;
&lt;p&gt;Two developer personas at Netflix: Cloud and UI people. Netflix deals with a third of all US broadband traffic, so they need to think at scale but also to run on really tiny cheap devices that eke out all performance. How do they turn UI developers into effective cloud developers who think at scale?&lt;/p&gt;
&lt;p&gt;Gave them UI comforts: Groovy, OO API and a Reactive API. Most UI developers (or indeed any developers) can't be trusted with locks. This means that reactive programming isn't enough, which leads to &amp;quot;how do we make parallel programs safe for developers&amp;quot;&lt;/p&gt;
&lt;p&gt;Enter Erik Meijer, the legend himself! He asked &amp;quot;Whats the difference between a database query and a mouse drag event?&amp;quot;. Database would use functional code and a mouse drag might be imperative. Erik points out that they are both collections.&lt;/p&gt;
&lt;p&gt;New JS closure syntax in ES6 is fantastic to make them easier to use. If you imagine a query for well-rated movies, then you need to map over video lists. He then shows a mouse drag event, but points out that the structure of the code is very simpler. Instead of a &amp;quot;filter&amp;quot; operator, he uses &amp;quot;takeUntil&amp;quot; which stops the operation after some predicate has been satisfied.&lt;/p&gt;
&lt;p&gt;The iterator pattern is similar to the observer, except for the bidirectional signalling. Iterators can throw next/hasNext/Throwable, but Observers dont have a similar completion semantic. What happens when we add these to the Observer? We end up with &amp;quot;onNext&amp;quot; and &amp;quot;onCompleted&amp;quot; and &amp;quot;onError&amp;quot;, so now the Observer has comparable semantics to Iterator, so the only thing that changes is the direction of the errors.&lt;/p&gt;
&lt;p&gt;Some platforms also have an Iterable. There is now also an Observable to which you can pass an Observer, in the same vein as passing an iterator to a Java Iterable. We also add a Disposable to both, so that when the IO stream has terminated, it can be stopped immediately without having to junk the rest of the data.&lt;/p&gt;
&lt;p&gt;Erik and his team at MSR demonstrated that these patterns are dual, so that Iterable and Observable are dual! These are the Reactive Extensions libraries that is a combinator library for the Observable type. It's open source and has been ported to a number of other languages than C# (including Java).&lt;/p&gt;
&lt;p&gt;Observable Monad is a Vector version of the Continuation monad. Null propagation semantics of the Maybe monad and Error propgation semantics of the Either monad. Produced and consumed with side-efects and acts as a fault line between pure and impure code. It can be composed functionally and cancellation semantics are clean. It can be synchronous or asynchronous which is a common mistake (to assume that Iterable is async -- either can also be sync simply by calling the functions immediately).&lt;/p&gt;
&lt;p&gt;If you Map over Observable, then&lt;/p&gt;
&lt;pre&gt;(rapid transcript)
var map = (observable, func) =&amp;gt;
  { forEach: observer =&amp;gt; 
    {
    var subscription =
     observable.forEach
       onNext : item =&amp;gt; oserver.onNext(func(item))
       onError : error =&amp;gt; observer.onError (error)
       onCompleted () =&amp;gt; observer.onCompleted()&lt;/pre&gt;
&lt;p&gt;We can use this to come up with a single reactive type for cloud and UI developers! Jafar demonstrates example of social notifications in the middle tier, but using Observable to filter notifications from a composition of the socialService and messageService. Both underlying services are returning observables, and are non-blocking and completely parallel. Both can execute synchronously or asynchronously and decide which knobs to turn for their particular scheduling needs. The programmer doesn't need to care about the details.&lt;/p&gt;
&lt;p&gt;Another example is search autocomplete, which is surprisingly hard. Need to decide how often to send requests (throttle them to be not per-key) and also deal with concurrent responses from keypresses coming in out of order.&lt;/p&gt;
&lt;pre&gt;var res = 
  keyPresses.throttle(20).flatMap(
    search =&amp;gt; 
      getSearchResults(search).takeUntil(keypresses));

res.forEach(resultSet =&amp;gt; listBox.setItems(resultSet)&lt;/pre&gt;
&lt;p&gt;This code fragment does all this composably and handles all that logic. It's throttled, ordered correctly and terminates until the keypresses stop (with respect to the throttling policy.&lt;/p&gt;
&lt;p&gt;The full tier is a UI (huge amount of mutable state), dropping in to a distributed functional style, and heading into the data tier. Recall this is at huge scale.&lt;/p&gt;
&lt;p&gt;Wins: Rx is open sourced from MS and ported to Java (Observable) and generally better tooled now.&lt;br/&gt;
Evangelism comes up again since you can't assume the best technical solution will win. Practice public speaking and focussing on soft skills! Speaker got better in a short amount of time at distilling the essence of the benefits, and explaining to the target audience why something matters (e.g. to a UI developer vs a cloud developer as he explained earlier).&lt;/p&gt;
&lt;p&gt;Challenges: Training/Hiring. Netflix didn't fire all their UI developers as the previous speaker did (audience laughter). Instead, they leveraged their skills at eking out mobile performance, and taught them alternatives: functional programming, vector programming and reactive programming. Be available to help out people (developers work weird hours!) and interactive training exercises really help too. Also help them understand &lt;i&gt;when&lt;/i&gt; to apply each technqique for a particular programming task.&lt;/p&gt;
&lt;p&gt;Some of the Javascript programmers had some intuition for these techniques from things like Promises. It wasn't quite the right answer, as sometimes you need vector versions for performance instead (since it degenerates to a scalar version by passing a vector of size 1). Netflix dont bother teaching scalar, only vector.&lt;/p&gt;
&lt;p&gt;Although the programmers are used to mapreduce, the embedded version of this is a lot harder for them to grasp -- it's just a programming style and not just magic in Hadoop. Hiring process adapts to spot the competent functional programmer.&lt;/p&gt;
&lt;p&gt;bind/flatMap/concatMap/mapcat/mapMany are all monadic versions with subtle semantics and so they use interactive training exercises to train developers in their runtime semantics.&lt;/p&gt;
&lt;p&gt;Challenges: performance needs some chunking for lowend devices (vector a manually chunked scalar monad) and is best applied to less chatty event streams. It worked for search on lowend devices since it takes so damn long to type anything in, so a less chatty UI stream (audience laughter). &amp;quot;We are screwed if the hardware UIs improve&amp;quot;.&lt;/p&gt;
&lt;p&gt;Type-unsafe flatMap is easier to understand but needs to be used carefully, but is useful on lowend deviecs.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/Reactive-Extensions/RxJS&quot;&gt;http://github.com/Reactive-Extensions/RxJS&lt;/a&gt; has all the source, so give it a try!&lt;/p&gt;
&lt;p&gt;Q: How do Databinding in Rx?&lt;br/&gt;
A: No templates, but many other tiers before the view layer are bound together. We introduce an Observable with both pure and impure code (an Observable type with a value property). However they learnt how to do this directly since Observable's lazy default is the wrong for data binding. Implementing a different type that is strict and publishes the result directly.&lt;/p&gt;
&lt;h3&gt;Medical Device Automation using message passing concurrency in Scheme&lt;/h3&gt;
&lt;p&gt;What does a molecular diagnostic device do and what does Scheme have to do with all this?&lt;/p&gt;
&lt;p&gt;Detects the presence of specific strands of DNA/RNA in sample and then does necleic acid extractions and purification. Sample are excited using lasers as they undergo PCR which results in spectrographs.&lt;br/&gt;
Device contains 19 boards with temp, motor control with many parts that move simultaneously at very high precisions. (author shows demos of the motors running and playing music from the system!)&lt;/p&gt;
&lt;p&gt;Client is written in C# and WPF and is thin/stateless. Sever is written in Scheme and Erlang with OTP embedded. Supervision structure to isolate hardware failures. A DSL provides the glue logic.&lt;/p&gt;
&lt;p&gt;Scheme is exceptionally clear and simple syntax, and they love the hygeinic syntactic abstractions for their DSL and the first-class functions and continuations are key. Arbitrary precision arithmetic is important for result calculations.&lt;/p&gt;
&lt;p&gt;The Erlang embedding in Scheme is how they interop. They embed records by referring to structured data by field name instead of field index. This allows for copying a record and changing particular fields.&lt;/p&gt;
&lt;p&gt;There's no pattern matching built into Scheme and enables matching on all the usual datatypes (strings, lists, vectors and records). It also allows matching the value against a local variable and/or binding values to local variables in the pattern itself, which is new in Scheme (but quite ML-like? -- editor)&lt;/p&gt;
&lt;p&gt;Processes are on-shot continuations with software timer interrupts. The Gen-server patterns provide a functional way of serializing messages and mutating state. The init/handle-call/handle-cast/handle-info and terminate are all encoded, and so it's all done except code-change (the FDA wouldnt appreciate code changing on the fly!)&lt;/p&gt;
&lt;p&gt;The event manager is responsible for event logging and subscriptions, and supervisors monitor processes and execute a restart or clean shutdown semantic (with enough logging for a field debug cycle).&lt;/p&gt;
&lt;p&gt;How it works in the instrument server: &amp;quot;let is crash&amp;quot; throughout and a notable lack of defensive programming due to the actor model. They manage some big hardware which fails all the time and this architecture directly addresses that reality.&lt;/p&gt;
&lt;p&gt;Easy assay is executed via a DSL which defines the pipeline in a &lt;i&gt;confirm mode&lt;/i&gt; to estimate running time, suggest missing resources and warn about a lack of timeslots. Once satisfied this is all taken care of, the queuing is done via a Tetris-style binpacking heuristic. Each action has its own process for fault tolerance. The DSL exposes an option to ignore action failures which is important for test runs and debugging (also during hardware development).&lt;/p&gt;
&lt;p&gt;Some examples of device failures are very bad: &lt;b&gt;Therac 25&lt;/b&gt; was a RTOS that gave people fatal radiation doses. It was tracked down to bad use of mutable state and integer overflow (taken care of in their system with FP and arbitrary precision math). &lt;b&gt;Ariane 5&lt;/b&gt; was due to interger overflow due to conversion precision, which also doesn't happen in their Scheme system which has non-lossy conversion. And finally the space shuttle simulator crashed due to memory unsafety (a restart was unclean), which cannot happen in Scheme. The supervision hierarchy in Erlang/Scheme can handle crashes with a stable strategy at any layer.&lt;/p&gt;
&lt;p&gt;Why a DSL? The assay developers need to write their own recipes such as &amp;quot;which recipes for this instrument, and in which order?&amp;quot;. The scientists shouldn't need software engineers to help them work, so the DSL sorts that out. Mechanical engineers need to check reliability and timing/variability on the hardware, which they can do by configuring DSL parameters.&lt;/p&gt;
&lt;p&gt;There are a few bits to the DSL: an extraction/purification language (tip loading, pipetting, moving magnets) and the protocol language (aspirating, dispensing, etc) and finally the motor language.&lt;/p&gt;
&lt;p&gt;Shows an example of the PCR language, which is a complex recipe involving baking, thermal cycling in loops. The DSL follows the logic flow of the English language version of the recipe very closely (with more brackets).&lt;/p&gt;
&lt;p&gt;Wrote a web server that supports HTTP requests and JSON/jQuery and an sexpression-based HTML code generator. Can render pages with Scheme logic and render to webbrowsers. Use by engineers for debugging and prototyping without having to touch the real UI, and non-engineers use it to map data sources from instruments into JSON (which can be fed into validation tools, for example to send to the FDA for regulation).&lt;/p&gt;
&lt;p&gt;Lessons learnt:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Message passing is great but not a silver bullet. Gen servers can deadlock between each other despite being deadlock free internally. Timeouts in genservers and supervisor logging makes this possible to catch at a higher level, which is crucial!&lt;/li&gt;
&lt;li&gt;Not much on the web about a design pattern for the supervisor structure, so they had to pioneer it (didnt really want to pioneer it though)&lt;/li&gt;
&lt;li&gt;Automated unit test frameworks also built by them by hand&lt;/li&gt;
&lt;li&gt;Hiring remains hard into this unique environment.&lt;/li&gt;
&lt;li&gt;Existing quality metrics like bug density are problematic, since Scheme is terse and so looks artificially worse than more verbose languages!&lt;/li&gt;
&lt;li&gt;FDA has more scrutiny into this system since this is different from the usual C/C++/C# codebases and also the large number of open source tools such as Sqlite/Emacs/git. Unique to this regulated problem space of course.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Message passing concurrency makes reasoning about semantics of concurrent process easier, ass well as debugging problems via fault isolation. Let-it-crash leads to shorter, less defensive code with fewer branch points and test cases. Strong typing and runtime checks provide cognizant failure instead of silent corruption (crucial to avoid in this medical space).&lt;/p&gt;
&lt;p&gt;Mixing languages has been nice, since they can pick the good bits of Scheme (macros, arbitrary precision math) and Erlang (OTP). DSLs provide the glue here, and rapid prototyping for non-expert software developers.&lt;/p&gt;
&lt;h2&gt;Gilt and Scala microengines&lt;/h2&gt;
&lt;p&gt;Clothing group, and they need to customize the website with per-user targetting. The customer facing stuff is the tip of the iceberg with a bunch of backoffice features that need to be plumbed through. The traffic patterns are all about flash traffic that spike massively during sales, and if they go down in these times they lose lots of money.&lt;/p&gt;
&lt;p&gt;Gilt is about six years old, and it was built as a Rails app in the beginning that was quite large. It had unclear ownership, complex dependencies, lengthy test cycles, and unexpected performance impacts from small changes. Rails encourages to &amp;quot;throw everything into one directory -- a thousands models in one directory&amp;quot; which is really unscalable as the number of engineers grew. Some bad production issues came out of this problem.&lt;/p&gt;
&lt;p&gt;Then they started to transition to microservices by transitioning a few core critical pieces into microserviecs such as inventory management. The number of services grew to over 300 services in just 4 years (each HTTP microprotocols), all built using Scala. They developed an architecture to support this sort of growth of microservices.&lt;/p&gt;
&lt;p&gt;Cornerstones of infrastructure (goal==cool stuff for customers!)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;b&gt;Build system:&lt;/b&gt; SBT is a &amp;quot;simple build tool&amp;quot; which then turned into &amp;quot;Scala build tool&amp;quot; due to its complex mental model. Configuring everything correctly can be tricky if you have a number of dependencies. Gilt wanted to abstract developers from this so they could focus on writing appliction code. They solved it via a large SBT plugin that takes care of dependency management that provides a standardized configuration for everything.&lt;br/&gt;
A complete build specification is shown which is very succinct: it just has a combinator for adding dependencies. Behind the scenes, the plugin provides a huge amount of support (testing, rpms, dependency, continuous builds, and many more)&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Configuration&lt;/b&gt; is handled by a Zookeeper cluster and can be overridden with local files or system properties. It's mapped into strongly-typed classes in Scala and validated via Hibernate so that configuration must match up with service expectations.&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Testing&lt;/b&gt; is the most challenging part of a microservice architecture. Functional tests are the gold standard, but hard for developers to run 300 services on their local laptops. Unit tests can run locally, but there's no mocking service for these (and overmocking results in useless testing that in non representative). They use the Cake pattern for dependency injection, which enables type-safe and scalable composition. It uses Scala's self-types and multiple trait inheritance. Things like object repositories or configuration providers can be expressed in this way. The pattern lets them mixin different sources and weave in real/mocked sources.&lt;b&gt;UI Testing&lt;/b&gt; is handled via Selenium and is built on ScalaTest. Automated browser testing with reusable components works well, and leverages Scala's type system well to reject invalid tests/code/configuration.&lt;/li&gt;
&lt;li&gt;Continuous Delivery lets them deliver 20 to 30 service versions every day using the aforementioned structures&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Some cool stuff: on their website, there are badges on their website showing inventory for each item. The inventory badges update in realtime as you look at the page, which really motivates people to buy as they spot inventory dropping down. Shoppers get excited and feel like they're in a Black Friday sale and are engaged in the shopping activity! Building this stuff was quite easy to do using event-driven Play application and Akka actors.&lt;/p&gt;
&lt;p&gt;They build on this for &amp;quot;freefall sales&amp;quot;. Essentially a Dutch auction and is also web sockets and Play based. It initiates a sale that lasts for a fixed time with the price dropping regularly. The highlight is a $16000 purse that leads to audience laughter.&lt;/p&gt;
&lt;p&gt;Q: how to deal with production side of microservices such as service discovery or log aggregation?&lt;br/&gt;
A: no service discovery as Zookeeper tracks where everything is (which ports something is on). Log aggregation isnt great at the moment, so they're working on centralized collection atm.&lt;/p&gt;
&lt;p&gt;Q: what's the greatest win of FP here? Is type safety really important or something like that?&lt;br/&gt;
A: in the context of the company development and the technical stack, one nice thing about Scala is that it combines the &amp;quot;good parts&amp;quot; of Ruby (concise, expressive) with type safety and performance (as they had in Java). Scala provided a balance between Java and Ruby by giving them type safety, performance and conciseness, which is a big win in terms of expressivity and reuse of components.&lt;/p&gt;
&lt;p&gt;Q: how do you handle versioning of microservices?&lt;br/&gt;
A: each service maintains back compat in its API until they ensure all their clients are upgraded. The URI path has the version number, so service providers bump the version number for new clients and keep the old version working. They then migrate all the clients of the service as quickly as is practical.&lt;/p&gt;
&lt;h2&gt;PalletOpts and infrastructure automation&lt;/h2&gt;
&lt;p&gt;(I missed a lot of this talk due to a lunch chat spilling over. I'll fill it in later --editor)&lt;/p&gt;
&lt;p&gt;A Clojure DSL that runs shell scripts and handles very complex infrastructure automation.&lt;/p&gt;
&lt;p&gt;Q: Yaron: How do you handle error propagation through scripts (the equiv of set -e in sh)&lt;br/&gt;
A: Each combinator propagates errors and there are different run strategies that handle errors differently depending on needs.&lt;/p&gt;
&lt;h2&gt;Streaming data at Twitter with Summingbird&lt;/h2&gt;
&lt;p&gt;Speaker is &lt;a href=&quot;http://twitter.com/sritchie&quot;&gt;@sritchie&lt;/a&gt; (&lt;a href=&quot;https://speakerdeck.com/sritchie/summingbird-at-cufp&quot;&gt;his slides&lt;/a&gt;). &lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-3.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-3-300x300.jpg&quot; class=&quot;size-medium wp-image-1399 alignright&quot; alt=&quot;photo 3&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Summingbird is how to do streaming Map Reduce at the scale they have at Twitter (scale is &amp;quot;staggering&amp;quot;). It has been open sourced since Sep 3rd and a bunch of internal systems at Twitter run on it. Mainly three people: @posco @sritchie and Ashu -- small teams.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Vision&lt;/b&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;b&gt;&amp;quot;Write your logic once&amp;quot;&lt;/b&gt;: Twitter has a number of 1000+ host Hadoop clusters and a lot of their data is done via k/v processing with Hadoop. Going streaming had to be done evolutionary by letting it be done either on Hadoop or on some new streaming service. Programmers experimenting with data shouldn't have to make systems decisions early on in the process. Twitters scale: 200m+ active users, 500M tweets/day and scale is pervasive.&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Solve systems problems once&lt;/b&gt; so that systems that are scaling stay fixed.&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Make non-trivial realtime compute as accessible as Scalding&lt;/b&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This leads onto Summingbird: a declarative map/reduce streaming DSL. It's a realtime platform that runs on Storm, and a batch platform that runs on Hadoop. The datastructures that come out of the DSL can be run on either platform (so you can choose between batch/streaming very late in the process).&lt;/p&gt;
&lt;p&gt;One of the big concepts that Summingbird embraces is the idea of &amp;quot;associative plus&amp;quot; operations -- the monoid.&lt;br/&gt;
The 4 S' of Summingbird (&amp;quot;you know you're onto something when they all have something in common!&amp;quot;):&lt;/p&gt;
&lt;pre&gt;Source[+T]
Store[-K,V]
Sink[-T]
Service[-K,+V]&lt;/pre&gt;
&lt;p&gt;Source is where data comes from, Store is a k/v store that is being aggregated into. Sink is a dump as processing items, and Service permits k/v lookups during a job.&lt;/p&gt;
&lt;p&gt;Store: what values are allowed? What constraints can we place on a MR job such that any valid value can make progress.&lt;/p&gt;
&lt;pre&gt;trait Monoid[V] {
  def zero: V
  def plus(l:V, r:V):V
}&lt;/pre&gt;
&lt;p&gt;&amp;quot;less scary than a monad!&amp;quot;. If you can take any two values and smash them together, you have a monoid -- e.g. integers. Also Sets have a monoid (concat) and lists (concat) and maps (recursively pull in the monoid on the value). Others include: HyperLogLog, CMS, ExponentialMA, BloomFilter, Moments,MinHash,Topk. All you need to do is find a datastructure with a monoid and you can use Summingbird. There is an open source library called Algebird (birds birds birds!).&lt;/p&gt;
&lt;p&gt;It took some convincing (the words like &amp;quot;monoid&amp;quot; still scared people at Twitter, sadly).&lt;/p&gt;
&lt;p&gt;Monoids are amazing due to Associativity. If you know that the values you are reducing are associative, then it's easy to parallelise since they can be built &amp;quot;in any order&amp;quot;.&lt;/p&gt;
&lt;p&gt;Even though realtime is important at Twitter, noones wanted to dip in due to the difficulty of getting started. Summingbird can pull in data from an existing static Hadoop cluster and then union it with a realtime feed. If you give the logic to Summingbird, it will run the logic on Hadoop (consuming discrete batches of data) and the client will keep track of how far it's gone. The realtime comes from partial aggregations over fixed time buckets, and is merged together in the client using the monoid to aggregate them together to look like a proper realtime feed.&lt;/p&gt;
&lt;p&gt;One cool feature: when you visit a tweet, you want the reverse feed of things that have embedded the tweet. The MR graph for this comes from: when you see an impression, find the key of the tweet and emit a tuple of the tweetid and Map[URL,Long]. Since Maps have a monoid, this can be run in parallel, and it will contain a list of who has viewed it and from where. The Map has a Long since popular tweets can be embedded in millions of websites and so they use an &amp;quot;accountment sketch&amp;quot; which is an approximate data structure to deal with scale there. The Summingbird layer which the speaker shows on stage filters events, and generates KV pairs and emits events.&lt;/p&gt;
&lt;p&gt;Twitter advertising is also built on Summingbird. Various campaigns can be built by building a backend using a Monoid that expresses the needs, and then the majority of the work is on the UI work in the frontend (where it should be -- remember, solve systems problems once is part of the vision).&lt;/p&gt;
&lt;p&gt;Future plans:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Akka, Spark, Tez platforms&lt;/li&gt;
&lt;li&gt;Pluggable graph optimizations since various planners do improved filter push&lt;/li&gt;
&lt;li&gt;Metadata publishing with HCatalog -- in OSS, this means better tooling for EC2 and other cloud platforms.&lt;/li&gt;
&lt;li&gt;And of course, more tutorials&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All work happens on Github so contributors are welcome.&lt;/p&gt;
&lt;p&gt;Summingbird is working well for the majority of realtime apps at Twitter. It's all about the Monoid! Data scientists who arent familiar with systems can deploy realtime systems, and 90%+ of the code is reused across the realtime and batch systems.&lt;/p&gt;
&lt;p&gt;Q: Did Hadoop need any changes to cope with the interfacing with Summingbird.&lt;br/&gt;
A: Scalding (written at Twitter) handles much of the interfacing with Hadoop. Hadoop is really the classical k/v store now. Real problem is figuring out which operations can work on both the batch and realtime and only admitting realtime.&lt;/p&gt;
&lt;p&gt;Q: Yaron: associativity is one nice thing about Monoid, but what about commutativity is also important. Are there examples of non-commutative datastructures&lt;br/&gt;
A: Good examples. It should be baked into the algebra (non-commutativity). This helps with data skew in particular. An important non-commutative application is Twitter itself! When you want to build the List monoid, the key is userid,time and the value is the list of tweets over that timeline (so ordering matters here). It's not good to get a non-deterministic order when building up these lists in parallel, so that's a good example of when associativity and commutativity are both important.&lt;/p&gt;
&lt;h2&gt;Functional Probabilistic Programming&lt;/h2&gt;
&lt;p&gt;Avi from Charles River, introducing the Figaro language.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Problem&lt;/b&gt;: Suppose you have some information (&amp;quot;suppose Brian ate pizza last night&amp;quot;) and you want to answer some questions based on this (&amp;quot;is Brian a student or a programmer?&amp;quot;) and keep track of the uncertainty in the answers.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Solution&lt;/b&gt;: Create a joint probability distribution over the variables, assert the evidence and use probabilistic inference to get the answer back.&lt;/p&gt;
&lt;p&gt;One common way to do this generative models. Probabilistic models in which variables are generated in order. Later values can depend on previous variables with a binding. This is a v popular approach with several implementations available over the years.&lt;/p&gt;
&lt;p&gt;Developing a new model requires figuring out a representation, an inference algorithm and a learning algorithm. All of these are significant challenges with each of them still being considered paper-worthy.&lt;/p&gt;
&lt;p&gt;The dominant paradigm is functional probabilistic programming. An expression describes a computation that produces a value.&lt;/p&gt;
&lt;pre&gt;let student = true in
let programmer = student in
let pizza = student &amp;amp;&amp;amp; programer in 
(student, programmer, pizza)

let student = flip 0.7 in
let programmer = if student flip(0.2) else flip(0.1) in
let pizza = if student &amp;amp;&amp;amp; programmer flip(0.9) else flip(0.3)
(student, programmer, pizza)&lt;/pre&gt;
&lt;p&gt;How are we supposed to understand this kind of program. Sampling semantics: run this program many times, each with a sample outcome. In each run, each outcome has some probability of being generated. The program defines a probability distribution over all the outcomes.&lt;/p&gt;
&lt;p&gt;This is a powerful approach since we are taking a Turing powerful language and probabilistic primitives are added, and this naturally expresses a wide range of models.&lt;/p&gt;
&lt;p&gt;Structured variable elimination, Markov chain Monte Carlo, importance sampling and so forth can all be built using functional probabilistic programming. PPLs aim to &amp;quot;democratize&amp;quot; model building -- one shouldn't need extensive training in ML or AI to build such models, or use them effectively.&lt;/p&gt;
&lt;p&gt;IBAL (2000-2007) is the first practical PPL, implemented in OCaml but not embedded in OCaml. Exact inference using structured variable elimination and later had intelligence important sampling. However, it was hard to integrate it with applications and data (in IBAL the data had to be hardcoded into the data, which wasnt practical). It also lacked continuous variables. Therefore the speaker built Figaro to work around the limitations.&lt;/p&gt;
&lt;p&gt;Figaro (2009-present) is a EDSL in Scala and allows distributions over any data type. It has a highly expressive constraint system that allows it to express non-generative models. There is an extensible library of inference algorithms that contains many of the popular probabilistic inference algorithms (eg. variable elimination).&lt;/p&gt;
&lt;p&gt;The goals of Figaro are to implement a PPL in a widely used library: Scala is the interop language as Java compat is a prime goal. Figaro provides various good abstractions such as OO that come out of Scala (not sure, he skipped slide rapidly here? -- editor)&lt;/p&gt;
&lt;p&gt;Figaro has an &lt;code&gt;Element[T]&lt;/code&gt; which is a class of probablistic models over type T. Atomic elements (Constant,Flip, Uniform, Geometric) are combined with compound elements &lt;code&gt;(If (Flip(0.9), Constant(0.5)...)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Under the hood, there is a probability monad to track the state. The Constant is the monadic unit and Chain(T,U) implements the monadic bind. Apply(T,U) implements monadic fmap. Most elements in Figaro are implemented using this monad.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-4.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-4-300x300.jpg&quot; class=&quot;size-medium wp-image-1400 alignright&quot; alt=&quot;photo 4&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Example 1: Probabilistic walk over a graph. In Figaro, we start by defining datastructures over the webpage graph (Edge, Node, Graph) and then we define some parameters of the random walk.&lt;/p&gt;
&lt;p&gt;Example 2: Friends and smokers. Create a person with a smokes variable. Friends are three times as likely to have the same smoking habit than different, so this is a constraint variable. Finally this is applied to all pairs of friends by adding constraints to the pairs. This is then instantiated in a particular situation by building a set of people (alice, bob, clara) and running the inference algorithm (VariableElimination) to calculate the probability that Clara smokes.&lt;/p&gt;
&lt;p&gt;Example 3: Hierarchical reasoning. We observe an object (say a vehicle on a road, or a person, or something) and we want to know what type of object it is. We have some observations about this object (its size, color or shape) and we want to know if its something we should be interested in. It's very natural to think of these objects via an inheritance hierarchy. In Figaro, every element has a name and belongs to an element collection. A reference is a sequence of names (such as vehicle size). Starting with an element collection, we can get to the vehicle associated with an element (go through through the sequence of nested element collections). However, there may be uncertainty in the identity of a reference (e.g. you dont know what vehicle1 is). Figaro resolve the element to the actual element.&lt;/p&gt;
&lt;p&gt;Obtaining Figaro is free and open source (cra.com/figaro) but v2 is on GitHub (like everything else today, it seems).&lt;/p&gt;
&lt;p&gt;Q: What are the limitations of Figaro, such as non-terminating Bernoulli tasks and what constraints cant be encoded?&lt;br/&gt;
A: Anything you can express can be put in constraints since any code can go in there. It's very easy to express something that you cant compute. Figaro is working on helping the programmer that can be computed over, such as via rejection sampling or simply rejecting the bad constraint.&lt;/p&gt;
&lt;p&gt;Q: Similar to Norman Ramsey's work (such as Church), whats the relationship&lt;br/&gt;
A: The languages fall into categories: their own languages and embedded libraries. The latter is Figaro and Infer.NET and Factory. INFER.NET is limited in expressivity and so can be compiled into a factor graph so is very efficient. Similarly Factory is lowlevel and compiles to factor graph. Lots to discuss here.&lt;/p&gt;
&lt;h2&gt;Haskell and FPComplete&lt;/h2&gt;
&lt;p&gt;Company exists to fix Haskell development tools. All the tools are cloud-based and run in a web browser. Content can be browsed anonymously. This talk will not have the Monad word in it!&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo4.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo4-300x300.jpg&quot; class=&quot;alignright size-medium wp-image-1425&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;There exists a feature to create tutorials and embed code within those tutorials.&lt;/p&gt;
&lt;p&gt;Latest product (being announced today) is a Haskell IDE that is a web based tool which requires no setup and no download. It has a number of cool features:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Errors are displayed immediately as it compiled as you type&lt;/li&gt;
&lt;li&gt;Git based so full version control&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Company goals: increase Haskell adoption and make it more accessible. Offer commercial grade tools and support and simplify Haskell development. Also to support the Haskell community and leverage the community to improve FP Complete's own products.&lt;/p&gt;
&lt;p&gt;The FP Haskell Center (released in Sep 2013) has:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a web front end (no setup,access to help and integrated with Haskell)&lt;/li&gt;
&lt;li&gt;Haskell backend has project management, developer feedback with errors, build system and a cloud based execution and deployment platform. The cloud allows for faster product evolution!&lt;/li&gt;
&lt;li&gt;Soon to have a personal version and version that will work behind firewalls etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It is all implemented in a Haskell web framework like Yesod. Lots of library support via conduits, and the UI uses Javascript (via Fay). All the heavy lifting is done in the backend and not via Javascript. Very few issues surfaced using Yesod and no major modifications were required to build their product.&lt;/p&gt;
&lt;p&gt;Challenges were outside the scope of Haskell usually, but Haskell was used to fix them.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Javascript coding was significant in the frontend&lt;/li&gt;
&lt;li&gt;Stable set of libraries are important&lt;/li&gt;
&lt;li&gt;Compiler integration (feedback and errors) must be available as a library to let the IDE spot identifier location problems&lt;/li&gt;
&lt;li&gt;Uses LXC containers to created isolation containers -- ephemeral storage and containers can run on either shared or dedicated systems.&lt;/li&gt;
&lt;li&gt;IDE uses isolation git state to separate users from each other. When projects are created, there is a visual representation of projects (in git repositories each, in S3) and each repo is accessed via Gitlib-2. Interesting is that this offers multiple backends for git access: Git C library, GitHub C library, IDE local repo in S3 or others in the future.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For building projects, code is being precompiled continuously in the backend and so bytecode can generated quickly and run within the IDE. Bytecode runs in the GHC frontend container and exceptions dont break the IDE. Keter and Chef provide deployment assistance to get it into a shared application server or container, and FP Complete offers this deployment as part of their product.&lt;/p&gt;
&lt;p&gt;Billing Processor provides SOAP APIs. Added SOAP Haskell libraries to Haskell via C++ bindings.&lt;/p&gt;
&lt;h2&gt;Mobile gaming from Japan&lt;/h2&gt;
&lt;p&gt;They normally built mobile games using Ruby, PHP, etc, but have switched to FP in recent years for reliability, high performance and productivity. However, they've suffered from memory leak (blaming Haskell's laziness, to audience laughter), and some data loss and performance degradation.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo3.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo3-300x300.jpg&quot; class=&quot;alignright size-medium wp-image-1424&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Gree is one of the largest mobile games platforms, with 37 million users and 2000 games as of June 2013. They develop social games and a platform for 3rd party games. They also do social media and advertising and licensing, and also venture capital.&lt;/p&gt;
&lt;p&gt;Employees are 2582 with a significant number of engineers (cant disclose exact numbers). On client side, it's normally Java, ObjC, Javascript and Unity/C#. Server side is usually PHP, MySQL and Flare (a KV store written in C++ developed internally at Gree). They started a Haskell project in Jun 2012 and they have 6 Scala and 4 Haskell engineers.&lt;/p&gt;
&lt;p&gt;They developed a KVS management system using Haskell, to setup and destroy KVS nodes in response to hardware faults and sudden access spikes. It's used in a large social game application. Another example is an image storage gateway, which converts WebDAV to memcached/S3 for the SNS photo uploader to store images. It uses Warp and http-conduit to do this conversion.&lt;/p&gt;
&lt;p&gt;Some pitfalls they faced with Haskell:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Memory leaks via lazy evaluation: frontend server keeps a list of active thread ids in a TVar for monitoring. When deleting from the thread list, the function didnt reduce the function to a normal form and so held onto a reference. This led to a serious memory leak that took the service down. It was fixed easily by evaluating to the normalform and forcing sequentialisation. They felt it is too easy to mix up TVar/MVar writes with other IO operations (which do reduce to normal form and avoid the leak). There is much confusion over the strict/lazy alternatives for non-IO functions&lt;/li&gt;
&lt;li&gt;Race conditions: Data put in a queue is very rarely lost. The reason is that the timeout functions can be used only once safely with an IO function. (details omitted)&lt;/li&gt;
&lt;li&gt;Performance degradation: from forking a lot of threads to do monitoring. This was easy to fix but happens often since Haskell libraries are developed actively and the implications of changes are not always obvious.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;How to fix all this? Better &lt;b&gt;testing&lt;/b&gt; to start with. Haskell has a great QuickCheck framework and they developed HUnit. This lets services be started in the setup (in their example, memcached using a spare port), and then run services against it and make sure its torn down in a timely fashion. They used this to extensively test their KVS system and Flare (written in C++). Over 150 system tests and a control server with 5000+ assertions, so this is a big scale test.&lt;/p&gt;
&lt;p&gt;Next up is documentation in Haskell. A problem report describes details of the problem and linked from a bug tracker. The timeline, workaround, impact and details caused must all be captured and are mixed up with a number of other reports, so none of the Haskell people read it. They collected up the aggregation and summarised it for other Haskell products. Despite this, other Haskell programmers still dont read it (audience laughter). To sort this out, they do automated checking using hlint. They customize hlint to &amp;quot;grep&amp;quot; for their particular pitfall, and then check for Emacs. hlint isnt quite good enough for a lot of their pitfalls though, such as the timeout issue from earlier, so they had some workarounds to deal with this. The good thing is that hlint is integrated into their text editor. Not all pitfalls can be caught by hlint: high level design issues will remain problematic.&lt;/p&gt;
&lt;p&gt;Education is also important. They have a brown bag (lunch? -- editor) FP meeting where they &amp;quot;Make GREE a better place through the power of FP&amp;quot;. They cover both Scala and Haskell topics. They also run an education program for new graduates, and they have a Haskell code puzzle series from Project Euler to help the new graduates.&lt;/p&gt;
&lt;p&gt;They conclude that they love FP and they develop some key components of our service using FP. But there are many pitfalls, and they are developing tools to assist them sort them out.&lt;/p&gt;
&lt;h2&gt;Haskell for distributed systems&lt;/h2&gt;
&lt;p&gt;Jeff Epstein (formerly a masters student in the Cambridge SRG, so it's good to see him again!) talks about their new distributed system that they are building in Haskell. His company is also available for hiring!&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo5.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo5-300x300.jpg&quot; class=&quot;alignright size-medium wp-image-1428&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;HA middleware manages networked clusters, aiming for exabyte-scale clusters. It's architected by Mathieu Boespflug and Peter Braam (who has spoken about their FPGA work &lt;a href=&quot;http://cufp.org/videos/parallel-scientific-awesome-haskell-fpga-compiler&quot;&gt;at past CUFPs&lt;/a&gt;). It manages 10000+ nodes and creates consensus in the cluster about the location of active services. It can handle events due to failures, recovery time should be approx. 5 seconds.&lt;/p&gt;
&lt;p&gt;Zookeeper didn't scale &lt;i&gt;(audience interruption: why didnt Zookeeper scale? Jeff says he doesn't know and should chat offline, audience member notes that they maintain Zookeeper and wants to know more)&lt;/i&gt;.&lt;/p&gt;
&lt;p&gt;Events are sent by nodes and aggregated at a proxy node, and enqueued at an HA station. Events are processed by the hA coordinator and updates a node state graph (which is also replicated -- everything is replicated and is a key theme in the talk). The HA coordinator is the decision maker which decides what to do on failure. Its main action is updating the node state graph to reflect the new strategy after failure.&lt;/p&gt;
&lt;p&gt;Key components are: Haskell, Cloud Haskell and Paxos.&lt;/p&gt;
&lt;p&gt;How we used Haskell:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Functional Data structures result in a purely functional graph and replicated (impurely) between cluster managers. Most of the feels imperative though, which was important.&lt;/li&gt;
&lt;li&gt;Refactoring being easier was important due to strong typing.&lt;/li&gt;
&lt;li&gt;Laziness was yet again a problem causer in IO due to space leaks in low-level networking code. He notes that distribution is a natural barrier to laziness, since the act of serializing a message forces its evaluation. He also notes that processes much behave the same between processes on the same host as between hosts, and so even local communication must be forced.&lt;i&gt;Phil Walder interjects to ask &amp;quot;why did you use Haskell? It's a bad fit! Jeff replies that &amp;quot;we like Haskell&amp;quot;&lt;/i&gt; and introduces Cloud Haskell, the topic of his MPhil thesis.Cloud Haskell is a library for distributed concurrency in Haskell and provides an actor-style message-passing interface, similarly to Erlang. It provides a &amp;quot;typed erlang&amp;quot;.Cloud Haskell is a good fit for this project in terms of interacting communicating components. Refactoring is easy, and this isn't a &amp;quot;big data&amp;quot; project in the sense of data size. There is a huge amount of communication messages though.CH has a pluggable transport layer such as TCP, but also for different underlying networks (they built Infiniband). However, CH requires ordered delivery of packets and this was a poor fit (they want out of order delivery, which could be built with UDP, but CH requires an ordering for some reason). Space leaks are a real problem in this layer.Cluster bringup is tough for CH, since nodes need to find each other at start of day, and there some hacks in there to work around a morning storm of messages.&lt;i&gt;(Interjection from audience: why not use Erlang? Jeff: performance wasnt up to par, and static types are important for them). Possibly the native code / bytecode erlang might be useful but speaker wasn't sure if it would work.&lt;/i&gt;
&lt;p&gt;Paxos: is all about making systems agree (well-known proven algorithm for consensus). They implemented this as a general purpose library on top of CH. The algorithm is a good match for the programming model, with the client, acceptor, proposer learning and leader all built as CH processes. It ended up being a small readable implementation (1.5kLOC) that closely matched the pseudocode in the original Paxos paper (made them feel better about correctness). It's used for synchronizing the state graph and for the distributed message queue.&lt;/p&gt;
&lt;p&gt;Challenges: Paxos is hard and untyped messages in CH make it worse. Getting reasonable performance from it also requires the modified variants. Liveness also is tricky to avoid overapproximations to prevent nodes being fenced out of the consensus unnecessarily. Multipaxos is something that solves some of this, and they're working on more specific stuff also.&lt;/p&gt;
&lt;p&gt;Debugging: The CH programming model makes it tractable to debug a distributed application on a single machine. Nevertheless, distributed code is still parallel and involves race conditions and mixing messages. They would like a distributed &lt;a href=&quot;http://www.haskell.org/haskellwiki/ThreadScope&quot;&gt;ThreadScope&lt;/a&gt; but instead mainly used oldskool logging.&lt;/p&gt;
&lt;p&gt;They did build a deterministic CH thread scheduler to replace CH's core message handling primitives, and they also used PROMELA&lt;/p&gt;
&lt;p&gt;Q: how much is open source or will be?&lt;br/&gt;
A: none as far as speaker knows&lt;/p&gt;
&lt;p&gt;Q: Marius: how are non-deterministic sources composed with the deterministic scheduler?&lt;br/&gt;
A: deterministic scheduler is for testing only, so timeouts also so deterministic.&lt;/p&gt;
&lt;h2&gt;IQ: Functional Reporting&lt;/h2&gt;
&lt;p&gt;Speaker is Edward Kmett on how they got FP in the door at S&amp;amp;P Capital in the door, their extensions to Haskell and generally how they're working on opensourcing their tech. SAP is huge and have a number of products (S&amp;amp;P Capital IQ Platform, ClariFI, AlphaWorks, Compustat).&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo6.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo6-300x300.jpg&quot; class=&quot;alignright size-medium wp-image-1434&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Getting FP in the door:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Monoids (introduced as with the Summingbird talk, for easy parallelisation)&lt;/li&gt;
&lt;li&gt;Reducers are another really powerful abstraction which can take a container full of values and give you back a structure, and it has a comonadic structure that lets you (e.g.) pass it many containers full of structures and generally compose things nicely. Reduction can also be done simultaneously across monoidal structures and essentially &amp;quot;we dont see the wiring hanging out of our code any more&amp;quot;.&lt;/li&gt;
&lt;li&gt;Performance attribution: This is a model that breaks down the reasons why you make money (what did you do that was significant). The old and busted model (implemented in Java, full dataset in memory, hard to extend) was horrible, and the new hotness is implemented in Scala, runs in constant space, is really fast and results are flattened elegantly via combinators to a database backend. In other words: better, but some details are glossed over (multipass algorithms, iteratees, caching layers, and handling missing data) -- but all this was sorted out and really sold Scala to the bigger company as a real asset.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;They developed Ermine, which is Haskell with Row Types. It's not quite Haskell, but it's main feature is that it's not Scala either (audience laughter). Writing functional programs in Scala is quite painful (e.g. not blowing stack with monads requires trampolining everything and is labour intensive just to get by day to day). They wrote Ermine in both Scala and Haskell with a portable Core that can run on the JVM.&lt;/p&gt;
&lt;p&gt;Ermine has a strong type system, with novel row types and polymorphic and constraint kinds (&amp;quot;they were just coming into GHC at the time and I wanted to understand them&amp;quot;) and Rank-N types via a derivative of HMF. It fit their domain requirements really wel, and has builtin database support, can be exposed to end users, a structured code editor that can only generate type-safe code as you're defining, and full control over error messages.&lt;/p&gt;
&lt;p&gt;Row types are a powerful way of describing the presence of a particular field. Its modelled via has, lacks and/or subsumes constraints. This is easily checked, but now inference flows unidirectionally through a join.&lt;br/&gt;
In Ermine, they have existentials in their constraint types &lt;i&gt;(technical explanation follows, not shown here --editor)&lt;/i&gt;.&lt;/p&gt;
&lt;p&gt;Their reporting layer has one declarative specification to do all the relational algebra specifications they want, and push it into specific backends (SQL Server, etc) and ensure they run their queries as close to the data as possible. They can also create extensive HTML reports that render pretty consistently across different target platforms. Their example of Ermine was written by a functional programmer that had done no functional programming previously, which required a little hand holding to work through some of the more obscure type errors, but generally it worked ok.&lt;/p&gt;
&lt;p&gt;All the code is being stuck onto Hackage/Github etc.&lt;/p&gt;
&lt;p&gt;Q: has it been rolled out to a lot of users?&lt;br/&gt;
A: being used on the main S&amp;amp;P website. One big client facing page for users. The next gen stuff is using Ermine more widely. The desktop app coming soon has Ermine and will be used by a huge number of users. Trend is to use it in an increasing number of their products.&lt;/p&gt;
&lt;h2&gt;Enterprise scheduling with Haskell at skedge.me&lt;/h2&gt;
&lt;p&gt;They have a cloud-based scheduling platform that takes care of complex enterprise scheduling. It has a branded customer experience (like Google Apps does), a flexible workflow and deep integration with backend systems and in-store workflow (e.g. on iPads).&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo7.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo7-300x300.jpg&quot; class=&quot;alignright size-medium wp-image-1445&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Example is Sephora who do makeup, and their appointment system is integrated via skedge.me that is embedded in an iFrame that looks like a seamless part of their site so that endusers cant tell the difference.&lt;/p&gt;
&lt;p&gt;When speaker started at skedge.me, there was a lot of fire fighting. It was 43k lines of Groovy on Grails, and several major intractable bugs were affecting the business: timezones, double bookings, recurring events not firing and notifications being delayed. Performance was an issue, as things that were interactive were sometime taking minutes to load. There was also a lot of inflexibility -- hilariously, they had to sometimes ask clients to change their business model to fit with the skedge.me model.&lt;/p&gt;
&lt;p&gt;After some careful though, they decided they had to rewrite skedge.me to cope with growth and better service. The author had done Haskell before, but not specifically was with building a website using it.&lt;/p&gt;
&lt;p&gt;Haskell had the perfect model for fixing their scaling problems. At the lowest level, they built a RawDB on top of the IO monad that did everything necessary to maintain ACID guarantees during transactions. An example is that once an effect gets committed (e.g. an email gets sent confirming an appointment and then is cancelled, which happened on their old racy platform). This RawDB layer gives them stronger consistency guarantees with tracked effects and automatic retries on temporary failure.&lt;/p&gt;
&lt;p&gt;On top of the RawDB, they build a DB monad which provides a higher level than SQL via algebraic data types, caching and data validation. They then layer a security monad on top of the DB monad to guarantee that all accesses have been checked. Finally there is a business logic layer to enforce local policy and customise per customer (which was a real problem in the past).&lt;/p&gt;
&lt;p&gt;Security is complex due to all the customization, and they needed roles by client (owner, staff, customer) but also because clients can customise their &lt;i&gt;verbs&lt;/i&gt; that only make sense within the component (Appointments can be joined, rescheduled, or notifications can be sent, edit cancelled). Haskell lets all this fit within a multiparameter type class, instead of doing OO-style inheritance that will rapidly get out of control. They map customisations from the customer onto a more standard schema that they can manipulate generically on a component-by-component basis, and it's all statically checked and generally easy to read (important for security critical code).&lt;/p&gt;
&lt;p&gt;Haskell &amp;quot;lets them build code for the long run&amp;quot;. Sometimes though, you need to write code quickly and not care about longevity. This was the case for the importer, which is a quick-and-dirty hack to get code into their system. It has a limited set of inputs, the &amp;quot;end user&amp;quot; is the developer, and it's thrown away once the job's done. (shows epic type). Often when people need to do this sort of thing, they resort to bash or dynamically typed systems. In this case, even for this &amp;quot;quick hack&amp;quot;, they couldnt have achieved what they did &amp;quot;as badly as they did, without the help of the type system&amp;quot;. Generally very positive!&lt;/p&gt;
&lt;p&gt;Libraries help them not have to write code. Haskell is generally lower in terms of package count, but their *use* of Hackage libraries has been a lot higher than Javascript. They use 9 Javascript libraries, and 71 unique Hackage libraries (+87 dependencies). Its a lot harder to find a quality library that works in the dynamically typed land. Only one of their Haskell libraries had to be replaced due to bugs. This is because Hackage is well-organized, and it's easier to vet a library since the purely functional ones are less risky (fewer sideeffects through other code). In contrast, Javascript libraries can sideeffect (e.g. on the DOM) very late in the QA process. So: fewer Haskell libraries, but the number of useful libraries seems to be higher.&lt;/p&gt;
&lt;p&gt;Problems: cyclic module dependencies with hs-boot files are unwieldy, so avoid them. Scalability with 4+cores was limited, but they havent tested GHC 7.8 (which apparently fixes a lot of this). Idle GC can cause issues with long pauses, so disable this feature -- it depends on your workload but it was ok for their server based workload.&lt;/p&gt;
&lt;p&gt;Debugging production problems without stack traces is really hard, so consider using profiling mode for all libraries.&lt;/p&gt;
&lt;p&gt;Bottom line: 8200 lines of Haskell from 40k+ lines of Groovy. No recurring bugs and very good performance and flexibility for customer needs. Used daily by thousands of people. Check out the &lt;a href=&quot;http://skedge.me&quot;&gt;website&lt;/a&gt;!.&lt;/p&gt;
&lt;p&gt;Q: what about testing (QuickCheck?)&lt;br/&gt;
A: they've done some QuickCheck on critical components (such as an map from times to events). Overall though, just putting Haskell together in the most obvious way led to improvements over their previous platform. Their QA guys are now writing unit tests in Haskell (because their Selenium bindings were harder).&lt;/p&gt;
&lt;h2&gt;Integration of Mathematica with MapReduce&lt;/h2&gt;
&lt;p&gt;From Paul-Jean Letourneau, a data scientist at Wolfram Research. &lt;i&gt;Started with a show of hands: most of the audience has used Mathematica and had heard of Wolfram.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo8.jpg&quot;&gt;&lt;img src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo8-300x300.jpg&quot; class=&quot;alignright size-medium wp-image-1450&quot; alt=&quot;photo&quot;/&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;The speaker has been responsible for a lot of the personal analytics posts on the Wolfram blog (the email analysis, genomics and several others). The theme of all his projects has been to work on large data. Mathematica has always kept its data oncore, which is a problem with very large data sets, and so this talk is about how they migrate over to a more big-data model to run offcore.&lt;/p&gt;
&lt;p&gt;Fundamental principles of Mathematica: everything is an expression, expressions are transformed until they stop changing, and transformation rules are in the form of patterns. Expressions are data structures (actually m-expressions in Lisp parlance). &lt;i&gt;(full explanation of these in Mathematica demonstrated but omitted here)&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;Expressions in Mathematica are immutable data structures (&amp;quot;program as data&amp;quot;) and so expressions can be rebound. Homoiconicity is pervasive as expressions are the data structure, even internally during evaluation (where it's represented as a tree).&lt;/p&gt;
&lt;p&gt;&lt;i&gt;&amp;quot;everything is a one-liner in Mathematica... for a sufficiently long line&amp;quot; (Theo Gray).&lt;/i&gt; (audience laughter). He demonstrates some cool oneliners that are Tweetable (&amp;lt;140chars) and demonstrates how to construct an image recursively out of itself (wow).&lt;/p&gt;
&lt;p&gt;He views it as a gateway drug to declarative programming&lt;/p&gt;
&lt;pre&gt;y = 0
For[i=1; i&amp;lt;=10; i++,y+=i^2]; y
385&lt;/pre&gt;
&lt;p&gt;(and then they discover Fold and all the advanced topics such as scoping, evaluation control and the MathLink protocol for IPC).&lt;/p&gt;
&lt;p&gt;HadoopLink is how they link Mathmetica to Hadoop. Example is WordCount, wherein he shows code to do it on a single core first (to test the output), and then an export to HDFS so that Hadoop can see the code. This looks fairly straightforward via a DFSExport command from HadoopLik.&lt;/p&gt;
&lt;p&gt;The Mapper looks something like:&lt;/p&gt;
&lt;pre&gt;Function[{k,v},
  With[{words=ToLowerCase 
    /@ StringSplit [k,RegularExpression[], ...&lt;/pre&gt;
&lt;p&gt;The reduces is similar, as it users an iterator to sum up each of the inputs. It actually communicates to the JVM to ensure that they dont have to load all the values into memory. Running the job is just a special HadoopMapReduceJob along with all the relevant expressions, and it goes ahead and submits it to Hadoop.&lt;/p&gt;
&lt;p&gt;Used this to build a genome search engine using all this. He shows how to prep data using Mitochondrian genomic data. The mapper only knows about a single base in the genome and its position, and the query sequence, how can it possibly align the query sequence with the genome? Algorithm scales with the size of the query, and not the size of the dataset. Hadoop can be used to handle the full dataset so getting local algorithm right in Mathematica can be focussed on rather than the bigger problem.&lt;/p&gt;
&lt;p&gt;Challenges: when this scaled up to search the entire human genome, my Hadoop cluster blows up. Nodes start dying, Nagios alerts, the works! After drilling down on these cryptic errors, the &amp;quot;garbage collector overhead was exceeded&amp;quot; which was hard to interpret. The memory consumption on each worker node when running with both Mathematica and the slave is quite high. This is a setting that's made on a clusterwide basis and so is problematic to tweak just for this. What he'd like to do is add job-specific options to run things like heap size.&lt;/p&gt;
&lt;p&gt;Its on GitHub and open source (github.com/shadanan/HadoopLink) so go for it.&lt;/p&gt;
&lt;h2&gt;Announcements&lt;/h2&gt;
&lt;p&gt;Ashish Agarwal is organizing BoFs! On Monday @ 6pm there will be a bioinformatics session with Jeff Hammerbacher with location on the CUFP website.&lt;/p&gt;
&lt;p&gt;On Tuesday there will be a BoF about organizing local events for FP. In the same way that politics is local, this BoF will help you figure out strategies for local events.&lt;/p&gt;
&lt;p&gt;Yaron Minsky announces that 17 organizations have sponsored CUFP this year, which helps students. Industry attention to FP is really amazing to see how FP is moving into the mainstream. Industrial reception at 1830 on Monday downstairs.&lt;/p&gt;
&lt;p&gt;Our thanks to Marius Eriksen and Mike Sperber for an amazing program!&lt;/p&gt;
</content><id>http://www.syslog.cl.cam.ac.uk/2013/09/22/liveblogging-cufp-2013/</id><title type="text">Liveblogging CUFP 2013</title><updated>2013-09-22T14:05:32+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://anil.recoil.org/2013/09/20/opam-1-1-beta.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;&lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas&lt;/a&gt; just announced the availability of the &lt;a href=&quot;http://opam.ocamlpro.com&quot;&gt;OPAM&lt;/a&gt; beta release.  This has been a huge amount of work for him and &lt;a href=&quot;http://louis.gesbert.fr/&quot;&gt;Louis&lt;/a&gt;, so I&amp;rsquo;m excited to see this release!  Aside from general stability, the main highlights for me are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;A switch to the &lt;a href=&quot;http://creativecommons.org/publicdomain/zero/1.0/&quot;&gt;CC0&lt;/a&gt; public-domain-like license for the repository, and LGPL2+linking exception for OPAM itself.  The &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/issues/955&quot;&gt;cutover to the new license&lt;/a&gt; was the first non-gratuitous use of GitHub&amp;rsquo;s fancy issue lists I&amp;rsquo;ve seen, too!  As part of this, we&amp;rsquo;re also beginning a transition over to hosting it at &lt;code&gt;opam.ocaml.org&lt;/code&gt;, to underline our committment to maintaining it as an OCaml community resource.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Much-improved support for package pinning and updates.  This is the feature that makes OPAM work well with &lt;a href=&quot;http://openmirage.org&quot;&gt;MirageOS&lt;/a&gt;, since we often need to do development work on a low-level library (such as a &lt;a href=&quot;https://github.com/mirage/ocaml-xen-block-driver&quot;&gt;device driver&lt;/a&gt; and recompile all the reverse dependencies.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Support for post-installation messages (e.g. to display &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/1100&quot;&gt;licensing information&lt;/a&gt; or configuration hints) and better support for the external library management issues I explained in an earlier post about &lt;a href=&quot;http://anil.recoil.org/2013/09/09/ocamlot-autotriaging.html&quot;&gt;OCamlot testing&lt;/a&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Better library structuring to let tools like &lt;a href=&quot;http://github.com/OCamlPro/opam2web&quot;&gt;Opam2web&lt;/a&gt; work with the package metadata.  For instance, my group&amp;rsquo;s &lt;a href=&quot;http://ocaml.io&quot;&gt;OCaml Labs&lt;/a&gt; has a comprehensive list of &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/pkg/index.html&quot;&gt;the software packages that we work on&lt;/a&gt; generated directly from an OPAM remote.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;A growing set of administration tools (via the &lt;code&gt;opam-admin&lt;/code&gt; binary) that run health checks and compute statistics over package repositories.   For example, here&amp;rsquo;s the result of running &lt;code&gt;opam-admin stats&lt;/code&gt; over the latest package repository to show various growth curves.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;table width=&quot;90%&quot; align=&quot;center&quot;&gt;
&lt;tr&gt;
&lt;td width=&quot;30%&quot; class=&quot;bimg&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/opam11-beta-contributors.png&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/opam11-beta-contributors.png&quot; border=&quot;0&quot; width=&quot;220&quot;/&gt;&lt;/a&gt;&lt;br/&gt;Number of unique contributors to the main OPAM package repository.&lt;/td&gt;
&lt;td width=&quot;30%&quot; class=&quot;bimg&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/opam11-beta-packages.png&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/opam11-beta-packages.png&quot; border=&quot;0&quot; width=&quot;220&quot;/&gt;&lt;/a&gt;&lt;br/&gt;Total number of unique packages (including multiple versions of the same package).&lt;/td&gt;
&lt;td width=&quot;30%&quot; class=&quot;bimg&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/opam11-beta-unique-packages.png&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/opam11-beta-packages.png&quot; border=&quot;0&quot; width=&quot;220&quot;/&gt;&lt;/a&gt;&lt;br/&gt;Total packages with multiple versions coalesced so you can see new package growth.&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Is it a &lt;a href=&quot;http://www.theatlantic.com/technology/archive/2013/05/the-hockey-stick-the-most-controversial-chart-in-science-explained/275753/&quot;&gt;hockey stick&lt;/a&gt; graph?  Only time will tell!
See Thomas&amp;rsquo; &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2013-09/msg00300.html&quot;&gt;full release announcement&lt;/a&gt; and let us know how you get along with this new release&amp;hellip;&lt;/p&gt;
</content><id>http://anil.recoil.org/2013/09/20/opam-1-1-beta.html</id><title type="text">OPAM 1.1 beta available, with pretty colours</title><updated>2013-09-20T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://ocamllabs.github.com/compiler-hacking/2013/09/17/compiler-hacking-july-2013" rel="alternate"/><contributor><uri>http://ocamllabs.github.io/compiler-hacking/rss.xml</uri><name>Compiler Hacking</name></contributor><content type="html">&lt;p&gt;&lt;img src=&quot;http://ocamllabs.github.io/compiler-hacking/imgs/2013-09-17.jpg&quot; alt=&quot;Compiler Hacking&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The first OCaml Labs compiler hacking session brought together around twenty people from &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/&quot;&gt;OCaml Labs&lt;/a&gt;, the wider &lt;a href=&quot;http://www.cl.cam.ac.uk&quot;&gt;Computer Lab&lt;/a&gt;, and &lt;a href=&quot;http://www.citrix.com/&quot;&gt;various&lt;/a&gt; &lt;a href=&quot;http://www.arm.com/&quot;&gt;companies&lt;/a&gt; around Cambridge for an enjoyable few hours learning about and improving the OCaml compiler toolchain, fuelled by &lt;a href=&quot;http://www.cherryboxpizza.co.uk&quot;&gt;pizza&lt;/a&gt; and home-made ice cream (thanks, &lt;a href=&quot;http://philippewang.info/CL/&quot;&gt;Philippe&lt;/a&gt;!).&lt;/p&gt;

&lt;p&gt;We benefited from the presence of a few &lt;a href=&quot;http://www.x9c.fr/&quot;&gt;experienced&lt;/a&gt; &lt;a href=&quot;http://danmey.org/&quot;&gt;compiler&lt;/a&gt; &lt;a href=&quot;http://lpw25.net/&quot;&gt;hackers&lt;/a&gt;, but for most of us it was the first attempt to modify the OCaml compiler internals.&lt;/p&gt;

&lt;p&gt;The first surprise of the day was the discovery that work on the &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;list of projects&lt;/a&gt; was underway before we even arrived!  Keen collaborators from The Internet had apparently spotted our triaged bug reports and &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=4323&quot;&gt;submitted&lt;/a&gt; &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=4737&quot;&gt;patches&lt;/a&gt; to Mantis.&lt;/p&gt;

&lt;h3&gt;Standard library and runtime&lt;/h3&gt;

&lt;p&gt;There was an exciting moment early on when it emerged that two teams had been working independently on the same issue!  When &lt;a href=&quot;https://github.com/jonludlam&quot;&gt;Jon Ludlam&lt;/a&gt; and &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/euan.html&quot;&gt;Euan Harris&lt;/a&gt; submitted a patch to add a &lt;code&gt;get_extension&lt;/code&gt; function to the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/libref/Filename.html&quot;&gt;&lt;code&gt;Filename&lt;/code&gt;&lt;/a&gt; module they found that they had been pipped to the post by &lt;a href=&quot;https://github.com/mcclurmc/&quot;&gt;Mike McClurg&lt;/a&gt;.  There's still the judging stage to go, though, as the patches wait &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5807&quot;&gt;on Mantis&lt;/a&gt; for official pronouncement from the Inria team. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://github.com/vbmithr&quot;&gt;Vincent Bernardoff&lt;/a&gt; also spent some time improving the standard library, &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=4919&quot;&gt;fleshing out the interface for translating between OCaml and C error codes&lt;/a&gt;, starting from a patch by Goswin von Brederlow.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/stedolan&quot;&gt;Stephen Dolan&lt;/a&gt; looked at a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=1956&quot;&gt;long-standing issue&lt;/a&gt; with names exported by the OCaml runtime that can clash with other libraries, and submitted a patch which hides the sole remaining offender for the runtime library.  As he noted in the comments, there are still a &lt;a href=&quot;https://gist.github.com/stedolan/6115403&quot;&gt;couple of hundred&lt;/a&gt; global names without the &lt;code&gt;caml_&lt;/code&gt; prefix in the &lt;code&gt;otherlibs&lt;/code&gt; section of the standard library.&lt;/p&gt;

&lt;h3&gt;Tools&lt;/h3&gt;

&lt;p&gt;There was a little flurry of work on new command-line options for the standard toolchain.&lt;/p&gt;

&lt;p&gt;A &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6102&quot;&gt;Mantis issue&lt;/a&gt; submitted by &lt;a href=&quot;http://gallium.inria.fr/~scherer/&quot;&gt;Gabriel Scherer&lt;/a&gt; suggests adding options to stop the compiler at certain stages, to better support tools such as &lt;a href=&quot;http://projects.camlcity.org/projects/findlib.html&quot;&gt;OCamlfind&lt;/a&gt; and to make it easier to debug the compiler itself.  The Ludlam / Harris team looked at this, and submitted a patch which provoked further thoughts from Gabriel.&lt;/p&gt;

&lt;p&gt;Vincent looked at extending &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/depend.html&quot;&gt;ocamldep&lt;/a&gt; with support for suffixes other than &lt;code&gt;.ml&lt;/code&gt; and &lt;code&gt;.mli&lt;/code&gt;.  Since &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=3725&quot;&gt;the issue&lt;/a&gt; was originally submitted, &lt;code&gt;ocamldep&lt;/code&gt; has acquired &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/depend.html#sec288&quot;&gt;&lt;code&gt;-ml-synonym&lt;/code&gt; and &lt;code&gt;-mli-synonym&lt;/code&gt; options&lt;/a&gt; that serve this purpose, so Vincent looked at supporting other suffixes in the compiler, and submitted a patch as a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6110&quot;&gt;new issue&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The OCaml top level has a simple feature for setting up the environment &amp;mdash;  when it starts up it looks for the file &lt;code&gt;.ocamlinit&lt;/code&gt;, and executes its contents.  It's sometimes useful to skip this stage and run the top level in a vanilla environment, so &lt;a href=&quot;https://github.com/dsheets&quot;&gt;David Sheets&lt;/a&gt; submitted a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6071&quot;&gt;patch&lt;/a&gt; that adds a &lt;code&gt;-no-init&lt;/code&gt; option, &lt;a href=&quot;https://github.com/ocaml/ocaml/blob/fadcc73c50b89ca80ecc11131c9a23dbd2c1e67a/Changes#L35&quot;&gt;due for inclusion&lt;/a&gt; in the next release.&lt;/p&gt;

&lt;h3&gt;Error-handling/reporting&lt;/h3&gt;

&lt;p&gt;Error handling issues saw a good deal of activity.  &lt;a href=&quot;http://www.cl.cam.ac.uk/~rp452/&quot;&gt;Rapha&amp;euml;l Proust&lt;/a&gt; submitted a patch to improve the &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6112&quot;&gt;reporting of error-enabled warnings&lt;/a&gt;; David investigated &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=3582&quot;&gt;handling out-of-range integer literals&lt;/a&gt; and &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5350&quot;&gt;return-code checking of C functions in the runtime&lt;/a&gt;, leading to some discussions on Mantis.  Stephen submitted a patch to improve the &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6182&quot;&gt;diagnostics for misuses of &lt;code&gt;virtual&lt;/code&gt;&lt;/a&gt;.  &lt;a href=&quot;http://www.cl.cam.ac.uk/~gk338/&quot;&gt;Gabriel Kerneis&lt;/a&gt; and Wojciech looked at some &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6109&quot;&gt;typos in ocamlbuild error messages&lt;/a&gt;, and Mike opened an &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6108&quot;&gt;issue to clarify the appropriate use of the &lt;code&gt;compiler-libs&lt;/code&gt; package&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;Language&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;open&lt;/code&gt; operation on modules can make it difficult for readers of a program to see where particular names are introduced, so its use is sometimes discouraged.  The basic feature of making names available without a module prefix is rather useful, though, so various new features (including &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual021.html#toc77&quot;&gt;local opens&lt;/a&gt;, &lt;a href=&quot;https://github.com/ocaml/ocaml/commit/f51bc04b55fbe22533f1075193dd3b2e52721f15&quot;&gt;warnings for shadowing&lt;/a&gt;, and &lt;a href=&quot;https://github.com/ocaml/ocaml/commit/a3b1c67fffd7de640ee9a0791f1fd0fad965b867&quot;&gt;explicit shadowing&lt;/a&gt;) have been introduced to tame its power. Stephen looked at adding a further feature, making it possible to open modules under a particular signature, so that &lt;code&gt;open M : S&lt;/code&gt; will introduce only those names in &lt;code&gt;M&lt;/code&gt; that are specified with &lt;code&gt;S&lt;/code&gt;.  There's an &lt;a href=&quot;https://github.com/lpw25/ocaml/tree/signatured-open&quot;&gt;initial prototype&lt;/a&gt; already, and we're looking forward to seeing the final results.&lt;/p&gt;

&lt;p&gt;The second language feature of the evening was support for infix operators (such as the List constructor, &lt;code&gt;::&lt;/code&gt;) for user-defined types, a feature that is definitely not in any way motivated by envy of Haskell.  Mike's &lt;a href=&quot;https://github.com/mcclurmc/ocaml/tree/infix-constructors&quot;&gt;prototype implementation&lt;/a&gt; is available, and there's an &lt;a href=&quot;https://github.com/mcclurmc/ocaml/pull/1&quot;&gt;additional patch&lt;/a&gt; that brings it closer to completion.&lt;/p&gt;

&lt;h3&gt;Next session&lt;/h3&gt;

&lt;p&gt;The next session is planned for 6pm on Wednesday 18th September 2013 at
&lt;a href=&quot;http://makespace.org/&quot;&gt;Makespace, Cambridge&lt;/a&gt;.  If you're planning to come along it'd be
helpful if you could add yourself to the &lt;a href=&quot;http://doodle.com/k6y2tiihkrb5vuw4&quot;&gt;Doodle Poll&lt;/a&gt;.  Hope to see
you there!&lt;/p&gt;
</content><id>http://ocamllabs.github.com/compiler-hacking/2013/09/17/compiler-hacking-july-2013</id><title type="text">Inaugural compiler hackers meeting</title><updated>2013-09-17T13:49:04+00:00</updated><author><email>cl-ocamllabs@lists.cam.ac.uk (OCaml Labs)</email><name>Compiler Hacking</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=352" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;Today&amp;rsquo;s OCaml Labs Monthly Meeting is all about practise talks for OCaml2013 so in that spirit, I&amp;rsquo;ll practising a bit of live-blogging too.&lt;/p&gt;
&lt;p&gt;13:53 &amp;ndash; Today&amp;rsquo;s SRG Meeting is over and its time for some work before the OCaml Labs meeting at 4:00, see you then &amp;hellip;&lt;/p&gt;
&lt;p&gt;16:02 Techincal difficulties delayed the start&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;text-decoration: underline;&quot;&gt;&lt;strong&gt;16:02 Intro from Anil&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;introducing Gabriel Scherer who is visiting us this week and going we are going to Maypole after this meeting. We had a cash prise from ASPLOS after winning the HiPEAC paper award and the money will go towards SRG wine for XMAS party. Signpost paper was accepted to FOCI and a HotNet paper on Trevi was also just accepted&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;OCL Website&lt;/strong&gt; &amp;ndash; Too much manual management at the moment, moving to an &lt;a href=&quot;http://planet.ocamlcore.org/&quot;&gt;ocaml planet&lt;/a&gt; feed of blog posts. David has been busy hacking on &lt;a href=&quot;https://github.com/OCamlPro/opam2web&quot;&gt;OPAM2web&lt;/a&gt;, OPAM has 512 packages, Opam2web takes a subset of the OPAM packages and makes the metadata into a minisite, like on OPAM. Doesn&amp;rsquo;t require manual updates, like an ATOM feed.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Upcoming events&lt;/strong&gt; &amp;ndash; Tomorrow is the 2nd &lt;a href=&quot;http://www.meetup.com/Makespace/events/138103982/&quot;&gt;compiler hacking event&lt;/a&gt;, at the &lt;a href=&quot;http://makespace.org/&quot;&gt;makespace&lt;/a&gt;. Anil will be talking at QCon on Mirage, Mirage 1.0 release date is October 22nd, so maybe a workshop before. We 3 talks for Ocaml2013 (Platform, OcamlOT and Ctypes) so here we go &amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;text-decoration: underline;&quot;&gt;&lt;strong&gt;16:09 Anil practice talk on OCaml Platform 1.0&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Languages take many difference approaches to platform, but what does platform even mean? As a late mover in this field, we can learn from other languages. A platforms is NOT a group of temporarily motivated hackers to build a replacement standard library. Its hard to adopt a particular approach without a domain specific purpose, there are too many opinions, we need objective way to determine what belongs in the platform, we need a genie community that is sustainable (even if a large party leaves). A platform is a bundle of tools that interoperate, with quantitative metric to judge success, built in agility and supporting developers thought the whole development life cycle. Industrial partners have a range of needs, as each work in different domains.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Tooling&lt;/strong&gt; &amp;ndash; Overview of 5 areas: OPAM from OCamlPro, IDE Tools, OPAM-DOC, OCaml compiler itself and Ocaml.org.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;OPAM&lt;/strong&gt; &amp;ndash; 1.1 released today (maybe), over 100 contributors to OPAM, &amp;nbsp;500+ packages, 1500+ unique versions, external dependency solver using CUDF&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;IDE Support&lt;/strong&gt; &amp;ndash; OCaml has many intermediate files. In OCaml 4.0 onwards, we have a binary format of an abstract syntax tree with type annotations&amp;nbsp;called cmt (and cmti for interface files), we can now create external tools to query this like opam-doc. ocp-index and ocp-indent from OCamlPro, and Merlin (I thinks this is EPIC)&amp;nbsp;are also now available&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;opam-doc&lt;/strong&gt; &amp;ndash; Now we have cmt files, we need unified documentation across packages, this is much harder than it sounds as it touches every part of the tool stack. Not all packages can be installed at once due to conflicts. Module inclusion is tough to code in static html. (Need to make a demo) bindoc takes the Typed AST (in cmt) and generates cmd, which include the ocamldoc comments, Opamdoc takes the cmt database for opam and output a single website with your universe of packages.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ocaml.org&lt;/strong&gt; &amp;ndash;&amp;nbsp;Demo of ocaml.org at &lt;a href=&quot;http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/ocaml-redesign.github.io/pkg/index.html&quot;&gt;ocaml-redesign.github.io/pkg/index.html&lt;/a&gt;, feedback is welcome says amir&lt;/p&gt;
&lt;p&gt;Now we have the tools, what metrics can we extract to see how well our tools are doing.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Portability&lt;/strong&gt; &amp;ndash; windows compatibility ?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Maintainer&lt;/strong&gt; &amp;ndash; is there a place for docs and will people response to issues/comments/emails, where can issues be submitted ?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Tests&lt;/strong&gt; &amp;ndash; code coverage, multi variant benchmarking&amp;nbsp;in &lt;a href=&quot;https://ocaml.janestreet.com/ocaml-core/latest/doc/core_bench/index.html&quot;&gt;core-bench&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Stability&lt;/strong&gt; &amp;ndash; OPAM support pining, how stable are the interfaces of libraries ?&lt;/p&gt;
&lt;p&gt;opam tracks compiler constraint, statically analyses the build system from logs (OCamlOT)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Agility&lt;/strong&gt; &amp;ndash; Building a platform is EXHAUSTING. We want to ask &amp;ldquo;WANT IF&amp;rdquo; questions:&amp;nbsp;&lt;a href=&quot;http://gallium.inria.fr/blog/monomorphic_let/&quot;&gt;what if let was monomophic&lt;/a&gt;? what if we removed &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-camlp4/manual002.html&quot;&gt;camlp4&lt;/a&gt;? what is the syntax precedence changes ?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Distrusted workflow&lt;/strong&gt; &amp;ndash; build on git, distributing tasks between 3 actors: Author (library writers), OCamlOL workers and maintainers. As we become more stable we move from staging to stable to inclusion in the platform.&lt;/p&gt;
&lt;p&gt;We are building a tussle, we want to launch a game in janurary and let people put standard libraries into the ring, running OCamlOT to discover the winner&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;No clear winner&lt;/strong&gt;: Lwt &amp;ndash; portability, Batteries &amp;ndash; free of syntax extensions, core &amp;ndash; comprehensive.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span style=&quot;text-decoration: underline;&quot;&gt;16:36 &amp;nbsp;Discussion over the battle of the standard libraries and talk feedback&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;C: talk is a bit long, not sure what to cut..&lt;/p&gt;
&lt;p&gt;C: OPAM was dicussed last year at OCaml2013, we want to update everyone and follow on without overlapping too much&lt;/p&gt;
&lt;p&gt;Q: Haven&amp;rsquo;t we already decided&amp;nbsp;on JS&amp;rsquo;s core ?&lt;/p&gt;
&lt;p&gt;A: No, we use all of them, i.e. Mirage used lwt extensively&lt;/p&gt;
&lt;p&gt;Q: What if we don&amp;rsquo;t want any of the new standard libraries ? maybe I just want to use domain specific libraries from OPAM as and when I need them&lt;/p&gt;
&lt;p&gt;A: We are not forcing the new standard libraries on anyone, but they are useful for beginners, nice to have consistent style, interoperability and few open statements e.g. Open Core.Std&lt;/p&gt;
&lt;p&gt;Q: What if I have already decided which standard library I want to use ?&lt;/p&gt;
&lt;p&gt;A: Again we are not forcing standard libraries on anyone, we are just trying to force effort more directly.&amp;nbsp;OCaml tools will always be standard library agnoctic&lt;/p&gt;
&lt;p&gt;C: the diagram of OCamlOT is confustion&lt;/p&gt;
&lt;p&gt;C: how to not overlap with david talks&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;text-decoration: underline;&quot;&gt;&lt;strong&gt;16:41 Davids talk on OCamlOT&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;State for the open source OCaml community&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Outline:&lt;/strong&gt; what is quality software?&amp;nbsp;what is the user experience?&amp;nbsp;what is feedback loop for package authors?&amp;nbsp;How do we represent the thing underneath this all?&amp;nbsp;utopian&amp;nbsp;future ?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Quality:&lt;/strong&gt; Work on every core (ANIL: We want multi-core &lt;img src=&quot;http://hh360.user.srcf.net/blog/wp-includes/images/smilies/icon_razz.gif&quot; alt=&quot;:P&quot; class=&quot;wp-smiley&quot;/&gt; ), consistent results: work or die nicely with obvious solution, not more &amp;ldquo;What have I forgotten?&amp;rdquo; questions, it should just tell you. We need addictive actions (not sure what they are), consistency, quality functions&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Universal concerns:&lt;/strong&gt; compiler hypothesis &amp;ldquo;what if&amp;rdquo; questions (anil already said this), build system hypotheses &amp;ldquo;what strange assumuptions is the buid system making?&amp;rdquo;, package manager hypothesis&amp;nbsp;and environmner&amp;nbsp;hypothesis&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Workflow:&lt;/strong&gt; Make a pull request, curator observes the proposal, predict the future, proposes amendments, feedback loop and finally agreement is reached. Core is release weekly for example, we are trying to work like linux kernal patches&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;New workflow:&lt;/strong&gt; promote&amp;nbsp;health of OCaml community,&amp;nbsp;preaching&amp;nbsp;compatibility, &amp;ldquo;observe, orient, decide and act&amp;rdquo;, Computer assisted curator will help a human, to run the loop faster, human can pose questions to the computer assisted curator e.g &amp;nbsp;&amp;ldquo;will this run on ARM ?&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Repository Observation:&lt;/strong&gt; github binding with web hooks but we are not tied to github. We&amp;nbsp;merge into the world and we need dependences from each possible users&amp;nbsp;prospective of the world&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Dependency Orientation:&lt;/strong&gt; capabilities with environmental&amp;nbsp;dependances, packages with constriant-based&amp;nbsp;dependencies, repositories&amp;nbsp;with revision dependencies and artifact dependencies. example of the android repo&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Triage Decisions:&lt;/strong&gt; taking plain text error and parsing them into categories such as unsatisfiability (can&amp;rsquo;t have these two packages), dependencies (if my dependency is broken, then I am broken), transient (network down), system, metadata, external dependences (you forgot to write a dependency), build errors and a combo of many of the above.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;State Action:&lt;/strong&gt; commit intention, build, error analysis and buid results&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Internet res:&lt;/strong&gt; The agents negotiates over REST API on HTTPS, independent metadata layers (not sure about this) ,everythings an s-exp, branch consistent store explained, like git or&amp;nbsp;&lt;a href=&quot;https://github.com/samoht/irminsule&quot;&gt;Irminsule&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Current state:&lt;/strong&gt; github web hooks, we are conservative so&amp;nbsp;one byte changes and we rebuild everything, basic triage heuristics completed, no amendment are proposed by the system atm, we don&amp;rsquo;t commit the outcome but the evidence, simple reactions to results, a website with green and red boxes in the large table&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;History:&lt;/strong&gt; we have found&amp;nbsp;lots of metadata issues&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt;, many packages bugs, some tool bugs like a non relocatable&lt;/span&gt;&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt;&amp;nbsp;compiler and &lt;/span&gt;ocamlbuild&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt; PATH &lt;/span&gt;ignorer&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt;, we currently have 30+ &lt;/span&gt;x84-64&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt; 30+&lt;/span&gt;x84-32&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt;, 8 ARMs , many&amp;nbsp;&lt;/span&gt;Linux&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt;&amp;nbsp;distros&lt;/span&gt;&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt;&amp;nbsp;, &lt;/span&gt;dead&amp;nbsp;&lt;a href=&quot;http://www.raspberrypi.org/&quot;&gt;Raspberry Pi&lt;/a&gt;, panicking&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt;&amp;nbsp;*nix &lt;/span&gt;filesystems&lt;span style=&quot;line-height: 1.714285714; font-size: 1rem;&quot;&gt; and lots of people have set warning as error&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Future:&lt;/strong&gt;&amp;nbsp;opamfu for DAG analysis, schema&amp;nbsp;migration overhead, lower overhead for administrating exotic workers contributed to OCamlOT, we need to authenticate machines using ocaml-sodium, we need more advanced automation, proposed&amp;nbsp;amendments, lets have a dialogue, better website integration, benchmarking your upgrades (how much improves cost), run experiments on whole OPAM universe&amp;nbsp;with differential analysis and VM-based test system, to specific the worker finely.&lt;/p&gt;
&lt;p&gt;What I think quantity is, vision of the future, how its represented underneath&amp;nbsp;and what&amp;rsquo;s next,&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;text-decoration: underline;&quot;&gt;&lt;strong&gt;Discussions&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;C: that was 20mins, feedback to David regarding content to be cut,&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;text-decoration: underline;&quot;&gt;&lt;strong&gt;17:23 Ctypes by Jeremy&amp;nbsp;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This is a update not a practice talk&lt;/p&gt;
&lt;p&gt;An examples of puts from C, how we can write no C and link in OCaml,&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NEW things in Ctypes:&lt;/strong&gt;&lt;br/&gt;
prettyprinting &amp;ndash; for C types and C values, making it much eaiser to examine values for debuygging&lt;/p&gt;
&lt;p&gt;biarray &amp;ndash; support for lump of C memory&lt;/p&gt;
&lt;p&gt;More type &amp;ndash; nullable string, complex numbers&lt;/p&gt;
&lt;p&gt;String conversions &amp;ndash; much faster&lt;/p&gt;
&lt;p&gt;Memory management issues &amp;ndash; ctypes now gives the programmer more control over lifetime of OCaml passed to C,&lt;/p&gt;
&lt;p&gt;finaliser &amp;ndash; which you can attach to memory&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Future&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;stub generation &amp;ndash; instead of dynamically binding, it will generate stub code to act to the API&lt;/p&gt;
&lt;p&gt;capability-style&amp;nbsp;memory&amp;nbsp;safty &amp;ndash; one rogue pointer in a C library, can cause hell, loading each C library in a seperate address space so i library can only kill itself, you can then even&amp;nbsp;run on C library on a foreign host or on a virtual machine&lt;/p&gt;
&lt;p&gt;static strcut/union layout &amp;ndash; checking layout of structures and unions against the API&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span style=&quot;text-decoration: underline;&quot;&gt;17:40 Amir demo of&amp;nbsp;ocaml-resdesign.githuib.io/docs/opam,&lt;/span&gt;&lt;/strong&gt; (its look great :))&lt;/p&gt;
&lt;p style=&quot;text-align: center;&quot;&gt;&lt;a href=&quot;http://hh360.user.srcf.net/blog/wp-content/uploads/2013/09/ocaml.png&quot;&gt;&lt;img src=&quot;http://hh360.user.srcf.net/blog/wp-content/uploads/2013/09/ocaml-253x300.png&quot; class=&quot;size-medium wp-image-363 aligncenter&quot; alt=&quot;ocaml&quot; width=&quot;253&quot; height=&quot;300&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
</content><id>http://hh360.user.srcf.net/blog/?p=352</id><title type="text">OCaml Monthly Meeting – Live Blog</title><updated>2013-09-17T12:54:53+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://anil.recoil.org/2013/09/16/camlpdf-the-end-of-sucky-pdf-tools.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;The fine folks at O&amp;rsquo;Reilly have been proof-reading the &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; book
that I&amp;rsquo;ve been working on.  My heart leapt with joy when the copyeditor commented that she thought it was very well written,
but my joy was short-lived when it turns out that all her comments were safely ensconced as PDF comments.  A few
hundreds comments that required a response from us, too.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;ldquo;No problem! MacOS X Preview can handle these!&amp;rdquo;&lt;/em&gt; was of course my first response, but it turns out it&amp;rsquo;s totally
broken with PDF notes.  The first note that you select will appear as the content of all the other subsequent notes.
Yaron Minsky then experimented with Adobe Acrobat, which I&amp;rsquo;ve sworn never to install again after an unfortunate
incident involving the uninstaller a couple of years ago.  That turned out to be incredibly slow.  I tried a
few open-source tools such as &lt;a href=&quot;http://en.wikipedia.org/wiki/Skim_(software)&quot;&gt;Skim&lt;/a&gt; which, while otherwise an
excellent bit of software, couldn&amp;rsquo;t render these particular annotations.&lt;/p&gt;

&lt;table style=&quot;float:right; padding: 10px&quot;&gt;
&lt;tr&gt;&lt;td&gt;
&lt;a href=&quot;http://anil.recoil.org/images/anil-jumping-acropolis.jpg&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/anil-jumping-acropolis-thumb.jpg&quot; style=&quot;float:right&quot; width=&quot;207&quot;/&gt;&lt;/a&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td width=&quot;210&quot;&gt;&lt;i&gt;&lt;small&gt;I &lt;a href=&quot;http://www.theguardian.com/media/mind-your-language/2012/jan/29/literally-a-much-misused-word&quot;&gt;literally&lt;/a&gt; jumped off my seat upon discovering cpdf.&lt;/small&gt;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Meanwhile, John Whitington just announced the release of the &lt;a href=&quot;http://coherentpdf.com/blog/?p=68&quot;&gt;Coherent PDF&lt;/a&gt; command-line tools.
Since these are all written in OCaml (and have been developed over quite a few years now), he also sent in an
OPAM &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/977&quot;&gt;pull request&lt;/a&gt; to add it to the database.
And most conveniently, this ended up solving my little PDF conundrum in less than an hour of hacking, and
has almost cured me of my lifelong fear of dealing with anything in a PDF-like format.  Here&amp;rsquo;s what I did:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;I installed the tools via &lt;code&gt;opam install cpdf&lt;/code&gt;.  This installed the library but not the binary (&lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/1100&quot;&gt;swiftly fixed&lt;/a&gt;).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Reading the license told me that it&amp;rsquo;s for non-commercial use only, so I bought a license from the
&lt;a href=&quot;http://coherentpdf.com&quot;&gt;Coherent PDF&lt;/a&gt; website (a bargain price, given how much it does!).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;I ran &lt;code&gt;cpdf -list-annotations&lt;/code&gt; over the PDF, and it dumped out all the comments as a text file to stdout.
This wasn&amp;rsquo;t quite enough for me, since I needed to match the annotation to a page number.  But since
John has released it as open-source, I forked the repository and patched the support directly into the
command-line tools, and sent a &lt;a href=&quot;https://github.com/johnwhitington/cpdf-source/pull/2&quot;&gt;pull request&lt;/a&gt;
back over to John.  Since it&amp;rsquo;s under a non-standard license, I decided to place my patch in the public
domain to make it easier for him to accept it if he chooses.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;My co-authors can just run &lt;code&gt;opam pin cpdf git://github.com/avsm/cpdf-source#annotation-page-numbers&lt;/code&gt;
to pin their local copy of CPDF to my forked branch in their own OPAM installations, and easily use my
copy until John gets a chance to integrate my changes properly upstream.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Total time including this blog post: 40 minutes. Now, onto fixing the author
responses comments for Real World OCaml now.  I&amp;rsquo;m so happy to have &lt;code&gt;cpdf&lt;/code&gt; as a
simple, hackable PDF utility, as it does things like page combining and rotations
that have always been a little flaky in other tools for me.  It&amp;rsquo;s the
&lt;a href=&quot;http://johnmacfarlane.net/pandoc/&quot;&gt;Pandoc&lt;/a&gt; of PDFs!&lt;/p&gt;
</content><id>http://anil.recoil.org/2013/09/16/camlpdf-the-end-of-sucky-pdf-tools.html</id><title type="text">Camlpdf, the first good command-line PDF tool I've found</title><updated>2013-09-16T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=153" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;This is a quick run-through of how I set up my development environment in vim:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Install&amp;nbsp;pathogen.vim&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;mkdir&lt;/span&gt; &lt;span style=&quot;color: #660033;&quot;&gt;-p&lt;/span&gt; ~&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;.vim&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;autoload ~&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;.vim&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;bundle; \
curl &lt;span style=&quot;color: #660033;&quot;&gt;-Sso&lt;/span&gt; ~&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;.vim&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;autoload&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;pathogen.vim \
    https:&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;//&lt;/span&gt;raw.github.com&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;tpope&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;vim-pathogen&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;master&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;autoload&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;pathogen.vim&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Add the following to ~/.vimrc:&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;vim&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #804040;&quot;&gt;execute&lt;/span&gt; pathogen#infect&lt;span style=&quot;color: #000000;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;)&lt;/span&gt;
&lt;span style=&quot;color: #804040;&quot;&gt;syntax&lt;/span&gt; &lt;span style=&quot;color: #25BB4D;&quot;&gt;on&lt;/span&gt;
&lt;span style=&quot;color: #804040;&quot;&gt;filetype&lt;/span&gt; &lt;span style=&quot;color: #25BB4D;&quot;&gt;plugin&lt;/span&gt; &lt;span style=&quot;color: #25BB4D;&quot;&gt;indent&lt;/span&gt; &lt;span style=&quot;color: #25BB4D;&quot;&gt;on&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Install Syntastic &lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #7a0874; font-weight: bold;&quot;&gt;cd&lt;/span&gt; ~&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;.vim&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;bundle
&lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;git clone&lt;/span&gt; https:&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;//&lt;/span&gt;github.com&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;scrooloose&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;syntastic.git&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Then quit vim and used :Helptags to check installs so far have worked.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Install Merlin&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot; style=&quot;font-family:monospace;&quot;&gt;opam switch 4.01.0dev+trunk
opam update
opam upgrade
opam &lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;install&lt;/span&gt; merlin&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Add the following to ~/.vimrc&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;vim&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #000000;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #804040;&quot;&gt;set&lt;/span&gt; &lt;span style=&quot;color: #668080;&quot;&gt;rtp&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;+&lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt;~/.&lt;/span&gt;opam&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;4&lt;span style=&quot;color: #000000;&quot;&gt;.&lt;/span&gt;01&lt;span style=&quot;color: #000000;&quot;&gt;.&lt;/span&gt;0dev&lt;span style=&quot;color: #000000;&quot;&gt;+&lt;/span&gt;trunk&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;share&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;ocamlmerlin&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;vim
&lt;span style=&quot;color: #000000;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #804040;&quot;&gt;set&lt;/span&gt; &lt;span style=&quot;color: #668080;&quot;&gt;rtp&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;+&lt;/span&gt;=&lt;span style=&quot;color: #000000;&quot;&gt;~/.&lt;/span&gt;opam&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;4&lt;span style=&quot;color: #000000;&quot;&gt;.&lt;/span&gt;01&lt;span style=&quot;color: #000000;&quot;&gt;.&lt;/span&gt;0dev&lt;span style=&quot;color: #000000;&quot;&gt;+&lt;/span&gt;trunk&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;share&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;ocamlmerlin&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;vimbufsync
&lt;span style=&quot;color: #804040;&quot;&gt;let&lt;/span&gt; g&lt;span style=&quot;color: #000000;&quot;&gt;:&lt;/span&gt;syntastic_ocaml_checkers=&lt;span style=&quot;color: #000000;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #C5A22D;&quot;&gt;'merlin'&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;:SyntasticInfo will return a list of syntax checkers available to Syntastic, check that this now includes merlin&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Install OCP Indent&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot; style=&quot;font-family:monospace;&quot;&gt;opam &lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;install&lt;/span&gt; ocp-indent&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Add the following to ~/.vimrc&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;vim&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #804040;&quot;&gt;autocmd&lt;/span&gt; &lt;span style=&quot;color: #25BB4D;&quot;&gt;FileType&lt;/span&gt; ocaml source &lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;home&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;heidi&lt;span style=&quot;color: #000000;&quot;&gt;-&lt;/span&gt;ann&lt;span style=&quot;color: #000000;&quot;&gt;/.&lt;/span&gt;opam&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;4&lt;span style=&quot;color: #000000;&quot;&gt;.&lt;/span&gt;01&lt;span style=&quot;color: #000000;&quot;&gt;.&lt;/span&gt;0dev&lt;span style=&quot;color: #000000;&quot;&gt;+&lt;/span&gt;trunk&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;share&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;typerex&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;ocp&lt;span style=&quot;color: #000000;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #25BB4D;&quot;&gt;indent&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;/&lt;/span&gt;ocp&lt;span style=&quot;color: #000000;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #25BB4D;&quot;&gt;indent&lt;/span&gt;&lt;span style=&quot;color: #000000;&quot;&gt;.&lt;/span&gt;vim&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

</content><id>http://hh360.user.srcf.net/blog/?p=153</id><title type="text">OCaml Development in Vim</title><updated>2013-09-09T07:51:03+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://anil.recoil.org/2013/09/09/ocamlot-autotriaging.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;The new release of OCaml (4.01.0) was just &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2013-09/msg00173.html&quot;&gt;announced&lt;/a&gt;!
The runup to a major release like this is normally a frantic time to test that
your favourite applications don&amp;rsquo;t break unexpectedly due to some incompatible
language feature.  This release cycle has a little different though, as we&amp;rsquo;ve
been working hard on using the &lt;a href=&quot;http://opam.ocamlpro.com&quot;&gt;OPAM&lt;/a&gt; package
database to build an online regression testing infrastructure to mechanize much
of this process.&lt;/p&gt;

&lt;p&gt;I wanted to share some of what OCamlot does today, some of the results from
about 3 months worth of runs that may help OCaml package maintainers, and
finally where we&amp;rsquo;re going with future developments.  This work has been
done in collaboration with &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/sheets.html&quot;&gt;David Sheets&lt;/a&gt; (who
built the OCamlot daemon) and the OPAM team ably led by &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; at &lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt;.
We&amp;rsquo;ve also had a lot of help from &lt;a href=&quot;https://github.com/diml&quot;&gt;Jeremie Dimino&lt;/a&gt; and &lt;a href=&quot;https://github.com/ysulsky&quot;&gt;Yury Sulsky&lt;/a&gt; from Jane Street
and &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; and &lt;a href=&quot;http://jon.recoil.org&quot;&gt;Jon Ludlam&lt;/a&gt; from Citrix acting as guinea pigs for their respective regular releases of the &lt;a href=&quot;https://github.com/janestreet&quot;&gt;Core&lt;/a&gt;
and &lt;a href=&quot;https://github.com/xapi-project&quot;&gt;Xen/XAPI&lt;/a&gt; releases to OPAM.&lt;/p&gt;

&lt;h2&gt;Towards a truely portable OCaml&lt;/h2&gt;

&lt;p&gt;The upstream OCaml toolchain is built on very UNIX-like principles, with a
number of command-line tools that form a build pipeline.  This process usually
ends with linking the intermediate object files with a &lt;a href=&quot;https://github.com/ocaml/ocaml/tree/trunk/byterun&quot;&gt;runtime library&lt;/a&gt; that provides the
garbage collector and other intrinsic OS functions.&lt;/p&gt;

&lt;p&gt;Given these raw compiler tools, it&amp;rsquo;s very easy to compile OCaml into all
sorts of weird and wonderful architectures.  We&amp;rsquo;ve seen it run on
&lt;a href=&quot;http://www.algo-prog.info/ocaml_for_pic/web/index.php&quot;&gt;8-bit PICs&lt;/a&gt;,
several efficient Javascript backends (originally &lt;a href=&quot;http://jaked.github.io/ocamljs/&quot;&gt;ocamljs&lt;/a&gt; and more recently &lt;a href=&quot;http://ocsigen.org/js_of_ocaml&quot;&gt;js_of_ocaml&lt;/a&gt;),
and of course my own &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage&lt;/a&gt; Xen unikernel.&lt;/p&gt;

&lt;p&gt;While the compiler tools themselves are quite portable and work on almost any
UNIX-like system, the build system scaffolding around third-party packages is
less portable.  Some features such as C bindings often contribute to build
breakage on some less-used operating systems such as FreeBSD or OpenBSD, as
they usually require probing for header file locations or adding custom &lt;code&gt;CFLAGS&lt;/code&gt;
before building.&lt;/p&gt;

&lt;table width=&quot;90%&quot; align=&quot;center&quot;&gt;
&lt;tr&gt;
&lt;td width=&quot;30%&quot; class=&quot;bimg&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/dreamplug-nest-1.jpg&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/dreamplug-nest-1-thumb.jpg&quot; border=&quot;0&quot; width=&quot;200&quot;/&gt;&lt;/a&gt;&lt;br/&gt;Every Internet of Things starts with a tangled pile of ARM Dreamplugs.&lt;/td&gt;
&lt;td width=&quot;30%&quot; class=&quot;bimg&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/sparc-macppc-openbsd-1.jpg&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/sparc-macppc-openbsd-1-thumb.jpg&quot; border=&quot;0&quot; width=&quot;200&quot;/&gt;&lt;/a&gt;&lt;br/&gt;And in our server room, venerable Sparc and PowerPC G4 OpenBSD boxen still live.&lt;/td&gt;
&lt;td style=&quot;vertical-align:bottom&quot; width=&quot;30%&quot; class=&quot;bimg&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/macppc-desktop-1.jpg&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/macppc-desktop-1-thumb.jpg&quot; border=&quot;0&quot; width=&quot;200&quot;/&gt;&lt;/a&gt;&lt;br/&gt;Finding older machines is getting tough, but here's &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave's&lt;/a&gt; old iMac G5 running Linux.&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Most OCaml developers use x86-based machines and so foreign architectures also
get less day-to-day testing (OCaml has superb support for fast native code
compilation on ARM, PowerPC, Sparc32, and we&amp;rsquo;re working on MIPS64 here as part
of the &lt;a href=&quot;http://www.cl.cam.ac.uk/research/security/ctsrd/cheri.html&quot;&gt;CHERI&lt;/a&gt;
project).&lt;/p&gt;

&lt;p&gt;We want to make sure that OCaml and its package ecosystem works just as well in
the embedded ecosystem as well as it does on vanilla x86 Linux.  This includes running on my
Linux iMac G5, my &lt;a href=&quot;https://wiki.freebsd.org/FreeBSD/arm/Raspberry%20Pi&quot;&gt;FreeBSD Raspberry Pi&lt;/a&gt;, my &lt;a href=&quot;http://www.openbsd.org/beagle.html&quot;&gt;OpenBSD Pandaboard&lt;/a&gt;, or even on a
bytecode-only architecture like an &lt;a href=&quot;http://www.openbsd.org/sparc64.html&quot;&gt;OpenBSD/Sparc64&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In the longer term, this paves the way to reliable cross-compiled packages for Windows, &lt;a href=&quot;https://github.com/vouillon/ocaml-android&quot;&gt;Android&lt;/a&gt; and &lt;a href=&quot;http://psellos.com/ocaml/compile-to-iphone.html&quot;&gt;iPhone&lt;/a&gt; (all of which have OCaml ports, but aren&amp;rsquo;t heavily tested with the full package database).  The only practical way to get started on this is by building an automated test infrastructure for OCaml that explores the feature matrix (which eerily for me, happened in the early days of Xen too, via &lt;a href=&quot;http://blogs.citrix.com/2013/08/30/xenserver-automated-testing-and-lab-orchestration-introducing-xenrt/&quot;&gt;XenRT&lt;/a&gt; to stabilize the hypervisor).&lt;/p&gt;

&lt;h3&gt;Why not Jenkins or Travis?&lt;/h3&gt;

&lt;p&gt;When we first started hacking on the OPAM testing infrastructure earlier this
year, I maintained a local &lt;a href=&quot;http://jenkins-ci.org&quot;&gt;Jenkins&lt;/a&gt; installation that
monitored the repository.  While Jenkins is a superb tool for many continuous
integration tasks, it fell over badly when trying to use it on the non-x86 and
non-Linux (or Windows) operating systems.  Jenkins requires a full Java runtime
stack to be available on each of the client machines, which was taking up more
time to get up and running than a simple OCaml-based client and server that
could compile to both portable bytecode or fast native code.&lt;/p&gt;

&lt;p&gt;The other difficulty with OPAM is selecting which packages actually need to be
tested, as it has a constraint-based package solver that supports expressive
forwards and backwards version restrictions.  While basic tests of the latest
packages worked with Jenkins, we needed to increasingly customize it to
automate interfacing directly with the OPAM libraries and calculating test
schedules based on incoming change requests.&lt;/p&gt;

&lt;p&gt;Another factor that ruled out depending on hosted services such as
&lt;a href=&quot;https://travis-ci.org&quot;&gt;Travis&lt;/a&gt; is that they tend to support x86-only
architectures, whereas we really want to test the full spectrum of CPU
variants supported by OCaml.  This doesn&amp;rsquo;t mean that there&amp;rsquo;s no place for
Travis of course, and in fact Mike Lin has already &lt;a href=&quot;http://blog.mlin.net/2013/02/testing-ocaml-projects-on-travis-ci.html&quot;&gt;made this work&lt;/a&gt;
with OPAM.&lt;/p&gt;

&lt;p&gt;For our full testing needs though,
&lt;a href=&quot;https://github.com/ocamllabs/ocamlot&quot;&gt;OCamlot&lt;/a&gt; was born: an OCaml client
and server system which coordinates different versions of the compiler,
architectures and OPAM versions and records the results for triage and
fixing issues.&lt;/p&gt;

&lt;h3&gt;Running OCamlot&lt;/h3&gt;

&lt;p&gt;The latest alpha release of OCamlot is pretty straightforward to run locally,
if you are so inclined.  First start a server process:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git clone git://github.com/ocamllabs/ocamlot
$ cd ocamlot
$ ./install_deps.sh
$ oasis setup
# (edit lib/config.ml if you need to change ports)
$ make
$ ./_build/lib/ocamlot_cmd.native --help
$ ./_build/lib/ocamlot_cmd.native serve
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The server listens on localhost only by default, and normally an SSL-to-TCP
proxy is deployed to listen for external connections (I use
&lt;a href=&quot;https://github.com/bumptech/stud&quot;&gt;stud&lt;/a&gt;, which is fast and easy to configure).&lt;/p&gt;

&lt;p&gt;The OCamlot clients require a local compilation of OCaml, and they autodetect
their local CPU architecture and operating system.  I&amp;rsquo;ve put a &lt;a href=&quot;https://gist.github.com/avsm/6393649&quot;&gt;gist
script&lt;/a&gt; together that automates this on
most Linux and BSD variants.  Just customize the top variables (set &lt;code&gt;MAKE&lt;/code&gt; to
&lt;code&gt;gmake&lt;/code&gt; under BSD) and set the hostname to your server process.&lt;/p&gt;

&lt;h3&gt;The results repository and auto-triage&lt;/h3&gt;

&lt;p&gt;Once the client is running, the server dispatches tasks from its test matrix,
which is calculated from the OPAM package repository.  The server maintains a
&lt;a href=&quot;https://github.com/ocamlot/ocamlot-state&quot;&gt;results repository&lt;/a&gt;, which is a Git
filesystem database that records the build results and logs via an
s-expression per task.  It also uses &lt;a href=&quot;https://github.com/mirage/ocaml-cohttp&quot;&gt;Cohttp&lt;/a&gt;
to serve up the results for a web browser.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s very convenient using Git repositories like this since we can use GitHub
(or any other Git host) to coordinate and record results, and restart the
server without needing any local state.  So convenient, in fact, that Thomas
and I have been working on a more formal engine for this called
&lt;a href=&quot;https://github.com/samoht/irminsule&quot;&gt;Irminsule&lt;/a&gt; (more on that in a later post,
though).&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s almost unheard of to have a full OCamlot run go by without some errors,
and so David put together the &lt;code&gt;ocamlot triage&lt;/code&gt; command.  This takes the
state repository and runs a set of regular expressions over it to classify them
into common errors.  The full file is
&lt;a href=&quot;https://github.com/ocamllabs/ocamlot/blob/master/lib/result.ml&quot;&gt;here&lt;/a&gt;, but an
excerpt should give you an idea of what we look for:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;c&quot;&gt;(* ordered minor to severe *)&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;analysis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solver&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;solver_error&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Dep&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;analysis&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Transient&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transient_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;system_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Meta&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;meta_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Ext_dep&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ext_dep_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Build&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;build_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Multiple&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;analysis&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;
	    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sexp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The errors are ordered by severity to aid in color highlighting. They start with
OPAM solver failures and dependency failures (e.g. due to trying to build a
package that requires a specific OCaml version that isn&amp;rsquo;t available), and
move onto missing package dependencies or system libraris.&lt;/p&gt;

&lt;h2&gt;Testing the run up to OCaml 4.01&lt;/h2&gt;

&lt;p&gt;Of course, running all these tests is useless without taking action on the results. I&amp;rsquo;ve been
keeping track of them in &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/issues/1029&quot;&gt;issue #1029&lt;/a&gt;.
The nice thing about GitHub issues is that when this bug is referenced in commits (even in
other repositories) a cross-reference shows up on that webpage and lets everything be tracked
nicely.&lt;/p&gt;

&lt;p&gt;So what were the most common failures in the runup to 4.01, and what should you avoid when
writing your own code?&lt;/p&gt;

&lt;h3&gt;Different standard library module signatures&lt;/h3&gt;

&lt;p&gt;There have been a few changes to some of the functor signatures in the standard library, such as
adding a &lt;code&gt;find&lt;/code&gt; function to Set (&lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5864&quot;&gt;mantis #5864&lt;/a&gt;).
A third-party library that tries to match the functor signature will fail to compile with a type error, such
as this one below for &lt;a href=&quot;http://anil.recoil.org/feeds/atom-ocaml.xml&quot;&gt;zipperposition.0.2&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Error: The implementation src/ptset.ml
       does not match the interface src/ptset.cmi:
       ...
       In module Big:
       The field `find' is required but not provided
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The relevant code in &lt;code&gt;zipperposition&lt;/code&gt; makes it clear what the problem is:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;c&quot;&gt;(* Big-endian Patricia trees *)&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Big&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sig&lt;/span&gt;
	  &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;S&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;
	  &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intersect&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This particular bug was &lt;a href=&quot;https://github.com/c-cube/zipperposition/issues/1&quot;&gt;reported
upstream&lt;/a&gt;, and the fix
requires implementing the &lt;code&gt;find&lt;/code&gt; function for the Patricia-tree-based &lt;code&gt;Set&lt;/code&gt;.
Since the OPAM package will always be broken on OCaml 4.01, it was marked with
a &lt;a href=&quot;https://github.com/ocamlpro/opam-repository/commit/e45530205987f67d4316a958446d3dcc954b19ec&quot;&gt;compiler version constraint&lt;/a&gt;
to prevent it being selected for installation under that compiler.  When a new
version with the fix is uploaded to OPAM, it will always be selected in
preference to this broken one.&lt;/p&gt;

&lt;p&gt;One other 4.01 change that temporarily broke most of the bigger networking libraries such as
&lt;a href=&quot;https://github.com/janestreet/core&quot;&gt;Core&lt;/a&gt;, &lt;a href=&quot;https://ocsigen.org/lwt&quot;&gt;Lwt&lt;/a&gt; and &lt;a href=&quot;http://batteries.forge.ocamlcore.org&quot;&gt;Batteries&lt;/a&gt;
was the addition of the &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5568&quot;&gt;close-on-exec&lt;/a&gt; flag to the &lt;code&gt;Unix&lt;/code&gt; module.
This change only affects upstream packages that redefine the UNIX module for their own purposes (such as adding an asynchronous I/O monad as Lwt does),
hence it affects the standard library replacement packages.&lt;/p&gt;

&lt;p&gt;The fix here was to locally add patches into the relevant OPAM packages to
immediately unbreak things when the fix when into the 4.01 branch of the
compiler, and notify upstream maintainers to release new versions of their
projects.  There&amp;rsquo;s a subtle problem here: when a patch such as this goes into
an unreleased branch of the compiler (such as &lt;code&gt;4.01.0dev&lt;/code&gt;), it&amp;rsquo;s hard to
reliably detect if the user has got the very latest version of the compiler or
not.
If you do have problems like this in the future, try recompiling via &lt;code&gt;opam switch reinstall &amp;lt;version&amp;gt;&lt;/code&gt; to the latest branch.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s very useful to be able to drop in bleeding-edge compiler tools into the
OPAM repository using compiler constraints like this.  For an example, see
Alain Frisch&amp;rsquo;s &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/blob/master/packages/ppx_tools.0.1/opam&quot;&gt;ppx_tools&lt;/a&gt;,
that require the very latest 4.02dev trunk release to compile his new
extension-points feature.&lt;/p&gt;

&lt;h3&gt;Multiple object definitions&lt;/h3&gt;

&lt;p&gt;OCaml 4.01 also restricts multiple method definitions with the same name in the
same object.  This leaves only inheritance as the way to override method names,
but some packages such as OCamlnet and Mlorg had minor uses of the old mechanism.&lt;/p&gt;

&lt;p&gt;You can see this by using &lt;code&gt;opam switch&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ opam switch 4.00.1
$ eval `opam config env`
$ ocaml
# object method x = 1 method x = 2 end;;
- : &amp;lt; x : int &amp;gt; = &amp;lt;obj&amp;gt;
$ opam switch 4.01.0
$ eval `opam config env`
$ ocaml
# object method x = 1 method x = 2 end;;
Error: The method `x' has multiple definitions in this object
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;New warnings, and the dreaded warnings-as-errors&lt;/h3&gt;

&lt;p&gt;After a decade of being deprecated, the &lt;code&gt;(or)&lt;/code&gt; and &lt;code&gt;(&amp;amp;)&lt;/code&gt; operators
finally had a warning turned on by default.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ocaml
# true or false;;
Warning 3: deprecated feature: operator (or); you should use (||) instead
- : bool = true
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This wouldn&amp;rsquo;t normally be so bad, except that a surprising number of
released packages also turn warnings into fatal errors (by using the
&lt;code&gt;-w @&lt;/code&gt; flags explained in the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/comp.html&quot;&gt;manual&lt;/a&gt;).
Warnings-as-errors is extremely useful when &lt;em&gt;developing&lt;/em&gt; code but is
rather harmful in released code, since a future compiler can choose
to emit new warnings that aren&amp;rsquo;t necessarily fatal bugs.&lt;/p&gt;

&lt;p&gt;Packages that failed like this include ocamlgraph, spotlib, quickcheck,
OPA, Lablgtk-extras and many more.  Please do make an effort to not
leave this option turned on in your packages, or else it makes life
more difficult for testing your code on bleeding edge versions of the
compiler in the future.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s worth noting here that OCaml 4.01 has introduced a fair number
of new and very useful warnings across a number of areas, mainly to do
with detecting unexpected ambiguation or shadowing of values.  I&amp;rsquo;ll
cover more on these in a future post about the new 4.01 goodies.&lt;/p&gt;

&lt;h3&gt;External system dependencies&lt;/h3&gt;

&lt;p&gt;While there any many packages in OPAM that are pure OCaml, there are
also a substantial number that require other system tools to be installed.
The Lablgtk GUI library obviously requires the C &lt;code&gt;gtk&lt;/code&gt; library to be
installed.&lt;/p&gt;

&lt;p&gt;Determining if these libraries are installed on a particular OS is
well beyond the scope of OPAM, as there are almost as many package
managers as there are operating systems.  However, it&amp;rsquo;s important for
automated testing and user-friendly error messages to have some notion
of detecting if the environment is ready for the OCaml package or not.&lt;/p&gt;

&lt;p&gt;We&amp;rsquo;re solving this by using a &lt;code&gt;depexts&lt;/code&gt; field in OPAM that consists
of a set of tags that identify OS-specific packages that need to be
present.  A separate script can query these tags from OPAM and do the
OS-specific tests or installation.&lt;/p&gt;

&lt;p&gt;For example, here&amp;rsquo;s the &lt;code&gt;sqlite3-ocaml&lt;/code&gt; OPAM description:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;opam-version: &amp;quot;1&amp;quot;
maintainer: &amp;quot;markus.mottl@gmail.com&amp;quot;
build: [
  [&amp;quot;ocaml&amp;quot; &amp;quot;setup.ml&amp;quot; &amp;quot;-configure&amp;quot;]
  [&amp;quot;ocaml&amp;quot; &amp;quot;setup.ml&amp;quot; &amp;quot;-build&amp;quot;]
  [&amp;quot;ocaml&amp;quot; &amp;quot;setup.ml&amp;quot; &amp;quot;-install&amp;quot;]
]
remove: [ [&amp;quot;ocamlfind&amp;quot; &amp;quot;remove&amp;quot; &amp;quot;sqlite3&amp;quot;] ]
depends: [&amp;quot;ocamlfind&amp;quot;]
depexts: [
  [ [&amp;quot;debian&amp;quot;  ] [ &amp;quot;libsqlite3-dev&amp;quot;]    ]
  [ [&amp;quot;freebsd&amp;quot; ] [ &amp;quot;database/sqlite3&amp;quot;]  ]
  [ [&amp;quot;openbsd&amp;quot; ] [ &amp;quot;database/sqlite3&amp;quot;]  ]
]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;depexts&lt;/code&gt; field here lists APT package for Debian, and the ports
tree locations for FreeBSD and OpenBSD.  It could also list more specialised
tags for particular versions of an OS.  You can query this from OPAM
as follows:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ opam install -e debian sqlite3-ocaml
libsqlite3-dev
$ opam install -e openbsd sqlite3-ocaml
database/sqlite3
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;OCamlot therefore needs to query the &lt;code&gt;depexts&lt;/code&gt; field from the package and
run the right &lt;code&gt;apt&lt;/code&gt; or &lt;code&gt;pkg_add&lt;/code&gt; commands.  I&amp;rsquo;ll write about this in more
detail when it&amp;rsquo;s fully baked, as we&amp;rsquo;ve modified the semantics of the tag
querying between OPAM 1.0 and OPAM 1.1 to make it easier to use in OCamlot.&lt;/p&gt;

&lt;h3&gt;Portable shell scripts&lt;/h3&gt;

&lt;p&gt;Once we&amp;rsquo;ve gotten past the hurdle of the compiler version causing failures, there is the
small matter of testing non-Linux operating systems, as well as non-x86
CPU architectures.  The &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/issues/1029&quot;&gt;#1029 overview&lt;/a&gt;
lists many of these failures under the Portability section.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.openbsd.org&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/ppuf200X181.gif&quot; style=&quot;float:right&quot;/&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Damien Doligez made some excellent points about how to write &lt;a href=&quot;http://gallium.inria.fr/blog/portable-conditionals-in-makefiles/&quot;&gt;portable
Makefiles&lt;/a&gt;
that works across both GNU and BSD makes.  This is why the carefully crafted
OCaml Makefiles do not require GNU make to be installed when compiling on
FreeBSD or OpenBSD (MacOS X gave up the fight a long time ago and installs GNU
make as its default &lt;code&gt;make&lt;/code&gt; command).&lt;/p&gt;

&lt;p&gt;OPAM tries to help out BSD by providing a &lt;code&gt;make&lt;/code&gt; macro in &lt;code&gt;opam&lt;/code&gt; files that
is substituted with either &lt;code&gt;&amp;quot;make&amp;quot;&lt;/code&gt; (by default) or &lt;code&gt;&amp;quot;gmake&amp;quot;&lt;/code&gt; (for BSD).
While this works for for the toplevel invocation of the Makefile, it fails
if the Makefile recursively invokes further targets without using the &lt;code&gt;$(MAKE)&lt;/code&gt;
variable instead of directly calling the command.
Patching these sorts of things is easy but tedious: see the &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/blob/master/packages/facile.1.1/files/bsdmake.patch&quot;&gt;patchfile&lt;/a&gt; for the
Facile constraint programming library for an example.&lt;/p&gt;

&lt;p&gt;The real problem here, of course, is that package maintainers cannot be reasonably
expected to test their code on systems that they don&amp;rsquo;t normally use&amp;ndash;if we demanded
perfect portability to be present in the main OPAM repository, we would&amp;rsquo;t get
any submissions!&lt;/p&gt;

&lt;p&gt;OCamlot automates this nicely though, by finding lots of portability bugs
automatically, and maintainers are by-and-large very responsive when we report
the problem upstream.&lt;/p&gt;

&lt;h2&gt;The emerging distributed workflow&lt;/h2&gt;

&lt;p&gt;The big drawback to OCamlot in its current form is the amount of triage effort
it puts on the OPAM maintainers.  The package database has now exceeded 500
packages in just a short few months, and has over 1500 unique versions that
all need build testing and more accurate constraints.  The wider community has
been &lt;em&gt;really&lt;/em&gt; keen to participate in helping with triage (just look at all the
other people that leapt in on &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/issues/1029&quot;&gt;bug #1029&lt;/a&gt;),
so its our immediate priority to make OCamlot more transparent for people that
want to use it to improve their own packages, and in the future also use it
to test various hypotheses about all the available open-source OCaml code
(see Jacques&amp;rsquo; experiment with &lt;a href=&quot;http://gallium.inria.fr/blog/monomorphic_let/&quot;&gt;monomorphic let&lt;/a&gt; as
an example of something that can benefit from wider automated compilation).&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ll talk more about how we&amp;rsquo;re solving this in my upcoming &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/&quot;&gt;OCaml 2013
Workshop&lt;/a&gt; talk about the Platform.  I
don&amp;rsquo;t want spoil it too much, but it involves a lovely distributed Git
workflow, an enhanced &lt;a href=&quot;https://github.com/OCamlPro/opam2web&quot;&gt;opam2web&lt;/a&gt;, and a
brand new metadata overlay system for OPAM that lets us enhance the package
database with extra information such as statistics, portability and test
results, but without polluting the main Git repository with all this extra
non-essential data.&lt;/p&gt;

&lt;p&gt;If you&amp;rsquo;re really curious to know right now, then you can see the outline of the
new system at Amir&amp;rsquo;s &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;new ocaml.org
wireframes&lt;/a&gt; blog post,
where Part III contains the continuous integration workflow.  A lot of infrastructure
work has gone into building all of this over the summer, and now it&amp;rsquo;s all
starting to be deployed in a very satisfying way&amp;hellip;&lt;/p&gt;
</content><id>http://anil.recoil.org/2013/09/09/ocamlot-autotriaging.html</id><title type="text">OCamlot--exploring the edges of OPAM packages</title><updated>2013-09-09T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=25" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;I&amp;rsquo;m busy planning my first trip across the&amp;nbsp;Atlantic to attend ICFP, CUFP and OCaml 2013. Today, I&amp;rsquo;ve been given the duty of &amp;ldquo;live blogging&amp;rdquo; the event, over at the &lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/&quot; title=&quot;syslog&quot;&gt;syslog&lt;/a&gt;, the Cambridge&amp;nbsp;Systems Research Group blog.&lt;/p&gt;
&lt;p&gt;My other job for the event is to improve the documentation for &lt;a href=&quot;http://janestreet.github.io/guide-async.html&quot;&gt;Janestreet&amp;rsquo;s Async&lt;/a&gt; library. if anyone else is keen, I would love to organise a doc-a-thon to populate the .mli files&lt;/p&gt;
</content><id>http://hh360.user.srcf.net/blog/?p=25</id><title type="text">ICFP, CUFP &amp; OCaml2013</title><updated>2013-08-28T20:05:23+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://openmirage.org/blog/introducing-vchan" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;em&gt;Editor&lt;/em&gt;: Note that some of the toolchain details of this blog post are
now out-of-date with Mirage 1.1, so we will update this shortly.&lt;/p&gt;
&lt;p&gt;Unless you are familiar with Xen's source code, there is little chance
that you've ever heard of the &lt;em&gt;vchan&lt;/em&gt; library or
protocol. Documentation about it is very scarce: a description can be
found on vchan's
&lt;a href=&quot;http://xenbits.xen.org/gitweb/?p=xen.git%3Ba=blob%3Bf=xen/include/public/io/libxenvchan.h%3Bhb=HEAD&quot;&gt;public header file&lt;/a&gt;,
that I quote here for convenience:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Originally borrowed from the
&lt;a href=&quot;http://www.qubes-os.org&quot;&gt;Qubes OS Project&lt;/a&gt;, this code (i.e. libvchan)
has been substantially rewritten [...]
This is a library for inter-domain communication.  A standard Xen ring
buffer is used, with a datagram-based interface built on top.  The
grant reference and event channels are shared in XenStore under a
user-specified path.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;This protocol uses shared memory for inter-domain communication,
i.e. between two VMs residing in the same Xen host, and uses Xen's
mechanisms -- more specifically,
&lt;a href=&quot;http://www.informit.com/articles/article.aspx?p=1160234&amp;amp;seqNum=3&quot;&gt;ring buffers&lt;/a&gt;
and
&lt;a href=&quot;http://xenbits.xen.org/gitweb/?p=xen.git%3Ba=blob%3Bf=tools/libxc/xenctrl.h%3Bh=f2cebafc9ddd4815ffc73fcf9e0d292b1d4c91ff%3Bhb=HEAD#l934&quot;&gt;event channels&lt;/a&gt;
-- in order to achieve its aims. &lt;em&gt;Datagram-based interface&lt;/em&gt; simply
means that the
&lt;a href=&quot;http://xenbits.xen.org/gitweb/?p=xen.git%3Ba=blob%3Bf=tools/libvchan/libxenvchan.h%3Bh=6365d36a06f8c8f56454724cefc4c2f1d39beba2%3Bhb=HEAD&quot;&gt;interface&lt;/a&gt;
resembles UDP, although there is support for stream based communication (like
TCP) as well.&lt;/p&gt;
&lt;p&gt;Over the last two months or so, I worked on a &lt;a href=&quot;http://github.com/mirage/ocaml-vchan&quot;&gt;pure OCaml
implementation&lt;/a&gt; of this library, meaning
that Mirage-based unikernels can now take full advantage of &lt;em&gt;vchan&lt;/em&gt; to
communicate with neighboring VMs! If your endpoint -- a Linux VM or another
unikernel -- is on the same host, it is much faster and more efficient to use
vchan rather than the network stack (although unfortunately, it is currently
incompatible with existing programs written against the &lt;code&gt;socket&lt;/code&gt; library under
UNIX or the &lt;code&gt;Flow&lt;/code&gt; module of Mirage, although this will improve). It also
provides a higher level of security compared to network sockets as messages
will never leave the host's shared memory.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Building the vchan echo domain&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Provided that you have a Xen-enabled machine, do the following from
dom0:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    opam install mirari mirage-xen mirage vchan&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will install the library and its dependencies. &lt;code&gt;mirari&lt;/code&gt; is
necessary to build the &lt;em&gt;echo unikernel&lt;/em&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    git clone git://github.com/mirage/ocaml-vchan
    cd test
    mirari configure --xen --no-install
    mirari build --xen
    sudo mirari run --xen&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will boot a &lt;code&gt;vchan echo domain&lt;/code&gt; for dom0, with connection
parameters stored in xenstore at &lt;code&gt;/local/domain/&amp;lt;domid&amp;gt;/data/vchan&lt;/code&gt;,
where &lt;code&gt;&amp;lt;domid&amp;gt;&lt;/code&gt; is the domain id of the vchan echo domain. The echo
domain is simply an unikernel hosting a vchan server accepting
connections from dom0, and echo'ing everything that is sent to it.&lt;/p&gt;
&lt;p&gt;The command &lt;code&gt;xl list&lt;/code&gt; will give you the domain id of the echo
server.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Building the vchan CLI from Xen's sources&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You can try it using a vchan client that can be found in Xen's sources
at &lt;code&gt;tools/libvchan&lt;/code&gt;: Just type &lt;code&gt;make&lt;/code&gt; in this directory. It will
compile the executable &lt;code&gt;vchan-node2&lt;/code&gt; that you can use to connect to
our freshly created echo domain:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    ./vchan-node2 client &amp;lt;domid&amp;gt;/local/domain/&amp;lt;domid&amp;gt;/data/vchan&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If everything goes well, what you type in there will be echoed.&lt;/p&gt;
&lt;p&gt;You can obtain the full API documentation for &lt;em&gt;ocaml-vchan&lt;/em&gt; by doing a
&lt;code&gt;cd ocaml-vchan &amp;amp;&amp;amp; make doc&lt;/code&gt;. If you are doing network programming
under UNIX, vchan's interface will not surprise you. If you are
already using vchan for a C project, you will see that the OCaml API
is nearly identical to what you are used to.&lt;/p&gt;
&lt;p&gt;Please let us know if you use or plan to use this library in any way!
If you need tremedous speed or more security, this might fit your
needs.&lt;/p&gt;

   </content><id>http://openmirage.org/blog/introducing-vchan</id><title type="text">Introducing vchan</title><updated>2013-08-23T17:43:00+00:00</updated><author><email></email><name>Vincent Bernardoff</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=86" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;Beta3 of RWO is now available:&amp;nbsp;&lt;a href=&quot;https://realworldocaml.org/&quot;&gt;https://realworldocaml.org/&lt;/a&gt;&amp;nbsp;and anil (one of the co-authors) comments on the release&amp;nbsp;&lt;a href=&quot;http://anil.recoil.org/2013/08/06/real-world-ocaml-beta2.html&quot;&gt;http://anil.recoil.org/2013/08/06/real-world-ocaml-beta2.html&lt;/a&gt;&lt;/p&gt;
&lt;figure style=&quot;width: 180px;&quot; class=&quot;wp-caption aligncenter&quot;&gt;&lt;img src=&quot;https://realworldocaml.org/media/img/oreilly-cover.gif&quot; alt=&quot;&quot; width=&quot;180&quot; height=&quot;236&quot;/&gt;&lt;figcaption class=&quot;wp-caption-text&quot;&gt;Cover of RWO&lt;/figcaption&gt;&lt;/figure&gt;
</content><id>http://hh360.user.srcf.net/blog/?p=86</id><title type="text">Real World OCaml beta3 release</title><updated>2013-08-19T10:39:34+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://openmirage.org/blog/oscon13-trip-report" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;Now that Mirage OS is rapidly converging on a
&lt;a href=&quot;http://github.com/avsm/mirage/issues/102&quot;&gt;Developer Preview Release 1&lt;/a&gt;, we
took it for a first public outing at
&lt;a href=&quot;http://www.oscon.com/oscon2013/&quot;&gt;OSCON'13&lt;/a&gt;, the O'Reilly Open Source
Conference. OSCON is in its 15th year now, and is a meeting place for
developers, business people and investors. It was a great opportunity to show
MirageOS off to some of the movers and shakers in the OSS world.&lt;/p&gt;
&lt;p&gt;Partly because MirageOS is about synthesising extremely specialised guest
kernels from high-level code, and partly because both Anil and I are
constitutionally incapable of taking the easy way out, we self-hosted the
slide deck on Mirage: after some last-minute hacking -- on content not Mirage
I should add! -- we built a self-contained unikernel of the talk.&lt;/p&gt;
&lt;p&gt;This was what you might call a &amp;quot;full stack&amp;quot; presentation: the custom
unikernel (flawlessly!) ran a type-safe
&lt;a href=&quot;https://github.com/mirage/mirage-platform/blob/master/xen/lib/netif.ml&quot;&gt;network device driver&lt;/a&gt;,
OCaml &lt;a href=&quot;http://github.com/mirage/mirage-net&quot;&gt;TCP/IP stack&lt;/a&gt; supporting an OCaml
&lt;a href=&quot;http://github.com/mirage/ocaml-cohttp&quot;&gt;HTTP&lt;/a&gt; framework that served slides
rendered using &lt;a href=&quot;http://lab.hakim.se/reveal-js/&quot;&gt;reveal.js&lt;/a&gt;. The slide deck,
including the turbo-boosted
&lt;a href=&quot;http://www.youtube.com/watch?v=2Mx8Bd5JYyo&quot;&gt;screencast&lt;/a&gt; of the slide deck
compilation, is hosted as another MirageOS virtual machine at
&lt;a href=&quot;http://decks.openmirage.org/&quot;&gt;decks.openmirage.org&lt;/a&gt;. We hope to add more
slide decks there soon, including resurrecting the tutorial! The source code
for all this is in the &lt;a href=&quot;http://github.com/mirage/mirage-decks&quot;&gt;mirage-decks&lt;/a&gt;
GitHub repo.&lt;/p&gt;
&lt;h3&gt;The Talk&lt;/h3&gt;

&lt;p&gt;The talk went down pretty well -- given we were in a graveyard slot on Friday
after many people had left, attendance was fairly high (around 30-40), and the
&lt;a href=&quot;http://www.oscon.com/oscon2013/public/schedule/detail/28956&quot;&gt;feedback scores&lt;/a&gt;
have been positive (averaging 4.7/5) with comments including &amp;quot;excellent
content and well done&amp;quot; and &amp;quot;one of the most excited projects I heard about&amp;quot;
(though we are suspicious that just refers to Anil's usual high-energy
presentation style...).&lt;/p&gt;
&lt;iframe allowfullscreen=&quot;1&quot; frameborder=&quot;0&quot; src=&quot;//www.youtube-nocookie.com/embed/2Mx8Bd5JYyo&quot; height=&quot;235&quot; width=&quot;420&quot; style=&quot;margin-left: 10px;&quot; align=&quot;right&quot;&gt; &amp;nbsp; &lt;/iframe&gt;

&lt;p&gt;Probably the most interesting chat after the talk was with the Rust authors
at Mozilla (&lt;a href=&quot;http://twitter.com/pcwalton&quot;&gt;@pcwalton&lt;/a&gt; and
&lt;a href=&quot;https://github.com/brson&quot;&gt;@brson&lt;/a&gt;) about combining the Mirage
&lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;unikernel&lt;/a&gt; techniques
with the &lt;a href=&quot;http://www.rust-lang.org&quot;&gt;Rust&lt;/a&gt; runtime. But perhaps the most
surprising feedback was when Anil and I were stopped in the street while
walking back from some well-earned sushi, by a cyclist who loudly declared
that he'd really enjoyed the talk and thought it was a really exciting project
-- never done something that achieved public acclaim from the streets before
:)&lt;/p&gt;
&lt;h3&gt;Book Signing and Xen.org&lt;/h3&gt;

&lt;p&gt;Anil also took some time to sit in a book signing for his forthcoming
&lt;a href=&quot;http://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; O'Reilly book.  This is
really important to making OCaml easier to learn, especially given that
all the Mirage libraries are using it.  Most of the dev team (and especially
thanks to &lt;a href=&quot;https://twitter.com/heidiann360&quot;&gt;Heidi Howard&lt;/a&gt; who bravely worked
through really early alpha revisions) have been giving
us feedback as the book is written, using the online commenting system.&lt;/p&gt;
&lt;p&gt;The Xen.org booth was also huge, and we spent quite a while plotting the
forthcoming Mirage/Xen/ARM backend. We're pretty much just waiting for the
&lt;a href=&quot;http://cubieboard.org&quot;&gt;Cubieboard2&lt;/a&gt; kernel patches to be upstreamed (keep an
eye &lt;a href=&quot;http://linux-sunxi.org/Main_Page&quot;&gt;here&lt;/a&gt;) so that we can boot Xen/ARM VMs
on tiny ARM devices.  There's a full report about this on the
&lt;a href=&quot;http://blog.xen.org/index.php/2013/07/31/the-xen-project-at-oscon/&quot;&gt;xen.org&lt;/a&gt;
blog post about OSCon.&lt;/p&gt;
&lt;h3&gt;Galois and HalVM&lt;/h3&gt;

&lt;p&gt;We also stopped by the &lt;a href=&quot;http://corp.galois.com&quot;&gt;Galois&lt;/a&gt; to chat with &lt;a href=&quot;https://twitter.com/acwpdx&quot;&gt;Adam
Wick&lt;/a&gt;, who is the leader of the
&lt;a href=&quot;http://corp.galois.com/halvm&quot;&gt;HalVM&lt;/a&gt; project at Galois. This is a similar
project to Mirage, but, since it's written in Haskell, has more of a focus
on elegant compositional semantics rather than the more brutal performance
and predictability that Mirage currently has at its lower levels.&lt;/p&gt;
&lt;p&gt;The future of all this ultimately lies in making it easier for these
multi-lingual unikernels to be managed and for all of them to communicate more
easily, so we chatted about code sharing and common protocols (such as
&lt;a href=&quot;https://github.com/vbmithr/ocaml-vchan&quot;&gt;vchan&lt;/a&gt;) to help interoperability.
Expect to see more of this once our respective implementations get more
stable.&lt;/p&gt;
&lt;p&gt;All-in-all OSCON'13 was a fun event and definitely one that we look forward
returning to with a more mature version of MirageOS, to build on the momentum
begun this year!  Portland was an amazing host city too, but what happens in
Portland, stays in Portland...&lt;/p&gt;

   </content><id>http://openmirage.org/blog/oscon13-trip-report</id><title type="text">Mirage travels to OSCON'13: a trip report</title><updated>2013-08-08T16:00:00+00:00</updated><author><email></email><name>Richard Mortier</name></author></entry><entry><link href="http://anil.recoil.org/2013/08/06/real-world-ocaml-beta2.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;The second and final public beta of Real World OCaml is now available:
  &lt;a href=&quot;https://realworldocaml.org&quot;&gt;https://realworldocaml.org&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Release notes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Over 2,000 comments from proofreaders have been resolved.  We realize that
reading early content is hard work, and hugely appreciate the spirited
feedback!  The book is now a week away from being handed over to the
O&amp;rsquo;Reilly production team for copyediting, so the window for changes are
limited after that.  Comments reset between milestones and so beta2 is a
clean slate; we&amp;rsquo;re still working through some remaining older issues.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The chapters on first-class modules, parsing with Menhir, and objects
and classes have been significantly revised from beta1. Our thanks to
Leo White for contributing significantly to the latter two chapters.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;All the code snippets and terminal outputs are now mechanically generated.
The source code is as close to public domain as practical, at:
    &lt;a href=&quot;https://github.com/realworldocaml/examples&quot;&gt;https://github.com/realworldocaml/examples&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The final version will have the installation chapter moved to be online
only, and we intend to publish updates there to elaborate on installation
and packaging mechanisms.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Exercises will be available after we go into production, and also only be
available online. We really like the collaborative spirit of the commenting
system, and will likely extend this to collecting exercises from our readers
on an ongoing basis.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;There&amp;rsquo;s been quite a bit of feedback and conversation about the book, so this
also seemed like a good point to checkpoint the process somewhat.&lt;/p&gt;

&lt;h2&gt;Crowd sourcing community feedback&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://realworldocaml.org&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/oreilly-cover.gif&quot; style=&quot;padding-left:15px&quot; align=&quot;right&quot;/&gt;&lt;/a&gt;
&lt;em&gt;Good&lt;/em&gt;: The decision to crowdsource feedback has been exhausting but very
worthwhile, with over 2,200 &lt;a href=&quot;http://github.com/ocamllabs/rwo-comments&quot;&gt;comments&lt;/a&gt; posted (and over 2,000
resolved by us too!).  O&amp;rsquo;Reilly has a similar platform called
&lt;a href=&quot;http://atlas.labs.oreilly.com&quot;&gt;Atlas&lt;/a&gt; that wasn&amp;rsquo;t quite ready when we started
our book, but I&amp;rsquo;d highly encourage new authors to go down this route and not
stick with a traditional editorial scheme.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s simply not possible for a
small group of technical reviewers to notice as many errors as the wider
community has. Having said this, it&amp;rsquo;s interesting how much more focussed and
critical the comments of our editor &lt;a href=&quot;http://radar.oreilly.com/andyo&quot;&gt;Andy Oram&lt;/a&gt;
were when compared to most of the wider community feedback, so the commenting system is
definitely a complement and not a replacement to the editorial process.&lt;/p&gt;

&lt;h3&gt;The GitHub requirement&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Bad&lt;/em&gt;: After the first beta, we got criticized on a &lt;a href=&quot;https://news.ycombinator.com/item?id=5893168&quot;&gt;Hacker News&lt;/a&gt; thread
for passing around Github oAuth tokens without SSL.
This was entirely my fault, and I corrected the site to be pure-SSL within 24 hours.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Ugly&lt;/em&gt;: In my defence though, I &lt;em&gt;dont want&lt;/em&gt; the authority that all the
reviewers have granted to me for their Github accounts!  We need just two
things to enable commenting: an identity service to cut down on spam comments,
and the ability to create issues in a &lt;a href=&quot;http://github.com/ocamllabs/rwo-comments&quot;&gt;public repository&lt;/a&gt;.  Unfortunately, Github&amp;rsquo;s
&lt;a href=&quot;http://developer.github.com/v3/oauth/#scopes&quot;&gt;scope&lt;/a&gt; API requires you to also
grant us access to commit to public code repositories.  Add on the fact that
around 6,000 people have clicked through the oAuth API to review RWO, and you
start to see just how much code we potentially have access to.
I did try to reduce the damage by not actually storing the oAuth tokens on the
server-side.  Instead, we store it in the client using a secure cookie, so you
can easily reset your browser to log out.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s not just about authentication either: another reader
&lt;a href=&quot;http://www.reddit.com/r/ocaml/comments/1gil84/public_beta_of_real_world_ocaml/cal811r&quot;&gt;points out&lt;/a&gt;
that if they use GitHub during work hours, they have no real way of separating
the news streams that result.&lt;/p&gt;

&lt;p&gt;Much of the frustration here is that there&amp;rsquo;s nothing I can do to fix this except
wait for GitHub to hopefully improve their service.  I very much hope that GitHub
is listening to this and has internal plans to overhaul their privilege management
APIs.&lt;/p&gt;

&lt;h3&gt;Infrastructure-free hosting&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Good&lt;/em&gt; and &lt;em&gt;Bad&lt;/em&gt;: One of my goals with the commenting infrastructure was to try
and eliminate all server-side code, so that we could simply publish the book
onto Github Pages and use JavaScript for the comment creation and listing.&lt;/p&gt;

&lt;p&gt;This &lt;em&gt;almost&lt;/em&gt; worked out. We still need a tiny HTTP proxy for comment creation,
as we add contextual information such as a milestone to every new comment to
make it easier to index.  Setting a milestone requires privileged access to the
repository and so our server-side proxy creates the issue using the
user-supplied oAuth token (so that it originates from the commenter), and then
updates it (via the &lt;a href=&quot;http://github.com/bactrian&quot;&gt;bactrian&lt;/a&gt; account) to add the
milestone add insert a little contextual comment pointing back to the book
paragraph where the comment originated from.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Good&lt;/em&gt;: The other criticism from the &lt;a href=&quot;http://www.reddit.com/r/programming/comments/1gipea/first_public_beta_of_real_world_ocaml_book/cakmeuz&quot;&gt;online
feedback&lt;/a&gt;
was the &lt;em&gt;requirement&lt;/em&gt; to have a Github login to read the book at all.  This is a
restriction that we intend to lift for the final release (which will be freely
available online under a &lt;a href=&quot;http://creativecommons.org/licenses/by-nc-nd/3.0/us/&quot;&gt;CC-BY-NC-ND&lt;/a&gt; license),
but I think it&amp;rsquo;s absolutely the right decision to gateway early adopters to get
useful feedback.  Even if we lost 90% of our potential reviewers through the
Github auth wall, I don&amp;rsquo;t think we could have coped with another 10,000
comments in any case.&lt;/p&gt;

&lt;p&gt;On the positive side, we didn&amp;rsquo;t have a single spam comment or other abuses of
the commenting system at all.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ve had quite a few queries been open-sourcing the
&lt;a href=&quot;http://github.com/realworldocaml/scripts&quot;&gt;scripts&lt;/a&gt; that drive the server-side
commenting, and this on my TODO list for after the final book has gone to
production.&lt;/p&gt;

&lt;h2&gt;Auto-generating the examples&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;Bad&lt;/em&gt;: We tried for far too long during the book writing to stumble through
with manual installation instructions and hand-copied code snippets and 
outputs.  Some of our alpha reviewers pointed out &lt;a href=&quot;https://github.com/ocamllabs/rwo-comments/issues/236&quot;&gt;vociferously&lt;/a&gt;
that spending time on installation and dealing with code typos was not a good
use of their time.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Good&lt;/em&gt;: &lt;a href=&quot;http://bolinfest.com&quot;&gt;Michael Bolin&lt;/a&gt; was entirely correct in his
criticism (and incidentally, one of our most superstar reviewers).  The latest
beta has an entirely mechanically generated toolchain that lets us regenerate
the entire book output from a cold start by cloning the &lt;a href=&quot;https://github.com/realworldocaml/examples&quot;&gt;examples&lt;/a&gt;
repository.  In retrospect, I should have written this infrastructure a year ago,
and I&amp;rsquo;d recommend any new books of this sort focus hard on automation from
the early days.&lt;/p&gt;

&lt;p&gt;Luckily, my automation &lt;a href=&quot;https://github.com/realworldocaml/scripts&quot;&gt;scripts&lt;/a&gt;
could crib heavily from existing open-source OCaml projects that had portions
of what we needed, such as &lt;a href=&quot;https://github.com/diml/utop&quot;&gt;uTop&lt;/a&gt; and
&lt;a href=&quot;https://github.com/ocaml/ocaml.org&quot;&gt;ocaml.org&lt;/a&gt; (and my thanks to
&lt;a href=&quot;https://github.com/diml&quot;&gt;Jeremie Dimino&lt;/a&gt; and &lt;a href=&quot;https://github.com/Chris00&quot;&gt;Christophe Troestler&lt;/a&gt; for
their help here).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Awesome&lt;/em&gt;: We&amp;rsquo;re hacking on a little surprise for the final online version of the
book, based on this build infrastructure.  Stay &lt;a href=&quot;http://try.ocamlpro.com&quot;&gt;tuned&lt;/a&gt;!&lt;/p&gt;
</content><id>http://anil.recoil.org/2013/08/06/real-world-ocaml-beta2.html</id><title type="text">Final Real World OCaml beta; the good, the bad and the ugly</title><updated>2013-08-06T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=99" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;I just wanted to share these sildes from&amp;nbsp;Yaron Minsky guest lecture at Princeton on &amp;ldquo;Abstractions and Types&amp;nbsp;for Concurrent&amp;nbsp;Programming&amp;rdquo;: [&lt;a href=&quot;http://www.cs.princeton.edu/~dpw/courses/cos326-12/lec/asynch-and-rpc.pdf&quot;&gt;pdf&lt;/a&gt;] &amp;nbsp;to the &lt;a href=&quot;http://www.cs.princeton.edu/~dpw/courses/cos326-12/&quot;&gt;COS 326&lt;/a&gt; class and the notes from Cornell&amp;rsquo;s OCaml course called &amp;ldquo;&lt;a href=&quot;http://www.cs.cornell.edu/Courses/cs3110/2011sp/lecturenotes.asp&quot;&gt;Data Structures and Functional Programming&lt;/a&gt;&amp;ldquo;, edit the URL to see notes from different years&lt;/p&gt;
</content><id>http://hh360.user.srcf.net/blog/?p=99</id><title type="text">OCaml Lecture Notes</title><updated>2013-08-01T14:40:42+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://openmirage.org/blog/xen-block-devices-with-mirage" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;a href=&quot;http://www.openmirage.org/&quot;&gt;Mirage&lt;/a&gt; is a
&lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;unikernel&lt;/a&gt;
or &amp;quot;library operating system&amp;quot; that allows us to build applications
which can be compiled to very diverse environments: the same code can be linked
to run as a regular Unix app, relinked to run as a &lt;a href=&quot;https://github.com/pgj/mirage-kfreebsd&quot;&gt;FreeBSD kernel module&lt;/a&gt;,
and even linked into a
self-contained kernel which can run on the &lt;a href=&quot;http://www.xenproject.org/&quot;&gt;Xen
hypervisor&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Mirage has access to an extensive suite of pure OCaml &lt;a href=&quot;https://github.com/mirage&quot;&gt;libraries&lt;/a&gt;,
covering everything from Xen &lt;a href=&quot;https://github.com/mirage/ocaml-xen-block-driver&quot;&gt;block&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirage/mirage-platform/blob/master/xen/lib/netif.ml&quot;&gt;network&lt;/a&gt; virtual device drivers,
a &lt;a href=&quot;https://github.com/mirage/mirage-net&quot;&gt;TCP/IP stack&lt;/a&gt;, OpenFlow learning switches and controllers, to
SSH and &lt;a href=&quot;https://github.com/mirage/ocaml-cohttp&quot;&gt;HTTP&lt;/a&gt; server implementations.&lt;/p&gt;
&lt;p&gt;I normally use Mirage to deploy applications as kernels on top of
a &lt;a href=&quot;http://www.xenserver.org/&quot;&gt;XenServer&lt;/a&gt; hypervisor. I start by
first using the Mirage libraries within a normal Unix userspace
application -- where I have access to excellent debugging tools --
and then finally link my app as a high-performance Xen kernel for
production.&lt;/p&gt;
&lt;p&gt;However Mirage is great for more than simply building Xen kernels.
In this post I'll describe how I've been using Mirage to create
experimental virtual disk devices for existing Xen VMs (which may
themselves be Linux, *BSD, Windows or even Mirage kernels).
The Mirage libraries let me easily
experiment with different backend file formats and protocols, all while
writing only type-safe OCaml code thats runs in userspace in a normal
Linux domain 0.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Disk devices under Xen&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The protocols used by Xen disk and network devices are designed to
permit fast and efficient software implementations, avoiding the
inefficiencies inherent in emulating physical hardware in software.
The protocols are based on two primitives:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;em&gt;shared memory pages&lt;/em&gt;: used for sharing both data and metadata&lt;/li&gt;&lt;li&gt;&lt;em&gt;event channels&lt;/em&gt;: similar to interrupts, these allow one side to signal the other&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;In the disk block protocol, the protocol starts with the client
(&amp;quot;frontend&amp;quot; in Xen jargon) sharing a page with the server (&amp;quot;backend&amp;quot;).
This single page will contain the request/response metadata, arranged
as a circular buffer or &amp;quot;ring&amp;quot;. The client (&amp;quot;frontend&amp;quot;) can then start
sharing pages containing disk blocks with the backend and pushing request
structures to the ring, updating shared pointers as it goes. The client
will give the server end a kick via an event channel signal and then both
ends start running simultaneously. There are no locks in the protocol so
updates to the shared metadata must be handled carefully, using write
memory barriers to ensure consistency.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Xen disk devices in Mirage&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Like everything else in Mirage, Xen disk devices are implemented as
libraries. The ocamlfind library called &amp;quot;xenctrl&amp;quot; provides support for
manipulating blocks of raw memory pages, &amp;quot;granting&amp;quot; access to them to
other domains and signalling event channels. There are two implementations
of &amp;quot;xenctrl&amp;quot;:
&lt;a href=&quot;https://github.com/mirage/mirage-platform/tree/master/xen/lib&quot;&gt;one that invokes Xen &amp;quot;hypercalls&amp;quot; directly&lt;/a&gt;
 and one which uses the &lt;a href=&quot;https://github.com/xapi-project/ocaml-xen-lowlevel-libs&quot;&gt;Xen userspace library libxc&lt;/a&gt;.
Both implementations satisfy a common signature, so it's easy to write
code which will work in both userspace and kernelspace.&lt;/p&gt;
&lt;p&gt;The ocamlfind library
&lt;a href=&quot;https://github.com/mirage/shared-memory-ring&quot;&gt;shared-memory-ring&lt;/a&gt;
provides functions to create and manipulate request/response rings in shared
memory as used by the disk and network protocols. This library is a mix of
99.9% OCaml and 0.1% asm, where the asm is only needed to invoke memory
barrier operations to ensure that metadata writes issued by one CPU core
appear in the same order when viewed from another CPU core.&lt;/p&gt;
&lt;p&gt;Finally the ocamlfind library
&lt;a href=&quot;https://github.com/mirage/ocaml-xen-block-driver&quot;&gt;xenblock&lt;/a&gt;
provides functions to hotplug and hotunplug disk devices, together with an
implementation of the disk block protocol itself.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Making custom virtual disk servers with Mirage&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Let's experiment with making our own virtual disk server based on
the Mirage example program, &lt;a href=&quot;https://github.com/mirage/xen-disk&quot;&gt;xen-disk&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;First, install &lt;a href=&quot;http://www.xen.org/&quot;&gt;Xen&lt;/a&gt;, &lt;a href=&quot;http://www.ocaml.org/&quot;&gt;OCaml&lt;/a&gt;
and &lt;a href=&quot;http://opam.ocamlpro.com/&quot;&gt;OPAM&lt;/a&gt;. Second initialise your system:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  opam init
  eval `opam config env`&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;At the time of writing, not all the libraries were released as upstream
OPAM packages, so it was necessary to add some extra repositories. This
should not be necessary after the Mirage developer preview at
&lt;a href=&quot;http://www.oscon.com/oscon2013/public/schedule/detail/28956&quot;&gt;OSCON 2013&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  opam remote add mirage-dev git://github.com/mirage/opam-repo-dev
  opam remote add xapi-dev git://github.com/xapi-project/opam-repo-dev&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install the unmodified &lt;code&gt;xen-disk&lt;/code&gt; package, this will ensure all the build
dependencies are installed:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  opam install xen-disk&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When this completes it will have installed a command-line tool called
&lt;code&gt;xen-disk&lt;/code&gt;. If you start a VM using your Xen toolstack of choice
(&amp;quot;xl create ...&amp;quot; or &amp;quot;xe vm-install ...&amp;quot; or &amp;quot;virsh create ...&amp;quot;) then you
should be able to run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  xen-disk connect &amp;lt;vmname&amp;gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;which will hotplug a fresh block device into the VM &amp;quot;&amp;lt;vmname&amp;gt;&amp;quot; using the
&amp;quot;discard&amp;quot; backend, which returns &amp;quot;success&amp;quot; to all read and write requests,
but actually throws all data away. Obviously this backend should only be
used for basic testing!&lt;/p&gt;
&lt;p&gt;Assuming that worked ok, clone and build the source for &lt;code&gt;xen-disk&lt;/code&gt; yourself:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  git clone git://github.com/mirage/xen-disk
  cd xen-disk
  make&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;Making a custom virtual disk implementation&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;xen-disk&lt;/code&gt; program has a set of simple built-in virtual disk implementations.
Each one satisifies a simple signature, contained in
&lt;a href=&quot;https://github.com/mirage/xen-disk/blob/master/src/storage.mli&quot;&gt;src/storage.mli&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;type configuration = {
  filename: string;      (** path where the data will be stored *)
  format: string option; (** format of physical data *)
}
(** Information needed to &amp;quot;open&amp;quot; a disk *)

module type S = sig
  (** A concrete mechanism to access and update a virtual disk. *)

  type t
  (** An open virtual disk *)

  val open_disk: configuration -&amp;gt; t option Lwt.t
  (** Given a configuration, attempt to open a virtual disk *)

  val size: t -&amp;gt; int64
  (** [size t] is the size of the virtual disk in bytes. The actual
      number of bytes stored on media may be different. *)

  val read: t -&amp;gt; Cstruct.t -&amp;gt; int64 -&amp;gt; int -&amp;gt; unit Lwt.t
  (** [read t buf offset_sectors len_sectors] copies [len_sectors]
      sectors beginning at sector [offset_sectors] from [t] into [buf] *)

  val write: t -&amp;gt; Cstruct.t -&amp;gt; int64 -&amp;gt; int -&amp;gt; unit Lwt.t
  (** [write t buf offset_sectors len_sectors] copies [len_sectors]
      sectors from [buf] into [t] beginning at sector [offset_sectors]. *)
end&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let's make a virtual disk implementation which uses an existing disk
image file as a &amp;quot;gold image&amp;quot;, but uses copy-on-write so that no writes
persist.
This is a common configuration in Virtual Desktop Infrastructure deployments
and is generally handy when you want to test a change quickly, and
revert it cleanly afterwards.&lt;/p&gt;
&lt;p&gt;A useful Unix technique for file I/O is to &amp;quot;memory map&amp;quot; an existing file:
this associates the file contents with a range of virtual memory addresses
so that reading and writing within this address range will actually
read or write the file contents.
The &amp;quot;mmap&amp;quot; C function has a number of flags, which can be used to request
&amp;quot;copy on write&amp;quot; behaviour. Reading the
&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/libref/Bigarray.Genarray.html&quot;&gt;OCaml manual Bigarray.map_file&lt;/a&gt;
it says:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;If shared is true, all modifications performed on the array are reflected
in the file. This requires that fd be opened with write permissions. If
shared is false, modifications performed on the array are done in memory
only, using copy-on-write of the modified pages; the underlying file is
not affected.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So we should be able to make a virtual disk implementation which memory
maps the image file and achieves copy-on-write by setting &amp;quot;shared&amp;quot; to false.
For extra safety we can also open the file read-only.&lt;/p&gt;
&lt;p&gt;Luckily there is already an
&lt;a href=&quot;https://github.com/mirage/xen-disk/blob/master/src/backend.ml#L63&quot;&gt;&amp;quot;mmap&amp;quot; implementation&lt;/a&gt;
in &lt;code&gt;xen-disk&lt;/code&gt;; all we need to do is tweak it slightly.
Note that the &lt;code&gt;xen-disk&lt;/code&gt; program uses a co-operative threading library called
&lt;a href=&quot;http://ocsigen.org/lwt/&quot;&gt;lwt&lt;/a&gt;
which replaces functions from the OCaml standard library which might block
with non-blocking variants. In
particular &lt;code&gt;lwt&lt;/code&gt; uses &lt;code&gt;Lwt_bytes.map_file&lt;/code&gt; as a wrapper for the
&lt;code&gt;Bigarray.Array1.map_file&lt;/code&gt; function.
In the &amp;quot;open-disk&amp;quot; function we simply need to set &amp;quot;shared&amp;quot; to &amp;quot;false&amp;quot; to
achieve the behaviour we want i.e.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  let open_disk configuration =
    let fd = Unix.openfile configuration.filename [ Unix.O_RDONLY ] 0o0 in
    let stats = Unix.LargeFile.fstat fd in
    let mmap = Lwt_bytes.map_file ~fd ~shared:false () in
    Unix.close fd;
    return (Some (stats.Unix.LargeFile.st_size, Cstruct.of_bigarray mmap))&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The read and write functions can be left as they are:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  let read (_, mmap) buf offset_sectors len_sectors =
    let offset_sectors = Int64.to_int offset_sectors in
    let len_bytes = len_sectors * sector_size in
    let offset_bytes = offset_sectors * sector_size in
    Cstruct.blit mmap offset_bytes buf 0 len_bytes;
    return ()

  let write (_, mmap) buf offset_sectors len_sectors =
    let offset_sectors = Int64.to_int offset_sectors in
    let offset_bytes = offset_sectors * sector_size in
    let len_bytes = len_sectors * sector_size in
    Cstruct.blit buf 0 mmap offset_bytes len_bytes;
    return () &lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now if we rebuild and run something like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  dd if=/dev/zero of=disk.raw bs=1M seek=1024 count=1
  losetup /dev/loop0 disk.raw
  mkfs.ext3 /dev/loop0
  losetup -d /dev/loop0

  dist/build/xen-disk/xen-disk connect &amp;lt;myvm&amp;gt; --path disk.raw&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Inside the VM we should be able to do some basic speed testing:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  # dd if=/dev/xvdb of=/dev/null bs=1M iflag=direct count=100
  100+0 records in
  100+0 records out
  104857600 bytes (105 MB) copied, 0.125296 s, 837 MB/s&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Plus we should be able to mount the filesystem inside the VM, make changes and
then disconnect (send SIGINT to xen-disk by hitting Control+C on your terminal)
without disturbing the underlying disk contents.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;So what else can we do?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Thanks to Mirage it's now really easy to experiment with custom storage types
for your existing VMs. If you have a cunning scheme where you want to hash block contents,
and use the hashes as keys in some distributed datastructure -- go ahead, it's
all easy to do. If you have ideas for improving the low-level block access protocol
then Mirage makes those experiments very easy too.&lt;/p&gt;
&lt;p&gt;If you come up with a cool example with Mirage, then send us a
&lt;a href=&quot;https://github.com/mirage&quot;&gt;pull request&lt;/a&gt; or send us an email to the
&lt;a href=&quot;http://www.openmirage.org/about/&quot;&gt;Mirage mailing list&lt;/a&gt; -- we'd
love to hear about it!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/xen-block-devices-with-mirage</id><title type="text">Creating Xen block devices with Mirage</title><updated>2013-07-18T11:20:00+00:00</updated><author><email></email><name>Dave Scott</name></author></entry><entry><link href="http://hh360.user.srcf.net/blog/?p=64" rel="alternate"/><contributor><uri>http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/</uri><name>Heidi Howard</name></contributor><content type="html">&lt;p&gt;&amp;ldquo;Perf&amp;rdquo; is a common command line linux tool used for code profiling, (&lt;a href=&quot;https://perf.wiki.kernel.org/index.php/Tutorial&quot;&gt;perf wiki&lt;/a&gt;). A alpha version of a OCaml native code compiler that output code, that can be analysis by perf is now avalaible in OPAM&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Installation&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Installing the perf compatible OCaml compiler is straight forward with OPAM, though quite time-consuming due to the need to re-install many packages&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot; style=&quot;font-family:monospace;&quot;&gt;$ opam remote add perf git:&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;//&lt;/span&gt;github.com&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;mshinwell&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;opam-repo-dev
$ opam switch &lt;span style=&quot;color: #000000;&quot;&gt;4.01&lt;/span&gt;-perf-annotate
$ &lt;span style=&quot;color: #7a0874; font-weight: bold;&quot;&gt;eval&lt;/span&gt; &lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;`&lt;/span&gt;opam config &lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;env&lt;/span&gt;&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;`&lt;/span&gt;
$ opam &lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;install&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Installing perf was also straight forward, in fact I already had it via the linux-tools package in apt-get for Ubuntu.&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;sudo&lt;/span&gt; &lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;apt-get install&lt;/span&gt; linux-tools&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Usage&lt;/strong&gt;&lt;br/&gt;
Compiling with the new perf-compatable Ocaml compiler was beautifully simple, running make within an existing project working first time without any further changes necessary.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Basics&lt;/strong&gt;&lt;br/&gt;
Basic reporting is collected and viewed using:&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;sudo&lt;/span&gt; perf record .&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;myprogram.native &lt;span style=&quot;color: #660033;&quot;&gt;-o&lt;/span&gt; myreport.data
&lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;sudo&lt;/span&gt; perf report &lt;span style=&quot;color: #660033;&quot;&gt;-i&lt;/span&gt; myreport.data
&lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;sudo&lt;/span&gt; perf script &lt;span style=&quot;color: #660033;&quot;&gt;-i&lt;/span&gt; myreport.data&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Similarly basic stats can be collected using:&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;sudo&lt;/span&gt; perf &lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;stat&lt;/span&gt; .&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;/&lt;/span&gt;myprogram.native &lt;span style=&quot;color: #660033;&quot;&gt;-o&lt;/span&gt; myreport.data
&lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;sudo&lt;/span&gt; &lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;cat&lt;/span&gt; myreport.data&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;When finished you can switch back to your normal compiler version, i.e.&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot; style=&quot;font-family:monospace;&quot;&gt;$ opam switch 4.00.1
$ &lt;span style=&quot;color: #7a0874; font-weight: bold;&quot;&gt;eval&lt;/span&gt; &lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;`&lt;/span&gt;opam config &lt;span style=&quot;color: #c20cb9; font-weight: bold;&quot;&gt;env&lt;/span&gt;&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;`&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

</content><id>http://hh360.user.srcf.net/blog/?p=64</id><title type="text">Profiling OCaml – Getting Started Guide</title><updated>2013-07-10T07:10:37+00:00</updated><author><email></email><name>Heidi Howard</name></author></entry><entry><link href="http://anil.recoil.org/2013/06/17/real-world-ocaml-beta-available.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;When I finished writing my PhD, I swore (as most recent graduates do) to never
write a thesis again.  Instead, life would be a series of pleasantly short
papers, interspersed with the occasional journal article, and lots of
not-writing-huge-book-activity in general.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://realworldocaml.org&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/oreilly-cover.gif&quot; style=&quot;padding-left:15px&quot; align=&quot;right&quot;/&gt;&lt;/a&gt;
Then &lt;a href=&quot;http://cufp.org/conference/2011&quot;&gt;CUFP 2011&lt;/a&gt; happened, and I find myself
in a bar in Tokyo with &lt;a href=&quot;https://twitter.com/yminsky&quot;&gt;Yaron Minsky&lt;/a&gt; and &lt;a href=&quot;http://monkey.org/~marius&quot;&gt;Marius Eriksen&lt;/a&gt;, and a dangerous bet ensued.
A few short weeks after that, and Yaron and I are chatting with &lt;a href=&quot;https://plus.google.com/111219778721183890368&quot;&gt;Jason Hickey&lt;/a&gt; in California about
writing a book about the language we love.  I&amp;rsquo;m still telling myself that this will never actually happen,
but then everyone&amp;rsquo;s favourite Californirishman &lt;a href=&quot;http://www.serpentine.com/blog/&quot;&gt;Bryan O&amp;rsquo;Sullivan&lt;/a&gt; puts us in touch with O&amp;rsquo;Reilly,
who published his excellent &lt;a href=&quot;http://realworldhaskell.org&quot;&gt;Haskell&lt;/a&gt; tome.&lt;/p&gt;

&lt;p&gt;O&amp;rsquo;Reilly arranged everything incredibly fast, with our editor &lt;a href=&quot;http://radar.oreilly.com/andyo&quot;&gt;Andy Oram&lt;/a&gt; driving us through the process.  We
decided early on that we wanted to write a book that had opinions based our
personal experience: about how OCaml code should be written, about the standard
library involved, and generally making functional programming more accessible.
Along the way, we&amp;rsquo;ve been working incredibly hard on the underlying software
platform too, with &lt;a href=&quot;http://ocaml.janestreet.com&quot;&gt;Jane Street&lt;/a&gt;, &lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt; and my own
group &lt;a href=&quot;http://ocaml.io&quot;&gt;OCaml Labs&lt;/a&gt; working together on all the pieces.  There&amp;rsquo;s
still a lot of work left to do, of course, but we&amp;rsquo;re right on track to get
all this released very soon now.&lt;/p&gt;

&lt;p&gt;So, without further ado, I was very pleased to send this e-mail this morning.
(and once again reaffirm my committment to never writing another book ever
again.  Until next time!)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Yaron Minsky, Jason Hickey and I are pleased to announce the beta release of
our forthcoming O&amp;rsquo;Reilly book, called &amp;ldquo;Real World OCaml&amp;rdquo;, available online at
&lt;a href=&quot;http://realworldocaml.org&quot;&gt;http://realworldocaml.org&lt;/a&gt;&lt;/p&gt;

  &lt;p&gt;The book is split into three parts: language concepts, tools and techniques,
and understanding the runtime.  As promised last year, we are making a public
beta available for community review and to help us hunt down inaccuracies and
find areas that need more clarification.&lt;/p&gt;

  &lt;p&gt;We&amp;rsquo;ve had the book in closed alpha for six months or so and have developed a
feedback system that uses Github to record your comments. This lets us follow
up to each review with clarifications and keep track of our progress in fixing
issues.  During alpha, we&amp;rsquo;ve received over 1400 comments in this fashion (and
addressed the vast majority of them!).  However, since we anticipate more
comments coming in from a public beta, we would request that you read the FAQ
to avoid drowning us in repeat comments: &lt;a href=&quot;http://www.realworldocaml.org/#faq&quot;&gt;http://www.realworldocaml.org/#faq&lt;/a&gt;.&lt;/p&gt;

  &lt;p&gt;(TL;DR followup another comment on Github directly if you can instead of
creating a new issue via the web interface)&lt;/p&gt;

  &lt;p&gt;This release is available in HTML format online at:
   &lt;a href=&quot;http://realworldocaml.org&quot;&gt;http://www.realworldocaml.org&lt;/a&gt;&lt;/p&gt;

  &lt;p&gt;O&amp;rsquo;Reilly is currently preparing a Rough Cuts release that will make the beta
available as PDF and in popular eBook formats.   We anticipate that this will
be available later this week, and I&amp;rsquo;ll send a followup when that happens.&lt;/p&gt;

  &lt;p&gt;Finally, we would especially like to thank our alpha reviewers.  Their &lt;a href=&quot;https://github.com/ocamllabs/rwo-comments/issues&quot;&gt;feedback&lt;/a&gt; has been invaluable to the
beta release. The book also includes substantial contributions to individual
chapters from Jeremy Yallop (FFI), Stephen Weeks (GC) and Leo White (objects).&lt;/p&gt;

  &lt;p&gt;If you have any comments that you&amp;rsquo;d like to send directly by e-mail, please
contact us at &lt;a href=&quot;mailto:rwo-authors@recoil.org&quot;&gt;rwo-authors@recoil.org&lt;/a&gt;.&lt;/p&gt;

  &lt;p&gt;Release notes for beta1:&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;The first-class modules chapter is incomplete, pending some portability
improvements to the ocaml-plugins Core library.&lt;/li&gt;
    &lt;li&gt;The binary serialization chapter is also incomplete, but has just enough
to teach you about the Async RPC library.&lt;/li&gt;
    &lt;li&gt;The installation chapter will be revised in anticipation of the OCaml 4.1
release, and is currently quite source-based.&lt;/li&gt;
    &lt;li&gt;The packaging and build systems chapter hasn&amp;rsquo;t been started yet.  We&amp;rsquo;re
still deciding whether or not to make this an online pointer rather than
a print chapter, since it&amp;rsquo;s likely to change quite fast.&lt;/li&gt;
    &lt;li&gt;We are preparing exercises per chapter that are not included in this
particular beta release, but will be available online as soon as possible.&lt;/li&gt;
    &lt;li&gt;The code examples will all be clonable as a separate repository in beta2.&lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;best,
Yaron, Jason and Anil&lt;/p&gt;
&lt;/blockquote&gt;
</content><id>http://anil.recoil.org/2013/06/17/real-world-ocaml-beta-available.html</id><title type="text">Phew, Real World OCaml beta now available.</title><updated>2013-06-17T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Jun%202013" rel="alternate"/><contributor><uri>http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml</uri><name>OCL Monthly News</name></contributor><content type="html">
      &lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/rwo-celebration.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/rwo-celebration-thumb.jpg&quot; class=&quot;left&quot;/&gt;&lt;/a&gt;
The rain continues to plummet down relentlessly as &amp;quot;summer&amp;quot; starts in OCaml
Labs. The most exciting news has been the public release of the &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World
OCaml&lt;/a&gt;, which hit the front page of the usual news
aggregators and generated huge interest!  This (reminiscent of the Xen 1.0
release) promptly took down servers for a couple of hours, but we managed to
minimise downtime in time for the Californians waking up.&lt;/p&gt;
&lt;p&gt;O'Reilly has also started selling PDF copies of the book under their &lt;a href=&quot;http://shop.oreilly.com/product/0636920024743.do&quot;&gt;Rough
Cuts&lt;/a&gt; program.  This gives you
a copy of the final book when it's released too.  Commenting is still open
on the &lt;a href=&quot;http://realworldocaml.org&quot;&gt;online version&lt;/a&gt;, so please do feel free to
participate there if you have time.&lt;/p&gt;
&lt;h3&gt;Systems Projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;Mirage&lt;/b&gt;: Anil and Dave did the last of the sweeping build changes to make
Mirage friendlier to use for beginners.  Previously, we required a custom OPAM
switch to build kernels, but now we use &lt;a href=&quot;http://www.openmirage.org/wiki/weekly-2013-06-11&quot;&gt;virtual
packages&lt;/a&gt; to separate the
choice of compiler and packages.  This of course breaks all our documentation,
but we're going to do a big sweep in July before
&lt;a href=&quot;http://www.oscon.com/oscon2013/public/schedule/speaker/109140&quot;&gt;OSCON&lt;/a&gt; with the
new scheme.  Vincent has also been burning through the core platform libraries,
cleaning them up and adding documentation strings.  He is also building a
shared memory &lt;a href=&quot;http://github.com/vbmithr/ocaml-vchan&quot;&gt;vchan&lt;/a&gt; driver that will
make parallel-Mirage unikernels very easy to coordinate on the same host.&lt;/p&gt;
&lt;p&gt;The huge news from our friends at Citrix is the open-sourcing of
&lt;a href=&quot;http://www.xenserver.org&quot;&gt;XenServer&lt;/a&gt;, which is the popular Citrix product that
embeds the &lt;a href=&quot;https://github.com/xapi-project&quot;&gt;OCaml XAPI&lt;/a&gt; cloud management
stack.  There are almost 100 major components
&lt;a href=&quot;http://github.com/xenserver&quot;&gt;released&lt;/a&gt; as part of this, several of which can
be directly reused with Mirage.  Mirage was always an ambitious project, but
it's all coming together now thanks to bold moves such as this from Citrix!&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Signpost:&lt;/b&gt; We woke up to the excellent but slightly scary news that
our &lt;a href=&quot;https://www.usenix.org/conference/foci13&quot;&gt;USENIX FOCI&lt;/a&gt; paper was accepted.
This now means that we get to present it in August at USENIX Security, but
the team is now racing to pull together the prototypes into a complete system
before the conference.  Nothing like a deadline to focus the mind!  We're
also working on the camera-ready version of the paper, which we will share
here when it's ready.&lt;/p&gt;
&lt;h3&gt;Platform Projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;OCamlot:&lt;/b&gt; David Sheets did an astounding job at pulling together a
working continuous build system in a very short amount of time, and promptly
managed to melt some of the older &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html#Machine%20Pool&quot;&gt;non-x86
machines&lt;/a&gt; in Anil's office.  Once Anil
sadly replaced them, the builder churned through a matrix of different compiler
versions (4.0,4.1dev,4.2dev), architectures (x86, x86_64, ARM, PowerPC), and
operating systems (Debian, Ubuntu, FreeBSD, OpenBSD to start with).  There's
a &lt;a href=&quot;https://ocaml-www3.ocamllabs.cl.cam.ac.uk/github/OCamlPro/opam-repository&quot;&gt;development URL&lt;/a&gt;, but
the next step is to retire this and move it to a proper home at &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Having continuous build for OPAM is really, really useful though, as it lets us
vet pull requests on several architectures before merging them. It also let
Anil repair OCaml on &lt;a href=&quot;https://github.com/avsm/ocaml/commit/c1da5f35cda0ee85e576197b88f503333ed9e9a1&quot;&gt;OpenBSD/macppc&lt;/a&gt;
too, which is possibly the most obscure fix he's done in a while.&lt;/p&gt;
&lt;p&gt;The next steps with OCamlot are to take a shot at porting the core to
&lt;a href=&quot;http://github.com/janestreet/jenga&quot;&gt;Jenga&lt;/a&gt;, which is Jane Street's next-generation
distributed build system.  This should let us improve the fault-tolerance and
logging aspects of it before putting it properly into production later in the summer.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Ctypes:&lt;/b&gt; The May &lt;a href=&quot;http://github.com/ocamllabs/ocaml-ctypes&quot;&gt;release&lt;/a&gt;
brought with it a good chunk of feedback, so Jeremy spent time incorporating
that and contributing to the Real World OCaml ctypes chapter.  He also added
support for garbage-collecting closures passed to C, and also very cool support
for &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes/pull/27&quot;&gt;printing C types and values&lt;/a&gt;.
Our friends at Citrix have started looking at ctypes, and Rob Hoes has already
used it to write &lt;a href=&quot;https://github.com/robhoes/ocaml-libnl&quot;&gt;bindings&lt;/a&gt; to the
Netlink Protocol Library Suite.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/daniel-presentation-vg.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/daniel-presentation-vg-thumb.jpg&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
&lt;b&gt;OPAM-doc&lt;/b&gt;: Vincent Botbol got the documentation generator stable enough
to pass the Core library through.  This is particularly challenging since Core
exercises pretty much every trick in the book when it comes to the use of the
module system.  However, Vincent successfully demonstrated the workflow of
OPAM-doc at the end-of-month meeting, and is aiming to have a public release
via OPAM in July (hopefully in time for the next beta release of Real World OCaml,
which uses Core heavily).&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Visualisation libraries:&lt;/b&gt; &lt;a href=&quot;http://erratique.ch/contact.en&quot;&gt;Daniel B&amp;uuml;nzli&lt;/a&gt; has
been spending a few months based in Citrix, working on a foundational new
declarative drawing library written in pure OCaml.  The &lt;a href=&quot;http://erratique.ch/software/vg&quot;&gt;Vg&lt;/a&gt; is already quite functional despite
still being in beta, and features a &lt;a href=&quot;http://erratique.ch/software/vg/demos/rhtmlc.html#arrowhead&quot;&gt;Javascript backend&lt;/a&gt;
that renders to both SVG and Canvas in HTML5.  That's not all though!  He's
also developing the &lt;a href=&quot;http://erratique.ch/software/vz&quot;&gt;Vz&lt;/a&gt; visualization library
that uses Vg to assemble more complex scenes and graphs.  Daniel's going to
join us in OCaml Labs for the remainder of the summer, so we're looking
forward to developing this more and using it on our various Platform projects
such as OCamlot.&lt;/p&gt;
&lt;h3&gt;Outreach&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;Real World OCaml:&lt;/b&gt; As mentioned earlier, the beta release of RWO went
splendidly, with a pleasing vibe that the book is what people expected.  There
were some interesting criticisms of the choice of Github authentication, but
we've had over 6000 registered commentators despite this (and of course, we
have plans &lt;a href=&quot;http://nymote.org&quot;&gt;brewing&lt;/a&gt; to tackle the identity problem).&lt;/p&gt;
&lt;p&gt;No beta release is perfect, of course, and our now-public commenting system has
resulted in &lt;a href=&quot;https://github.com/ocamllabs/rwo-comments/issues&quot;&gt;over 1500&lt;/a&gt;
issues being raised.  Well, that's all of Yaron, Anil and Jason's free time
gone for some time!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/amir-shisha.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/amir-shisha-thumb.jpg&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
&lt;b&gt;OCaml.org&lt;/b&gt;: We're in the process of looking at the site as a whole and
designing the workflow we'd like to have for growing and maintaining it.  Some
discussions have taken place about using Markdown in place of the current HTML
snippets, which would make it easier for external contributors to get involved.
In the meantime, Amir has converted the current site to Markdown format to see
how this process would work in practice.  You can see his experimenting and
scripts in the &lt;a href=&quot;https://github.com/ocamllabs/ocaml.org-temp&quot;&gt;temporary repo&lt;/a&gt; in
the &lt;code&gt;markdown-site/&lt;/code&gt; folder.
Philippe also showed off &lt;a href=&quot;https://github.com/pw374/MPP-language-blender&quot;&gt;MPP&lt;/a&gt;
at the internal meetings, and is stabilising it for a public release this
summer (once it has been integrated into the ocaml.org workflow).&lt;/p&gt;
&lt;p&gt;This month also had a number of programming language gurus show up at the Lab
for the &lt;em&gt;Algebraic Effects and Handlers&lt;/em&gt; workshop organised by &lt;a href=&quot;http://www.cl.cam.ac.uk/~ss368/&quot;&gt;Sam
Staton&lt;/a&gt;.  Most of the group attended this, as
we're all interested in how to encode effects for several of our projects (most
notably &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/t2.html#Irminsule&quot;&gt;Irminsule&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;We also enjoyed a visit by &lt;a href=&quot;https://github.com/bvaugon&quot;&gt;Beno&amp;icirc;t Vaugon&lt;/a&gt;, who gave a talk on his
&lt;a href=&quot;http://oud.ocaml.org/2012/slides/oud2012-paper10-slides.pdf&quot;&gt;OCamlCC&lt;/a&gt;
OCaml-to-C compiler, and also participated in a talk on
&lt;a href=&quot;http://www.algo-prog.info/ocaml_for_pic/web/index.php?id=ocapic&quot;&gt;OCAPIC&lt;/a&gt;. He
also chatted with us about his alternative &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6017&quot;&gt;GADT-based implementation of
Printf&lt;/a&gt;, which promises to both
speed up and simplify the printer support in OCaml (and also relieve Mirage of
another dependency on &lt;code&gt;libc&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;i&gt;Link roundup:&lt;/i&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://blog.xen.org/index.php/2013/06/25/xenserver-org-and-the-xen-project/&quot; class=&quot;icon-community&quot;&gt;XenServer open-sourced!&lt;/a&gt; &lt;em&gt;(Jun 25th)&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://realworldocaml.org&quot; class=&quot;icon-quick-links&quot;&gt;Real World OCaml public beta now available.&lt;/a&gt; &lt;em&gt;(Jun 17th)&lt;/em&gt;&lt;/li&gt;&lt;/ul&gt;

   </content><id>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Jun%202013</id><title type="text">Jun 2013 news update</title><updated>2013-06-01T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://openmirage.org/blog/the-road-to-a-dev-release" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;There's been a crazy stream of activity since the start of the year, but the most important news is that we have a release target for an integrated developer preview of the Mirage stack: a talk at &lt;a href=&quot;http://www.oscon.com/oscon2013/public/schedule/detail/28956&quot;&gt;O'Reilly OSCon&lt;/a&gt; in July!  Do turn up there and find &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; and &lt;a href=&quot;http://anil.recoil.org&quot;&gt;Anil Madhavapeddy&lt;/a&gt; showing off interactive demonstrations.&lt;/p&gt;
&lt;p&gt;Meanwhile, another significant announcement has been that Xen is &lt;a href=&quot;http://www.linuxfoundation.org/news-media/announcements/2013/04/xen-become-linux-foundation-collaborative-project&quot;&gt;joining the Linux Foundation&lt;/a&gt; as a collaborative project.  This is great news for Mirage: as a library operating system, we can operate just as easily under other hypervisors, and even on bare-metal devices such as the &lt;a href=&quot;http://raspberrypi.org&quot;&gt;Raspberry Pi&lt;/a&gt;.  We're very much looking forward to getting the Xen-based developer release done, and interacting with the wider Linux community (and FreeBSD, for that matter, thanks to Gabor Pali's &lt;a href=&quot;https://github.com/pgj/mirage-kfreebsd&quot;&gt;kFreeBSD&lt;/a&gt; backend).&lt;/p&gt;
&lt;p&gt;Here's some other significant news from the past few months:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.ocamlpro.com/blog/2013/03/14/opam-1.0.0.html&quot;&gt;OPAM 1.0 was released&lt;/a&gt;, giving Mirage a solid package manager for handling the many libraries required to glue an application together.  &lt;a href=&quot;https://github.com/vbmithr&quot;&gt;Vincent Bernardoff&lt;/a&gt; joined the team at Citrix and has been building a Mirage build-frontend called &lt;a href=&quot;https://github.com/mirage/mirari&quot;&gt;Mirari&lt;/a&gt; to hide much of the system complexity from a user who isn't too familiar with either Xen or OCaml.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;A new group called the &lt;a href=&quot;http://ocaml.io&quot;&gt;OCaml Labs&lt;/a&gt; has started up in the &lt;a href=&quot;http://www.cl.cam.ac.uk&quot;&gt;Cambridge Computer Laboratory&lt;/a&gt;, and is working on improving the OCaml toolchain and platform.  This gives Mirage a big boost, as we can re-use several of the documentation, build and test improvements in our own releases.  You can read up on the group's activities via the &lt;a href=&quot;http://ocaml.io/news&quot;&gt;monthly updates&lt;/a&gt;, or browse through the various &lt;a href=&quot;http://ocaml.io/tasks&quot;&gt;projects&lt;/a&gt;.  One of the more important projects is the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html#OCamlot&quot;&gt;OCamlot&lt;/a&gt; continuous build infrastructure, which will also be testing Mirage kernels as one of the supported backends.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;As we head into release mode, we've started &lt;a href=&quot;http://openmirage.org/wiki/tag/overview/meetings&quot;&gt;weekly meetings&lt;/a&gt; to coordinate all the activities.  We're keeping notes as we go along, so you should be able to skim the notes and &lt;a href=&quot;https://lists.cam.ac.uk/pipermail/cl-mirage/&quot;&gt;mailing list archives&lt;/a&gt; to get a feel for the overall activities.  Anil is maintaining a &lt;a href=&quot;http://openmirage.org/wiki/dev-preview-checklist&quot;&gt;release checklist&lt;/a&gt; for the summer developer preview.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;Anil (along with Yaron Minsky and Jason Hickey) is finishing up an O'Reilly book on &lt;a href=&quot;http://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt;, which will be a useful guide to using OCaml for systems and network programming. If you'd like to review an early copy, please get in touch.  The final book is anticipated to be released towards the end of the year, with a &lt;a href=&quot;http://shop.oreilly.com/category/roughcuts.do&quot;&gt;Rough Cut&lt;/a&gt; at the end of the summer.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;The core system was described in an &lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;ASPLOS 2013&lt;/a&gt; paper, which should help you understand the background behind library operating systems. Some of the Mirage libraries are also currently being integrated into the next-generation &lt;a href=&quot;http://blogs.citrix.com/2012/05/17/introducing-windsor-a-new-xen-based-virtualization-architecture/&quot;&gt;Windsor&lt;/a&gt; release of the Xen Cloud Platform, which means that several of the libraries will be used in production and hence move beyond research-quality code.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;In the next few months, the installation notes and getting started guides will
all be revamped to match the reality of the new tooling, so expect some flux
there.   If you want to take an early try of Mirage beforehand, don't forget to
hop on the &lt;code&gt;#mirage&lt;/code&gt; IRC channel on Freenode and ping us with questions
directly.  We will also be migrating some of the project infrastructure to be fully
self-hosted on Mirage and Xen, and placing some of the services onto the new &lt;a href=&quot;http://xenproject.org&quot;&gt;xenproject.org&lt;/a&gt; infrastructure.&lt;/p&gt;

   </content><id>http://openmirage.org/blog/the-road-to-a-dev-release</id><title type="text">The road to a developer preview at OSCON 2013</title><updated>2013-05-20T16:20:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#May%202013" rel="alternate"/><contributor><uri>http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml</uri><name>OCL Monthly News</name></contributor><content type="html">
      &lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/thomas-nycoug-2013.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/thomas-nycoug-2013-thumb.jpg&quot; class=&quot;left&quot;/&gt;&lt;/a&gt;
May is exam time in Cambridge, and the corridors of the OCaml Labs resounded
with the wailing of frantic students finishing their dissertations and
preparing for exams.  We welcomed &lt;a href=&quot;https://github.com/vincent-botbol&quot;&gt;Vincent Botbol&lt;/a&gt; to join us for a summer internship,
and he started hacking on the new &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html#OPAM%20Doc&quot;&gt;opam-doc&lt;/a&gt;
right away.&lt;/p&gt;
&lt;p&gt;Anil, Thomas, Leo and Amir also visited &lt;a href=&quot;http://janestreet.com&quot;&gt;Jane
Street&lt;/a&gt; HQ in New York City, where we had a productive
couple of days reviewing our projects and getting feedback from them about
approaches to multicore and type system enhancements. &lt;a href=&quot;http://ashishagarwal.org&quot;&gt;Ashish
Agarwal&lt;/a&gt; also organised a fun evening with the &lt;a href=&quot;http://www.meetup.com/NYC-OCaml/events/117222022/&quot;&gt;New
York OCaml Users Group&lt;/a&gt;,
where Anil and Thomas presented our plans for the nascent OCaml Platform.&lt;/p&gt;
&lt;h3&gt;Systems Projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;Mirage:&lt;/b&gt; This was a month of consolidation and bugfixing in Mirage.  We've
been settling into weekly meetings to coordinate the hacking between us and
Citrix, and the minutes (&lt;a href=&quot;http://www.openmirage.org/wiki/weekly-2013-05-14&quot;&gt;1&lt;/a&gt;
&lt;a href=&quot;http://www.openmirage.org/wiki/weekly-2013-05-21&quot;&gt;2&lt;/a&gt;
&lt;a href=&quot;http://www.openmirage.org/wiki/weekly-2013-05-28&quot;&gt;3&lt;/a&gt;) may be useful if you
want to catch up.  The biggest bugbear is always the build system, and we've
been exploring the use of &lt;a href=&quot;http://github.com/janestreet/jenga&quot;&gt;Jenga&lt;/a&gt; as the
eventual async-aware coordination and build system for running Mirage kernels.
Dave made great progress with a
&lt;a href=&quot;http://github.com/djs55/message-switch&quot;&gt;message-switch&lt;/a&gt; that coordinates
multiple kernels, and Balraj fixed several performance regressions in the
TCP/IP stack by building unit tests that spawn millions of parallel TCP
connections.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Signpost:&lt;/b&gt; We took a break from building prototypes to submit a paper on the
basic design to the USENIX Free and Open Communications (&lt;a href=&quot;https://www.usenix.org/conference/foci13&quot;&gt;FOCI
2013&lt;/a&gt;) workshop.  Haris and Heidi
blazed a path on writing this paper, and we've got even more ideas rolling
around about how to use DNSSEC to break the cloud deadlock.  The
&lt;a href=&quot;http://github.com/mirage/ocaml-dns&quot;&gt;ocaml-dns&lt;/a&gt; continues to grow features too.&lt;/p&gt;
&lt;h3&gt;Platform Projects&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/nycoug-drinkup-2013.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/nycoug-drinkup-2013-thumb.jpg&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
&lt;b&gt;Ctypes:&lt;/b&gt; Jeremy
&lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2013-06/msg00046.html&quot;&gt;announced&lt;/a&gt;
the first release of a new foreign-function mechanism for OCaml that doesn't
require you to write any C stubs at all!  You can browse the &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes&quot;&gt;source
code&lt;/a&gt; and
&lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes/wiki/ctypes-tutorial&quot;&gt;tutorial&lt;/a&gt;, and
install it via OPAM.  This is very much the first 0.1 release, and we have
exciting future developments to turn this into a full-fledged replacement for
the fast-but-rather-difficult-to-use-right OCaml FFI.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;OPAM-doc:&lt;/b&gt; Vincent Botbol started building on Leo's work on the new
&lt;a href=&quot;http://github.com/vincent-botbol/opam-doc&quot;&gt;opam-doc&lt;/a&gt; tool. This is intended to
replace the venerable &lt;code&gt;ocamldoc&lt;/code&gt; with one that uses all the latest features of
the compiler.  In particular, it can use the new typed AST &lt;code&gt;cmt&lt;/code&gt; output to
avoid duplicating the compiler functionality, and can also build up a global
package table to generate complete cross-references across an entire OPAM 
collection.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;OCamlot:&lt;/b&gt; David has been building up the libraries and tools needed for
the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html#OCamlot%200.2.0&quot;&gt;continuous build&lt;/a&gt; infrastructure.
This includes much-improved
&lt;a href=&quot;http://github.com/avsm/ocaml-github&quot;&gt;ocaml-github&lt;/a&gt;, bindings, which are now
being used to power the &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; site as
well as well as OCamlot.  In addition, he's got an interesting collection of
regular expressions to automatically triage common failures from OPAM
(such as missing external dependencies), that should help reduce the manual
burden of getting thousands of tests results dumped on the small OPAM team.&lt;/p&gt;
&lt;h3&gt;Compiler Projects&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/janestreet-hq-2013.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/janestreet-hq-2013-thumb.jpg&quot; class=&quot;left&quot;/&gt;&lt;/a&gt;
&lt;b&gt;OCaml-Java&lt;/b&gt;: Xavier Clerc has been hacking away at his next-generation
OCaml-Java backend (using many new features in JDK7). He's released a
&lt;a href=&quot;http://ocamljava.x9c.fr/preview/concurrency.html&quot;&gt;preview&lt;/a&gt; of the bindings to
Java concurrency, and is looking for feedback on it.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Performance profiling&lt;/b&gt;: Mark Shinwell has been hacking on improving the
integration of the runtime with &lt;code&gt;perf&lt;/code&gt;.  This should give us the hooks to
reliably track where memory was allocated.  His branch isn't going to land in
OCaml 4.1, but should be available as an OPAM switch for people to easily
try out when it's more stable.&lt;/p&gt;
&lt;h3&gt;Outreach&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;OCaml.org:&lt;/b&gt; Philippe and Amir have been putting their heads together with
Christophe and Ashish to turn the &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt; build pipeline
into something a little more structured.  Philippe is building a &lt;a href=&quot;https://github.com/pw374/MPP-language-blender&quot;&gt;template
processor&lt;/a&gt; for this purpose.
The OCaml site is a more complicated than the average site due to our desire to
embed &lt;a href=&quot;http://ocsigen.org/js_of_ocaml&quot;&gt;js_of_ocaml&lt;/a&gt; interactive toplevels
throughout the tutorials, and also to have active OPAM integration throughout
the site to make it easier for newcomers to sample the language.&lt;/p&gt;
&lt;p&gt;The design of a handful of pages are also now available to preview, if you
don't mind some manual git cloning. The best way to do this is to clone the
&lt;a href=&quot;https://github.com/ocamllabs/ocaml.org-temp&quot;&gt;temporary repo&lt;/a&gt; onto your local
machine and look in the &lt;code&gt;new-design/_site&lt;/code&gt; directory.  There are examples of
the home page, 100 lines of OCaml page and several others.  Since we're just
getting started with applying these changes the site isn't clicky (yet).  For
some extra fun, try resizing your browser window and see how the pages reflow
to suit smaller (mobile) screens!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/nyc-trip-balcony-view-2013.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/nyc-trip-balcony-view-2013-thumb.jpg&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
&lt;b&gt;Real World OCaml:&lt;/b&gt; Anil, Yaron and Jason continue to work hard on getting
a release out of the door.  We shipped a final alpha6 this month that is 
chapter-complete, and have been preparing for a big public June release of
the book.  Thousands of comments have been received and closed already,
making this an unusually active (but incredibly useful) ongoing review
process.  Leo and Jeremy also contributed portions of text for the Objects
and FFI chapters in alpha6, and join Stephen Weeks as external contributors
to the book.&lt;/p&gt;
&lt;p&gt;Meanwhile, Leo himself has recovered from the elation of being granted his PhD,
to the harsh reality of having to finish corrections.  He has been forced by
his colleagues to stop hacking on OCaml and submit his final thesis.  Rumours
are that he will reemerge in June after delivering his &lt;a href=&quot;http://staticanalysis.org/SAS13/papers.html&quot;&gt;SAS
2013&lt;/a&gt; talk on using an
implication-algebra generalisation of logic programming to concisely analyse
OpenMP programs for parallisation opportunities.&lt;/p&gt;
&lt;p&gt;This month's talk was courtesy of &lt;a href=&quot;http://www.lip6.fr/actualite/personnes-fiche.php?ident=D1161&amp;amp;LANG=en&quot;&gt;Mathias Bourgoin&lt;/a&gt;,
who visited from France and gave a talk on his PhD work on GPU processing.  His
tool, &lt;a href=&quot;http://www.algo-prog.info/spoc/web/index.php?id=spoc&quot;&gt;SPOC&lt;/a&gt; has been
released onto OPAM and is a set of easy-to-use tools for generating CUDA and
OpenCL code, and also a camlp4 extension to write external kernels directly in
OCaml.  Thanks for visiting, Mathias!&lt;/p&gt;

   </content><id>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#May%202013</id><title type="text">May 2013 news update</title><updated>2013-05-01T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Apr%202013" rel="alternate"/><contributor><uri>http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml</uri><name>OCL Monthly News</name></contributor><content type="html">
      &lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/leo-oculus.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/leo-oculus-thumb.jpg&quot; thumb=&quot;&quot; width=&quot;150px&quot; class=&quot;left&quot;/&gt;&lt;/a&gt;
It's been a heads-down month of hacking at the Labs for April, as the
group have settled into their projects and are concentrating on getting code
out.  We did take the opportunity to redesign the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/index.html&quot;&gt;project pages&lt;/a&gt; as the active projects grew.&lt;/p&gt;
&lt;p&gt;We welcomed &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/euan.html&quot;&gt;Euan Harris&lt;/a&gt; as a new visitor, and he has
begun work on a distributed actor library in the vein of Erlang's
&lt;a href=&quot;https://github.com/erlang/otp&quot;&gt;OTP&lt;/a&gt;.  The prolific &lt;a href=&quot;http://erratique.ch&quot;&gt;Daniel B&amp;uuml;nzli&lt;/a&gt; also joined us for the summer to work on his &lt;a href=&quot;http://erratique.ch/software/vg/&quot;&gt;Vg&lt;/a&gt; visualisation library.  He's based out of the Citrix offices, and is also contributing to the Xen project.&lt;/p&gt;
&lt;h3&gt;Platform projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;OPAM: &lt;/b&gt; The project has entered a bug fixing stage after its release, and
the package set has steadily grown via external contributors. David Sheets has
been hacking away on the automated &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html#OCamlot&quot;&gt;OCamlot&lt;/a&gt;
bot, and we released improved &lt;a href=&quot;https://github.com/avsm/ocaml-github&quot;&gt;Github&lt;/a&gt;
API bindings.  We're aiming to get OCamlot live and running in May, so stay
tuned!  There is a &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html#Machine%20Pool&quot;&gt;steadily growing
collection&lt;/a&gt; of odd ARM and PowerPC
devices in Anil's desk that will generally make it easier to test your OCaml
code in unusual environments.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;OCaml.org redesign:&lt;/b&gt; Progress on the website continues and we're now
working on the actual HTML/CSS from the earlier
&lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Site-Redesign&quot;&gt;mockups&lt;/a&gt;.  We'll be
publishing these in a fork of the website
&lt;a href=&quot;https://github.com/ocamllabs/ocaml.org&quot;&gt;repository&lt;/a&gt;, so do feel free to create
issues there with your comments.  Philippe has begun the
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/outreach.html#Meta%20preprocessor&quot;&gt;MPP&lt;/a&gt; templating tool to glue together
all the website scripts more coherently. Discussions about this take place on
the &lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure&lt;/a&gt; mailing
list, which is open to all.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/makespace-apr-2013.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/makespace-apr-2013-thumb.jpg&quot; thumb=&quot;&quot; width=&quot;150px&quot; class=&quot;left&quot;/&gt;&lt;/a&gt;
The monthly OCaml get togethers in the &lt;a href=&quot;http://makespace.org&quot;&gt;Cambridge
Makespace&lt;/a&gt; are also really fun.  This month saw around 30
people wander through the doors, and work through the latest excerpts of
&lt;a href=&quot;http://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt;. And around midnight, Jeremy and
Leo competed to find more and more obscure
&lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5992&quot;&gt;bugs&lt;/a&gt; in the corners of the
OCaml type system...  You can track the subsequent meetups via the &lt;a href=&quot;http://www.meetup.com/Cambridge-NonDysFunctional-Programmers/events/114286762/&quot;&gt;NonDysFunctional Meetup group&lt;/a&gt;, which includes functional programmers from around the Cambridgeshire area.  Jon and Anil also attended the &lt;a href=&quot;http://developer.yahoo.com/events/hack_europe_london/&quot;&gt;Yahoo Hackday&lt;/a&gt; in London, where Jon met a giant robot and started &lt;a href=&quot;https://github.com/jonludlam/mssl&quot;&gt;SSL bindings&lt;/a&gt;, and Anil experimented with &lt;a href=&quot;http://github.com/avsm/ocaml-js-localstorage&quot;&gt;js_of_ocaml LocalStorage&lt;/a&gt; for Irminsule.&lt;/p&gt;
&lt;h3&gt;Systems projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;Mirage&lt;/b&gt;: We've finally got a release date for the first preview of
Mirage, which will be at &lt;a href=&quot;http://www.oscon.com/oscon2013/public/schedule/detail/28956&quot;&gt;O'Reilly OSCON&lt;/a&gt; this July!  Pulling together the release is a big endeavour, and the
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/mirage.html&quot;&gt;team&lt;/a&gt; has started weekly calls to work through the
project.  The minutes for these are online, so you can
&lt;a href=&quot;http://www.openmirage.org/wiki/tag/overview/meetings&quot;&gt;browse&lt;/a&gt; them to catch
up. There's also a slightly scary
&lt;a href=&quot;http://www.openmirage.org/wiki/dev-preview-checklist&quot;&gt;checklist&lt;/a&gt; of all the
libraries that need to be released before July, so the team has its work cut
out for it!  The Xen group also announced that it is joining the Linux Foundation,
and the &lt;a href=&quot;http://www.linuxfoundation.org/news-media/announcements/2013/04/xen-become-linux-foundation-collaborative-project&quot;&gt;press release&lt;/a&gt; gave Mirage a prominent mention as one of the key recent developments in Xen.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/jon-robot-yahoo.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/jon-robot-yahoo-thumb.jpg&quot; thumb=&quot;&quot; width=&quot;120px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
&lt;b&gt;Irminsule&lt;/b&gt;: Thomas now has a full implementation of the git file format
in his &lt;a href=&quot;http://github.com/samoht/cagit&quot;&gt;cagit&lt;/a&gt; repository, and the interfaces
for Irminsule's branch-consistent model are coming together.  He gave a demo to
the Mirage team, with &lt;a href=&quot;http://www.openmirage.org/wiki/weekly-2013-04-23&quot;&gt;discussion
notes&lt;/a&gt; available.&lt;/p&gt;
&lt;h3&gt;Compiler projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;Multicore and Concurrency&lt;/b&gt;: Stephen Dolan's made great progress on bringing up a multicore
runtime using &lt;a href=&quot;https://github.com/stedolan/ocaml&quot;&gt;thread-local storage&lt;/a&gt;, which results
in a surprisingly compact diff to the OCaml runtime.  We're now moving onto the
higher-level bindings to use the parallel runtimes effectively from within OCaml.
We also began a &lt;a href=&quot;http://lists.ocaml.org/listinfo/wg-parallel&quot;&gt;wg-parallel&lt;/a&gt; working
group in order to start figuring out the evolution of the &lt;a href=&quot;http://ocsigen.org/lwt&quot;&gt;Lwt&lt;/a&gt; and 
&lt;a href=&quot;https://github.com/janestreet/async&quot;&gt;Async&lt;/a&gt; concurrency libraries.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;libffi&lt;/b&gt;: Jeremy got frustrated by the difficulty of writing safe C bindings,
and started the &lt;a href=&quot;http://github.com/ocamllabs/ocaml-ctypes&quot;&gt;ctypes&lt;/a&gt; library, which
offers a pure OCaml solution. This even includes managing callbacks across the
OCaml/C divide, and uses &lt;a href=&quot;https://github.com/atgreen/libffi&quot;&gt;libffi&lt;/a&gt; under the hood
to remain efficient and platform-independent.  There is the exciting possibility
about hooking this library with the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/compiler.html#Compile-time%20meta%20programming&quot;&gt;compile-time metaprogramming&lt;/a&gt; to eliminate all performance cost, so we're going to spend some time
on this project to make it a well-documented alternative to the existing C FFI.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/mezzo-talk.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/mezzo-talk.jpg&quot; thumb=&quot;&quot; width=&quot;120px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
The OCaml Labs talk series continued with a visit from &lt;a href=&quot;http://gallium.inria.fr/~fpottier/&quot;&gt;Francois
Pottier&lt;/a&gt; ad &lt;a href=&quot;http://www.xulforum.org&quot;&gt;Jonathan
Protzenko&lt;/a&gt; from the INRIA
&lt;a href=&quot;http://gallium.inria.fr&quot;&gt;Gallium&lt;/a&gt; research team.  Jonathan presented their
&lt;a href=&quot;http://gallium.inria.fr/~protzenk/mezzo-lang&quot;&gt;Mezzo&lt;/a&gt; language, which places
emphasis on aliasing and controlled access to mutation.  This is of particular
interest to several of our systems projects that do not require the full power of
OCaml to build low-level systems components, and Raphael, Alan, Leo and Anil
had productive discussions about how we could try Mezzo out when it's released.&lt;/p&gt;
&lt;p&gt;&lt;i&gt;Link roundup:&lt;/i&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://www.linuxfoundation.org/news-media/announcements/2013/04/xen-become-linux-foundation-collaborative-project&quot; class=&quot;icon-rss&quot;&gt;Xen and MirageOS to join Linux Foundation&lt;/a&gt; &lt;em&gt;(Apr 14th)&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://www.meetup.com/Cambridge-NonDysFunctional-Programmers/events/114286762/&quot; class=&quot;icon-community&quot;&gt;OCaml Hacking/Meetup Session&lt;/a&gt; &lt;em&gt;(Apr 18th)&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://www.oscon.com/oscon2013/public/schedule/detail/28956&quot; class=&quot;icon-quick-links&quot;&gt;OSCon Mirage talk selected.&lt;/a&gt; &lt;em&gt;(Apr 21st)&lt;/em&gt;&lt;/li&gt;&lt;/ul&gt;

   </content><id>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Apr%202013</id><title type="text">Apr 2013 news update</title><updated>2013-04-01T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://amirchaudhry.com/wireframe-demos-for-ocamlorg" rel="alternate"/><contributor><uri>http://amirchaudhry.com/tags/ocamllabs-atom.xml</uri><name>Amir Chaudhry</name></contributor><content type="html">
&lt;h3&gt;Making mockups&lt;/h3&gt;

&lt;p&gt;Over the last few months, I&amp;rsquo;ve been working on various aspects of the &lt;a href=&quot;http://ocaml.org&quot;&gt;OCaml.org&lt;/a&gt; design project.  This covers things like the design, information architecture and how to incorporate new functionality.  One of the methods for thinking through these was to put together a bunch of wireframes using &lt;a href=&quot;http://www.balsamiq.com&quot;&gt;Balsamiq&lt;/a&gt; and use these to express (and generate) ideas as well as get feedback quickly.&lt;/p&gt;

&lt;p&gt;If you haven&amp;rsquo;t used wireframes before, think of them as a slightly more advanced form of sketching things out on a whiteboard.  The best aspect is that it&amp;rsquo;s far quicker, easier and &lt;em&gt;cheaper&lt;/em&gt; to iterate using wireframes than on an actual website.  As you&amp;rsquo;ll see below, you can also convey a lot of information about how a site might work by showing people a clickable demo.&lt;/p&gt;

&lt;p&gt;I want to make this work public and I thought the best way would be to show you some screencasts of how the upcoming &lt;a href=&quot;http://ocaml.org&quot;&gt;OCaml.org&lt;/a&gt; website might work and also make the demo available to all of you.  The three videos below cover three aspects of the site and I&amp;rsquo;d encourage you to go through them in order (about 16 minutes in total).  Apologies if my screen isn&amp;rsquo;t particularly clear in the videos but you can visit the demo for yourself and see things in more detail (link and info on feedback at the end of this post).&lt;/p&gt;

&lt;h3&gt;Video walkthroughs&lt;/h3&gt;

&lt;p&gt;For those who&amp;rsquo;d like to watch the videos back-to-back and scaled to fit your browser window, you can &lt;a href=&quot;http://vimeo.com/couchmode/album/2301640&quot;&gt;view the Vimeo album in &amp;lsquo;couchmode&amp;rsquo;&lt;/a&gt;. Otherwise, individual videos are embedded below (total time 16m17s).&lt;/p&gt;

&lt;div class=&quot;flex-video widescreen vimeo&quot;&gt;
    &lt;iframe src=&quot;http://player.vimeo.com/video/61768157?byline=0&amp;amp;portrait=0&amp;amp;color=de9e6a&quot; width=&quot;540&quot; height=&quot;303&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot; allowfullscreen=&quot;true&quot;&gt;Video Part 1 - Overview - http://player.vimeo.com/video/61768157&lt;/iframe&gt;
&lt;/div&gt;

&lt;div class=&quot;flex-video widescreen vimeo&quot;&gt;
    &lt;iframe src=&quot;http://player.vimeo.com/video/61768235?byline=0&amp;amp;portrait=0&amp;amp;color=de9e6a&quot; width=&quot;540&quot; height=&quot;304&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot; allowfullscreen=&quot;true&quot;&gt;Video Part 2 - Documentation - http://player.vimeo.com/video/61768235&lt;/iframe&gt;
&lt;/div&gt;

&lt;div class=&quot;flex-video widescreen vimeo&quot;&gt;
    &lt;iframe src=&quot;http://player.vimeo.com/video/61768273?byline=0&amp;amp;portrait=0&amp;amp;color=de9e6a&quot; width=&quot;540&quot; height=&quot;304&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot; allowfullscreen=&quot;true&quot;&gt;Video Part 3 - Continuous Integration - http://player.vimeo.com/video/61768273&lt;/iframe&gt;
&lt;/div&gt;

&lt;h3&gt;Public wireframe demo&lt;/h3&gt;

&lt;p&gt;A demo you can interact with can be found at &lt;a href=&quot;https://ocaml.mybalsamiq.com/projects/public-demo/naked/0_home?key=b897ea86d8a8199c6e46b3295ddf630dfa33e5e1&quot;&gt;OCaml.org wireframe demo&lt;/a&gt; and image files for each page are available on the &lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Wireframes&quot;&gt;github ocaml.org wiki&lt;/a&gt;.  Please bear in mind the following:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Not everything that looks like it might be clickable actually is (and vice versa). There&amp;rsquo;ll be a toggle on the bottom right of the browser window that will highlight what can be clicked.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;There are parts of the site which are &amp;lsquo;work in progress&amp;rsquo; and are marked as such.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The designs you see aren&amp;rsquo;t necessarily final. Your feedback will help shape our decisions and the best way to provide it is via the &lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure mailing list&lt;/a&gt;.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

</content><id>http://amirchaudhry.com/wireframe-demos-for-ocamlorg</id><title type="text">Wireframe demos for OCaml.org</title><updated>2013-03-14T00:00:00+00:00</updated><author><email></email><name>Amir Chaudhry</name></author></entry><entry><link href="http://lpw25.net/2013/03/10/ocaml-namespaces.html" rel="alternate"/><contributor><uri>http://www.lpw25.net/atom.xml</uri><name>Leo White</name></contributor><content type="html">&lt;div class=&quot;well well-small&quot;&gt;
  &lt;h4&gt;
Contents
&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#problems-with-pack&quot;&gt;Problems with pack&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#formal-semantics&quot;&gt;Formal semantics&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#design-goals&quot;&gt;Design goals&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#design-choices&quot;&gt;Design choices&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#flat-or-hierarchical&quot;&gt;Flat or hierarchical?&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#should-namespaces-be-opened-explicitly-in-source-code&quot;&gt;Should namespaces be opened explicitly in source code?&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#how-should-the-compiler-find-modules-in-the-presence-of-namespaces&quot;&gt;How should the compiler find modules in the presence of namespaces?&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#how-should-namespaces-specified&quot;&gt;How should namespaces specified?&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#how-rich-should-a-description-language-be&quot;&gt;How rich should a description language be?&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#should-namespaces-support-automatically-opened-members&quot;&gt;Should namespaces support automatically opened members?&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#proposal&quot;&gt;Proposal&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#simple-namespaces-through-filenames&quot;&gt;Simple namespaces through filenames&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#an-alternative-to-search-paths&quot;&gt;An alternative to search paths&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#the--name-argument&quot;&gt;The &amp;ldquo;-name&amp;rdquo; argument&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/atom.xml#the--open-argument&quot;&gt;The &amp;ldquo;-open&amp;rdquo; argument&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;

&lt;p&gt;Recently there has been a lot of discussion on
&lt;a href=&quot;http://lists.ocaml.org/listinfo/platform&quot;&gt;platform@lists.ocaml.org&lt;/a&gt; about
proposals for adding namespaces to OCaml. I&amp;rsquo;ve written this post to summarise
the design decisions for such a proposal and to make my own proposal.&lt;/p&gt;

&lt;p&gt;Before discussing what namespaces are and the issues surrounding their
implementation, it is important to explain why they are needed in the first
place. &lt;/p&gt;

&lt;p&gt;The most important reason for adding namespaces is to provide some means for
grouping the components of a library together. Up to now this has been
achieved using the OCaml module system. Since the components of an OCaml
library are modules, a module can be created that contains all the components
of the library as sub-modules. The &amp;ldquo;-pack&amp;rdquo; option for the compiler was created
to allow this module to be created while still keeping each component of the
library in its own file.&lt;/p&gt;

&lt;h3&gt;Problems with pack&lt;/h3&gt;

&lt;p&gt;There are some critical problems with using &amp;ldquo;-pack&amp;rdquo; to create a single module
containing the whole library:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The packed module is a single unit that has to be linked or not as a
unit. This means that any program using part of the library must include the
entire library.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The packed module is a choke-point in the dependency graph.  If a file
depends on one thing in the packed module then it needs to be recompiled if
anything in the packed module changes.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Opening a large packed module is very slow and can seriously affect build
performance.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These problems are all caused by the fact that pack creates an OCaml
module. To understand this consider the run-time semantics of the module
system.&lt;/p&gt;

&lt;p&gt;At run-time a module is a record. Initialising a module involves initialising
every component of the module and placing them in this record.  Initialising
these components can involve executing arbitrary code; in fact the execution
of an OCaml program is simply the initialisation of all its modules.&lt;/p&gt;

&lt;p&gt;The problems with pack are related to these dynamic semantics. In order to
be a module pack must create a record to represent this module. This means
that it must initialise all of its components. It is this (rather than any
detail of pack&amp;rsquo;s implementation) that causes the problems identified above.&lt;/p&gt;

&lt;p&gt;Access to the components of a top-level module could proceed without the
existence of this record. However, the record is required in order to &amp;ldquo;alias&amp;rdquo;
the module, use the module as a first-class value or use it as the argument to
a functor.&lt;/p&gt;

&lt;p&gt;Any attempt to overcome the problems with pack, whilst still maintaining
the illusion that the &amp;ldquo;pack&amp;rdquo; is a normal module, would result (at the very
least) in one of the following unhealthy situations:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The module type of the &amp;ldquo;packed module&amp;rdquo; would depend on which of its
components were accessed by the program.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Any use of the &amp;ldquo;packed module&amp;rdquo; other than as a simple container
(e.g.
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;CS&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
&lt;span class=&quot;nn&quot;&gt;Core&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Std&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; 
) could have a dramatic effect on what was
linked into the program and potentially on the semantics of the program.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Namespaces are basically modules that can only be used as a simple
container. This means that they do not need a corresponding record at
run-time (or any other run-time representation). This avoids the problems
with pack as well as enabling other useful features.&lt;/p&gt;

&lt;h3&gt;Formal semantics&lt;/h3&gt;

&lt;p&gt;Following the semantics and description language for namespaces described by
&lt;a href=&quot;http://gallium.inria.fr/~scherer/namespaces/spec.pdf&quot;&gt;Gabriel Scherer et al&lt;/a&gt;,
I will consider namespaces to be name-labelled trees whose leaves are
compilation units. I will use 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; 
to represent projection on namespaces, so the 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
member of the 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
namespace will be referred to as 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;.&lt;/p&gt;

&lt;h3&gt;Design goals&lt;/h3&gt;

&lt;p&gt;Some design goals that we might want from a proposal for adding namespaces to
OCaml include:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Allow library components to be grouped together without creating a module
containing them.&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Allow users to group together modules from different libraries as they see
fit.&lt;/strong&gt; This means letting people change which namespace a library module is
in.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Allow library components to be given multiple names.&lt;/strong&gt; For example
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Lib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
and 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Lib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Stable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
, where 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Lib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Stable&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
is a namespace containing only those components whose interfaces are stable.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Be simple and easy to explain to beginners.&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Allow multiple source files to share the same filename.&lt;/strong&gt; Each module that
is linked into an OCaml program must have a unique name. Currently, a
module&amp;rsquo;s name is completely determined by its filename. This forces library
developers to either use pack (which gives its components new long names) or
give their source files long names like &amp;ldquo;libName_Foo.ml&amp;rdquo;. A namespaces
proposal may be able to alleviate this problem.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Allow libraries to control which modules are open by default.&lt;/strong&gt; By default
OCaml opens the standard library&amp;rsquo;s 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Pervasives&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
module. Libraries that wish to replace the standard library may also wish to
provide their own
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Pervasives&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
module and have it opened by default.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Support libraries that wish to remain compatible with versions of OCaml
without namespaces.&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Require minimal changes to existing build systems.&lt;/strong&gt; Since a namespace
proposal changes how a library&amp;rsquo;s components are named, it may require
changes to some build systems. If these changes are too invasive then users
of some build systems will probably be unable to use namespaces in the near
future.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Design choices&lt;/h3&gt;

&lt;h4&gt;Flat or hierarchical?&lt;/h4&gt;

&lt;p&gt;In order to replace pack, namespaces must be able to contain modules. It is
not clear, however, whether they need to be able to contain other
namespaces. We call namespaces that can contain other namespaces
&lt;em&gt;hierarchical&lt;/em&gt;, as opposed to &lt;em&gt;flat&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;In favour of flat namespaces:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Hierarchical namespaces might lead to arbitrary categorising of components
(e.g.&lt;br/&gt;
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Array&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
). These add syntactic clutter and do not bring any real benefit.  &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Hierarchical namespaces might lead to deep java-style hierarchies
(e.g.&lt;br/&gt;
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Janestreet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Core&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Std&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
). These add syntactic clutter without adding any actual information.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In favour of hierarchical namespaces:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;
A library may wish to provide multiple versions of some of its components. For
example:

&lt;ul&gt;
&lt;li&gt;    
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Http&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Async&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IO&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
 and 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Http&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Lwt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IO&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Windows&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Directories&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
and 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Unix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Directories&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Core&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Mutex&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
and 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Core&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Testing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Mutex&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;/ul&gt;

In such situations it is useful to be able to write both


&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;open&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Core&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[...]&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Testing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Mutex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


and


&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;open&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Core&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Testing&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[...]&lt;/span&gt;
&lt;span class=&quot;nn&quot;&gt;Mutex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
None of the systems of namespaces that have been proposed have any
additional cost for supporting hierarchical namespaces.
&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;Should namespaces be opened explicitly in source code?&lt;/h4&gt;

&lt;p&gt;There was some debate on the platform mailing list about whether to support
opening namespaces explicitly in source code. This means allowing a syntax
like:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;
&lt;pre&gt;&lt;code class=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;open&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;that allows the members of namespace 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
to be referenced directly (i.e.
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
can be referred to as 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;The alternative would be to only support opening namespaces through a
command-line argument.&lt;/p&gt;

&lt;p&gt;In favour of supporting explicit opens:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;If you open two namespaces with commonly named sub-components then the order
of those opens matters. If the opens are command-line arguments then the
order of those command-line arguments (often determined by build systems and
other tools) matters. This is potentially very fragile.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Explicit opens in a source file give valuable information about which
libraries are being used by that source file. If a file contains &amp;ldquo;open
namespace Core&amp;rdquo; then you know it uses the Core library.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Local namespace opens provide users more precise control over their naming
environment.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Against supporting explicit opens:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;They require a new syntactic construct.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;How should the compiler find modules in the presence of namespaces?&lt;/h4&gt;

&lt;p&gt;Currently, when looking for a module 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
that is not in the current environment, the OCaml compiler will search the
directories in its search path for a file called &amp;ldquo;bar.cmi&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;In the presence of namespaces this becomes more complicated: how does the
compiler find the module 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
?&lt;/p&gt;

&lt;p&gt;The suggested possible methods for finding modules in the presence of
namespaces fall into four categories.&lt;/p&gt;

&lt;h5&gt;Using filenames&lt;/h5&gt;

&lt;p&gt;By storing the interface for 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
in a file named &amp;ldquo;foo-bar.cmi&amp;rdquo; the compiler can continue to simply look-up
modules in its search path.&lt;/p&gt;

&lt;p&gt;Note that &amp;ldquo;-&amp;ldquo; is an illegal character in module names so there is no risk of
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
being confused with a module called 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo-bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;This simple scheme does not support placing a module within multiple
namespaces or allowing users to put existing modules in a new namespace.&lt;/p&gt;

&lt;h5&gt;Checking multiple &amp;ldquo;.cmi&amp;rdquo; files&lt;/h5&gt;

&lt;p&gt;The name of the namespace containing a compilation unit could be included in
the &amp;ldquo;.cmi&amp;rdquo; file of that unit. Then, when looking for a module 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
, the compiler would try every &amp;ldquo;bar.cmi&amp;rdquo; file in its search path until it
found one that was part of the &amp;ldquo;Foo&amp;rdquo; namespace. This may require the compiler
to open all the &amp;ldquo;bar.cmi&amp;rdquo; files on its search path, which could be expensive
on certain operating systems.&lt;/p&gt;

&lt;p&gt;This scheme does not support allowing users to put existing modules in a new
namespace, but can support placing a module in multiple namespaces.&lt;/p&gt;

&lt;p&gt;It is difficult to detect typos in namespace open statements using this
scheme. For example, detecting that
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Core&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Sdt&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; 
should have been
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Core&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Std&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
would require the compiler to check every file in its search path for one that
was part of namespace
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Core&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Sdt&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;.&lt;/p&gt;

&lt;h5&gt;Using namespace description files&lt;/h5&gt;

&lt;p&gt;The compiler could find a member of a namespace by consulting a file that
describes the members of that namespace.&lt;/p&gt;

&lt;p&gt;For example, if namespace 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
was described by a file &amp;ldquo;foo.ns&amp;rdquo; that was on the compiler&amp;rsquo;s search path then
the compiler could find
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
by locating &amp;ldquo;foo.ns&amp;rdquo; and using it to look-up the location of the &amp;ldquo;.cmi&amp;rdquo; file
for
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;These namespace description files could be created automatically by some
tool. However, they must be produced before detecting dependencies with
OCamlDep, which could complicate the build process.&lt;/p&gt;

&lt;h5&gt;Using environment description files&lt;/h5&gt;

&lt;p&gt;The compiler could find a member of a namespace by consulting a file that
describes a mapping between module names and &amp;ldquo;.cmi&amp;rdquo; files.&lt;/p&gt;

&lt;p&gt;For example, if a file &amp;ldquo;foo.mlpath&amp;rdquo; included the mapping &amp;ldquo;Foo#Bar:
foo/bar.cmi&amp;rdquo; then that file could be passed as a command-line argument to the
compiler and used to look up the &amp;ldquo;bar.cmi&amp;rdquo; file directly.&lt;/p&gt;

&lt;p&gt;Looking up modules using this scheme may speed up compilation by avoiding the
need to scan directories for files.&lt;/p&gt;

&lt;h4&gt;How should namespaces specified?&lt;/h4&gt;

&lt;p&gt;Perhaps the most important question for any namespaces proposal is how
namespaces are specified. It is closely related to the above question of how
the compiler finds modules in the presence of namespaces.&lt;/p&gt;

&lt;p&gt;The suggested possible methods for specifying namespaces fall into five
categories.&lt;/p&gt;

&lt;h5&gt;Explicitly in the source files&lt;/h5&gt;

&lt;p&gt;Namespaces could be specified by adding a line like:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;
&lt;pre&gt;&lt;code class=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;to the beginning of each compilation unit that is part of the 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; 
namespace. &lt;/p&gt;

&lt;p&gt;This has the benefit of making namespaces explicitly part of the language
itself, however it does mean that the full name of a module is specified in
two locations: partly in the filename and partly within the file itself.&lt;/p&gt;

&lt;h5&gt;Through command-line arguments&lt;/h5&gt;

&lt;p&gt;Namespaces could be specified by passing a command-line argument to the
compiler. For example, 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; 
could be compiled with the command-line:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;ocamlc -c -namespace Foo bar.ml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This scheme also means that the full name of a module is specified in two
locations: partly in the build system and partly in the filename.&lt;/p&gt;

&lt;h5&gt;Through filenames&lt;/h5&gt;

&lt;p&gt;Namespaces could be specified using the filenames of source files. For
example, 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; 
would be created by compiling a file &amp;ldquo;foo-bar.ml&amp;rdquo;&lt;/p&gt;

&lt;p&gt;This scheme is simple and very similar to how modules are currently named, but
it would require all source files to have long unique names.&lt;/p&gt;

&lt;h5&gt;Through namespace description files&lt;/h5&gt;

&lt;p&gt;Namespaces could be specified using namespace description files. The 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
namespace would be specified by a file &amp;ldquo;foo.ns&amp;rdquo; that described the members of
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;module Bar = &amp;quot;foo_bar.cmi&amp;quot;
namespace Testing = &amp;quot;testing.ns&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h5&gt;Through environment description files&lt;/h5&gt;

&lt;p&gt;Namespaces could be specified using environment description files. A namespace
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
would be defined by passing an environment description file to the compiler
that included mappings for each of the members of
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;. For example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Foo#Bar: &amp;quot;foo_bar.cmi&amp;quot;
Foo#Testing#Bar: &amp;quot;foo_testing_bar.cmi&amp;quot;
Baz: &amp;quot;baz.cmi&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In addition to specifying namespaces, this system allows users (or a tool like
OCamlFind) to have complete control the naming environment of a program.&lt;/p&gt;

&lt;h4&gt;How rich should a description language be?&lt;/h4&gt;

&lt;p&gt;For namespace proposals that use namespace or environment description files,
they must decide how rich their description language should be.&lt;/p&gt;

&lt;p&gt;For example, &lt;a href=&quot;http://gallium.inria.fr/~scherer/namespaces/spec.pdf&quot;&gt;Gabriel Scherer et
al&lt;/a&gt; describe a very rich
environment description language including many different operations that can
be performed on namespaces.&lt;/p&gt;

&lt;p&gt;A rich description language can produce shorter descriptions. However, the
more operations a language supports the more syntax that users must understand
in order to read description files. The majority of description files are
unlikely to require complex operations.&lt;/p&gt;

&lt;h4&gt;Should namespaces support automatically opened members?&lt;/h4&gt;

&lt;p&gt;A feature of namespaces that has been proposed on the mailing list is to allow
some modules within a namespace to be automatically opened when the namespace
is also opened. This makes it seem that the namespace has values and types as
members.&lt;/p&gt;

&lt;p&gt;This feature is based on the current design of Jane Street&amp;rsquo;s Core
library. Users of the Core library are expected to open the
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Core&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;Std&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
 module before using the library. Opening this module provides access to all
the other modules of the library (much like opening a namespace), but it also
provides types and values similar to those provided by the standard library&amp;rsquo;s
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Pervasives&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; module.&lt;/p&gt;

&lt;p&gt;Supporting auto-opened modules would allow 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Core&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;Std&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
to be directly replaced by a namespace. However, the semantics of this feature
could be awkward due to potential conflicts between members of the namespace
and sub-modules of the auto-opened modules. It also increases the overlap
between namespaces and modules.&lt;/p&gt;

&lt;h3&gt;Proposal&lt;/h3&gt;

&lt;p&gt;In the last section of this post I will outline a namespaces proposal that I
think satisfies the design goals set out earlier.&lt;/p&gt;

&lt;p&gt;I think that satisfying these design goals requires a combination of
extensions to OCaml. My proposal is made up of four such extensions. To keep
things simple for users to understand, I have tried to keep each of these
extensions completely independent of the others and with a clearly defined
goal.&lt;/p&gt;

&lt;h4&gt;Simple namespaces through filenames&lt;/h4&gt;

&lt;p&gt;Currently, the name of a module is completely defined by its filename, and
modules are looked up using a simple search path. While it has some problems,
this simple paradigm has served OCaml well and I think that it is important to
provide some support for namespaces within this paradigm.&lt;/p&gt;

&lt;p&gt;This means allowing simple namespaces to be specified using source file
names. For example, to create a module 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
within the namespace 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
developers can simply create an implementation file &amp;ldquo;foo-bar.ml&amp;rdquo; and an
interface file &amp;ldquo;foo-bar.mli&amp;rdquo;. This interface file would be compiled to a
&amp;ldquo;foo-bar.cmi&amp;rdquo; file. Hierarchical namespaces would be created by files with
names like &amp;ldquo;foo-bar-baz.ml&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;These namespaced modules can be referred to using the syntax 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;. 
This syntax simply causes the compiler to look in its search path for a
&amp;ldquo;foo-bar.cmi&amp;rdquo; file.&lt;/p&gt;

&lt;p&gt;I also propose supporting a namespace opening syntax like:
&amp;lt;div class=&amp;quot;highlight&amp;quot;&amp;gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;open&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;
[...]
&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;lt;/div&amp;gt;&lt;/p&gt;

&lt;h4&gt;An alternative to search paths&lt;/h4&gt;

&lt;p&gt;Forcing the name of a module to be completely defined by its (compiled)
filename makes it easy to look-up modules in a search path. However, it
prevents modules from being given multiple names or being renamed by users. So
I propose supporting an alternative look-up mechanism.&lt;/p&gt;

&lt;p&gt;I propose supporting environment description files called &lt;em&gt;search path
files&lt;/em&gt;. These files would have a syntax like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Foo#Bar : &amp;quot;other_bar.cmi&amp;quot;
Foo#Baz : Foo#Bar
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This file can be given to the &amp;ldquo;-I&amp;rdquo; command-line argument instead of a
directory and used to look-up the locations of &amp;ldquo;.cmi&amp;rdquo; files for given module
names.&lt;/p&gt;

&lt;p&gt;These search path files can be used to alias modules and to create new
namespaces. They also allow a module to be available under multiple namespaces.&lt;/p&gt;

&lt;p&gt;I envisage two particular modes of use:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Library authors can write &amp;ldquo;.mlpath&amp;rdquo; files and tell OCamlFind to use that
file as its search path instead of a list of directories.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;A user (or potentially OCamlFind) can create search path files to define
their entire naming environment as they see fit.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;The &amp;ldquo;-name&amp;rdquo; argument&lt;/h4&gt;

&lt;p&gt;While the hard link between a module&amp;rsquo;s name and the name of its source file
makes life easier for build systems (&amp;ldquo;list.cmi&amp;rdquo; can only be produced by
compiling &amp;ldquo;list.ml&amp;rdquo;), it forces library authors to give their source files long
unique names.&lt;/p&gt;

&lt;p&gt;I propose adding a &amp;ldquo;-name&amp;rdquo; command-line argument to the OCaml compiler. This
would be used as follows:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;ocamlc -c -name Foo#Bar other.ml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This command would produce a &amp;ldquo;foo-bar.cmi&amp;rdquo; file defining a module named
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
. This means that &amp;ldquo;.cmi&amp;rdquo; files would still be expected to be unique, but
source files could be named however the developer wants.&lt;/p&gt;

&lt;p&gt;Obviously, any tools that assume that a module 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
must be compiled from a file called &amp;ldquo;bar.ml&amp;rdquo; will not work in this
situation. However, the only OCaml tool that absolutely relies on this
assumption is &amp;ldquo;OCamlDep&amp;rdquo; when it is producing makefile formatted output.&lt;/p&gt;

&lt;p&gt;Build systems would not be required to support the &amp;ldquo;-name&amp;rdquo; argument, however
it would make it easy for them to provide features such as:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Creating namespaces to reflect a directory structure (e.g. &amp;ldquo;foo/bar.mli&amp;rdquo; becomes &amp;ldquo;foo-bar.cmi&amp;rdquo;).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Placing all the modules of a library under a common namespace (e.g. &amp;ldquo;bar.mli&amp;rdquo; becomes &amp;ldquo;foo-bar.cmi&amp;rdquo;)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This would mean that the names of source files could be kept conveniently
short.&lt;/p&gt;

&lt;h4&gt;The &amp;ldquo;-open&amp;rdquo; argument&lt;/h4&gt;

&lt;p&gt;My proposals do not include support for automatically opened modules within
namespaces. I feel that this feature conflates two separate issues and it
would be better to solve the problem of automatically opened modules elsewhere. &lt;/p&gt;

&lt;p&gt;Auto-opened modules are meant to allow libraries to provide their own
equivalent of the standard library&amp;rsquo;s 
&lt;span class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Pervasives&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;
module. I think that it would be more appropriate to have these &amp;ldquo;pervasive&amp;rdquo;
modules opened by default in any program compiled using one of these
libraries.&lt;/p&gt;

&lt;p&gt;I propose adding a command-line argument &amp;ldquo;-open&amp;rdquo; that could be used to open a
module by default:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;ocamlc -c -open core-pervasives.cmi foo.ml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;By adding support for this feature to OCamlFind, libraries could add this
argument to every program compiled using them. This amounts to having
automatically opened modules as part of the package system rather than part of
the namespace system.&lt;/p&gt;
</content><id>http://lpw25.net/2013/03/10/ocaml-namespaces.html</id><title type="text">Adding namespaces to OCaml</title><updated>2013-03-10T00:00:00+00:00</updated><author><email></email><name>Leo White</name></author></entry><entry><link href="http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Mar%202013" rel="alternate"/><contributor><uri>http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml</uri><name>OCL Monthly News</name></contributor><content type="html">
      &lt;p&gt;The OCaml Labs hackers continue to arrive, with &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/sheets.html&quot;&gt;David
Sheets&lt;/a&gt; arriving from sunny San Francisco, and &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/xclerc.html&quot;&gt;Xavier Clerc&lt;/a&gt; visiting from the less-sunny
&lt;a href=&quot;http://www.inria.fr&quot;&gt;INRIA&lt;/a&gt; in France.  David's done great work on several
OCaml libraries such as &lt;a href=&quot;http://github.com/avsm/ocaml-cohttp&quot;&gt;Cohttp&lt;/a&gt; and on
&lt;a href=&quot;http://www.youtube.com/watch?v=ll9z1ULtgqo&amp;amp;feature=plcp&quot;&gt;WebGL&lt;/a&gt;, and he's diving
straight into a first release of &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html&quot;&gt;OCamlot&lt;/a&gt; before
starting his PhD later in the year. Xavier will
work on releasing his &lt;a href=&quot;http://ocamljava.x9c.fr/preview/&quot;&gt;OCaml Java
2.0&lt;/a&gt; rewrite this summer, which takes
advantage of all the latest JDK features for non-Java languages.&lt;/p&gt;
&lt;p&gt;A new research grant has also been awarded to &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/crowcroft.html&quot;&gt;Jon Crowcroft&lt;/a&gt;.
The &lt;a href=&quot;http://hubofallthings.wordpress.com&quot;&gt;Hub of All Things&lt;/a&gt; is a &amp;pound;1.2m multi-disciplinary
project funded by the &lt;a href=&quot;http://www.rcuk.ac.uk/research/xrcprogrammes/Digital/Pages/home.aspx&quot;&gt;RCUK Digital Economy Programme&lt;/a&gt; and led by 
&lt;a href=&quot;http://www2.warwick.ac.uk/fac/sci/wmg/people/profile/?wmgid=849&quot;&gt;Irene Ng&lt;/a&gt; 
in Warwick.  HAT aims to create a home platform, under the user's control, 
where a market to exchange their personal data for new products and 
personalised services could exist.  The Cambridge piece of this work will use
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/mirage.html&quot;&gt;Mirage&lt;/a&gt; for embedded systems programming, and
&lt;a href=&quot;http://signpost.io&quot;&gt;Signpost&lt;/a&gt;, to enable devices to connect and communicate
with each-other across the edge network.&lt;/p&gt;
&lt;h3&gt;Platform projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;OPAM: &lt;/b&gt; &lt;a href=&quot;http://opam.ocamlpro.com&quot;&gt;OPAM&lt;/a&gt;, the popular OCaml Package Manager, recently had its &lt;a href=&quot;http://www.ocamlpro.com/blog/2013/03/14/opam-1.0.0.html&quot;&gt;1.0
release&lt;/a&gt;!  OPAM has
been in development for just over a year, and this is a significant milestone
for the project.  The OPAM &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/issues&quot;&gt;package repository&lt;/a&gt; has had over 500 issues, closed over 400 pull requests and now contains over 450 packages
(and more than twice that number if you consider that multiple versions are
available).  This kind of user adoption is a fantastic sign for the OCaml
community.  We're very happy to be using OPAM as a key piece of the upcoming
OCaml Platform and the continuous integration and test system.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Site-Redesign&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/ocaml_home_v2-2-thumb.jpg&quot; width=&quot;220px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
&lt;b&gt;OCaml.org redesign:&lt;/b&gt; Amir extended the Balsamiq mockups into more
realistic static site designs that can be &lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Site-Redesign&quot;&gt;found on the
wiki&lt;/a&gt;.  We're building
on the theme we began with the &lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Draft-OCaml-Logos&quot;&gt;OCaml Logo&lt;/a&gt;, but also
including the full functionality we want for the revamped site.  The samples
should give people an idea of the colour schemes and images we'll be using, and
feedback is &lt;em&gt;very&lt;/em&gt; welcome.  Next, we're creating the HTML/CSS templates we
need to make these mockups a reality.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;OCamlot&lt;/b&gt;: Within hours of getting off the plane, David was already 
getting well into the OCaml-based test tool and working on the pieces we 
need to get to a usable first version.  The OCamlot workflow was last 
described in Amir's
&lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;Balsamiq mockups&lt;/a&gt;
in case you want to catch up.  This work is made all the more important as 
Jane Street continues to demonstrate their strong commitment to open-source 
by sending in OPAM pull requests 
&lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/644&quot;&gt;every week&lt;/a&gt; 
for new releases of their &lt;a href=&quot;http://janestreet.github.io&quot;&gt;libraries&lt;/a&gt;.  The 
testing for these releases is currently handled manually and we're really 
looking forward to having them dealt with automatically!&lt;/p&gt;
&lt;h3&gt;Systems projects&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/asplos-mort.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/asplos-mort-thumb.jpg&quot; thumb=&quot;ASPLOS served green drinks. Hmm&quot; width=&quot;120px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
&lt;b&gt;Mirage&lt;/b&gt;: There is much preparation ongoing for the big 
&lt;a href=&quot;http://wiki.xen.org/wiki/Mirage_Incubation_Project_Proposal&quot;&gt;xen.org incubation&lt;/a&gt;, 
which has now been approved by the Xen community board. Vincent's work on 
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/mirage.html&quot;&gt;Mirari&lt;/a&gt; is going very well, and he's updated the 
&lt;a href=&quot;http://www.openmirage.org/wiki/install&quot;&gt;Mirage installation&lt;/a&gt; instructions 
to use Mirari instead of the manual process required before. 
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/avsm.html&quot;&gt;Anil&lt;/a&gt; and &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/mort.html&quot;&gt;Mort&lt;/a&gt; also attended 
and presented the 
&lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;ASPLOS 2013&lt;/a&gt; paper in 
Houston.  For the curious, 
&lt;a href=&quot;http://www.yelp.co.uk/biz/bens-beans-houston&quot;&gt;Ben's Beans&lt;/a&gt; is the only good 
coffee we could find suitable for a European in Texas.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Irminsule&lt;/b&gt;: Now that the core of Mirage is heading for release, the 
team is turning their attention to the storage and distributed programming 
challenge. &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/tg.html&quot;&gt;Thomas&lt;/a&gt; and Anil have been working on a new 
policy-free, branch-consistent storage layer that exposed a raw git-like 
universe to Mirage applications. We're working on as part of the 
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/t2.html&quot;&gt;Trilogy2&lt;/a&gt; that's investigating how to improve the 
reliability of congested datacenters.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/heidi-signposts.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/heidi-signposts-thumb.jpg&quot; width=&quot;130px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
&lt;b&gt;Signposts&lt;/b&gt;: &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/heidi.html&quot;&gt;Heidi&lt;/a&gt; gave an &lt;em&gt;excellent&lt;/em&gt; talk 
about Signpost and the benefits it can offer internet users today
&lt;i&gt;(see right)&lt;/i&gt;. This was one of a set of talks that took place in the 
Computer Lab, organised by &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/mycroft.html&quot;&gt;Alan Mycroft&lt;/a&gt;, on open 
software and open hardware with speakers such as
&lt;a href=&quot;http://en.wikipedia.org/wiki/Jon_Hall_(programmer)&quot;&gt;Jon 'maddog' Hall&lt;/a&gt; of
Linux International. There was fairly unanimous agreement that Heidi's 
slides were better than Anil's.&lt;/p&gt;
&lt;h3&gt;Compiler projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;Multicore&lt;/b&gt;: Once the dreaded ICFP deadline was out of the way, 
Stephen, Leo, Raphael and Anil put their heads together to start 
architecting the support for parallel multicore support in the OCaml runtime.
A key part of the design space is to maintain the sequential performance and 
simplicity of the existing runtime, but still make it easy to extend shared 
memory onto different cores.  We'll have more details on this shortly when 
early prototypes are done and some benchmarks run.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Namespaces:&lt;/b&gt; Leo's also been extremely busy in the 
&lt;a href=&quot;http://lists.ocaml.org/listinfo/platform&quot;&gt;platform mailing list&lt;/a&gt;, which has 
been the location for the discussion of namespaces.  A few hundred emails 
have been exchanged on this topic and Leo has summarised the discussion and 
made proposals in his blog post about 
&lt;a href=&quot;http://www.lpw25.net/2013/03/10/ocaml-namespaces.html&quot;&gt;OCaml namespaces&lt;/a&gt;.  Although this is a complex issue, aspects of namespaces will be important to 
the work on the OCaml Platform so we look forward to the outcome of these 
discussions.&lt;/p&gt;
&lt;p&gt;&lt;i&gt;Link roundup:&lt;/i&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://lists.ocaml.org/pipermail/platform/2013-March/000291.html&quot; class=&quot;icon-email&quot;&gt;OPAM 1.0 Released!&lt;/a&gt; &lt;em&gt;(Mar 14th)&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot; class=&quot;icon-rss&quot;&gt;Wireframe demos for OCaml.org&lt;/a&gt; &lt;em&gt;(Mar 14th)&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/2013/03/10/ocaml-namespaces.html&quot; class=&quot;icon-rss&quot;&gt;Adding namespaces to OCaml&lt;/a&gt; &lt;em&gt;(Mar 10th)&lt;/em&gt;&lt;/li&gt;&lt;/ul&gt;

   </content><id>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Mar%202013</id><title type="text">Mar 2013 news update</title><updated>2013-03-01T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://lpw25.net/2013/02/05/camlp4-alternative-part-2.html" rel="alternate"/><contributor><uri>http://www.lpw25.net/atom.xml</uri><name>Leo White</name></contributor><content type="html">&lt;p&gt;In my &lt;a href=&quot;http://www.lpw25.net/2013/01/23/camlp4-alternative-part-1.html&quot;&gt;previous blog post&lt;/a&gt; I
discussed how we might use AST transformers, attributes and quotations as a
simpler alternative to camlp4. While AST transformers are much simpler to use
than camlp4 they still require knowledge of the OCaml syntax tree, and they are
still implemented outside of the language as preprocessors.&lt;/p&gt;

&lt;p&gt;In this post I&amp;rsquo;ll explore how to implement extensions:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;within the language itself without external preprocessors&lt;/li&gt;
  &lt;li&gt;without the need for detailed knowledge of the OCaml syntax tree&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;By including these extensions in the language itself the increasing number of
tools being built to support OCaml (e.g. typerex) can handle them directly. For
instance, IDEs could show the expansions of quotations by using the information
in &amp;ldquo;.cmt&amp;rdquo; files.&lt;/p&gt;

&lt;p&gt;I will start with quotations, which can be implemented without any knowledge of
the OCaml syntax tree, and then expand my proposal to include other kinds of
extension.&lt;/p&gt;

&lt;p&gt;Since my previous post, there has been a lot of discussion on
&lt;a href=&quot;http://lists.ocaml.org/listinfo/wg-camlp4&quot;&gt;wg-camlp4@lists.ocaml.org&lt;/a&gt; about
possible syntaxes for quotations and attributes and other kinds of extension. In
keeping with those ongoing discussions, I will use &lt;code&gt;{:id { string }}&lt;/code&gt; as the
syntax for quotations (which transform a string into an AST node) and &lt;code&gt;(:id
expr)&lt;/code&gt; as the syntax for extensions that transform an OCaml expression into an
AST node.&lt;/p&gt;

&lt;p&gt;Note that the proposals in this post are more long-term than the &amp;ldquo;ppx&amp;rdquo; solution
discussed in the previous post. Moving an extension from ppx to the mechanism
described in this post would require only minimal work. So in the short/medium
term extension authors should implement their extensions using ppx.&lt;/p&gt;

&lt;h4&gt;Quotations&lt;/h4&gt;

&lt;p&gt;A quotation is simply a function which takes a string and returns an AST
node. To provide built-in support we need to, for every quotation &lt;code&gt;{:foo { bar
}}&lt;/code&gt;:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;find a function that corresponds to &lt;code&gt;foo&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;apply it to the string &amp;ldquo; bar &amp;ldquo; &lt;/li&gt;
  &lt;li&gt;copy the resulting AST node in place of the original quotation&lt;/li&gt;
&lt;/ol&gt;

&lt;h5&gt;Quotations in modules&lt;/h5&gt;

&lt;p&gt;We might want to find the function corresponding to quotation &lt;code&gt;foo&lt;/code&gt; by simply
looking in the current module, or one of the other modules in our environment,
for a function called &lt;code&gt;foo&lt;/code&gt;. However there are a few problems with this simple
scheme:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;The function we call must exist and be compiled before we can use it.&lt;/li&gt;
  &lt;li&gt;There is no clear separation between what is being executed at compile-time
and what is being executed and run-time.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The first problem basically means that we can only use functions defined in
other files. The other problem is more subtle.&lt;/p&gt;

&lt;p&gt;OCaml modules do not really exist at compile time. They are created at run-time,
and their creation encompasses the entire execution of the program. For example,
consider this simple module:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;c&quot;&gt;(* main.ml *)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Hello, world!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To create the &lt;code&gt;Main&lt;/code&gt; module, we must create its member &lt;code&gt;x&lt;/code&gt;. Once the creation of
&lt;code&gt;Main&lt;/code&gt; is finished the &lt;code&gt;printf&lt;/code&gt; has been executed and the whole program has
completed. Now if we add a quotation function &lt;code&gt;foo&lt;/code&gt; to this module:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;c&quot;&gt;(* main.ml *)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Hello, world!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keywords&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Hashtbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;(* Some expression using keywords *)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;How do we distinguish between data such as &lt;code&gt;keywords&lt;/code&gt; which are needed at
compile-time when the quotation is run, and data like &lt;code&gt;x&lt;/code&gt; whose creation is
meant to drive the program at run-time? There is nothing explicit in the
definitions of &lt;code&gt;foo&lt;/code&gt; or &lt;code&gt;keywords&lt;/code&gt; that indicates that they are intended for
compile-time execution.&lt;/p&gt;

&lt;p&gt;These problems are related to the fact that OCaml is an impure language. Any
expression (including module definitions) can have side-effects, and the
run-time behaviour of the program is simply the combination of all these
side-effects. This makes it difficult to separate the side-effects that are
related to a quotation from the side-effects that are part of the program&amp;rsquo;s
execution.&lt;/p&gt;

&lt;p&gt;Despite appearing alongside other functions in the program, &lt;code&gt;foo&lt;/code&gt; must be
executed in a completely separate environment. Any side-effects (e.g. mutable
state, I/O) that are produced while creating and executing &lt;code&gt;foo&lt;/code&gt; will be
completely separate from the side-effects of the other functions in its module.&lt;/p&gt;

&lt;h5&gt;Where can we put them?&lt;/h5&gt;

&lt;p&gt;If we don&amp;rsquo;t want to put quotation functions in our modules, where should we put
them? The module system provides the only mechanism for referring to functions in
other files, how can we refer to functions which are not included in a module?&lt;/p&gt;

&lt;p&gt;The answer to these questions comes from the idea of &lt;em&gt;namespaces&lt;/em&gt;. Namespaces
are a way to give longer names to top-level modules without changing the
module&amp;rsquo;s filename. They also allow these top-level modules to be grouped
together.&lt;/p&gt;

&lt;p&gt;The details of proposals for namespaces vary on their details, but they
basically allow you to take the module defined by a file &amp;ldquo;baz.ml&amp;rdquo; and refer to
it as &amp;ldquo;Bar.Baz&amp;rdquo;. Here &amp;ldquo;Bar&amp;rdquo; is not a module (it cannot be used as the argument
to a functor) but a namespace.&lt;/p&gt;

&lt;p&gt;Namespaces seem likely to be included in OCaml in the near future,
and they provide a convenient way to refer to quotations without putting
quotations within modules.&lt;/p&gt;

&lt;p&gt;The idea is to write quotations in a &amp;ldquo;bar.mlq&amp;rdquo; file (compiled to
&amp;ldquo;bar.cmq&amp;rdquo;). These quotations would then be placed in the namespace &amp;ldquo;Bar&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;Quotations would be defined with a syntax like:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;c&quot;&gt;(* bar.mlq *)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;quotation&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This could then be used with the syntax:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;o&quot;&gt;{:&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This will make it easy for quotations to be provided by libraries. So that the
following code would perfectly possible:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;o&quot;&gt;{:&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Core&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Web&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;world&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;}}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h5&gt;Quotations in different contexts&lt;/h5&gt;

&lt;p&gt;So far, we have ignored the question of what type is used to represent an AST
node. The standard library would need to provide such a type so that quotations
could be written without linking to compiler-libs. There would also need to be
different types for different kinds of AST nodes. We do not want a quotation
used as an expression returning an AST node that represents a pattern&lt;/p&gt;

&lt;p&gt;However, we also might want to create quotations that can be used as both
expressions and patterns. This means that the quotation must return a different
type depending on where it is used.&lt;/p&gt;

&lt;p&gt;The solution to this issue is to give quotations the type &lt;code&gt;'a ctx -&amp;gt; string -&amp;gt;
'a&lt;/code&gt;.  The &lt;code&gt;ctx&lt;/code&gt; type would be a GADT that described what context a quotation was
being used from. It could also contain other information about the context, such
as its location in the source file.&lt;/p&gt;

&lt;h5&gt;Building Quotations&lt;/h5&gt;

&lt;p&gt;Creating the quotation functions requires some facility for creating AST
nodes. For this purpose, the standard library would include special quotations,
for example: &lt;code&gt;{:Ast.expr{ x + 3 }}&lt;/code&gt;. These quotations would be implemented
directly using the compiler&amp;rsquo;s lexer and parser.&lt;/p&gt;

&lt;p&gt;It would also be useful (especially for handling anti-quotations) to allow
quotations to be built from other quotations. For this we could provide another
syntax: &lt;code&gt;{:foo}&lt;/code&gt; that would refer directly to the quotation function
&lt;code&gt;foo&lt;/code&gt;. Obviously, this syntax would only be allowed within &amp;ldquo;.mlq&amp;rdquo; files.&lt;/p&gt;

&lt;h4&gt;Other extensions&lt;/h4&gt;

&lt;p&gt;This system could easily be extended to other kinds of extension. Rather than
declaring &amp;ldquo;quotations&amp;rdquo; with type &lt;code&gt;'a ctx -&amp;gt; string -&amp;gt; 'a&lt;/code&gt;, we could declare
&lt;em&gt;templates&lt;/em&gt; with type &lt;code&gt;'a ctx -&amp;gt; 'a&lt;/code&gt;. The context would contain the arguments to
the template (a string for quotations, an AST node for other templates).&lt;/p&gt;

&lt;p&gt;So a template declared as:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;c&quot;&gt;(* bar.mlq *)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;template&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;could be used with the syntax:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;o&quot;&gt;(:&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Unlike quotations, more general templates must be able to interpret AST nodes
themselves. This means we must provide mechanisms for handling AST nodes. For
this purpose, the standard library would include a simpler version of the
&lt;code&gt;AstMapper&lt;/code&gt; module that is in compiler-libs.&lt;/p&gt;

&lt;p&gt;We could also allow the AST quotations (e.g. `Ast.expr) to be used as
patterns. This approach can be a bit fragile because syntactic sugar can cause a
pattern to match ASTs that it was not expected to match. However, for matching
simple AST nodes it is probably fairly robust.&lt;/p&gt;

&lt;h4&gt;Summary&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;Allow extensions to be written as OCaml functions within &amp;ldquo;.mlq&amp;rdquo; files.&lt;/li&gt;
  &lt;li&gt;Refer to these functions by attaching them directly to namespaces.&lt;/li&gt;
  &lt;li&gt;Require these functions to have type &lt;code&gt;'a ctx -&amp;gt; 'a&lt;/code&gt;, where &lt;code&gt;ctx&lt;/code&gt; includes a
GADT describing the context that the extension has been used in.&lt;/li&gt;
  &lt;li&gt;Provide AST quotations in the standard library (e.g. &lt;code&gt;{:Ast.expr{ x + 3 }}&lt;/code&gt;)
which use the compiler&amp;rsquo;s own lexer and parser.&lt;/li&gt;
&lt;/ol&gt;
</content><id>http://lpw25.net/2013/02/05/camlp4-alternative-part-2.html</id><title type="text">An alternative to camlp4 - Part 2</title><updated>2013-02-05T00:00:00+00:00</updated><author><email></email><name>Leo White</name></author></entry><entry><link href="http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Feb%202013" rel="alternate"/><contributor><uri>http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml</uri><name>OCL Monthly News</name></contributor><content type="html">
      &lt;p&gt;Two new people joined the core team at Cambridge: &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/yallop.html&quot;&gt;Jeremy Yallop&lt;/a&gt; and &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/pwang.html&quot;&gt;Philippe Wang&lt;/a&gt;!
Jeremy has extensive expertise with meta-programming and generic programming,
and is initially looking at the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/compiler.html#Camlp4%20redesign&quot;&gt;camlp4 redesign&lt;/a&gt;.
Philippe has been taking on the challenge of running OCaml well on restricted embedded systems, which
will also have knock-on benefits to x86 compilation with the same optimisations.
&lt;a href=&quot;http://www.x9c.fr&quot;&gt;Xavier Clerc&lt;/a&gt; also joined us for a day in advance of his
visit in April, with much interest in his &lt;a href=&quot;http://argot.x9c.fr&quot;&gt;Argot&lt;/a&gt; project
and the upcoming &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/outreach.html#OCaml.org%20redesign&quot;&gt;redesign of OCaml.org&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Two new research grants have been awarded that are relevant to the OCaml Labs mission:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://gow.epsrc.ac.uk/NGBOViewGrant.aspx?GrantRef=EP/K032968/1&quot;&gt;Network-as-a-Service&lt;/a&gt; is a 3-year grant to solve pressing problems in &amp;quot;Big Data&amp;quot; processing, and will enable us to continue to develop &lt;a href=&quot;http://openmirage.org&quot;&gt;MirageOS&lt;/a&gt; and the use of OCaml and functional programming in this space.  We're going to be collaborating with Imperial and Nottingham on this, with the Cambridge efforts led by &lt;a href=&quot;http://www.cl.cam.ac.uk/~awm22/&quot;&gt;Andrew Moore&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/crowcroft.html&quot;&gt;Jon Crowcroft&lt;/a&gt; and &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/avsm.html&quot;&gt;Anil Madhavapeddy&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://rems.io&quot;&gt;Rigorous Engineering of Mainstream Systems&lt;/a&gt; asks how we can use rigorous maths to improve the quality of mainstream computer systems.  It is led by &lt;a href=&quot;http://www.cl.cam.ac.uk/~pes20&quot;&gt;Peter Sewell&lt;/a&gt; at Cambridge, and most of the tools (including &lt;a href=&quot;http://www.cl.cam.ac.uk/~pes20/ott/&quot;&gt;Ott&lt;/a&gt; and &lt;a href=&quot;http://www.cs.kent.ac.uk/people/staff/sao/lem/&quot;&gt;Lem&lt;/a&gt;) are written in OCaml and will benefit from the ongoing work at OCaml Labs.&lt;/li&gt;&lt;/ul&gt;

&lt;h3&gt;Platform projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;OPAM&lt;/b&gt;: &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/rdc-talk.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/rdc-talk-thumb.jpg&quot; width=&quot;130px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
We've been working hard on an OPAM 1.0 release, and Thomas and Anil have been sweeping through the package tree to stabilise the repository via automated builds.
We also had a brilliant visit from &lt;a href=&quot;http://www.dicosmo.org/index.html.en&quot;&gt;Roberto Di Cosmo&lt;/a&gt; from &lt;a href=&quot;http://www.pps.univ-paris-diderot.fr&quot;&gt;PPS&lt;/a&gt;, who has contributed extensively to the open-source community over the years.  He gave a talk on the &lt;a href=&quot;http://upsilon.cc/~zack/research/publications/infsof2012-mpm.pdf&quot;&gt;challenges of handling large-scale versioning&lt;/a&gt; of packages from a mathematical perspective (particularly applied to Debian), which is very useful input for the ongoing OPAM work.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Mailing lists&lt;/b&gt;: A new &lt;a href=&quot;http://lists.ocaml.org/listinfo/opengl&quot;&gt;opengl@lists.ocaml.org&lt;/a&gt; was
set up for those interested in OpenGL and WebGL on OCaml, and discussion so far
has covered LabGL on the Raspberry Pi. There are also still plans to begin
working groups for build systems and parallelism but will be announced in due
course once the preparatory work has been completed.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Real World OCaml&lt;/b&gt;: The book is now on &lt;a href=&quot;http://www.realworldocaml.org&quot;&gt;alpha3&lt;/a&gt;,
where Part 1 is nearly complete.  New sections on installation and a more
expanded prologue have also been included in this version.&lt;/p&gt;
&lt;iframe allowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot; webkitallowfullscreen=&quot;true&quot; style=&quot;float:right; padding: 0px 10px 10px 10px;&quot; frameborder=&quot;0&quot; height=&quot;169&quot; width=&quot;300&quot; src=&quot;http://player.vimeo.com/video/61768157?byline=0&amp;amp;portrait=0&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;&lt;b&gt;Redesign: &lt;/b&gt; As part of the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/outreach.html#OCaml.org%20redesign&quot;&gt;redesign
work&lt;/a&gt;, and to showcase the kind of
additional functionality we'd like to create, Amir put together a set of
screencasts that talk though a wireframe demo of the new site.  These short
videos covered elements of design, the new documentation system and an overview
of how the continuous integration system would work.  You can read more and
experience the clickable demo via &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg&quot;&gt;Amir's blog post&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Systems and compiler projects&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;Mirage&lt;/b&gt;: Anil gave two tech talks about &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage&lt;/a&gt; this month at Citrix and Microsoft Research, as practise talks for &lt;a href=&quot;http://asplos13.rice.edu&quot;&gt;ASPLOS 2013&lt;/a&gt;. Mirage itself is nearing a release, and &lt;a href=&quot;https://github.com/vbmithr&quot;&gt;Vincent Bernardoff&lt;/a&gt; has joined the Citrix engineering team to help drive it to release. He's been primarily focussed on the build frontend (dubbed &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/mirage.html#Mirari&quot;&gt;Mirari&lt;/a&gt;) to make Mirage applications easier to compile out-of-the-box.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;camlp4 redesign:&lt;/b&gt; There has been more discussion about the future of camlp4 and &lt;a href=&quot;http://www.lpw25.net/2013/02/05/camlp4-alternative-part-2.html&quot;&gt;Leo posted another summary&lt;/a&gt; on his thoughts for an alternative apporach to quotations.&lt;/p&gt;
&lt;p&gt;&lt;i&gt;Link roundup:&lt;/i&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/2013/02/05/camlp4-alternative-part-2.html&quot; class=&quot;icon-rss&quot;&gt;An alternative to camlp4 - Part 2&lt;/a&gt; &lt;em&gt;(Feb 5th)&lt;/em&gt;&lt;/li&gt;&lt;/ul&gt;

   </content><id>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Feb%202013</id><title type="text">Feb 2013 news update</title><updated>2013-02-01T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://lpw25.net/2013/01/23/camlp4-alternative-part-1.html" rel="alternate"/><contributor><uri>http://www.lpw25.net/atom.xml</uri><name>Leo White</name></contributor><content type="html">&lt;p&gt;Since its creation camlp4 has proven to be a very useful tool. People have used
it to experiment with new features for OCaml and to provide interesting
meta-programming facilities. However, there is general agreement that camlp4 is
too powerful and complex for the applications that it is most commonly used for,
and there is a growing movement to provide a simpler alternative.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;http://lists.ocaml.org/listinfo/wg-camlp4&quot;&gt;wg-camlp4@lists.ocaml.org&lt;/a&gt;
mailing list has been created to discuss implementing this simpler
alternative. This blog post is a way of kick-starting the discussion on this
list, by explaining my thoughts on what needs to be done.&lt;/p&gt;

&lt;p&gt;Personally, I think that providing a real alternative to camlp4 involves two
phases. The first phase is to provide support for implementing the most popular
camlp4 extensions without camlp4. Since the people who have implemented these
extensions already require good knowledge of the OCaml grammar it is not
unreasonable to expect a similar level of expertise to use the alternative. This
phase can easily be implemented before the next OCaml release, and I will
discuss what I think that will involve in the remainder of this post.&lt;/p&gt;

&lt;p&gt;The second phase involves extending this support to allow general OCaml
programmers to write extensions, and to include such extensions within the
language itself rather than as part of a pre-processor. I will discuss my
thoughts on this phase in a later blog post.&lt;/p&gt;

&lt;h4&gt;Camlp4 in the wild&lt;/h4&gt;

&lt;p&gt;Camlp4 works by producing pre-processors that parse an OCaml file and then output
a syntax tree directly into the compiler. Extensions are written by extending
the default OCaml parser and converting any new syntax tree nodes into existing
OCaml nodes. Most of the complexity in camlp4 comes from its extensible
grammars, which gives camlp4 the ability to extend the OCaml syntax
arbitrarily. However, most applications do not need this ability. &lt;/p&gt;

&lt;p&gt;From an ad-hoc survey of camlp4 extensions in the OPAM repository, most of the
popular camlp4 extensions seem to fall into one of three categories: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
Type-conv style extensions such as 
&lt;a href=&quot;https://bitbucket.org/yminsky/ocaml-core/wiki/Home&quot;&gt;sexplib&lt;/a&gt;, 
&lt;a href=&quot;https://github.com/mirage/orm&quot;&gt;ORM&lt;/a&gt; and 
&lt;a href=&quot;https://github.com/mirage/dyntype&quot;&gt;dyntype&lt;/a&gt;. 
These extend the syntax to allow code such as:

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sexp_drop_default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sexp_drop_if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sexp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
Extensions using camlp4's quotations syntax such as 
&lt;a href=&quot;https://github.com/mirage/ocaml-cow&quot;&gt;COW&lt;/a&gt;. These look like:

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hello&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;world&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
Other syntax extensions that could be expressed using existing syntax or the
camlp4 quotation syntax. For example, 
&lt;a href=&quot;http://ocsigen.org/js_of_ocaml/&quot;&gt;js_of_ocaml&lt;/a&gt; provides a
&lt;code&gt;##&lt;/code&gt; operator for accessing javascript objects. This could easily be replaced by
a valid operator such as &lt;code&gt;%%&lt;/code&gt;.
&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;By providing support for these specific kinds of extension, we can provide an
alternative to camlp4 for the majority of its applications.&lt;/p&gt;

&lt;h4&gt;AST transformers, attributes and quotations&lt;/h4&gt;

&lt;p&gt;A much simpler alternative to allowing arbitrary syntax extensions is to use
&lt;em&gt;AST transformers&lt;/em&gt;, &lt;em&gt;attributes&lt;/em&gt; and &lt;em&gt;quotations&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;AST transformers are simply functions that perform transformations on the OCaml
syntax tree. These can already be implemented using the new
&amp;ldquo;&lt;a href=&quot;http://www.lexifi.com/blog/syntax-extensions-without-camlp4-lets-do-it&quot;&gt;-ppx&lt;/a&gt;&amp;rdquo;
command line option that has been included on the OCaml development trunk by
Alain Frisch. This option accepts a program as an argument, and pipes the syntax
tree through that program after parsing and before type checking.&lt;/p&gt;

&lt;p&gt;Attributes are places in the grammar where generic data can be attached to the
syntax tree. This data is simply ignored by the main OCaml compiler, but it can
used be AST transformers to control transformations. &lt;/p&gt;

&lt;p&gt;Quotations are any construct that is not lexed or parsed by the compiler. These
can be attributes, expressions, patterns etc. The contents of a quotation can be
lexed and parsed by an AST transformer and converted into a regular AST node.&lt;/p&gt;

&lt;p&gt;Before support for attributes and quotations can be added to the compiler
decisions need to be made about what kinds of attributes and quotations to
support. Personally I prefer quotation attributes to attributes that are parsed
by the compiler because they are more flexible. However there is no reason that
both kinds cannot be supported by the compiler using different syntax.&lt;/p&gt;

&lt;p&gt;I think that it is important to support at least the following kinds of attribute:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
Simple named quotations for expressions, patterns and type expressions:

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;:&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
Type constructor quotation attributes:

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
Type-conv style definition attributes:

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;(* some valid expression *)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
Annotating types with syntactically valid expressions:

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot; data-lang=&quot;ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@@&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;(* some valid expression *)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Once support for these attributes and quotations is added to OCaml I think that
the majority of camlp4 applications could be easily converted into AST
transformers.&lt;/p&gt;

&lt;p&gt;In order to make this transition easy, work must also be done to provide tools
for manipulating OCaml&amp;rsquo;s AST and parsing quotations. It would also be worthwhile
trying to normalise some of the stranger corners of the OCaml syntax tree. This
will make writing AST transformers simpler and more robust&lt;/p&gt;

&lt;p&gt;Finally, the &amp;ldquo;-ppx&amp;rdquo; option must be integrated into the many OCaml build
systems.&lt;/p&gt;

&lt;h4&gt;Join the discussion&lt;/h4&gt;

&lt;p&gt;The above suggestions are just the attributes and quotations that I think will
be necessary to provide a viable alternative to camlp4. However, I suspect that
they are not sufficient. It would be very useful to hear from anyone who has
written camlp4 extensions about what kind of extensions they have written, and
what they think would be necessary to support their extensions without
camlp4. So please join the
&lt;a href=&quot;http://lists.ocaml.org/listinfo/wg-camlp4&quot;&gt;wg-camlp4@lists.ocaml.org&lt;/a&gt; list and post
your thoughts.&lt;/p&gt;
</content><id>http://lpw25.net/2013/01/23/camlp4-alternative-part-1.html</id><title type="text">An alternative to camlp4 - Part 1</title><updated>2013-01-23T00:00:00+00:00</updated><author><email></email><name>Leo White</name></author></entry><entry><link href="http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Jan%202013" rel="alternate"/><contributor><uri>http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml</uri><name>OCL Monthly News</name></contributor><content type="html">
      &lt;p&gt;There's a lot of interest in the work we're doing, and the number of collaborative &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/index.html&quot;&gt;projects&lt;/a&gt; is increasing fast. 
We held the first monthly meeting in the Computer Lab, where &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/avsm.html&quot;&gt;Anil&lt;/a&gt; provided
an overview of the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/index.html&quot;&gt;research work&lt;/a&gt; that OCaml Labs is
starting. An interesting theme of the discussion that followed was
related to undergraduate teaching and how things like the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html&quot;&gt;OCaml
Platform&lt;/a&gt; and infrastructure would make it easier for
students to get to grips with programming.&lt;/p&gt;
&lt;p&gt;For the evening after the meeting, &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/amirmc.html&quot;&gt;Amir&lt;/a&gt; set up 
an informal OCaml hacking/tutorial session in Cambridge.  Around 15 eager 
people attended the event in &lt;a href=&quot;http://makespace.org&quot;&gt;Makespace&lt;/a&gt; (a community 
workshop), with most of them being new to the language.  Anil introduced 
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/outreach.html#Book%20review%20site&quot;&gt;Real World OCaml&lt;/a&gt; 
and shared the 
introductory chapters while Thomas provided help with OPAM.  This turned out 
to be a great test of the installation process for newcomers to OCaml, as 
well as the book's instructions. A number of issues came to light, partly 
related to a perfect storm of package issues, which everyone is keen to 
improve.  Despite these problems, attendees were very positive and were keen 
to see more gatherings like this in future.  When Amir asked for feedback, 
pretty much everyone commented on how great the pizza was.&lt;/p&gt;
&lt;h3&gt;Platform projects&lt;/h3&gt;

&lt;p&gt;OCaml Labs also hosted its first visitor this month as &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/tg.html&quot;&gt;Thomas
Gazagnaire&lt;/a&gt;, the CTO of OCamlPro, spent three weeks in
Cambridge.  Much effort was put into preparing Mirage for release, discussions
about parallelism and the OCaml Platform, and anything where OPAM is a crucial
component.  Worth noting is that (at time of writing) the 
&lt;a href=&quot;https://github.com/OCamlPro/opam-repository&quot;&gt;opam-repository&lt;/a&gt; has now 
become the &lt;a href=&quot;https://github.com/languages/OCaml&quot;&gt;overall most forked OCaml project on Github&lt;/a&gt;.&lt;br/&gt;The &lt;a href=&quot;http://lists.ocaml.org/pipermail/platform/&quot;&gt;Platform mailing list&lt;/a&gt; 
has also been formed for discussion regarding the OCaml Platform.  Anyone 
interested in the discussions about the platform, which will include 
development on OPAM, should join this list.&lt;/p&gt;
&lt;p&gt;Part of the Platform work involves creating a new 
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html&quot;&gt;design for OCaml.org&lt;/a&gt;, which also 
&lt;a href=&quot;http://lists.ocaml.org/pipermail/infrastructure/2013-February/000194.html&quot;&gt;kicked-off this week&lt;/a&gt;.&lt;br/&gt;Amir will keep people updated about progress via updates to the 
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/outreach.html#OCaml.org%20redesign&quot;&gt;OCL website&lt;/a&gt;, 
&lt;a href=&quot;http://lists.ocaml.org/pipermail/infrastructure/&quot;&gt;Infrastructure mailing list&lt;/a&gt; and also by posting things to the 
&lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki&quot;&gt;OCaml.org Github wiki&lt;/a&gt;.  The 
current stage of work involves thinking of the types of pages OCaml.org 
requires, in order to refine the templates we need.  As part of this, we 
also commissioned a new logo for OCaml and although it's still under 
development, you can see the latest draft on the 
&lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Draft-OCaml-Logos&quot;&gt;OCaml.org wiki&lt;/a&gt;.
 Please send any feedback directly to Amir.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/t2-kickoff-2.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/t2-kickoff-2-thumb.jpg&quot; width=&quot;130px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
The Real World OCaml book website was released as a 
&lt;a href=&quot;http://www.realworldocaml.org&quot;&gt;limited alpha&lt;/a&gt; earlier in the month, with 
the aim of getting early feedback and comments. Each paragraph of the online 
book has commenting functionality, using Github issues as a backend.  This 
means that each comment made on the book website creates a new issue on 
Github, which authors/commenters can track and discuss before editing the 
content.  So far there have been over 250 comments on the alpha, with half 
them being dealt with already.&lt;/p&gt;
&lt;p&gt;A new EU project also kicked-off called &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/t2.html&quot;&gt;Trilogy 2&lt;/a&gt;, which builds on the 
award-winning work from the original &lt;a href=&quot;http://www.trilogy-project.org&quot;&gt;Trilogy&lt;/a&gt; project.  OnApp (a member of Trilogy 2), will be providing the &lt;a href=&quot;http://lists.ocaml.org/pipermail/infrastructure/2013-February/000198.html&quot;&gt;cloud Infrastructure for ocaml.org&lt;/a&gt;, and Thomas and Anil will be expanding the Mirage project into distributed computing under this umbrella.  As befits an EU project, it kicked off with an especially nice dinner at &lt;a href=&quot;http://www.christs.cam.ac.uk&quot;&gt;Christ's College&lt;/a&gt;...&lt;/p&gt;
&lt;h3&gt;Systems research&lt;/h3&gt;

&lt;p&gt;&lt;b&gt;Mirage:&lt;/b&gt; This was formally proposed as an 
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/mirage.html&quot;&gt;incubated Xen.org project&lt;/a&gt; and the proposal was put forward for 
&lt;a href=&quot;http://wiki.xen.org/wiki/Mirage_Incubation_Project_Proposal&quot;&gt;community review&lt;/a&gt;. There were many positive 
comments on the Xen mailing lists (along the lines of 
&lt;a href=&quot;http://lists.xen.org/archives/html/xen-devel/2013-01/msg01084.html&quot;&gt;&amp;quot;Mirage is cool stuff&amp;quot;&lt;/a&gt;)
and voting is currently underway by eligible members of the Xen community.
Assuming a positive outcome, incubation would give the Mirage project greater
visibility and access to resources.  This would accelerate progress towards an
alpha release in Q1/Q2 this year.  In 
addition to this, a proposal for an 
&lt;a href=&quot;http://www.oscon.com/oscon2013&quot;&gt;OSCON talk&lt;/a&gt; was also submitted and the camera-ready version of the ASPLOS paper is 
&lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;now available&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Illuminate&lt;/b&gt;: A related research topic where Mirage could be useful is in embedded systems 
and the Internet of Things.  One specific use case is the 
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/illuminate.html&quot;&gt;Illuminate Project&lt;/a&gt;, where Mirage can be used 
to create appliances running on the ARM microcontrollers alongside an LED 
lighting network.  Such a lighting system is now deployed in large parts of 
the Computer Laboratory and will form an excellent test-bed to explore these 
ideas further.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Signpost:&lt;/b&gt;: &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/t2-kickoff-1.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/t2-kickoff-1-thumb.jpg&quot; width=&quot;130px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
Signpost is also achieving greater outreach with 
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/crowcroft.html&quot;&gt;Jon Crowcroft&lt;/a&gt; discussing such technologies at a 
meeting in Dagstul on &lt;a href=&quot;http://www.dagstuhl.de/en/program/calendar/semhp/?semnr=13062&quot;&gt;Decentralized Systems for Privacy
Preservation&lt;/a&gt;.
Cambridge also hosted &lt;a href=&quot;http://en.wikipedia.org/wiki/Eric_Schmidt&quot;&gt;Eric Schmidt&lt;/a&gt;
from Google, where he is the Humanitas Visiting Professor in Media for 2013.
Eric delivered a &lt;a href=&quot;http://www.crassh.cam.ac.uk/events/2332/&quot;&gt;talk&lt;/a&gt; on the future
of conflict, combat and intervention.  Anil and Jon got an opportunity to
discuss Signposts with him for 20 minutes, which was an interesting clash of
opinions (we want decentralised identity, Google want it all to go through
them).  Either way, we're even more motivated to get the Signpost tech out to
the big bad world as soon as possible.  Meanwhile, Haris found his identical
twin brother in &lt;a href=&quot;http://en.wikipedia.org/wiki/St_John's_College,_Cambridge#The_Master.27s_Lodge_and_Garden&quot;&gt;St Johns Masters Lodge&lt;/a&gt;...&lt;/p&gt;
&lt;h3&gt;Compiler projects&lt;/h3&gt;

&lt;p&gt;Several mailing lists are in progress for various community-driven projects.
The first of these is a working group on the future of syntax extensions in 
OCaml (&lt;a href=&quot;http://lists.ocaml.org/pipermail/wg-camlp4&quot;&gt;wg-camlp4&lt;/a&gt;).  This group is 
chaired by &lt;a href=&quot;http://alain.frisch.fr&quot;&gt;Alain Frisch&lt;/a&gt; and Leo White and has 
generated a great deal of discussion in the last two weeks.  Leo is 
summarising his thoughts in a series of &lt;a href=&quot;http://www.lpw25.net&quot;&gt;blog posts&lt;/a&gt; 
as he goes.  Further working groups on parallelism in OCaml and build systems are under 
discussion and will be announced in due course.&lt;/p&gt;
&lt;p&gt;As well as all the research and development activity we've also been 
recruiting.  We've had several rounds of interviews and made a number of 
offers so hopefully we'll be announcing new members of the OCaml Labs team 
in the coming months.  In addition, we'd also like to mention that Leo 
successfully defended his PhD Thesis in January.  Finally, we'd like to 
welcome a new honorary member of OCaml Labs, Nathan Scott, born on 30th 
January.  Congratulations &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/djs.html&quot;&gt;Dave&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;&lt;i&gt;Link roundup:&lt;/i&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://www.lpw25.net/2013/01/23/camlp4-alternative-part-1.html&quot; class=&quot;icon-rss&quot;&gt;An alternative to camlp4 - Part 1&lt;/a&gt; &lt;em&gt;(Jan 23rd)&lt;/em&gt;&lt;/li&gt;&lt;/ul&gt;

   </content><id>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Jan%202013</id><title type="text">Jan 2013 news update</title><updated>2013-01-01T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Dec%202012" rel="alternate"/><contributor><uri>http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml</uri><name>OCL Monthly News</name></contributor><content type="html">
      &lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/cam-snow.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/cam-snow-thumb.jpg&quot; width=&quot;130px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
OCaml Labs kicked-off with an internal meeting of the Cambridge-based members,
who battled endless snow to make it to the meeting.
There are over 20 people involved just within the building and over 30
including those outside the University. We welcomed a few new members,
including Leo White (Postdoc), Raphael Proust (PhD student) and Stephen Dolan
(PhD student).  At this initial gathering Anil talked over some of the projects
that were already taking place in the Lab, as well as the new work that would
be supported by OCaml Labs.&lt;/p&gt;
&lt;p&gt;Significant progress was made on the research side too.
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/mirage.html&quot;&gt;Mirage&lt;/a&gt; has had a flurry of new releases as we
prepare for a first public release, and we're in the final stages of being
officially incubated as a &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/mirage.html&quot;&gt;xen.org project&lt;/a&gt;.
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/illuminate.html#Signpost%20prototype&quot;&gt;Signpost&lt;/a&gt; is also
taking shape, mainly due to the addition of DNSSEC to the
&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/illuminate.html#Signpost%20prototypew&quot;&gt;ocaml-dns&lt;/a&gt; implementation.
There's been industrial interest in the applications of Signpost and the team
is pursuing these for more use cases.&lt;/p&gt;
&lt;p&gt;We also began work on a new website for the &lt;a href=&quot;http://realworldocaml.org&quot;&gt;Real World
OCaml&lt;/a&gt;.  We took inspiration from our friends who wrote
Real World Haskell, and the site will have commenting functionality so that
people can suggest improvements before the book is finalised.  As part of this,
we also worked with a design firm to begin creating a &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/outreach.html#OCaml.org%20redesign&quot;&gt;new logo for the OCaml
language&lt;/a&gt;.&lt;br/&gt;The logo will be placed into the
public domain for use by anyone.&lt;/p&gt;
&lt;p&gt;Last, but certainly not least, Ashish put the new &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt;
website live, to much electronic &lt;a href=&quot;https://twitter.com/jakedonham/status/281170330700095488&quot;&gt;applause&lt;/a&gt;.
A great way to end 2012!&lt;/p&gt;

   </content><id>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Dec%202012</id><title type="text">Dec 2012 news update</title><updated>2012-12-01T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Nov%202012" rel="alternate"/><contributor><uri>http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml</uri><name>OCL Monthly News</name></contributor><content type="html">
      &lt;p&gt;OCaml Labs finally opened its doors with announcements from
&lt;a href=&quot;https://ocaml.janestreet.com/?q=node/109&quot;&gt;Yaron&lt;/a&gt; and
&lt;a href=&quot;http://anil.recoil.org/2012/10/19/announcing-ocaml-labs.html&quot;&gt;Anil&lt;/a&gt;!  Although
much of the remainder of November was spent on administration and wiring up
machines for the forthcoming &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/platform.html#Machine%20Pool&quot;&gt;test cluster&lt;/a&gt;, we
also celebrated the acceptance of a paper on &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/tasks/mirage.html&quot;&gt;Mirage&lt;/a&gt;
to &lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;ASPLOS 2013&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/caml-consortium-20121101.jpg&quot;&gt;&lt;img src=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/images/caml-consortium-20121101-thumb.jpg&quot; width=&quot;130px&quot; class=&quot;right&quot;/&gt;&lt;/a&gt;
We also had a very productive visit from &lt;a href=&quot;http://www.ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt;.
Fabrice, Thomas and Pierre came over to discuss the new
&lt;a href=&quot;http://opam.ocamlpro.com&quot;&gt;OPAM&lt;/a&gt; package manager and the plans for building an
OCaml Platform in 2013. This was in preparation for the subsequent Consortium
meeting of the industrial board of OCaml, where Anil was able to present (and
get approved) an overview of what &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt; would become.
You can see the &lt;a href=&quot;http://anil.recoil.org/slides/OCaml-Consortium-2012-OCamlLabs.pdf&quot;&gt;slides of his talk online&lt;/a&gt;.  An
interesting thing to note is just how broad the set of OCaml language users
are: right the way from formal methods, to systems projects, and even web
developers.&lt;/p&gt;
&lt;p&gt;Since the Consortium meeting, the infrastructure behind ocaml.org is being
built out and there's already been helpful input via the
&lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure mailing list&lt;/a&gt;.  A continuous build system has been put together for internal testing, with
support from Citrix, and &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/atom.xml#opam&quot;&gt;OPAM&lt;/a&gt; itself continues to mature and grow in
popularity.&lt;/p&gt;

   </content><id>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Nov%202012</id><title type="text">Nov 2012 news update</title><updated>2012-11-01T12:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://anil.recoil.org/2012/10/19/announcing-ocaml-labs.html" rel="alternate"/><contributor><uri>http://anil.recoil.org/feeds/atom-ocaml.xml</uri><name>Anil Madhavapeddy</name></contributor><content type="html">&lt;p&gt;I&amp;rsquo;m very excited to announce &lt;em&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs&quot;&gt;OCaml Labs&lt;/a&gt;&lt;/em&gt;, the latest project to hit the Cambridge Computer Lab. As anyone that hangs out near me probably realises, I very much enjoy functional programming.
My weapon of choice tends to be &lt;a href=&quot;http://www.ocaml-lang.org&quot;&gt;OCaml&lt;/a&gt;, as it condenses &lt;a href=&quot;http://events.inf.ed.ac.uk/Milner2012/X_Leroy-html5-mp4.html&quot;&gt;decades of research&lt;/a&gt; into a
pragmatic blend of functional, imperative and object-oriented programming styles.
What&amp;rsquo;s perhaps less well known are the steady &lt;a href=&quot;http://www.ocaml-lang.org/companies.html&quot;&gt;inroads&lt;/a&gt; that OCaml has been making into mission-critical areas of industry.
At &lt;a href=&quot;http://ocaml.janestreet.com&quot;&gt;Jane Street&lt;/a&gt;, billions of dollars of transactions are routed through a huge ML code-base that is designed to catch bugs &lt;a href=&quot;http://vimeo.com/14313378&quot;&gt;at compile-time&lt;/a&gt;.
At &lt;a href=&quot;http://github.com/xen-org/xen-api&quot;&gt;Citrix&lt;/a&gt;, the Xen management toolstack that powers &lt;a href=&quot;http://blogs.citrix.com/2012/10/09/one-in-a-million/&quot;&gt;millions&lt;/a&gt; of hosts in the cloud is &lt;a href=&quot;http://anil.recoil.org/papers/2010-icfp-xen.pdf&quot;&gt;largely written in OCaml&lt;/a&gt;.
Facebook does sophisticated &lt;a href=&quot;https://github.com/facebook/pfff/wiki/Main&quot;&gt;static analysis&lt;/a&gt; using OCaml over their vast PHP codebase to close security holes.&lt;/p&gt;

&lt;p&gt;The OCaml community is small but dedicated, but there is always more to do to
improve the language and ecosystem. So, thanks to a generous platform grant
from &lt;a href=&quot;http://ocaml.janestreet.com&quot;&gt;Jane Street&lt;/a&gt;, we are launching a program to
help with the open-source development of OCaml from Cambridge.&lt;/p&gt;

&lt;p&gt;The &lt;em&gt;&lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/&quot;&gt;OCaml Labs&lt;/a&gt;&lt;/em&gt; are based in the &lt;a href=&quot;http://www.cl.cam.ac.uk&quot;&gt;Cambridge Computer Lab&lt;/a&gt; and led my myself, &lt;a href=&quot;http://www.cl.cam.ac.uk/~am21/&quot;&gt;Alan Mycroft&lt;/a&gt; and &lt;a href=&quot;http://www.cl.cam.ac.uk/~iml1/&quot;&gt;Ian Leslie&lt;/a&gt;.  We&amp;rsquo;re closely affiliated with other &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/collaboration.html&quot;&gt;groups&lt;/a&gt;, and will be:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;developing the OCaml Platform, which will bundle the official OCaml compiler from INRIA with a tested set of community libraries that refreshed every six months. &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;working with the core OCaml team at INRIA&amp;rsquo;s &lt;a href=&quot;http://gallium.inria.fr/&quot;&gt;Gallium&lt;/a&gt; group on the compiler, and with commercial partners like &lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt; on tool development. OCamlPro are making some very impressive progress already with the &lt;a href=&quot;http://opam.ocamlpro.com&quot;&gt;OPAM&lt;/a&gt; packge manager and &lt;a href=&quot;http://www.typerex.org&quot;&gt;TypeRex&lt;/a&gt; IDE helper.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;supporting the online presence with more teaching material and content.  Yaron, Jason and I are working hard on a &lt;a href=&quot;http://realworldocaml.org&quot;&gt;new book&lt;/a&gt; that will be published next year, and the OCaml Web team (led by &lt;a href=&quot;http://ashishagarwal.org&quot;&gt;Ashish&lt;/a&gt; and &lt;a href=&quot;https://plus.google.com/109604597514379193052/posts&quot;&gt;Christophe&lt;/a&gt;) have made great progress on a &lt;a href=&quot;http://www.ocaml-lang.org&quot;&gt;brand new website&lt;/a&gt; that we will move to the &lt;code&gt;ocaml.org&lt;/code&gt; domain soon.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Research efforts&lt;/h3&gt;

&lt;p&gt;Of course, it is difficult to hack on a language in a void, and we also &lt;em&gt;use&lt;/em&gt; OCaml heavily in our own research.  The other half of OCaml Lab&amp;rsquo;s goals are more disruptive (and riskier!):&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The upcoming first beta release of &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage&lt;/a&gt;, which is an operating system designed for cloud and embedded environments, and is written almost entirely from the ground up in OCaml. The outputs of Mirage include a &lt;a href=&quot;http://www.openmirage.org/blog/breaking-up-is-easy-with-opam&quot;&gt;large number of libraries&lt;/a&gt; which are usable separately, such as pure implementations of TCP/IP, DNS, SSH, DHCP and HTTP.  The Xen hackers, led by &lt;a href=&quot;http://dave.recoil.org&quot;&gt;David Scott&lt;/a&gt;, are out in force to integrate Mirage into their &lt;a href=&quot;http://www.xen.org/xensummit/xs12na_talks/T2.html&quot;&gt;next-generation&lt;/a&gt; platform.  Meanwhile, Raphael Proust is busy eliminating the &lt;a href=&quot;http://anil.recoil.org/papers/drafts/2012-places-limel-draft1.pdf&quot;&gt;garbage collector&lt;/a&gt; with his cut-down &amp;ldquo;LinearML&amp;rdquo; variant.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Working with our collaborators at the &lt;a href=&quot;http://horizon.ac.uk&quot;&gt;Horizon Institute&lt;/a&gt; on privacy-preserving technologies such as &lt;a href=&quot;http://anil.recoil.org/papers/2012-sigcomm-signposts-demo.pdf&quot;&gt;Signposts&lt;/a&gt; which let you build and maintain your own personal clouds that operate &lt;a href=&quot;http://anil.recoil.org/papers/2011-icdcn-droplets.pdf&quot;&gt;autonomously&lt;/a&gt; from the central cloud.  You can read more about our &lt;a href=&quot;http://www.cam.ac.uk/research/features/privacy-by-design/&quot;&gt;privacy-by-design&lt;/a&gt; philosophy too.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Extending OCaml to run on secure hardware platforms that doesn&amp;rsquo;t compromise on performance, using the MIPS64-based &lt;a href=&quot;http://www.cl.cam.ac.uk/research/security/ctsrd/cheri.html&quot;&gt;capability processor&lt;/a&gt; that is being developed at at the Lab.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The &lt;a href=&quot;http://www.trilogy-project.org&quot;&gt;Trilogy&lt;/a&gt; was a hugely successful EU-funded effort on future evolution of the Internet, and resulted in &lt;a href=&quot;http://trilogy-project.org/publications/standards-contributions.html&quot;&gt;numerous RFCs&lt;/a&gt; on subjects such as multipath-TCP.  We&amp;rsquo;re partipating in the follow-up (imaginatively dubbed &amp;ldquo;Trilogy2&amp;rdquo;), and look forward to working on more structured abstractions for programming large-scale networks.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Getting involved&lt;/h3&gt;

&lt;p&gt;So, how can you get involved?  We are initially advertising three positions for full-time developers and researchers (&lt;a href=&quot;http://www.jobs.cam.ac.uk/job/-21662/&quot;&gt;junior&lt;/a&gt; and &lt;a href=&quot;http://www.jobs.cam.ac.uk/job/-21942/&quot;&gt;senior&lt;/a&gt;) to help us get started with the OCaml Platform and compiler development.  These aren&amp;rsquo;t conventional pure research jobs, and a successful candidate should enjoy the open-source development cycle (you retain your own copyright for your own projects).
The Computer Lab offers a pretty unique environment: a friendly, non-hierarchical group in a beautiful city, and some of the best faculty and students you could hope to hang out with.&lt;/p&gt;

&lt;p&gt;And finally, there is a longer lead time on &lt;a href=&quot;http://www.cl.cam.ac.uk/admissions/phd/&quot;&gt;applying for PhDs&lt;/a&gt;, but this is a great time to get involved.  When I started at the Lab in 2002, a little project called &lt;a href=&quot;http://xen.org&quot;&gt;Xen&lt;/a&gt; was just kicking off, and many of us had a wild (and oft great) time riding that wave.  Get in touch with myself, &lt;a href=&quot;http://www.cl.cam.ac.uk/~am21/&quot;&gt;Alan&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/~iml1/&quot;&gt;Ian&lt;/a&gt; or &lt;a href=&quot;http://www.cl.cam.ac.uk/~jac22/&quot;&gt;Jon&lt;/a&gt; soon if you are interested in applying!  There&amp;rsquo;s some more information available on the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/collaboration.html&quot;&gt;OCaml Labs pages&lt;/a&gt; about options.&lt;/p&gt;
</content><id>http://anil.recoil.org/2012/10/19/announcing-ocaml-labs.html</id><title type="text">Announcing the OCaml Labs project</title><updated>2012-10-19T02:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://openmirage.org/blog/breaking-up-is-easy-with-opam" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;When we first started developing Mirage in 2009, we were rewriting huge chunks of operating system and runtime code in OCaml. This ranged from low-level device drivers to higher-level networking protocols such as TCP/IP or HTTP.  The changes weren't just straight rewrites of C code either, but also involved experimenting with interfaces such as iteratees and &lt;a href=&quot;http://openmirage.org/wiki/tutorial-lwt&quot;&gt;lightweight threading&lt;/a&gt; to take advantage of OCaml's static type system.  To make all of this easy to work with, we decided to lump everything into a &lt;a href=&quot;http://github.com/avsm/mirage&quot;&gt;single Git repository&lt;/a&gt; that would bootstrap the entire system with a single &lt;code&gt;make&lt;/code&gt; invocation.&lt;/p&gt;
&lt;p&gt;Nowadays though, Mirage is self-hosting, the interfaces are settling down, the number of libraries are growing every day, and portions of it are being used in &lt;a href=&quot;http://openmirage.org/blog/xenstore-stub-domain&quot;&gt;the Xen Cloud Platform&lt;/a&gt;. So for the first developer release, we wanted to split up the monolithic repository into more manageable chunks, but still make it as easy as possible for the average OCaml developer to try out Mirage.&lt;/p&gt;
&lt;p&gt;Thanks to much hard work from &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas&lt;/a&gt; and his colleagues at &lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt;, we now have &lt;a href=&quot;http://opam.ocamlpro.com&quot;&gt;OPAM&lt;/a&gt;: a fully-fledged package manager for Mirage!  OPAM is a source-based package manager that supports a growing number of community OCaml libraries.  More importantly for Mirage, it can also switch between multiple compiler installations, and so support cross-compiled runtimes and modified standard libraries.&lt;/p&gt;
&lt;p&gt;OPAM includes compiler variants for Mirage-friendly environments for Xen and the UNIX &lt;code&gt;tuntap&lt;/code&gt; backends.  The &lt;a href=&quot;http://openmirage.org/wiki/install&quot;&gt;installation instructions&lt;/a&gt; now give you instructions on how to use OPAM, and the old monolithic repository is considered deprecated.  We're still working on full documentation for the first beta release, but all the repositories are on the &lt;a href=&quot;http://github.com/mirage&quot;&gt;Mirage organisation&lt;/a&gt; on Github, with some of the important ones being:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/mirage-platform&quot;&gt;mirage-platform&lt;/a&gt; has the core runtime for Xen and UNIX, implemented as the &lt;code&gt;OS&lt;/code&gt; module.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/mirage-net&quot;&gt;mirage-net&lt;/a&gt; has the TCP/IP networking stack.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/ocaml-cstruct&quot;&gt;ocaml-cstruct&lt;/a&gt; has the camlp4 extension to manipulate memory like C &lt;code&gt;struct&lt;/code&gt;s, but with type-safe accessors in OCaml.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/ocaml-xenstore&quot;&gt;ocaml-xenstore&lt;/a&gt; has a portable implementation of the Xenstore protocol to communicate with the Xen management stack from a VM (or even act as a &lt;a href=&quot;http://openmirage.org/blog/xenstore-stub-domain&quot;&gt;server in a stub domain&lt;/a&gt;).&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/ocaml-dns&quot;&gt;ocaml-dns&lt;/a&gt; is a pure OCaml implementation of the DNS protocol, including a server and stub resolver.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/ocaml-re&quot;&gt;ocaml-re&lt;/a&gt; is a pure OCaml version of several regular expression engines, including Perl compatibility.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/ocaml-uri&quot;&gt;ocaml-uri&lt;/a&gt; handles parsing the surprisingly complex URI strings.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/ocaml-cohttp&quot;&gt;ocaml-cohttp&lt;/a&gt; is a portable HTTP parser, with backends for Mirage, Lwt and Core/Async. This is a good example of how to factor out OS-specific concerns using the OCaml type system (and I plan to blog more about this soon).&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/ocaml-cow&quot;&gt;ocaml-cow&lt;/a&gt; is a set of syntax extensions for JSON, CSS, XML and XHTML, which are explained &lt;a href=&quot;http://openmirage.org/wiki/cow&quot;&gt;here&lt;/a&gt;, and used by this site.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/dyntype&quot;&gt;ocaml-dyntype&lt;/a&gt; uses camlp4 to &lt;a href=&quot;http://anil.recoil.org/papers/2011-dynamics-ml.pdf&quot;&gt;generate dynamic types&lt;/a&gt; and values from OCaml type declarations.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/orm&quot;&gt;ocaml-orm&lt;/a&gt; auto-generates SQL scheme from OCaml types via Dyntype, and currently supports SQLite.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://github.com/mirage/ocaml-openflow&quot;&gt;ocaml-openflow&lt;/a&gt; implements an OCaml switch and controller for the Openflow protocol.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;There are quite a few more that are still being hacked for release by the team, but we're getting there very fast now. We also have the Mirage ports of &lt;a href=&quot;http://github.com/avsm/ocaml-ssh&quot;&gt;SSH&lt;/a&gt; to integrate before the first release this year, and Haris has got some &lt;a href=&quot;http://github.com/mirage/ocaml-crypto-keys&quot;&gt;interesting DNSSEC&lt;/a&gt; code!  If you want to get involved, join the &lt;a href=&quot;http://openmirage.org/about&quot;&gt;mailing list&lt;/a&gt; or IRC channel!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/breaking-up-is-easy-with-opam</id><title type="text">Breaking up is easy to do (with OPAM)</title><updated>2012-10-17T17:30:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://openmirage.org/blog/xenstore-stub-domain" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;[ *Due to continuing development, some of the details in this blog post are now out-of-date. It is archived here.* ]&lt;/p&gt;
&lt;p&gt;On all hosts running &lt;a href=&quot;http://www.xen.org/&quot;&gt;Xen&lt;/a&gt;, there is a critical service called &lt;a href=&quot;http://wiki.xen.org/wiki/XenStore&quot;&gt;xenstore&lt;/a&gt;.
Xenstore is used to allow &lt;em&gt;untrusted&lt;/em&gt; user VMs to communicate with &lt;em&gt;trusted&lt;/em&gt; system VMs, so that&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;virtual disk and network connections can be established&lt;/li&gt;&lt;li&gt;performance statistics and OS version information can be shared&lt;/li&gt;&lt;li&gt;VMs can be remotely power-cycled, suspended, resumed, snapshotted and migrated.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;If the xenstore service fails then at best the host cannot be controlled (i.e. no VM start or shutdown)
and at worst VM isolation is compromised since an untrusted VM will be able to gain unauthorised access to disks or networks.
This blog post examines how to disaggregate xenstore from the monolithic domain 0, and run it as an independent &lt;a href=&quot;http://www.cl.cam.ac.uk/~dgm36/publications/2008-murray2008improving.pdf&quot;&gt;stub domain&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Recently in the Xen community, Daniel De Graaf and Alex Zeffertt have added support for
&lt;a href=&quot;http://lists.xen.org/archives/html/xen-devel/2012-01/msg02349.html&quot;&gt;xenstore stub domains&lt;/a&gt;
where the xenstore service is run directly as an OS kernel in its own isolated VM. In the world of Xen,
a running VM is a &amp;quot;domain&amp;quot; and a &amp;quot;stub&amp;quot; implies a single-purpose OS image rather than a general-purpose
machine.
Previously if something bad happened in &amp;quot;domain 0&amp;quot; (the privileged general-purpose OS where xenstore traditionally runs)
such as an out-of-memory event or a performance problem, then the critical xenstore process might become unusable
or fail altogether. Instead if xenstore is run as a &amp;quot;stub domain&amp;quot; then it is immune to such problems in
domain 0. In fact, it will even allow us to &lt;em&gt;reboot&lt;/em&gt; domain 0 in future (along with all other privileged
domains) without incurring any VM downtime during the reset!&lt;/p&gt;
&lt;p&gt;The new code in &lt;a href=&quot;http://xenbits.xensource.com/xen-unstable.hg&quot;&gt;xen-unstable.hg&lt;/a&gt; lays the necessary groundwork
(Xen and domain 0 kernel changes) and ports the original C xenstored to run as a stub domain.&lt;/p&gt;
&lt;p&gt;Meanwhile, thanks to &lt;a href=&quot;http://tab.snarc.org&quot;&gt;Vincent Hanquez&lt;/a&gt; and &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt;, we also have an
&lt;a href=&quot;http://gazagnaire.org/pub/SSGM10.pdf&quot;&gt;OCaml implementation of xenstore&lt;/a&gt; which, as well as the offering
memory-safety, also supports a high-performance transaction engine, necessary for surviving a stressful
&amp;quot;VM bootstorm&amp;quot; event on a large server in the cloud. Vincent and Thomas' code is Linux/POSIX only.&lt;/p&gt;
&lt;p&gt;Ideally we would have the best of both worlds:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;a fast, memory-safe xenstored written in OCaml,&lt;/li&gt;&lt;li&gt;running directly as a Xen stub domain i.e. as a specialised kernel image without Linux or POSIX&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;We can now do both, using Mirage!  If you're saying, &amp;quot;that sounds great! How do I do that?&amp;quot; then read on...&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Step 1: remove dependency on POSIX/Linux&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;If you read through the existing OCaml xenstored code, it becomes obvious that the main uses of POSIX APIs are for communication
with clients, both Unix sockets and for a special Xen inter-domain shared memory interface. It was a fairly
painless process to extract the required socket-like IO signature and turn the bulk of the server into
a &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual004.html&quot;&gt;functor&lt;/a&gt;. The IO signature ended up looking approximately like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    type t
    val read: t -&amp;gt; string -&amp;gt; int -&amp;gt; int -&amp;gt; int Lwt.t
    val write: t -&amp;gt; string -&amp;gt; int -&amp;gt; int -&amp;gt; unit Lwt.t
    val destroy: t -&amp;gt; unit Lwt.t&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;For now the dependency on &lt;a href=&quot;http://ocsigen.org/lwt/&quot;&gt;Lwt&lt;/a&gt; is explicit but in future I'll probably make it more abstract so we
can use &lt;a href=&quot;https://ocaml.janestreet.com/?q=node/100&quot;&gt;Core Async&lt;/a&gt; too.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Step 2: add a Mirage Xen IO implementation&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In a stub-domain all communication with other domains is via shared memory pages and &amp;quot;event channels&amp;quot;.
Mirage already contains extensive support for using these primitives, and uses them to create fast
network and block virtual device drivers. To extend the code to cover the Xenstore stub domain case,
only a few tweaks were needed to add the &amp;quot;server&amp;quot; side of a xenstore ring communication, in addition
to the &amp;quot;client&amp;quot; side which was already present.&lt;/p&gt;
&lt;p&gt;In Xen, domains share memory by a system of explicit &amp;quot;grants&amp;quot;, where a client (called &amp;quot;frontend&amp;quot;)
tells the hypervisor to allow a server (called &amp;quot;backend&amp;quot;) access to specific memory pages. Mirage
already had code to create such grants, all that was missing was a few simple functions to receive
grants from other domains.&lt;/p&gt;
&lt;p&gt;These changes are all in the current &lt;a href=&quot;https://github.com/mirage/mirage-platform&quot;&gt;mirage-platform&lt;/a&gt;
tree.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Step 3: add a Mirage Xen &amp;quot;main&amp;quot; module and Makefile&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The Mirage &amp;quot;main&amp;quot; module necessary for a stub domain looks pretty similar to the normal Unix
userspace case except that it:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;arranges to log messages via the VM console (rather than a file or the network, since a disk or network device cannot be created without a working xenstore, and it's important not to introduce a bootstrap
 problem here)&lt;/li&gt;&lt;li&gt;instantiates the server functor with the shared memory inter-domain IO module.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;The Makefile looks like a regular Makefile, invoking ocamlbuild. The whole lot is built with
&lt;a href=&quot;http://oasis.forge.ocamlcore.org/&quot;&gt;OASIS&lt;/a&gt; with a small extension added by &lt;a href=&quot;http://anil.recoil.org/&quot;&gt;Anil&lt;/a&gt; to set a few options
required for building Xen kernels rather than regular binaries.&lt;/p&gt;
&lt;p&gt;... and it all works!&lt;/p&gt;
&lt;p&gt;The code is in two separate repositories:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/djs55/ocaml-xenstore&quot;&gt;ocaml-xenstore&lt;/a&gt;: contains all the generic stuff&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/djs55/ocaml-xenstore-xen&quot;&gt;ocaml-xenstore-xen&lt;/a&gt;: contains the unix userspace
 and xen stub domain IO modules and &amp;quot;main&amp;quot; functions&lt;/li&gt;&lt;li&gt;(optional) To regenerate the OASIS file, grab the &lt;code&gt;add-xen&lt;/code&gt; branch from this &lt;a href=&quot;http://github.com/avsm/oasis&quot;&gt;OASIS fork&lt;/a&gt;.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Example build instructions&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;If you want to try building it yourself, try the following on a modern 64-bit OS. I've tested these
instructions on a fresh install of Debian Wheezy.&lt;/p&gt;
&lt;p&gt;First install OCaml and the usual build tools:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    apt-get install ocaml build-essential git curl rsync&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then install the OCamlPro &lt;code&gt;opam&lt;/code&gt; package manager to simplify the installation of extra packages&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    git clone git://github.com/OCamlPro/opam.git
    cd opam
    make
    make install
    cd ..&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Initialise OPAM with the default packages:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    opam --yes init
    eval `opam config -env`&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Add the &amp;quot;mirage&amp;quot; development package source (this step will not be needed once the package definitions are upstreamed)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    opam remote -add dev git://github.com/mirage/opam-repo-dev&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Switch to the special &amp;quot;mirage&amp;quot; version of the OCaml compiler&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    opam --yes switch -install 3.12.1+mirage-xen
    opam --yes switch 3.12.1+mirage-xen
    eval `opam config -env`&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Install the generic Xenstore protocol libraries&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    opam --yes install xenstore&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Install the Mirage development libraries&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    opam --yes install mirage&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If this fails with &amp;quot;+ runtime/dietlibc/lib/atof.c:1: sorry, unimplemented: 64-bit mode not compiled in&amp;quot; it means you need a 64-bit build environment.
Next, clone the xen stubdom tree&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    git clone git://github.com/djs55/ocaml-xenstore-xen&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Build the Xen stubdom&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    cd ocaml-xenstore-xen
    make&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The binary now lives in &lt;code&gt;xen/_build/src/server_xen.xen&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Deploying on a Xen system&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Running a stub Xenstored is a little tricky because it depends on the latest and
greatest Xen and Linux PVops kernel. In the future it'll become much easier (and probably
the default) but for now you need the following:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;xen-4.2 with XSM (Xen Security Modules) turned on&lt;/li&gt;&lt;li&gt;A XSM/FLASK policy which allows the stubdom to call the &amp;quot;domctl getdomaininfo&amp;quot;. For the moment it's safe to skip this step with the caveat that xenstored will leak connections when domains die.&lt;/li&gt;&lt;li&gt;a Xen-4.2-compatible toolstack (either the bundled xl/libxl or xapi with &lt;a href=&quot;http://github.com/djs55/xen-api/tree/xen-4.2&quot;&gt;some patches&lt;/a&gt;)&lt;/li&gt;&lt;li&gt;Linux-3.5 PVops domain 0 kernel&lt;/li&gt;&lt;li&gt;the domain builder binary &lt;code&gt;init-xenstore-domain&lt;/code&gt; from &lt;code&gt;xen-4.2/tools/xenstore&lt;/code&gt;.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;To turn the stub xenstored on, you need to edit whichever &lt;code&gt;init.d&lt;/code&gt; script is currently starting xenstore and modify it to call&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    init-xenstore-domain /path/to/server_xen.xen 256 flask_label&lt;/code&gt;&lt;/pre&gt;
   </content><id>http://openmirage.org/blog/xenstore-stub-domain</id><title type="text">Building a &quot;Xenstore stub domain&quot; with Mirage</title><updated>2012-09-12T00:00:00+00:00</updated><author><email></email><name>Dave Scott</name></author></entry><entry><link href="http://openmirage.org/blog/announcing-mirage-openflow" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;&lt;strong&gt;Due to continuing development, some of the details in this blog post are now out-of-date. It is archived here.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Something we've been working on for a little while now that we're pretty
excited about is an &lt;a href=&quot;http://openflow.org/&quot;&gt;OpenFlow&lt;/a&gt; implementation for
Mirage. For those who're not networking types, in short, OpenFlow is a
protocol and framework for devolving network control to software running on
platforms other than the network elements themselves. It consists of three
main parts:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;a &lt;em&gt;controller&lt;/em&gt;, responsible for exercising control over the network;&lt;/li&gt;&lt;li&gt;&lt;em&gt;switches&lt;/em&gt;, consisting of switching hardware, with flow tables that apply
 forwarding behaviours to matching packets; and&lt;/li&gt;&lt;li&gt;the &lt;em&gt;protocol&lt;/em&gt;, by which controllers and switches communicate.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;For more -- and far clearer! -- explanations, see any of the many online
OpenFlow resources such as &lt;a href=&quot;http://openflowhub.org&quot;&gt;OpenFlowHub&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Within Mirage we have an OpenFlow implementation in two parts: individual
libraries that provide controller and switch functionality. Linking the switch
library enables your application to become a software-based OpenFlow switch.
Linking in the controller library enables your application to exercise direct
control over OpenFlow network elements.&lt;/p&gt;
&lt;p&gt;The controller is modelled after the &lt;a href=&quot;http://noxrepo.org/&quot;&gt;NOX&lt;/a&gt; open-source
controller and currently provides only relatively low-level access to the
OpenFlow primitives: a very cool thing to build on top of it would be a
higher-level abstraction such as that provided by
&lt;a href=&quot;http://haskell.cs.yale.edu/?page_id=376&quot;&gt;Nettle&lt;/a&gt; or
&lt;a href=&quot;http://www.frenetic-lang.org/&quot;&gt;Frenetic&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The switch is primarily intended as an experimental platform -- it is
hopefully easier to extend than some of the existing software switches while
still being sufficiently high performance to be interesting!&lt;/p&gt;
&lt;p&gt;By way of a sample of how it fits together, here's a skeleton for a simple
controller application:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;type mac_switch = {
  addr: OP.eaddr; 
  switch: OP.datapath_id;
}

type switch_state = {
  mutable mac_cache: 
        (mac_switch, OP.Port.t) Hashtbl.t;
  mutable dpid: OP.datapath_id list
}

let switch_data = {
  mac_cache = Hashtbl.create 7; 
  dpid = [];
} 

let join_cb controller dpid evt =
  let dp = match evt with
      | OE.Datapath_join c -&amp;gt; c
      | _ -&amp;gt; invalid_arg &amp;quot;bogus datapath_join&amp;quot;
  in 
  switch_data.dpid &amp;lt;- switch_data.dpid @ [dp]

let packet_in_cb controller dpid evt =
  (* algorithm details omitted for space *)

let init ctrl = 
  OC.register_cb ctrl OE.DATAPATH_JOIN join_cb;
  OC.register_cb ctrl OE.PACKET_IN packet_in_cb

let main () =
  Net.Manager.create (fun mgr interface id -&amp;gt;
    let port = 6633 in 
    OC.listen mgr (None, port) init
  )&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We've written up some of the gory details of the design, implementation and
performance in a &lt;a href=&quot;http://openmirage.org/docs/iccsdn12-mirage.pdf&quot;&gt;short paper&lt;/a&gt; to the
&lt;a href=&quot;http://www.ieee-icc.org/&quot;&gt;ICC&lt;/a&gt;
&lt;a href=&quot;http://sdn12.mytestbed.net/&quot;&gt;Software Defined Networking&lt;/a&gt; workshop. Thanks to
some sterling work by &lt;a href=&quot;http://www.cl.cam.ac.uk/~cr409/&quot;&gt;Haris&lt;/a&gt; and
&lt;a href=&quot;mailto:balraj.singh@cl.cam.ac.uk&quot;&gt;Balraj&lt;/a&gt;, the headline numbers are pretty
good though: the unoptimised Mirage controller implementation is only 30--40%
lower performance than the highly optimised NOX &lt;em&gt;destiny-fast&lt;/em&gt; branch, which
drops most of the programmability and flexibility of NOX; but is about &lt;em&gt;six
times&lt;/em&gt; higher performance than the fully flexible current NOX release. The
switch's performance  running as a domU virtual machine is indistinguishable
from the current &lt;a href=&quot;http://openvswitch.org/&quot;&gt;Open vSwitch&lt;/a&gt; release.&lt;/p&gt;
&lt;p&gt;For more details see &lt;a href=&quot;http://openmirage.org/docs/iccsdn12-mirage.pdf&quot;&gt;the paper&lt;/a&gt; or contact
&lt;a href=&quot;mailto:mort@cantab.net&quot;&gt;Mort&lt;/a&gt;,
&lt;a href=&quot;mailto:charalampos.rotsos@cl.cam.ac.uk&quot;&gt;Haris&lt;/a&gt; or
&lt;a href=&quot;mailto:anil@recoil.org&quot;&gt;Anil&lt;/a&gt;. Please do get in touch if you've any comments
or questions, or you do anything interesting with it!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/announcing-mirage-openflow</id><title type="text">Connected Cloud Control: OpenFlow in Mirage</title><updated>2012-02-29T11:10:00+00:00</updated><author><email></email><name>Richard Mortier</name></author></entry><entry><link href="http://www.skjegstad.com/blog/2012/01/12/ardrone-test-flight-1/" rel="alternate"/><contributor><uri>http://www.skjegstad.com/feeds/all.atom.xml</uri><name>Magnus Skjegstad</name></contributor><content type="html">&lt;p&gt;I bought an AR.Drone some time ago, but I haven't been able to do any testing with it until now. Yesterday we did a short experiment to see if it could lift the mobile phones we used for the &lt;a href=&quot;http://www.skjegstad.com/blog/2011/12/02/experimenting-with-distributed-chat/&quot;&gt;chat experiment&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/ardrone_experiment_1/ardrone1.jpg&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;


&lt;p&gt;In this picture the phone is taped to the side of the AR.Drone. The phone was running an Android app which took pictures at regular intervals and sent its current GPS position. The GPS coordinates and the images were then sent to a laptop. Here are two of the pictures taken by the phone. &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/ardrone_experiment_1/camera_28.jpg&quot; class=&quot;center&quot;/&gt;
&lt;img src=&quot;http://www.skjegstad.com/images/blog/ardrone_experiment_1/camera_33.jpg&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;We also recorded a video of the experiment. The AR.Drone did not seem to have any problems stabilizing itself with a mobile phone taped to its side.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;videobox&quot;&gt;
            &lt;video width=&quot;480&quot; height=&quot;360&quot; preload=&quot;none&quot; controls=&quot;controls&quot; poster=&quot;/images/blog/ardrone_experiment_1/ardrone-test.png&quot;&gt;&lt;source src=&quot;/images/blog/ardrone_experiment_1/ardrone-test.m4v&quot; type=&quot;video/mp4; codecs=&amp;quot;avc1.42E01E, mp4a.40.2&amp;quot;&quot;&gt;&lt;/source&gt;&lt;/video&gt;&lt;/div&gt;
&lt;p&gt;Here's some of the output from the test program on the laptop. It only shows the GPS coordinates in this screenshot.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/ardrone_experiment_1/screenshot1.png&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;(Video and images by &lt;a href=&quot;https://plus.google.com/103407634074542782203&quot;&gt;Ketil Lund&lt;/a&gt;)&lt;/p&gt;</content><id>http://www.skjegstad.com/blog/2012/01/12/ardrone-test-flight-1/</id><title type="text">AR.Drone test flight #1</title><updated>2012-01-12T11:46:00+00:00</updated><author><email></email><name>Magnus Skjegstad</name></author></entry><entry><link href="http://www.skjegstad.com/blog/2012/01/05/macvim-and-funnel-pl/" rel="alternate"/><contributor><uri>http://www.skjegstad.com/feeds/all.atom.xml</uri><name>Magnus Skjegstad</name></contributor><content type="html">&lt;p&gt;There are several plugins for Vim and MacVim that require a connection to an external program such as R, Lisp or Octave. Some of them rely on a Perl-script written by Larry Clapp called funnel.pl to communicate with the external program. Unfortunately, this script can be difficult to get to work in OS X as it depends on the GNU Readline library. &lt;/p&gt;


&lt;p&gt;Before you use this guide you should follow the instructions for the plugin you want to configure (e.g. for &lt;a href=&quot;http://www.uft.uni-bremen.de/chemie/ranke/?page=vim_R_linux&quot;&gt;R&lt;/a&gt;, &lt;a href=&quot;http://www.vim.org/scripts/script.php?script_id=221&quot;&gt;Lisp&lt;/a&gt; or &lt;a href=&quot;http://www.vim.org/scripts/script.php?script_id=1049&quot;&gt;Octave&lt;/a&gt;).  At some point the instructions will tell you to start funnel.pl and it will fail with an error message like&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;Can&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;initialize&amp;quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;via&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;package&lt;/span&gt; 
&lt;span class=&quot;s&quot;&gt;&amp;quot;Term::ReadLine::Stub&amp;quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;funnel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pl&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;404.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To fix this, first make sure you have IO::Pty installed from CPAN:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cpan&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pty&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Next, we need to install GNU Readline. If you use &lt;a href=&quot;http://mxcl.github.com/homebrew&quot;&gt;Homebrew&lt;/a&gt; it can be installed with&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;brew&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;readline&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Homebrew does not install the library system wide, as that would be in potential conflict with libedit, the library normally used in OS X. Instead, it places it in a subdirectory in your Homebrew directory structure. On my machine, this was /usr/local/homebrew/Cellar/readline/6.2.2. If you are unsure you can use the command&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;brew&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;readline&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;to see where it was installed.&lt;/p&gt;
&lt;p&gt;Finally, we need to install Term::ReadLine::Gnu and link it to the GNU Readline library. You should be able to find the latest version &lt;a href=&quot;http://search.cpan.org/dist/Term-ReadLine-Gnu/&quot;&gt;here&lt;/a&gt;. I used version 1.20.&lt;/p&gt;
&lt;p&gt;Extract the source code and run&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;perl&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Makefile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PL&lt;/span&gt; \
    &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;includedir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;usr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;homebrew&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cellar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readline&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;6.2.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; \
    &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libdir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;usr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;homebrew&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cellar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readline&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;6.2.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Change the libdir and includedir options so that they reflect the location of the readline-library installed by Homebrew. &lt;/p&gt;
&lt;p&gt;You should now be able to compile and install the Term::ReadLine::Gnu module using &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; \
&lt;span class=&quot;n&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;After compilation succeeds and the module is installed you should be able to run funnel.pl.&lt;/p&gt;</content><id>http://www.skjegstad.com/blog/2012/01/05/macvim-and-funnel-pl/</id><title type="text">Getting funnel.pl to work in OS X</title><updated>2012-01-05T00:00:00+00:00</updated><author><email></email><name>Magnus Skjegstad</name></author></entry><entry><link href="http://www.skjegstad.com/blog/2011/12/02/experimenting-with-distributed-chat/" rel="alternate"/><contributor><uri>http://www.skjegstad.com/feeds/all.atom.xml</uri><name>Magnus Skjegstad</name></contributor><content type="html">&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/uavexperiment/image5.jpg&quot; class=&quot;left&quot;/&gt;&lt;/p&gt;
&lt;p&gt;In this experiment we use a remote controlled airplane and an Android phone to carry data between two computers. The idea is that in environments where
you are without a network connection you could still get a working network environment with the help of mobile nodes picking up messages in one area and delivering them in another. A typical
scenario is for example rescue operations, where people may move in and out of a difficult to access rescue area and carry messages with them on their mobile phones. 
Although we focus on chat in this experiment, the real data carried could be anything you could store in a file, e.g. medical data from patients, information gathered from sensors in the 
environment, images etc.
&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/uavexperiment/MobileNode.png&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The image above illustrates the scenario we use in the experiment. Bob and Alice are two users who are unable to communicate directly. Another user, 
Charlie, has been visiting Bob and is about to go over to Alice. As Bob is unable to reach Alice he delivers his
messages to Charlie, who then proceeds to carry them over to Alice.  This is the basic principle we evaluate in the experiment. 
Except Bob and Alice are laptops and Charlie is a cell phone attached to an airplane.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/uavexperiment/image1.jpg&quot; title=&quot;Espen Skjervold holding the airplane&quot; height=&quot;300&quot; width=&quot;300&quot; alt=&quot;Espen Skjervold holding the airplane&quot; class=&quot;left&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The client we use on the laptops is the same as I wrote for a &lt;a href=&quot;http://www.skjegstad.com/papers/milcom11_distributed_chat.pdf&quot;&gt;paper&lt;/a&gt; I presented at MILCOM in November. It runs on top of a generic protocol and middleware for 
distributing content reliably in dynamic network environments, called Mist. In the paper we only evaluated its performance in a virtual environment, so after we finished the paper we 
thought it would be interesting to see if we could do a real experiment with the same software.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/uavexperiment/image2.jpg&quot; title=&quot;Mobile phone attached to the plane with electrical tape&quot; height=&quot;300&quot; width=&quot;200&quot; alt=&quot;Mobile phone attached to the plane with electrical tape&quot; class=&quot;right&quot;/&gt;&lt;/p&gt;
&lt;p&gt;One of my co-authors on the paper, Espen Skjervold, had a remote controlled airplane we used to carry the mobile node. As the plane was small and light we had to find an Android phone that it was 
able to lift for longer time periods. The phone we ended up using was the &lt;a href=&quot;http://www.sonyericsson.com/cws/corporate/products/phoneportfolio/specification/xperiax10mini&quot;&gt;Sony Ericsson Xperia x10 mini&lt;/a&gt;. 
According to the specifications it only weighs 88 grams. With the help of high quality electrical tape we taped the phone to the plane, as seen in the picture to the right.&lt;/p&gt;
&lt;p&gt;On the Android phone we installed a very basic application which just starts the Mist middleware. It also regularly transmits the GPS coordinates of the phone. For the 
clients we used two Macbooks running the chat client I wrote for the paper. The clients generate random text strings from &lt;a href=&quot;http://en.wikipedia.org/wiki/Lorem_ipsum&quot;&gt;Lorem Ipsum&lt;/a&gt; every 10 seconds. 
The phone and the laptops were all configured to join the same ad-hoc wireless network.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/uavexperiment/image3.jpg&quot; alt=&quot;Node 1&quot; class=&quot;center&quot; title=&quot;Node 1&quot;/&gt;
&lt;img src=&quot;http://www.skjegstad.com/images/blog/uavexperiment/image4.jpg&quot; alt=&quot;Node 2&quot; class=&quot;right&quot; title=&quot;Node 2&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The radio range of the laptops and the phone turned out to be much longer than we had anticipated. To reduce the radio range, we placed one of the nodes in the trunk of the car. We placed the other node behind a car at the 
other end of the parking lot. After some trial and error we managed to find a placement of the nodes which allowed the airplane to only be within the radio range of one laptop at the time.&lt;/p&gt;
&lt;p&gt;The image below shows the airplane carrying messages between the two nodes. The nodes are never in contact with the airplane at the same time, so the messages have to be physically carried between the nodes by the Android-phone/airplane.&lt;/p&gt;
&lt;p&gt;When the plane comes in contact with one of the nodes the Android-phone picks up any new messages and delivers old ones. The plane then moves out of radio range for while, before it comes in contact with the other node and repeats the process.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.skjegstad.com/images/blog/uavexperiment/image6.jpg&quot; alt=&quot;Carrying chat messages from node 2 to node 1.&quot; class=&quot;center&quot; title=&quot;Carrying chat messages from node 2 to node 1.&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The plane we used was not very fast, so we weren't able to reach the same speeds as we tested in the paper. But this small scale demonstration shows that the Mist middleware also works in real world experiments. &lt;/p&gt;
&lt;p&gt;The Mist middleware will soon be released as open source.&lt;/p&gt;</content><id>http://www.skjegstad.com/blog/2011/12/02/experimenting-with-distributed-chat/</id><title type="text">Experimenting with distributed chat</title><updated>2011-12-02T00:46:00+00:00</updated><author><email></email><name>Magnus Skjegstad</name></author></entry><entry><link href="http://www.skjegstad.com/blog/2011/10/20/a-stand-alone-java-bloom-filter/" rel="alternate"/><contributor><uri>http://www.skjegstad.com/feeds/all.atom.xml</uri><name>Magnus Skjegstad</name></contributor><content type="html">&lt;p&gt;Some years ago I needed a Bloom filter implementation in Java. At the time, most implementations where either written for a special purpose or relied on other libraries. I decided to write my own Bloomfilter-class which did not depend on anything outside the standard JDK. &lt;/p&gt;
&lt;p&gt;This post gives some examples of how the implementation can be used. If you want to go straight to the source code, it is available &lt;a href=&quot;https://github.com/magnuss/java-bloomfilter&quot;&gt;here&lt;/a&gt;. You can also download &lt;a href=&quot;https://github.com/MagnusS/Java-BloomFilter/blob/master/src/com/skjegstad/utils/BloomFilter.java&quot;&gt;BloomFilter.java&lt;/a&gt; directly if you don't need the whole project. &lt;/p&gt;
&lt;p&gt;To create an empty Bloom filter, call the constructor with the required false positive probability and the number of elements you expect to add to the Bloom filter. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p_fp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// False positive probability&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Expected number of elements&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;BloomFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BloomFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The constructor chooses a length and number of hash functions which will provide the given false positive probability (approximately). Note that if you insert more elements than the number of expected elements you specify, the actual false positive probability will rapidly increase.&lt;/p&gt;
&lt;p&gt;There are several other constructors available which provide different levels of control of how the Bloom filter is initialized. You can also specify the Bloom filter parameters directly (bits per element, number of hash functions and number of elements).&lt;/p&gt;
&lt;p&gt;After the Bloom filter has been created, new elements may be added using the add()-method.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To check whether an element has been stored in the Bloom filter, use the contains()-method. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// returns true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Keep in mind that the accuracy of this method depends on the false positive probability. It will always return true for elements which have been added to the Bloom filter, but it may also return true for elements which have not been added. The accuracy can be estimated using the expectedFalsePositiveProbability()-method.&lt;/p&gt;
&lt;p&gt;Put together, here is the full example.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p_fp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// False positive probability&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Expected number of elements&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;BloomFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BloomFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Always returns true&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Bloom filter contains foo!&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Probability of a false positive: &amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
         &lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;expectedFalsePositiveProbability&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bar&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Should return false, but could return true&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;There was a false positive.&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The source code is currently hosted at &lt;a href=&quot;https://github.com/magnuss/java-bloomfilter&quot;&gt;GitHub&lt;/a&gt;. &lt;/p&gt;</content><id>http://www.skjegstad.com/blog/2011/10/20/a-stand-alone-java-bloom-filter/</id><title type="text">A stand-alone Java Bloom filter</title><updated>2011-10-20T11:17:00+00:00</updated><author><email></email><name>Magnus Skjegstad</name></author></entry><entry><link href="http://openmirage.org/blog/an-outing-to-cufp" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;The team signed up to do a tutorial at &lt;a href=&quot;http://cufp.org&quot;&gt;CUFP&lt;/a&gt; on the topic of &lt;a href=&quot;http://cufp.org/conference/sessions/2011/t3-building-functional-os&quot;&gt;Building a Functional OS&lt;/a&gt;, which meant zooming off to Tokyo!  This was the first public show of the project, and resulted in a furious &lt;a href=&quot;https://github.com/avsm/mirage/graphs/impact&quot;&gt;flurry of commits&lt;/a&gt; from the whole team to get it ready. The 45-strong crowd at the tutorial were really full of feedback, and particular thanks to &lt;a href=&quot;http://www.deinprogramm.de/sperber/&quot;&gt;Michael&lt;/a&gt; for organising the event, and &lt;a href=&quot;http://ocaml.janestreet.com/?q=blog/5&quot;&gt;Yaron&lt;/a&gt;, &lt;a href=&quot;http://monkey.org/~marius/&quot;&gt;Marius&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/#!/stevej&quot;&gt;Steve&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/wil&quot;&gt;Wil&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/#!/adoemon&quot;&gt;Adrian&lt;/a&gt; and the rest for shouting out questions regularly!&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;The tutorial&lt;/em&gt; is &lt;a href=&quot;http://github.com/avsm/mirage-tutorial&quot;&gt;a Mirage application&lt;/a&gt;, so you can clone it and view it locally through your web browser. The content is mirrored at &lt;a href=&quot;http://tutorial.openmirage.org&quot;&gt;tutorial.openmirage.org&lt;/a&gt;, although it does require cleanup to make it suitable to an online audience. The SVG integration is awkward and it only works on Chrome/Safari, so I will probably rewrite it using &lt;a href=&quot;http://imakewebthings.github.com/deck.js/&quot;&gt;deck.js&lt;/a&gt; soon. The tutorial is a good showcase of Mirage, as it compiles to Xen, UNIX (both kernel sockets and direct tuntap) with a RAMdisk or external filesystem, and is a good way to mess around with application synthesis (look at the &lt;code&gt;Makefile&lt;/code&gt; targets in &lt;code&gt;slides/&lt;/code&gt;).&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;Installation&lt;/em&gt;: &lt;a href=&quot;http://openmirage.org/wiki/install&quot;&gt;instructions&lt;/a&gt; have been simplified, and we now only require OCaml on the host and include everything else in-tree. Thomas has also made Emacs and Vim plugins that are compatible with the ocamlbuild layout.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;Lwt&lt;/em&gt;: a &lt;a href=&quot;http://openmirage.org/wiki/tutorial-lwt&quot;&gt;new tutorial&lt;/a&gt; which walks you through the cooperative threading library we use, along with exercises (all available in &lt;a href=&quot;http://github.com/avsm/mirage-tutorial&quot;&gt;mirage-tutorial&lt;/a&gt;). Raphael and Balraj are looking for feedback on this, so get in touch!&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;Javascript&lt;/em&gt;: via &lt;a href=&quot;http://nodejs.org&quot;&gt;node.js&lt;/a&gt; did not work in time for the tutorial, as integrating I/O is a tangled web that will take some time to sort out. Raphael is working on this in a &lt;a href=&quot;https://github.com/raphael-proust/nodejs_of_ocaml&quot;&gt;separate tree&lt;/a&gt; for now.  As part of this effort though, he integrated a pure OCaml &lt;a href=&quot;http://openmirage.org/wiki/ocaml-regexp&quot;&gt;regular expression library&lt;/a&gt; that does not require C bindings, and is surprisingly fast.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;Devices&lt;/em&gt;: we can now synthesise binaries that share common code but have very different I/O interfaces. This is due to a new device manager, and David also heroically wrote a complete &lt;a href=&quot;http://github.com/avsm/mirage/tree/master/lib/fs&quot;&gt;FAT12/16/32 library&lt;/a&gt; that we demonstrated.  Yaron Minsky suggested a &lt;a href=&quot;https://gist.github.com/1245418&quot;&gt;different approach&lt;/a&gt; to the device manager using &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/manual021.html#toc81&quot;&gt;first-class modules&lt;/a&gt; instead of objects, so I am experimentally trying this before writing documentation on it.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;TCP&lt;/em&gt;: the notorious Mirage stack is far more robust due to our resident networking guru Balraj hunting down last-minute bugs. Although it held together with sticky tape during the tutorial, he is now adding retransmission and congestion control to make it actually standards-compliant.  Still, if you dont have any packet loss, the &lt;a href=&quot;http://xen.openmirage.org/&quot;&gt;unikernel version&lt;/a&gt; of this website does actually serve pages.&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;OpenFlow&lt;/em&gt;: is a new &lt;a href=&quot;http://www.openflow.org/wk/index.php/OpenFlow_v1.0&quot;&gt;standard&lt;/a&gt; for &lt;a href=&quot;http://networkheresy.wordpress.com/&quot;&gt;Software Defined Networking&lt;/a&gt;, and Haris and Mort have been hacking away at a complete implementation directly in Mirage!  We will be giving a tutorial on this at the &lt;a href=&quot;http://changeofelia.info.ucl.ac.be/&quot;&gt;OFELIA summer school&lt;/a&gt; in November (it is summer somewhere, I guess). The prospect of a high-speed unikernel switching fabric for the cloud, programmed in a functional style, is something I am really looking forward to seeing!&lt;/p&gt;
&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;Jane Street Core&lt;/em&gt;: preceeding us was Yaron's &lt;a href=&quot;http://cufp.org/conference/sessions/2011/t2-janestreets-ocaml-core-library&quot;&gt;Core&lt;/a&gt; tutorial. Since Mirage provides it own complete standard library, we can adopt portions of Core that do not require OS threads or UNIX-specific features.  I really like the idea that Mirage enforces a discipline on writing portable interfaces, as dependencies on OS-specific features do sneak in insiduously and make switching to different platforms very difficult (e.g. Windows support). Incidentally, Yaron's &lt;a href=&quot;http://queue.acm.org/detail.cfm?id=2038036&amp;amp;ref=fullrss&quot;&gt;ACM Queue&lt;/a&gt; article is a great introduction to OCaml.&lt;/p&gt;
&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;So as you can see, it has been a busy few months!  Much of the core of Mirage is settling down now, and we are writing a paper with detailed performance benchmarks of our various backends.  Keep an eye on the &lt;a href=&quot;https://github.com/avsm/mirage/issues?milestone=2&amp;amp;state=open&quot;&gt;Github milestone&lt;/a&gt; for the preview release, join our &lt;a href=&quot;https://lists.cam.ac.uk/mailman/listinfo/cl-mirage&quot;&gt;new mailing list&lt;/a&gt;, or follow the newly sentient &lt;a href=&quot;http://twitter.com/openmirage&quot;&gt;openmirage on twitter&lt;/a&gt;!&lt;/p&gt;

   </content><id>http://openmirage.org/blog/an-outing-to-cufp</id><title type="text">An Outing to CUFP 2011</title><updated>2011-09-29T11:10:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://openmirage.org/blog/spring-cleaning" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;We've been plugging away on Mirage for the last few months, and things are starting to take shape nicely. As the older blog entries were out-of-date, we have shifted the descriptive material to a new &lt;a href=&quot;http://openmirage.org/wiki&quot;&gt;wiki&lt;/a&gt; section instead. What else has been happening?&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;The Xen unikernel backend is fully event-driven (no interrupts) and very stable under stress testing now. The TCP stack is also complete enough to self-host this website, and you can try it out by navigating to &lt;a href=&quot;http://xen.openmirage.org&quot;&gt;xen.openmirage.org&lt;/a&gt;. The stack doesnt actually do retransmissions yet, so your user experience may &amp;quot;vary&amp;quot;. Check out the &lt;a href=&quot;http://openmirage.org/wiki/install&quot;&gt;installation&lt;/a&gt; and &lt;a href=&quot;http://openmirage.org/wiki/hello-world&quot;&gt;hello world&lt;/a&gt; guides to try it out for yourself.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://www.cs.nott.ac.uk/~rmm/&quot;&gt;Richard Mortier&lt;/a&gt; has put together a performance testing framework that lets us analyse the performance of Mirage applications on different backends (e.g. UNIX vs Xen), and against other conventional applications (e.g. BIND for DNS serving). Read more in the wiki &lt;a href=&quot;http://openmirage.org/wiki/performance&quot;&gt;here&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; has rewritten the website to use the COW syntax extensions. He has also started a new job with &lt;a href=&quot;http://www.ocamlpro.com/&quot;&gt;OCamlPro&lt;/a&gt; doing consultancy on OCaml, so congratulations are in order!&lt;/li&gt;&lt;li&gt;Thomas has also started integrating experimental Node.js support to fill in our buzzword quota for the year (and more seriously, to explore alternative VM backends for Mirage applications). &lt;/li&gt;&lt;li&gt;The build system (often a bugbear of such OS projects) now fully uses &lt;a href=&quot;http://brion.inria.fr/gallium/index.php/Ocamlbuild&quot;&gt;ocamlbuild&lt;/a&gt; for all OCaml and C dependencies, and so the whole OS can be rebuilt with different compilers (e.g. LLVM) or flags with a single invocation.&lt;/li&gt;&lt;/ul&gt;

&lt;p&gt;There are some exciting developments coming up later this year too!&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/raphael-proust&quot;&gt;Raphael Proust&lt;/a&gt; will be joining the Mirage team in Cambridge over the summer in an internship.&lt;/li&gt;&lt;li&gt;Anil Madhavapeddy will be giving several &lt;a href=&quot;http://openmirage.org/wiki/talks&quot;&gt;tech talks&lt;/a&gt; on Mirage: at the &lt;a href=&quot;https://forge.ocamlcore.org/plugins/mediawiki/wiki/ocaml-meeting/index.php/OCamlMeeting2011&quot;&gt;OCaml User's Group&lt;/a&gt; in Paris this Friday, at &lt;a href=&quot;http://acunu.com&quot;&gt;Acunu&lt;/a&gt; in London on May 31st, and at Citrix Cambridge on June 3rd. If you are interested, please do drop by and say hi.&lt;/li&gt;&lt;li&gt;Verisign has supported the project with an &lt;a href=&quot;http://www.marketwire.com/press-release/Verisign-Announces-Winners-of-Grants-Aimed-at-Strengthening-Internet-Infrastructure-NASDAQ-VRSN-1412893.htm&quot;&gt;Internet Infrastructure Grant&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://dave.recoil.org&quot;&gt;David Scott&lt;/a&gt; (chief architect of the Xen Cloud Platform) and &lt;a href=&quot;http://anil.recoil.org&quot;&gt;Anil Madhavapeddy&lt;/a&gt; will give a joint tutorial on constructing functional operating systems at the &lt;a href=&quot;http://cufp.org&quot;&gt;Commercial Users of Functional Programming&lt;/a&gt; workshop in Tokyo, Japan in September.&lt;/li&gt;&lt;/ul&gt;
   </content><id>http://openmirage.org/blog/spring-cleaning</id><title type="text">A Spring Wiki Cleaning</title><updated>2011-04-11T15:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry><entry><link href="http://openmirage.org/blog/self-hosting-mirage-website" rel="alternate"/><contributor><uri>http://openmirage.org/blog/atom.xml</uri><name>Mirage OS</name></contributor><content type="html">
      &lt;p&gt;Welcome to the new self-hosting website for the Mirage project!  As we go about preparing a release for later in the year, this blog will contain technical musings and work-in-progress reports of various bits of the operating system as they mature. Since there's so much to talk about, we decided to start with a blog format, and eventually collect things into a proper document as they stabilise.&lt;/p&gt;
&lt;p&gt;Feel free to subscribe to the &lt;a href=&quot;http://openmirage.org/blog/atom.xml&quot;&gt;Atom&lt;/a&gt; feed to keep up-to-date with our progress, or just e-mail us or comment on individual posts with any queries.&lt;/p&gt;

   </content><id>http://openmirage.org/blog/self-hosting-mirage-website</id><title type="text">Self-hosting Mirage website</title><updated>2010-10-11T15:00:00+00:00</updated><author><email></email><name>Anil Madhavapeddy</name></author></entry></feed>